(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))l(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const _ of d.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&l(_)}).observe(document,{childList:!0,subtree:!0});function i(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function l(c){if(c.ep)return;c.ep=!0;const d=i(c);fetch(c.href,d)}})();/**
* @vue/shared v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function bx(n){const t=Object.create(null);for(const i of n.split(","))t[i]=1;return i=>i in t}const ts={},ff=[],Nc=()=>{},IE=()=>!1,yg=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),wx=n=>n.startsWith("onUpdate:"),Kr=Object.assign,Tx=(n,t)=>{const i=n.indexOf(t);i>-1&&n.splice(i,1)},_k=Object.prototype.hasOwnProperty,Bn=(n,t)=>_k.call(n,t),ki=Array.isArray,pf=n=>_m(n)==="[object Map]",vg=n=>_m(n)==="[object Set]",K1=n=>_m(n)==="[object Date]",qi=n=>typeof n=="function",Vs=n=>typeof n=="string",Uc=n=>typeof n=="symbol",Wn=n=>n!==null&&typeof n=="object",LE=n=>(Wn(n)||qi(n))&&qi(n.then)&&qi(n.catch),DE=Object.prototype.toString,_m=n=>DE.call(n),gk=n=>_m(n).slice(8,-1),zE=n=>_m(n)==="[object Object]",Ex=n=>Vs(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,zp=bx(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),xg=n=>{const t=Object.create(null);return(i=>t[i]||(t[i]=n(i)))},yk=/-\w/g,yl=xg(n=>n.replace(yk,t=>t.slice(1).toUpperCase())),vk=/\B([A-Z])/g,Sd=xg(n=>n.replace(vk,"-$1").toLowerCase()),bg=xg(n=>n.charAt(0).toUpperCase()+n.slice(1)),Jy=xg(n=>n?`on${bg(n)}`:""),ph=(n,t)=>!Object.is(n,t),P_=(n,...t)=>{for(let i=0;i<n.length;i++)n[i](...t)},OE=(n,t,i,l=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:l,value:i})},Z_=n=>{const t=parseFloat(n);return isNaN(t)?n:t},xk=n=>{const t=Vs(n)?Number(n):NaN;return isNaN(t)?n:t};let Y1;const wg=()=>Y1||(Y1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function fl(n){if(ki(n)){const t={};for(let i=0;i<n.length;i++){const l=n[i],c=Vs(l)?Ek(l):fl(l);if(c)for(const d in c)t[d]=c[d]}return t}else if(Vs(n)||Wn(n))return n}const bk=/;(?![^(]*\))/g,wk=/:([^]+)/,Tk=/\/\*[^]*?\*\//g;function Ek(n){const t={};return n.replace(Tk,"").split(bk).forEach(i=>{if(i){const l=i.split(wk);l.length>1&&(t[l[0].trim()]=l[1].trim())}}),t}function $c(n){let t="";if(Vs(n))t=n;else if(ki(n))for(let i=0;i<n.length;i++){const l=$c(n[i]);l&&(t+=l+" ")}else if(Wn(n))for(const i in n)n[i]&&(t+=i+" ");return t.trim()}const Sk="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Mk=bx(Sk);function RE(n){return!!n||n===""}function Ck(n,t){if(n.length!==t.length)return!1;let i=!0;for(let l=0;i&&l<n.length;l++)i=Tg(n[l],t[l]);return i}function Tg(n,t){if(n===t)return!0;let i=K1(n),l=K1(t);if(i||l)return i&&l?n.getTime()===t.getTime():!1;if(i=Uc(n),l=Uc(t),i||l)return n===t;if(i=ki(n),l=ki(t),i||l)return i&&l?Ck(n,t):!1;if(i=Wn(n),l=Wn(t),i||l){if(!i||!l)return!1;const c=Object.keys(n).length,d=Object.keys(t).length;if(c!==d)return!1;for(const _ in n){const v=n.hasOwnProperty(_),r=t.hasOwnProperty(_);if(v&&!r||!v&&r||!Tg(n[_],t[_]))return!1}}return String(n)===String(t)}function Ak(n,t){return n.findIndex(i=>Tg(i,t))}const BE=n=>!!(n&&n.__v_isRef===!0),Ge=n=>Vs(n)?n:n==null?"":ki(n)||Wn(n)&&(n.toString===DE||!qi(n.toString))?BE(n)?Ge(n.value):JSON.stringify(n,FE,2):String(n),FE=(n,t)=>BE(t)?FE(n,t.value):pf(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[l,c],d)=>(i[Qy(l,d)+" =>"]=c,i),{})}:vg(t)?{[`Set(${t.size})`]:[...t.values()].map(i=>Qy(i))}:Uc(t)?Qy(t):Wn(t)&&!ki(t)&&!zE(t)?String(t):t,Qy=(n,t="")=>{var i;return Uc(n)?`Symbol(${(i=n.description)!=null?i:t})`:n};/**
* @vue/reactivity v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let la;class Pk{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=la,!t&&la&&(this.index=(la.scopes||(la.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].pause();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,i;if(this.scopes)for(t=0,i=this.scopes.length;t<i;t++)this.scopes[t].resume();for(t=0,i=this.effects.length;t<i;t++)this.effects[t].resume()}}run(t){if(this._active){const i=la;try{return la=this,t()}finally{la=i}}}on(){++this._on===1&&(this.prevScope=la,la=this)}off(){this._on>0&&--this._on===0&&(la=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let i,l;for(i=0,l=this.effects.length;i<l;i++)this.effects[i].stop();for(this.effects.length=0,i=0,l=this.cleanups.length;i<l;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,l=this.scopes.length;i<l;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0}}}function kk(){return la}let os;const tv=new WeakSet;class NE{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,la&&la.active&&la.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,tv.has(this)&&(tv.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||VE(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,J1(this),UE(this);const t=os,i=Ql;os=this,Ql=!0;try{return this.fn()}finally{$E(this),os=t,Ql=i,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)Cx(t);this.deps=this.depsTail=void 0,J1(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?tv.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Rv(this)&&this.run()}get dirty(){return Rv(this)}}let jE=0,Op,Rp;function VE(n,t=!1){if(n.flags|=8,t){n.next=Rp,Rp=n;return}n.next=Op,Op=n}function Sx(){jE++}function Mx(){if(--jE>0)return;if(Rp){let t=Rp;for(Rp=void 0;t;){const i=t.next;t.next=void 0,t.flags&=-9,t=i}}let n;for(;Op;){let t=Op;for(Op=void 0;t;){const i=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(l){n||(n=l)}t=i}}if(n)throw n}function UE(n){for(let t=n.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function $E(n){let t,i=n.depsTail,l=i;for(;l;){const c=l.prevDep;l.version===-1?(l===i&&(i=c),Cx(l),Ik(l)):t=l,l.dep.activeLink=l.prevActiveLink,l.prevActiveLink=void 0,l=c}n.deps=t,n.depsTail=i}function Rv(n){for(let t=n.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(WE(t.dep.computed)||t.dep.version!==t.version))return!0;return!!n._dirty}function WE(n){if(n.flags&4&&!(n.flags&16)||(n.flags&=-17,n.globalVersion===qp)||(n.globalVersion=qp,!n.isSSR&&n.flags&128&&(!n.deps&&!n._dirty||!Rv(n))))return;n.flags|=2;const t=n.dep,i=os,l=Ql;os=n,Ql=!0;try{UE(n);const c=n.fn(n._value);(t.version===0||ph(c,n._value))&&(n.flags|=128,n._value=c,t.version++)}catch(c){throw t.version++,c}finally{os=i,Ql=l,$E(n),n.flags&=-3}}function Cx(n,t=!1){const{dep:i,prevSub:l,nextSub:c}=n;if(l&&(l.nextSub=c,n.prevSub=void 0),c&&(c.prevSub=l,n.nextSub=void 0),i.subs===n&&(i.subs=l,!l&&i.computed)){i.computed.flags&=-5;for(let d=i.computed.deps;d;d=d.nextDep)Cx(d,!0)}!t&&!--i.sc&&i.map&&i.map.delete(i.key)}function Ik(n){const{prevDep:t,nextDep:i}=n;t&&(t.nextDep=i,n.prevDep=void 0),i&&(i.prevDep=t,n.nextDep=void 0)}let Ql=!0;const ZE=[];function Du(){ZE.push(Ql),Ql=!1}function zu(){const n=ZE.pop();Ql=n===void 0?!0:n}function J1(n){const{cleanup:t}=n;if(n.cleanup=void 0,t){const i=os;os=void 0;try{t()}finally{os=i}}}let qp=0;class Lk{constructor(t,i){this.sub=t,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Ax{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!os||!Ql||os===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==os)i=this.activeLink=new Lk(os,this),os.deps?(i.prevDep=os.depsTail,os.depsTail.nextDep=i,os.depsTail=i):os.deps=os.depsTail=i,GE(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const l=i.nextDep;l.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=l),i.prevDep=os.depsTail,i.nextDep=void 0,os.depsTail.nextDep=i,os.depsTail=i,os.deps===i&&(os.deps=l)}return i}trigger(t){this.version++,qp++,this.notify(t)}notify(t){Sx();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{Mx()}}}function GE(n){if(n.dep.sc++,n.sub.flags&4){const t=n.dep.computed;if(t&&!n.dep.subs){t.flags|=20;for(let l=t.deps;l;l=l.nextDep)GE(l)}const i=n.dep.subs;i!==n&&(n.prevSub=i,i&&(i.nextSub=n)),n.dep.subs=n}}const Bv=new WeakMap,pd=Symbol(""),Fv=Symbol(""),Xp=Symbol("");function _o(n,t,i){if(Ql&&os){let l=Bv.get(n);l||Bv.set(n,l=new Map);let c=l.get(i);c||(l.set(i,c=new Ax),c.map=l,c.key=i),c.track()}}function Au(n,t,i,l,c,d){const _=Bv.get(n);if(!_){qp++;return}const v=r=>{r&&r.trigger()};if(Sx(),t==="clear")_.forEach(v);else{const r=ki(n),E=r&&Ex(i);if(r&&i==="length"){const C=Number(l);_.forEach((z,R)=>{(R==="length"||R===Xp||!Uc(R)&&R>=C)&&v(z)})}else switch((i!==void 0||_.has(void 0))&&v(_.get(i)),E&&v(_.get(Xp)),t){case"add":r?E&&v(_.get("length")):(v(_.get(pd)),pf(n)&&v(_.get(Fv)));break;case"delete":r||(v(_.get(pd)),pf(n)&&v(_.get(Fv)));break;case"set":pf(n)&&v(_.get(pd));break}}Mx()}function rf(n){const t=Dn(n);return t===n?t:(_o(t,"iterate",Xp),gl(n)?t:t.map(Hr))}function Eg(n){return _o(n=Dn(n),"iterate",Xp),n}const Dk={__proto__:null,[Symbol.iterator](){return ev(this,Symbol.iterator,Hr)},concat(...n){return rf(this).concat(...n.map(t=>ki(t)?rf(t):t))},entries(){return ev(this,"entries",n=>(n[1]=Hr(n[1]),n))},every(n,t){return gu(this,"every",n,t,void 0,arguments)},filter(n,t){return gu(this,"filter",n,t,i=>i.map(Hr),arguments)},find(n,t){return gu(this,"find",n,t,Hr,arguments)},findIndex(n,t){return gu(this,"findIndex",n,t,void 0,arguments)},findLast(n,t){return gu(this,"findLast",n,t,Hr,arguments)},findLastIndex(n,t){return gu(this,"findLastIndex",n,t,void 0,arguments)},forEach(n,t){return gu(this,"forEach",n,t,void 0,arguments)},includes(...n){return iv(this,"includes",n)},indexOf(...n){return iv(this,"indexOf",n)},join(n){return rf(this).join(n)},lastIndexOf(...n){return iv(this,"lastIndexOf",n)},map(n,t){return gu(this,"map",n,t,void 0,arguments)},pop(){return _p(this,"pop")},push(...n){return _p(this,"push",n)},reduce(n,...t){return Q1(this,"reduce",n,t)},reduceRight(n,...t){return Q1(this,"reduceRight",n,t)},shift(){return _p(this,"shift")},some(n,t){return gu(this,"some",n,t,void 0,arguments)},splice(...n){return _p(this,"splice",n)},toReversed(){return rf(this).toReversed()},toSorted(n){return rf(this).toSorted(n)},toSpliced(...n){return rf(this).toSpliced(...n)},unshift(...n){return _p(this,"unshift",n)},values(){return ev(this,"values",Hr)}};function ev(n,t,i){const l=Eg(n),c=l[t]();return l!==n&&!gl(n)&&(c._next=c.next,c.next=()=>{const d=c._next();return d.done||(d.value=i(d.value)),d}),c}const zk=Array.prototype;function gu(n,t,i,l,c,d){const _=Eg(n),v=_!==n&&!gl(n),r=_[t];if(r!==zk[t]){const z=r.apply(n,d);return v?Hr(z):z}let E=i;_!==n&&(v?E=function(z,R){return i.call(this,Hr(z),R,n)}:i.length>2&&(E=function(z,R){return i.call(this,z,R,n)}));const C=r.call(_,E,l);return v&&c?c(C):C}function Q1(n,t,i,l){const c=Eg(n);let d=i;return c!==n&&(gl(n)?i.length>3&&(d=function(_,v,r){return i.call(this,_,v,r,n)}):d=function(_,v,r){return i.call(this,_,Hr(v),r,n)}),c[t](d,...l)}function iv(n,t,i){const l=Dn(n);_o(l,"iterate",Xp);const c=l[t](...i);return(c===-1||c===!1)&&Ix(i[0])?(i[0]=Dn(i[0]),l[t](...i)):c}function _p(n,t,i=[]){Du(),Sx();const l=Dn(n)[t].apply(n,i);return Mx(),zu(),l}const Ok=bx("__proto__,__v_isRef,__isVue"),HE=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Uc));function Rk(n){Uc(n)||(n=String(n));const t=Dn(this);return _o(t,"has",n),t.hasOwnProperty(n)}class qE{constructor(t=!1,i=!1){this._isReadonly=t,this._isShallow=i}get(t,i,l){if(i==="__v_skip")return t.__v_skip;const c=this._isReadonly,d=this._isShallow;if(i==="__v_isReactive")return!c;if(i==="__v_isReadonly")return c;if(i==="__v_isShallow")return d;if(i==="__v_raw")return l===(c?d?Gk:JE:d?YE:KE).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(l)?t:void 0;const _=ki(t);if(!c){let r;if(_&&(r=Dk[i]))return r;if(i==="hasOwnProperty")return Rk}const v=Reflect.get(t,i,bo(t)?t:l);if((Uc(i)?HE.has(i):Ok(i))||(c||_o(t,"get",i),d))return v;if(bo(v)){const r=_&&Ex(i)?v:v.value;return c&&Wn(r)?jv(r):r}return Wn(v)?c?jv(v):gm(v):v}}class XE extends qE{constructor(t=!1){super(!1,t)}set(t,i,l,c){let d=t[i];if(!this._isShallow){const r=yh(d);if(!gl(l)&&!yh(l)&&(d=Dn(d),l=Dn(l)),!ki(t)&&bo(d)&&!bo(l))return r||(d.value=l),!0}const _=ki(t)&&Ex(i)?Number(i)<t.length:Bn(t,i),v=Reflect.set(t,i,l,bo(t)?t:c);return t===Dn(c)&&(_?ph(l,d)&&Au(t,"set",i,l):Au(t,"add",i,l)),v}deleteProperty(t,i){const l=Bn(t,i);t[i];const c=Reflect.deleteProperty(t,i);return c&&l&&Au(t,"delete",i,void 0),c}has(t,i){const l=Reflect.has(t,i);return(!Uc(i)||!HE.has(i))&&_o(t,"has",i),l}ownKeys(t){return _o(t,"iterate",ki(t)?"length":pd),Reflect.ownKeys(t)}}class Bk extends qE{constructor(t=!1){super(!0,t)}set(t,i){return!0}deleteProperty(t,i){return!0}}const Fk=new XE,Nk=new Bk,jk=new XE(!0);const Nv=n=>n,l_=n=>Reflect.getPrototypeOf(n);function Vk(n,t,i){return function(...l){const c=this.__v_raw,d=Dn(c),_=pf(d),v=n==="entries"||n===Symbol.iterator&&_,r=n==="keys"&&_,E=c[n](...l),C=i?Nv:t?G_:Hr;return!t&&_o(d,"iterate",r?Fv:pd),{next(){const{value:z,done:R}=E.next();return R?{value:z,done:R}:{value:v?[C(z[0]),C(z[1])]:C(z),done:R}},[Symbol.iterator](){return this}}}}function c_(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function Uk(n,t){const i={get(c){const d=this.__v_raw,_=Dn(d),v=Dn(c);n||(ph(c,v)&&_o(_,"get",c),_o(_,"get",v));const{has:r}=l_(_),E=t?Nv:n?G_:Hr;if(r.call(_,c))return E(d.get(c));if(r.call(_,v))return E(d.get(v));d!==_&&d.get(c)},get size(){const c=this.__v_raw;return!n&&_o(Dn(c),"iterate",pd),c.size},has(c){const d=this.__v_raw,_=Dn(d),v=Dn(c);return n||(ph(c,v)&&_o(_,"has",c),_o(_,"has",v)),c===v?d.has(c):d.has(c)||d.has(v)},forEach(c,d){const _=this,v=_.__v_raw,r=Dn(v),E=t?Nv:n?G_:Hr;return!n&&_o(r,"iterate",pd),v.forEach((C,z)=>c.call(d,E(C),E(z),_))}};return Kr(i,n?{add:c_("add"),set:c_("set"),delete:c_("delete"),clear:c_("clear")}:{add(c){!t&&!gl(c)&&!yh(c)&&(c=Dn(c));const d=Dn(this);return l_(d).has.call(d,c)||(d.add(c),Au(d,"add",c,c)),this},set(c,d){!t&&!gl(d)&&!yh(d)&&(d=Dn(d));const _=Dn(this),{has:v,get:r}=l_(_);let E=v.call(_,c);E||(c=Dn(c),E=v.call(_,c));const C=r.call(_,c);return _.set(c,d),E?ph(d,C)&&Au(_,"set",c,d):Au(_,"add",c,d),this},delete(c){const d=Dn(this),{has:_,get:v}=l_(d);let r=_.call(d,c);r||(c=Dn(c),r=_.call(d,c)),v&&v.call(d,c);const E=d.delete(c);return r&&Au(d,"delete",c,void 0),E},clear(){const c=Dn(this),d=c.size!==0,_=c.clear();return d&&Au(c,"clear",void 0,void 0),_}}),["keys","values","entries",Symbol.iterator].forEach(c=>{i[c]=Vk(c,n,t)}),i}function Px(n,t){const i=Uk(n,t);return(l,c,d)=>c==="__v_isReactive"?!n:c==="__v_isReadonly"?n:c==="__v_raw"?l:Reflect.get(Bn(i,c)&&c in l?i:l,c,d)}const $k={get:Px(!1,!1)},Wk={get:Px(!1,!0)},Zk={get:Px(!0,!1)};const KE=new WeakMap,YE=new WeakMap,JE=new WeakMap,Gk=new WeakMap;function Hk(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function qk(n){return n.__v_skip||!Object.isExtensible(n)?0:Hk(gk(n))}function gm(n){return yh(n)?n:kx(n,!1,Fk,$k,KE)}function Xk(n){return kx(n,!1,jk,Wk,YE)}function jv(n){return kx(n,!0,Nk,Zk,JE)}function kx(n,t,i,l,c){if(!Wn(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const d=qk(n);if(d===0)return n;const _=c.get(n);if(_)return _;const v=new Proxy(n,d===2?l:i);return c.set(n,v),v}function mf(n){return yh(n)?mf(n.__v_raw):!!(n&&n.__v_isReactive)}function yh(n){return!!(n&&n.__v_isReadonly)}function gl(n){return!!(n&&n.__v_isShallow)}function Ix(n){return n?!!n.__v_raw:!1}function Dn(n){const t=n&&n.__v_raw;return t?Dn(t):n}function Kk(n){return!Bn(n,"__v_skip")&&Object.isExtensible(n)&&OE(n,"__v_skip",!0),n}const Hr=n=>Wn(n)?gm(n):n,G_=n=>Wn(n)?jv(n):n;function bo(n){return n?n.__v_isRef===!0:!1}function Yi(n){return Yk(n,!1)}function Yk(n,t){return bo(n)?n:new Jk(n,t)}class Jk{constructor(t,i){this.dep=new Ax,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?t:Dn(t),this._value=i?t:Hr(t),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(t){const i=this._rawValue,l=this.__v_isShallow||gl(t)||yh(t);t=l?t:Dn(t),ph(t,i)&&(this._rawValue=t,this._value=l?t:Hr(t),this.dep.trigger())}}function es(n){return bo(n)?n.value:n}const Qk={get:(n,t,i)=>t==="__v_raw"?n:es(Reflect.get(n,t,i)),set:(n,t,i,l)=>{const c=n[t];return bo(c)&&!bo(i)?(c.value=i,!0):Reflect.set(n,t,i,l)}};function QE(n){return mf(n)?n:new Proxy(n,Qk)}class tI{constructor(t,i,l){this.fn=t,this.setter=i,this._value=void 0,this.dep=new Ax(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=qp-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=l}notify(){if(this.flags|=16,!(this.flags&8)&&os!==this)return VE(this,!0),!0}get value(){const t=this.dep.track();return WE(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function eI(n,t,i=!1){let l,c;return qi(n)?l=n:(l=n.get,c=n.set),new tI(l,c,i)}const u_={},H_=new WeakMap;let ad;function iI(n,t=!1,i=ad){if(i){let l=H_.get(i);l||H_.set(i,l=[]),l.push(n)}}function nI(n,t,i=ts){const{immediate:l,deep:c,once:d,scheduler:_,augmentJob:v,call:r}=i,E=mt=>c?mt:gl(mt)||c===!1||c===0?Pu(mt,1):Pu(mt);let C,z,R,j,G=!1,W=!1;if(bo(n)?(z=()=>n.value,G=gl(n)):mf(n)?(z=()=>E(n),G=!0):ki(n)?(W=!0,G=n.some(mt=>mf(mt)||gl(mt)),z=()=>n.map(mt=>{if(bo(mt))return mt.value;if(mf(mt))return E(mt);if(qi(mt))return r?r(mt,2):mt()})):qi(n)?t?z=r?()=>r(n,2):n:z=()=>{if(R){Du();try{R()}finally{zu()}}const mt=ad;ad=C;try{return r?r(n,3,[j]):n(j)}finally{ad=mt}}:z=Nc,t&&c){const mt=z,bt=c===!0?1/0:c;z=()=>Pu(mt(),bt)}const Q=kk(),rt=()=>{C.stop(),Q&&Q.active&&Tx(Q.effects,C)};if(d&&t){const mt=t;t=(...bt)=>{mt(...bt),rt()}}let ft=W?new Array(n.length).fill(u_):u_;const xt=mt=>{if(!(!(C.flags&1)||!C.dirty&&!mt))if(t){const bt=C.run();if(c||G||(W?bt.some((Ot,zt)=>ph(Ot,ft[zt])):ph(bt,ft))){R&&R();const Ot=ad;ad=C;try{const zt=[bt,ft===u_?void 0:W&&ft[0]===u_?[]:ft,j];ft=bt,r?r(t,3,zt):t(...zt)}finally{ad=Ot}}}else C.run()};return v&&v(xt),C=new NE(z),C.scheduler=_?()=>_(xt,!1):xt,j=mt=>iI(mt,!1,C),R=C.onStop=()=>{const mt=H_.get(C);if(mt){if(r)r(mt,4);else for(const bt of mt)bt();H_.delete(C)}},t?l?xt(!0):ft=C.run():_?_(xt.bind(null,!0),!0):C.run(),rt.pause=C.pause.bind(C),rt.resume=C.resume.bind(C),rt.stop=rt,rt}function Pu(n,t=1/0,i){if(t<=0||!Wn(n)||n.__v_skip||(i=i||new Map,(i.get(n)||0)>=t))return n;if(i.set(n,t),t--,bo(n))Pu(n.value,t,i);else if(ki(n))for(let l=0;l<n.length;l++)Pu(n[l],t,i);else if(vg(n)||pf(n))n.forEach(l=>{Pu(l,t,i)});else if(zE(n)){for(const l in n)Pu(n[l],t,i);for(const l of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,l)&&Pu(n[l],t,i)}return n}/**
* @vue/runtime-core v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ym(n,t,i,l){try{return l?n(...l):n()}catch(c){Sg(c,t,i)}}function tc(n,t,i,l){if(qi(n)){const c=ym(n,t,i,l);return c&&LE(c)&&c.catch(d=>{Sg(d,t,i)}),c}if(ki(n)){const c=[];for(let d=0;d<n.length;d++)c.push(tc(n[d],t,i,l));return c}}function Sg(n,t,i,l=!0){const c=t?t.vnode:null,{errorHandler:d,throwUnhandledErrorInProduction:_}=t&&t.appContext.config||ts;if(t){let v=t.parent;const r=t.proxy,E=`https://vuejs.org/error-reference/#runtime-${i}`;for(;v;){const C=v.ec;if(C){for(let z=0;z<C.length;z++)if(C[z](n,r,E)===!1)return}v=v.parent}if(d){Du(),ym(d,null,10,[n,r,E]),zu();return}}sI(n,i,c,l,_)}function sI(n,t,i,l=!0,c=!1){if(c)throw n;console.error(n)}const Fo=[];let Lc=-1;const _f=[];let nh=null,cf=0;const tS=Promise.resolve();let q_=null;function Kp(n){const t=q_||tS;return n?t.then(this?n.bind(this):n):t}function rI(n){let t=Lc+1,i=Fo.length;for(;t<i;){const l=t+i>>>1,c=Fo[l],d=Yp(c);d<n||d===n&&c.flags&2?t=l+1:i=l}return t}function Lx(n){if(!(n.flags&1)){const t=Yp(n),i=Fo[Fo.length-1];!i||!(n.flags&2)&&t>=Yp(i)?Fo.push(n):Fo.splice(rI(t),0,n),n.flags|=1,eS()}}function eS(){q_||(q_=tS.then(nS))}function oI(n){ki(n)?_f.push(...n):nh&&n.id===-1?nh.splice(cf+1,0,n):n.flags&1||(_f.push(n),n.flags|=1),eS()}function tw(n,t,i=Lc+1){for(;i<Fo.length;i++){const l=Fo[i];if(l&&l.flags&2){if(n&&l.id!==n.uid)continue;Fo.splice(i,1),i--,l.flags&4&&(l.flags&=-2),l(),l.flags&4||(l.flags&=-2)}}}function iS(n){if(_f.length){const t=[...new Set(_f)].sort((i,l)=>Yp(i)-Yp(l));if(_f.length=0,nh){nh.push(...t);return}for(nh=t,cf=0;cf<nh.length;cf++){const i=nh[cf];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}nh=null,cf=0}}const Yp=n=>n.id==null?n.flags&2?-1:1/0:n.id;function nS(n){try{for(Lc=0;Lc<Fo.length;Lc++){const t=Fo[Lc];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),ym(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;Lc<Fo.length;Lc++){const t=Fo[Lc];t&&(t.flags&=-2)}Lc=-1,Fo.length=0,iS(),q_=null,(Fo.length||_f.length)&&nS()}}let za=null,sS=null;function X_(n){const t=za;return za=n,sS=n&&n.type.__scopeId||null,t}function rS(n,t=za,i){if(!t||n._n)return n;const l=(...c)=>{l._d&&J_(-1);const d=X_(t);let _;try{_=n(...c)}finally{X_(d),l._d&&J_(1)}return _};return l._n=!0,l._c=!0,l._d=!0,l}function ar(n,t){if(za===null)return n;const i=kg(za),l=n.dirs||(n.dirs=[]);for(let c=0;c<t.length;c++){let[d,_,v,r=ts]=t[c];d&&(qi(d)&&(d={mounted:d,updated:d}),d.deep&&Pu(_),l.push({dir:d,instance:i,value:_,oldValue:void 0,arg:v,modifiers:r}))}return n}function Kh(n,t,i,l){const c=n.dirs,d=t&&t.dirs;for(let _=0;_<c.length;_++){const v=c[_];d&&(v.oldValue=d[_].value);let r=v.dir[l];r&&(Du(),tc(r,i,8,[n.el,v,n,t]),zu())}}const aI=Symbol("_vte"),oS=n=>n.__isTeleport,Su=Symbol("_leaveCb"),h_=Symbol("_enterCb");function lI(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Md(()=>{n.isMounted=!0}),Cd(()=>{n.isUnmounting=!0}),n}const ul=[Function,Array],aS={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ul,onEnter:ul,onAfterEnter:ul,onEnterCancelled:ul,onBeforeLeave:ul,onLeave:ul,onAfterLeave:ul,onLeaveCancelled:ul,onBeforeAppear:ul,onAppear:ul,onAfterAppear:ul,onAppearCancelled:ul},lS=n=>{const t=n.subTree;return t.component?lS(t.component):t},cI={name:"BaseTransition",props:aS,setup(n,{slots:t}){const i=RS(),l=lI();return()=>{const c=t.default&&hS(t.default(),!0);if(!c||!c.length)return;const d=cS(c),_=Dn(n),{mode:v}=_;if(l.isLeaving)return nv(d);const r=ew(d);if(!r)return nv(d);let E=Vv(r,_,l,i,z=>E=z);r.type!==No&&Jp(r,E);let C=i.subTree&&ew(i.subTree);if(C&&C.type!==No&&!hd(C,r)&&lS(i).type!==No){let z=Vv(C,_,l,i);if(Jp(C,z),v==="out-in"&&r.type!==No)return l.isLeaving=!0,z.afterLeave=()=>{l.isLeaving=!1,i.job.flags&8||i.update(),delete z.afterLeave,C=void 0},nv(d);v==="in-out"&&r.type!==No?z.delayLeave=(R,j,G)=>{const W=uS(l,C);W[String(C.key)]=C,R[Su]=()=>{j(),R[Su]=void 0,delete E.delayedLeave,C=void 0},E.delayedLeave=()=>{G(),delete E.delayedLeave,C=void 0}}:C=void 0}else C&&(C=void 0);return d}}};function cS(n){let t=n[0];if(n.length>1){for(const i of n)if(i.type!==No){t=i;break}}return t}const uI=cI;function uS(n,t){const{leavingVNodes:i}=n;let l=i.get(t.type);return l||(l=Object.create(null),i.set(t.type,l)),l}function Vv(n,t,i,l,c){const{appear:d,mode:_,persisted:v=!1,onBeforeEnter:r,onEnter:E,onAfterEnter:C,onEnterCancelled:z,onBeforeLeave:R,onLeave:j,onAfterLeave:G,onLeaveCancelled:W,onBeforeAppear:Q,onAppear:rt,onAfterAppear:ft,onAppearCancelled:xt}=t,mt=String(n.key),bt=uS(i,n),Ot=(Bt,Nt)=>{Bt&&tc(Bt,l,9,Nt)},zt=(Bt,Nt)=>{const ee=Nt[1];Ot(Bt,Nt),ki(Bt)?Bt.every(Wt=>Wt.length<=1)&&ee():Bt.length<=1&&ee()},Rt={mode:_,persisted:v,beforeEnter(Bt){let Nt=r;if(!i.isMounted)if(d)Nt=Q||r;else return;Bt[Su]&&Bt[Su](!0);const ee=bt[mt];ee&&hd(n,ee)&&ee.el[Su]&&ee.el[Su](),Ot(Nt,[Bt])},enter(Bt){let Nt=E,ee=C,Wt=z;if(!i.isMounted)if(d)Nt=rt||E,ee=ft||C,Wt=xt||z;else return;let ae=!1;const ye=Bt[h_]=He=>{ae||(ae=!0,He?Ot(Wt,[Bt]):Ot(ee,[Bt]),Rt.delayedLeave&&Rt.delayedLeave(),Bt[h_]=void 0)};Nt?zt(Nt,[Bt,ye]):ye()},leave(Bt,Nt){const ee=String(n.key);if(Bt[h_]&&Bt[h_](!0),i.isUnmounting)return Nt();Ot(R,[Bt]);let Wt=!1;const ae=Bt[Su]=ye=>{Wt||(Wt=!0,Nt(),ye?Ot(W,[Bt]):Ot(G,[Bt]),Bt[Su]=void 0,bt[ee]===n&&delete bt[ee])};bt[ee]=n,j?zt(j,[Bt,ae]):ae()},clone(Bt){const Nt=Vv(Bt,t,i,l,c);return c&&c(Nt),Nt}};return Rt}function nv(n){if(Mg(n))return n=vh(n),n.children=null,n}function ew(n){if(!Mg(n))return oS(n.type)&&n.children?cS(n.children):n;if(n.component)return n.component.subTree;const{shapeFlag:t,children:i}=n;if(i){if(t&16)return i[0];if(t&32&&qi(i.default))return i.default()}}function Jp(n,t){n.shapeFlag&6&&n.component?(n.transition=t,Jp(n.component.subTree,t)):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function hS(n,t=!1,i){let l=[],c=0;for(let d=0;d<n.length;d++){let _=n[d];const v=i==null?_.key:String(i)+String(_.key!=null?_.key:d);_.type===an?(_.patchFlag&128&&c++,l=l.concat(hS(_.children,t,v))):(t||_.type!==No)&&l.push(v!=null?vh(_,{key:v}):_)}if(c>1)for(let d=0;d<l.length;d++)l[d].patchFlag=-2;return l}function dS(n){n.ids=[n.ids[0]+n.ids[2]+++"-",0,0]}const K_=new WeakMap;function Bp(n,t,i,l,c=!1){if(ki(n)){n.forEach((G,W)=>Bp(G,t&&(ki(t)?t[W]:t),i,l,c));return}if(Fp(l)&&!c){l.shapeFlag&512&&l.type.__asyncResolved&&l.component.subTree.component&&Bp(n,t,i,l.component.subTree);return}const d=l.shapeFlag&4?kg(l.component):l.el,_=c?null:d,{i:v,r}=n,E=t&&t.r,C=v.refs===ts?v.refs={}:v.refs,z=v.setupState,R=Dn(z),j=z===ts?IE:G=>Bn(R,G);if(E!=null&&E!==r){if(iw(t),Vs(E))C[E]=null,j(E)&&(z[E]=null);else if(bo(E)){E.value=null;const G=t;G.k&&(C[G.k]=null)}}if(qi(r))ym(r,v,12,[_,C]);else{const G=Vs(r),W=bo(r);if(G||W){const Q=()=>{if(n.f){const rt=G?j(r)?z[r]:C[r]:r.value;if(c)ki(rt)&&Tx(rt,d);else if(ki(rt))rt.includes(d)||rt.push(d);else if(G)C[r]=[d],j(r)&&(z[r]=C[r]);else{const ft=[d];r.value=ft,n.k&&(C[n.k]=ft)}}else G?(C[r]=_,j(r)&&(z[r]=_)):W&&(r.value=_,n.k&&(C[n.k]=_))};if(_){const rt=()=>{Q(),K_.delete(n)};rt.id=-1,K_.set(n,rt),ka(rt,i)}else iw(n),Q()}}}function iw(n){const t=K_.get(n);t&&(t.flags|=8,K_.delete(n))}wg().requestIdleCallback;wg().cancelIdleCallback;const Fp=n=>!!n.type.__asyncLoader,Mg=n=>n.type.__isKeepAlive;function hI(n,t){fS(n,"a",t)}function dI(n,t){fS(n,"da",t)}function fS(n,t,i=go){const l=n.__wdc||(n.__wdc=()=>{let c=i;for(;c;){if(c.isDeactivated)return;c=c.parent}return n()});if(Cg(t,l,i),i){let c=i.parent;for(;c&&c.parent;)Mg(c.parent.vnode)&&fI(l,t,i,c),c=c.parent}}function fI(n,t,i,l){const c=Cg(t,n,l,!0);pS(()=>{Tx(l[t],c)},i)}function Cg(n,t,i=go,l=!1){if(i){const c=i[n]||(i[n]=[]),d=t.__weh||(t.__weh=(..._)=>{Du();const v=vm(i),r=tc(t,i,n,_);return v(),zu(),r});return l?c.unshift(d):c.push(d),d}}const Bu=n=>(t,i=go)=>{(!tm||n==="sp")&&Cg(n,(...l)=>t(...l),i)},pI=Bu("bm"),Md=Bu("m"),mI=Bu("bu"),_I=Bu("u"),Cd=Bu("bum"),pS=Bu("um"),gI=Bu("sp"),yI=Bu("rtg"),vI=Bu("rtc");function xI(n,t=go){Cg("ec",n,t)}const bI="components",mS=Symbol.for("v-ndc");function wI(n){return Vs(n)?TI(bI,n,!1)||n:n||mS}function TI(n,t,i=!0,l=!1){const c=za||go;if(c){const d=c.type;{const v=hL(d,!1);if(v&&(v===t||v===yl(t)||v===bg(yl(t))))return d}const _=nw(c[n]||d[n],t)||nw(c.appContext[n],t);return!_&&l?d:_}}function nw(n,t){return n&&(n[t]||n[yl(t)]||n[bg(yl(t))])}function gs(n,t,i,l){let c;const d=i,_=ki(n);if(_||Vs(n)){const v=_&&mf(n);let r=!1,E=!1;v&&(r=!gl(n),E=yh(n),n=Eg(n)),c=new Array(n.length);for(let C=0,z=n.length;C<z;C++)c[C]=t(r?E?G_(Hr(n[C])):Hr(n[C]):n[C],C,void 0,d)}else if(typeof n=="number"){c=new Array(n);for(let v=0;v<n;v++)c[v]=t(v+1,v,void 0,d)}else if(Wn(n))if(n[Symbol.iterator])c=Array.from(n,(v,r)=>t(v,r,void 0,d));else{const v=Object.keys(n);c=new Array(v.length);for(let r=0,E=v.length;r<E;r++){const C=v[r];c[r]=t(n[C],C,r,d)}}else c=[];return c}const Uv=n=>n?BS(n)?kg(n):Uv(n.parent):null,Np=Kr(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Uv(n.parent),$root:n=>Uv(n.root),$host:n=>n.ce,$emit:n=>n.emit,$options:n=>gS(n),$forceUpdate:n=>n.f||(n.f=()=>{Lx(n.update)}),$nextTick:n=>n.n||(n.n=Kp.bind(n.proxy)),$watch:n=>ZI.bind(n)}),sv=(n,t)=>n!==ts&&!n.__isScriptSetup&&Bn(n,t),EI={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:i,setupState:l,data:c,props:d,accessCache:_,type:v,appContext:r}=n;let E;if(t[0]!=="$"){const j=_[t];if(j!==void 0)switch(j){case 1:return l[t];case 2:return c[t];case 4:return i[t];case 3:return d[t]}else{if(sv(l,t))return _[t]=1,l[t];if(c!==ts&&Bn(c,t))return _[t]=2,c[t];if((E=n.propsOptions[0])&&Bn(E,t))return _[t]=3,d[t];if(i!==ts&&Bn(i,t))return _[t]=4,i[t];$v&&(_[t]=0)}}const C=Np[t];let z,R;if(C)return t==="$attrs"&&_o(n.attrs,"get",""),C(n);if((z=v.__cssModules)&&(z=z[t]))return z;if(i!==ts&&Bn(i,t))return _[t]=4,i[t];if(R=r.config.globalProperties,Bn(R,t))return R[t]},set({_:n},t,i){const{data:l,setupState:c,ctx:d}=n;return sv(c,t)?(c[t]=i,!0):l!==ts&&Bn(l,t)?(l[t]=i,!0):Bn(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(d[t]=i,!0)},has({_:{data:n,setupState:t,accessCache:i,ctx:l,appContext:c,propsOptions:d,type:_}},v){let r,E;return!!(i[v]||n!==ts&&v[0]!=="$"&&Bn(n,v)||sv(t,v)||(r=d[0])&&Bn(r,v)||Bn(l,v)||Bn(Np,v)||Bn(c.config.globalProperties,v)||(E=_.__cssModules)&&E[v])},defineProperty(n,t,i){return i.get!=null?n._.accessCache[t]=0:Bn(i,"value")&&this.set(n,t,i.value,null),Reflect.defineProperty(n,t,i)}};function sw(n){return ki(n)?n.reduce((t,i)=>(t[i]=null,t),{}):n}let $v=!0;function SI(n){const t=gS(n),i=n.proxy,l=n.ctx;$v=!1,t.beforeCreate&&rw(t.beforeCreate,n,"bc");const{data:c,computed:d,methods:_,watch:v,provide:r,inject:E,created:C,beforeMount:z,mounted:R,beforeUpdate:j,updated:G,activated:W,deactivated:Q,beforeDestroy:rt,beforeUnmount:ft,destroyed:xt,unmounted:mt,render:bt,renderTracked:Ot,renderTriggered:zt,errorCaptured:Rt,serverPrefetch:Bt,expose:Nt,inheritAttrs:ee,components:Wt,directives:ae,filters:ye}=t;if(E&&MI(E,l,null),_)for(const he in _){const oe=_[he];qi(oe)&&(l[he]=oe.bind(i))}if(c){const he=c.call(i,i);Wn(he)&&(n.data=gm(he))}if($v=!0,d)for(const he in d){const oe=d[he],Oe=qi(oe)?oe.bind(i,i):qi(oe.get)?oe.get.bind(i,i):Nc,Ue=!qi(oe)&&qi(oe.set)?oe.set.bind(i):Nc,$t=Er({get:Oe,set:Ue});Object.defineProperty(l,he,{enumerable:!0,configurable:!0,get:()=>$t.value,set:ce=>$t.value=ce})}if(v)for(const he in v)_S(v[he],l,i,he);if(r){const he=qi(r)?r.call(i):r;Reflect.ownKeys(he).forEach(oe=>{LI(oe,he[oe])})}C&&rw(C,n,"c");function de(he,oe){ki(oe)?oe.forEach(Oe=>he(Oe.bind(i))):oe&&he(oe.bind(i))}if(de(pI,z),de(Md,R),de(mI,j),de(_I,G),de(hI,W),de(dI,Q),de(xI,Rt),de(vI,Ot),de(yI,zt),de(Cd,ft),de(pS,mt),de(gI,Bt),ki(Nt))if(Nt.length){const he=n.exposed||(n.exposed={});Nt.forEach(oe=>{Object.defineProperty(he,oe,{get:()=>i[oe],set:Oe=>i[oe]=Oe,enumerable:!0})})}else n.exposed||(n.exposed={});bt&&n.render===Nc&&(n.render=bt),ee!=null&&(n.inheritAttrs=ee),Wt&&(n.components=Wt),ae&&(n.directives=ae),Bt&&dS(n)}function MI(n,t,i=Nc){ki(n)&&(n=Wv(n));for(const l in n){const c=n[l];let d;Wn(c)?"default"in c?d=k_(c.from||l,c.default,!0):d=k_(c.from||l):d=k_(c),bo(d)?Object.defineProperty(t,l,{enumerable:!0,configurable:!0,get:()=>d.value,set:_=>d.value=_}):t[l]=d}}function rw(n,t,i){tc(ki(n)?n.map(l=>l.bind(t.proxy)):n.bind(t.proxy),t,i)}function _S(n,t,i,l){let c=l.includes(".")?kS(i,l):()=>i[l];if(Vs(n)){const d=t[n];qi(d)&&qr(c,d)}else if(qi(n))qr(c,n.bind(i));else if(Wn(n))if(ki(n))n.forEach(d=>_S(d,t,i,l));else{const d=qi(n.handler)?n.handler.bind(i):t[n.handler];qi(d)&&qr(c,d,n)}}function gS(n){const t=n.type,{mixins:i,extends:l}=t,{mixins:c,optionsCache:d,config:{optionMergeStrategies:_}}=n.appContext,v=d.get(t);let r;return v?r=v:!c.length&&!i&&!l?r=t:(r={},c.length&&c.forEach(E=>Y_(r,E,_,!0)),Y_(r,t,_)),Wn(t)&&d.set(t,r),r}function Y_(n,t,i,l=!1){const{mixins:c,extends:d}=t;d&&Y_(n,d,i,!0),c&&c.forEach(_=>Y_(n,_,i,!0));for(const _ in t)if(!(l&&_==="expose")){const v=CI[_]||i&&i[_];n[_]=v?v(n[_],t[_]):t[_]}return n}const CI={data:ow,props:aw,emits:aw,methods:Mp,computed:Mp,beforeCreate:Bo,created:Bo,beforeMount:Bo,mounted:Bo,beforeUpdate:Bo,updated:Bo,beforeDestroy:Bo,beforeUnmount:Bo,destroyed:Bo,unmounted:Bo,activated:Bo,deactivated:Bo,errorCaptured:Bo,serverPrefetch:Bo,components:Mp,directives:Mp,watch:PI,provide:ow,inject:AI};function ow(n,t){return t?n?function(){return Kr(qi(n)?n.call(this,this):n,qi(t)?t.call(this,this):t)}:t:n}function AI(n,t){return Mp(Wv(n),Wv(t))}function Wv(n){if(ki(n)){const t={};for(let i=0;i<n.length;i++)t[n[i]]=n[i];return t}return n}function Bo(n,t){return n?[...new Set([].concat(n,t))]:t}function Mp(n,t){return n?Kr(Object.create(null),n,t):t}function aw(n,t){return n?ki(n)&&ki(t)?[...new Set([...n,...t])]:Kr(Object.create(null),sw(n),sw(t??{})):t}function PI(n,t){if(!n)return t;if(!t)return n;const i=Kr(Object.create(null),n);for(const l in t)i[l]=Bo(n[l],t[l]);return i}function yS(){return{app:null,config:{isNativeTag:IE,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let kI=0;function II(n,t){return function(l,c=null){qi(l)||(l=Kr({},l)),c!=null&&!Wn(c)&&(c=null);const d=yS(),_=new WeakSet,v=[];let r=!1;const E=d.app={_uid:kI++,_component:l,_props:c,_container:null,_context:d,_instance:null,version:pL,get config(){return d.config},set config(C){},use(C,...z){return _.has(C)||(C&&qi(C.install)?(_.add(C),C.install(E,...z)):qi(C)&&(_.add(C),C(E,...z))),E},mixin(C){return d.mixins.includes(C)||d.mixins.push(C),E},component(C,z){return z?(d.components[C]=z,E):d.components[C]},directive(C,z){return z?(d.directives[C]=z,E):d.directives[C]},mount(C,z,R){if(!r){const j=E._ceVNode||vo(l,c);return j.appContext=d,R===!0?R="svg":R===!1&&(R=void 0),n(j,C,R),r=!0,E._container=C,C.__vue_app__=E,kg(j.component)}},onUnmount(C){v.push(C)},unmount(){r&&(tc(v,E._instance,16),n(null,E._container),delete E._container.__vue_app__)},provide(C,z){return d.provides[C]=z,E},runWithContext(C){const z=gf;gf=E;try{return C()}finally{gf=z}}};return E}}let gf=null;function LI(n,t){if(go){let i=go.provides;const l=go.parent&&go.parent.provides;l===i&&(i=go.provides=Object.create(l)),i[n]=t}}function k_(n,t,i=!1){const l=RS();if(l||gf){let c=gf?gf._context.provides:l?l.parent==null||l.ce?l.vnode.appContext&&l.vnode.appContext.provides:l.parent.provides:void 0;if(c&&n in c)return c[n];if(arguments.length>1)return i&&qi(t)?t.call(l&&l.proxy):t}}const vS={},xS=()=>Object.create(vS),bS=n=>Object.getPrototypeOf(n)===vS;function DI(n,t,i,l=!1){const c={},d=xS();n.propsDefaults=Object.create(null),wS(n,t,c,d);for(const _ in n.propsOptions[0])_ in c||(c[_]=void 0);i?n.props=l?c:Xk(c):n.type.props?n.props=c:n.props=d,n.attrs=d}function zI(n,t,i,l){const{props:c,attrs:d,vnode:{patchFlag:_}}=n,v=Dn(c),[r]=n.propsOptions;let E=!1;if((l||_>0)&&!(_&16)){if(_&8){const C=n.vnode.dynamicProps;for(let z=0;z<C.length;z++){let R=C[z];if(Ag(n.emitsOptions,R))continue;const j=t[R];if(r)if(Bn(d,R))j!==d[R]&&(d[R]=j,E=!0);else{const G=yl(R);c[G]=Zv(r,v,G,j,n,!1)}else j!==d[R]&&(d[R]=j,E=!0)}}}else{wS(n,t,c,d)&&(E=!0);let C;for(const z in v)(!t||!Bn(t,z)&&((C=Sd(z))===z||!Bn(t,C)))&&(r?i&&(i[z]!==void 0||i[C]!==void 0)&&(c[z]=Zv(r,v,z,void 0,n,!0)):delete c[z]);if(d!==v)for(const z in d)(!t||!Bn(t,z))&&(delete d[z],E=!0)}E&&Au(n.attrs,"set","")}function wS(n,t,i,l){const[c,d]=n.propsOptions;let _=!1,v;if(t)for(let r in t){if(zp(r))continue;const E=t[r];let C;c&&Bn(c,C=yl(r))?!d||!d.includes(C)?i[C]=E:(v||(v={}))[C]=E:Ag(n.emitsOptions,r)||(!(r in l)||E!==l[r])&&(l[r]=E,_=!0)}if(d){const r=Dn(i),E=v||ts;for(let C=0;C<d.length;C++){const z=d[C];i[z]=Zv(c,r,z,E[z],n,!Bn(E,z))}}return _}function Zv(n,t,i,l,c,d){const _=n[i];if(_!=null){const v=Bn(_,"default");if(v&&l===void 0){const r=_.default;if(_.type!==Function&&!_.skipFactory&&qi(r)){const{propsDefaults:E}=c;if(i in E)l=E[i];else{const C=vm(c);l=E[i]=r.call(null,t),C()}}else l=r;c.ce&&c.ce._setProp(i,l)}_[0]&&(d&&!v?l=!1:_[1]&&(l===""||l===Sd(i))&&(l=!0))}return l}const OI=new WeakMap;function TS(n,t,i=!1){const l=i?OI:t.propsCache,c=l.get(n);if(c)return c;const d=n.props,_={},v=[];let r=!1;if(!qi(n)){const C=z=>{r=!0;const[R,j]=TS(z,t,!0);Kr(_,R),j&&v.push(...j)};!i&&t.mixins.length&&t.mixins.forEach(C),n.extends&&C(n.extends),n.mixins&&n.mixins.forEach(C)}if(!d&&!r)return Wn(n)&&l.set(n,ff),ff;if(ki(d))for(let C=0;C<d.length;C++){const z=yl(d[C]);lw(z)&&(_[z]=ts)}else if(d)for(const C in d){const z=yl(C);if(lw(z)){const R=d[C],j=_[z]=ki(R)||qi(R)?{type:R}:Kr({},R),G=j.type;let W=!1,Q=!0;if(ki(G))for(let rt=0;rt<G.length;++rt){const ft=G[rt],xt=qi(ft)&&ft.name;if(xt==="Boolean"){W=!0;break}else xt==="String"&&(Q=!1)}else W=qi(G)&&G.name==="Boolean";j[0]=W,j[1]=Q,(W||Bn(j,"default"))&&v.push(z)}}const E=[_,v];return Wn(n)&&l.set(n,E),E}function lw(n){return n[0]!=="$"&&!zp(n)}const Dx=n=>n==="_"||n==="_ctx"||n==="$stable",zx=n=>ki(n)?n.map(Rc):[Rc(n)],RI=(n,t,i)=>{if(t._n)return t;const l=rS((...c)=>zx(t(...c)),i);return l._c=!1,l},ES=(n,t,i)=>{const l=n._ctx;for(const c in n){if(Dx(c))continue;const d=n[c];if(qi(d))t[c]=RI(c,d,l);else if(d!=null){const _=zx(d);t[c]=()=>_}}},SS=(n,t)=>{const i=zx(t);n.slots.default=()=>i},MS=(n,t,i)=>{for(const l in t)(i||!Dx(l))&&(n[l]=t[l])},BI=(n,t,i)=>{const l=n.slots=xS();if(n.vnode.shapeFlag&32){const c=t._;c?(MS(l,t,i),i&&OE(l,"_",c,!0)):ES(t,l)}else t&&SS(n,t)},FI=(n,t,i)=>{const{vnode:l,slots:c}=n;let d=!0,_=ts;if(l.shapeFlag&32){const v=t._;v?i&&v===1?d=!1:MS(c,t,i):(d=!t.$stable,ES(t,c)),_=t}else t&&(SS(n,t),_={default:1});if(d)for(const v in c)!Dx(v)&&_[v]==null&&delete c[v]},ka=QI;function NI(n){return jI(n)}function jI(n,t){const i=wg();i.__VUE__=!0;const{insert:l,remove:c,patchProp:d,createElement:_,createText:v,createComment:r,setText:E,setElementText:C,parentNode:z,nextSibling:R,setScopeId:j=Nc,insertStaticContent:G}=n,W=(Tt,Ft,Jt,Se=null,me=null,we=null,Ke=void 0,$e=null,Ne=!!Ft.dynamicChildren)=>{if(Tt===Ft)return;Tt&&!hd(Tt,Ft)&&(Se=vi(Tt),ce(Tt,me,we,!0),Tt=null),Ft.patchFlag===-2&&(Ne=!1,Ft.dynamicChildren=null);const{type:Re,ref:fi,shapeFlag:ti}=Ft;switch(Re){case Pg:Q(Tt,Ft,Jt,Se);break;case No:rt(Tt,Ft,Jt,Se);break;case I_:Tt==null&&ft(Ft,Jt,Se,Ke);break;case an:Wt(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne);break;default:ti&1?bt(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne):ti&6?ae(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne):(ti&64||ti&128)&&Re.process(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne,_n)}fi!=null&&me?Bp(fi,Tt&&Tt.ref,we,Ft||Tt,!Ft):fi==null&&Tt&&Tt.ref!=null&&Bp(Tt.ref,null,we,Tt,!0)},Q=(Tt,Ft,Jt,Se)=>{if(Tt==null)l(Ft.el=v(Ft.children),Jt,Se);else{const me=Ft.el=Tt.el;Ft.children!==Tt.children&&E(me,Ft.children)}},rt=(Tt,Ft,Jt,Se)=>{Tt==null?l(Ft.el=r(Ft.children||""),Jt,Se):Ft.el=Tt.el},ft=(Tt,Ft,Jt,Se)=>{[Tt.el,Tt.anchor]=G(Tt.children,Ft,Jt,Se,Tt.el,Tt.anchor)},xt=({el:Tt,anchor:Ft},Jt,Se)=>{let me;for(;Tt&&Tt!==Ft;)me=R(Tt),l(Tt,Jt,Se),Tt=me;l(Ft,Jt,Se)},mt=({el:Tt,anchor:Ft})=>{let Jt;for(;Tt&&Tt!==Ft;)Jt=R(Tt),c(Tt),Tt=Jt;c(Ft)},bt=(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne)=>{Ft.type==="svg"?Ke="svg":Ft.type==="math"&&(Ke="mathml"),Tt==null?Ot(Ft,Jt,Se,me,we,Ke,$e,Ne):Bt(Tt,Ft,me,we,Ke,$e,Ne)},Ot=(Tt,Ft,Jt,Se,me,we,Ke,$e)=>{let Ne,Re;const{props:fi,shapeFlag:ti,transition:ci,dirs:_i}=Tt;if(Ne=Tt.el=_(Tt.type,we,fi&&fi.is,fi),ti&8?C(Ne,Tt.children):ti&16&&Rt(Tt.children,Ne,null,Se,me,rv(Tt,we),Ke,$e),_i&&Kh(Tt,null,Se,"created"),zt(Ne,Tt,Tt.scopeId,Ke,Se),fi){for(const Ji in fi)Ji!=="value"&&!zp(Ji)&&d(Ne,Ji,null,fi[Ji],we,Se);"value"in fi&&d(Ne,"value",null,fi.value,we),(Re=fi.onVnodeBeforeMount)&&kc(Re,Se,Tt)}_i&&Kh(Tt,null,Se,"beforeMount");const Ei=VI(me,ci);Ei&&ci.beforeEnter(Ne),l(Ne,Ft,Jt),((Re=fi&&fi.onVnodeMounted)||Ei||_i)&&ka(()=>{Re&&kc(Re,Se,Tt),Ei&&ci.enter(Ne),_i&&Kh(Tt,null,Se,"mounted")},me)},zt=(Tt,Ft,Jt,Se,me)=>{if(Jt&&j(Tt,Jt),Se)for(let we=0;we<Se.length;we++)j(Tt,Se[we]);if(me){let we=me.subTree;if(Ft===we||LS(we.type)&&(we.ssContent===Ft||we.ssFallback===Ft)){const Ke=me.vnode;zt(Tt,Ke,Ke.scopeId,Ke.slotScopeIds,me.parent)}}},Rt=(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne=0)=>{for(let Re=Ne;Re<Tt.length;Re++){const fi=Tt[Re]=$e?sh(Tt[Re]):Rc(Tt[Re]);W(null,fi,Ft,Jt,Se,me,we,Ke,$e)}},Bt=(Tt,Ft,Jt,Se,me,we,Ke)=>{const $e=Ft.el=Tt.el;let{patchFlag:Ne,dynamicChildren:Re,dirs:fi}=Ft;Ne|=Tt.patchFlag&16;const ti=Tt.props||ts,ci=Ft.props||ts;let _i;if(Jt&&Yh(Jt,!1),(_i=ci.onVnodeBeforeUpdate)&&kc(_i,Jt,Ft,Tt),fi&&Kh(Ft,Tt,Jt,"beforeUpdate"),Jt&&Yh(Jt,!0),(ti.innerHTML&&ci.innerHTML==null||ti.textContent&&ci.textContent==null)&&C($e,""),Re?Nt(Tt.dynamicChildren,Re,$e,Jt,Se,rv(Ft,me),we):Ke||oe(Tt,Ft,$e,null,Jt,Se,rv(Ft,me),we,!1),Ne>0){if(Ne&16)ee($e,ti,ci,Jt,me);else if(Ne&2&&ti.class!==ci.class&&d($e,"class",null,ci.class,me),Ne&4&&d($e,"style",ti.style,ci.style,me),Ne&8){const Ei=Ft.dynamicProps;for(let Ji=0;Ji<Ei.length;Ji++){const Ri=Ei[Ji],Fn=ti[Ri],Mn=ci[Ri];(Mn!==Fn||Ri==="value")&&d($e,Ri,Fn,Mn,me,Jt)}}Ne&1&&Tt.children!==Ft.children&&C($e,Ft.children)}else!Ke&&Re==null&&ee($e,ti,ci,Jt,me);((_i=ci.onVnodeUpdated)||fi)&&ka(()=>{_i&&kc(_i,Jt,Ft,Tt),fi&&Kh(Ft,Tt,Jt,"updated")},Se)},Nt=(Tt,Ft,Jt,Se,me,we,Ke)=>{for(let $e=0;$e<Ft.length;$e++){const Ne=Tt[$e],Re=Ft[$e],fi=Ne.el&&(Ne.type===an||!hd(Ne,Re)||Ne.shapeFlag&198)?z(Ne.el):Jt;W(Ne,Re,fi,null,Se,me,we,Ke,!0)}},ee=(Tt,Ft,Jt,Se,me)=>{if(Ft!==Jt){if(Ft!==ts)for(const we in Ft)!zp(we)&&!(we in Jt)&&d(Tt,we,Ft[we],null,me,Se);for(const we in Jt){if(zp(we))continue;const Ke=Jt[we],$e=Ft[we];Ke!==$e&&we!=="value"&&d(Tt,we,$e,Ke,me,Se)}"value"in Jt&&d(Tt,"value",Ft.value,Jt.value,me)}},Wt=(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne)=>{const Re=Ft.el=Tt?Tt.el:v(""),fi=Ft.anchor=Tt?Tt.anchor:v("");let{patchFlag:ti,dynamicChildren:ci,slotScopeIds:_i}=Ft;_i&&($e=$e?$e.concat(_i):_i),Tt==null?(l(Re,Jt,Se),l(fi,Jt,Se),Rt(Ft.children||[],Jt,fi,me,we,Ke,$e,Ne)):ti>0&&ti&64&&ci&&Tt.dynamicChildren?(Nt(Tt.dynamicChildren,ci,Jt,me,we,Ke,$e),(Ft.key!=null||me&&Ft===me.subTree)&&CS(Tt,Ft,!0)):oe(Tt,Ft,Jt,fi,me,we,Ke,$e,Ne)},ae=(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne)=>{Ft.slotScopeIds=$e,Tt==null?Ft.shapeFlag&512?me.ctx.activate(Ft,Jt,Se,Ke,Ne):ye(Ft,Jt,Se,me,we,Ke,Ne):He(Tt,Ft,Ne)},ye=(Tt,Ft,Jt,Se,me,we,Ke)=>{const $e=Tt.component=oL(Tt,Se,me);if(Mg(Tt)&&($e.ctx.renderer=_n),aL($e,!1,Ke),$e.asyncDep){if(me&&me.registerDep($e,de,Ke),!Tt.el){const Ne=$e.subTree=vo(No);rt(null,Ne,Ft,Jt),Tt.placeholder=Ne.el}}else de($e,Tt,Ft,Jt,me,we,Ke)},He=(Tt,Ft,Jt)=>{const Se=Ft.component=Tt.component;if(YI(Tt,Ft,Jt))if(Se.asyncDep&&!Se.asyncResolved){he(Se,Ft,Jt);return}else Se.next=Ft,Se.update();else Ft.el=Tt.el,Se.vnode=Ft},de=(Tt,Ft,Jt,Se,me,we,Ke)=>{const $e=()=>{if(Tt.isMounted){let{next:ti,bu:ci,u:_i,parent:Ei,vnode:Ji}=Tt;{const Vn=AS(Tt);if(Vn){ti&&(ti.el=Ji.el,he(Tt,ti,Ke)),Vn.asyncDep.then(()=>{Tt.isUnmounted||$e()});return}}let Ri=ti,Fn;Yh(Tt,!1),ti?(ti.el=Ji.el,he(Tt,ti,Ke)):ti=Ji,ci&&P_(ci),(Fn=ti.props&&ti.props.onVnodeBeforeUpdate)&&kc(Fn,Ei,ti,Ji),Yh(Tt,!0);const Mn=uw(Tt),zn=Tt.subTree;Tt.subTree=Mn,W(zn,Mn,z(zn.el),vi(zn),Tt,me,we),ti.el=Mn.el,Ri===null&&JI(Tt,Mn.el),_i&&ka(_i,me),(Fn=ti.props&&ti.props.onVnodeUpdated)&&ka(()=>kc(Fn,Ei,ti,Ji),me)}else{let ti;const{el:ci,props:_i}=Ft,{bm:Ei,m:Ji,parent:Ri,root:Fn,type:Mn}=Tt,zn=Fp(Ft);Yh(Tt,!1),Ei&&P_(Ei),!zn&&(ti=_i&&_i.onVnodeBeforeMount)&&kc(ti,Ri,Ft),Yh(Tt,!0);{Fn.ce&&Fn.ce._def.shadowRoot!==!1&&Fn.ce._injectChildStyle(Mn);const Vn=Tt.subTree=uw(Tt);W(null,Vn,Jt,Se,Tt,me,we),Ft.el=Vn.el}if(Ji&&ka(Ji,me),!zn&&(ti=_i&&_i.onVnodeMounted)){const Vn=Ft;ka(()=>kc(ti,Ri,Vn),me)}(Ft.shapeFlag&256||Ri&&Fp(Ri.vnode)&&Ri.vnode.shapeFlag&256)&&Tt.a&&ka(Tt.a,me),Tt.isMounted=!0,Ft=Jt=Se=null}};Tt.scope.on();const Ne=Tt.effect=new NE($e);Tt.scope.off();const Re=Tt.update=Ne.run.bind(Ne),fi=Tt.job=Ne.runIfDirty.bind(Ne);fi.i=Tt,fi.id=Tt.uid,Ne.scheduler=()=>Lx(fi),Yh(Tt,!0),Re()},he=(Tt,Ft,Jt)=>{Ft.component=Tt;const Se=Tt.vnode.props;Tt.vnode=Ft,Tt.next=null,zI(Tt,Ft.props,Se,Jt),FI(Tt,Ft.children,Jt),Du(),tw(Tt),zu()},oe=(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne=!1)=>{const Re=Tt&&Tt.children,fi=Tt?Tt.shapeFlag:0,ti=Ft.children,{patchFlag:ci,shapeFlag:_i}=Ft;if(ci>0){if(ci&128){Ue(Re,ti,Jt,Se,me,we,Ke,$e,Ne);return}else if(ci&256){Oe(Re,ti,Jt,Se,me,we,Ke,$e,Ne);return}}_i&8?(fi&16&&ri(Re,me,we),ti!==Re&&C(Jt,ti)):fi&16?_i&16?Ue(Re,ti,Jt,Se,me,we,Ke,$e,Ne):ri(Re,me,we,!0):(fi&8&&C(Jt,""),_i&16&&Rt(ti,Jt,Se,me,we,Ke,$e,Ne))},Oe=(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne)=>{Tt=Tt||ff,Ft=Ft||ff;const Re=Tt.length,fi=Ft.length,ti=Math.min(Re,fi);let ci;for(ci=0;ci<ti;ci++){const _i=Ft[ci]=Ne?sh(Ft[ci]):Rc(Ft[ci]);W(Tt[ci],_i,Jt,null,me,we,Ke,$e,Ne)}Re>fi?ri(Tt,me,we,!0,!1,ti):Rt(Ft,Jt,Se,me,we,Ke,$e,Ne,ti)},Ue=(Tt,Ft,Jt,Se,me,we,Ke,$e,Ne)=>{let Re=0;const fi=Ft.length;let ti=Tt.length-1,ci=fi-1;for(;Re<=ti&&Re<=ci;){const _i=Tt[Re],Ei=Ft[Re]=Ne?sh(Ft[Re]):Rc(Ft[Re]);if(hd(_i,Ei))W(_i,Ei,Jt,null,me,we,Ke,$e,Ne);else break;Re++}for(;Re<=ti&&Re<=ci;){const _i=Tt[ti],Ei=Ft[ci]=Ne?sh(Ft[ci]):Rc(Ft[ci]);if(hd(_i,Ei))W(_i,Ei,Jt,null,me,we,Ke,$e,Ne);else break;ti--,ci--}if(Re>ti){if(Re<=ci){const _i=ci+1,Ei=_i<fi?Ft[_i].el:Se;for(;Re<=ci;)W(null,Ft[Re]=Ne?sh(Ft[Re]):Rc(Ft[Re]),Jt,Ei,me,we,Ke,$e,Ne),Re++}}else if(Re>ci)for(;Re<=ti;)ce(Tt[Re],me,we,!0),Re++;else{const _i=Re,Ei=Re,Ji=new Map;for(Re=Ei;Re<=ci;Re++){const Cn=Ft[Re]=Ne?sh(Ft[Re]):Rc(Ft[Re]);Cn.key!=null&&Ji.set(Cn.key,Re)}let Ri,Fn=0;const Mn=ci-Ei+1;let zn=!1,Vn=0;const Us=new Array(Mn);for(Re=0;Re<Mn;Re++)Us[Re]=0;for(Re=_i;Re<=ti;Re++){const Cn=Tt[Re];if(Fn>=Mn){ce(Cn,me,we,!0);continue}let fs;if(Cn.key!=null)fs=Ji.get(Cn.key);else for(Ri=Ei;Ri<=ci;Ri++)if(Us[Ri-Ei]===0&&hd(Cn,Ft[Ri])){fs=Ri;break}fs===void 0?ce(Cn,me,we,!0):(Us[fs-Ei]=Re+1,fs>=Vn?Vn=fs:zn=!0,W(Cn,Ft[fs],Jt,null,me,we,Ke,$e,Ne),Fn++)}const Mr=zn?UI(Us):ff;for(Ri=Mr.length-1,Re=Mn-1;Re>=0;Re--){const Cn=Ei+Re,fs=Ft[Cn],Ys=Ft[Cn+1],Eo=Cn+1<fi?Ys.el||Ys.placeholder:Se;Us[Re]===0?W(null,fs,Jt,Eo,me,we,Ke,$e,Ne):zn&&(Ri<0||Re!==Mr[Ri]?$t(fs,Jt,Eo,2):Ri--)}}},$t=(Tt,Ft,Jt,Se,me=null)=>{const{el:we,type:Ke,transition:$e,children:Ne,shapeFlag:Re}=Tt;if(Re&6){$t(Tt.component.subTree,Ft,Jt,Se);return}if(Re&128){Tt.suspense.move(Ft,Jt,Se);return}if(Re&64){Ke.move(Tt,Ft,Jt,_n);return}if(Ke===an){l(we,Ft,Jt);for(let ti=0;ti<Ne.length;ti++)$t(Ne[ti],Ft,Jt,Se);l(Tt.anchor,Ft,Jt);return}if(Ke===I_){xt(Tt,Ft,Jt);return}if(Se!==2&&Re&1&&$e)if(Se===0)$e.beforeEnter(we),l(we,Ft,Jt),ka(()=>$e.enter(we),me);else{const{leave:ti,delayLeave:ci,afterLeave:_i}=$e,Ei=()=>{Tt.ctx.isUnmounted?c(we):l(we,Ft,Jt)},Ji=()=>{we._isLeaving&&we[Su](!0),ti(we,()=>{Ei(),_i&&_i()})};ci?ci(we,Ei,Ji):Ji()}else l(we,Ft,Jt)},ce=(Tt,Ft,Jt,Se=!1,me=!1)=>{const{type:we,props:Ke,ref:$e,children:Ne,dynamicChildren:Re,shapeFlag:fi,patchFlag:ti,dirs:ci,cacheIndex:_i}=Tt;if(ti===-2&&(me=!1),$e!=null&&(Du(),Bp($e,null,Jt,Tt,!0),zu()),_i!=null&&(Ft.renderCache[_i]=void 0),fi&256){Ft.ctx.deactivate(Tt);return}const Ei=fi&1&&ci,Ji=!Fp(Tt);let Ri;if(Ji&&(Ri=Ke&&Ke.onVnodeBeforeUnmount)&&kc(Ri,Ft,Tt),fi&6)Xe(Tt.component,Jt,Se);else{if(fi&128){Tt.suspense.unmount(Jt,Se);return}Ei&&Kh(Tt,null,Ft,"beforeUnmount"),fi&64?Tt.type.remove(Tt,Ft,Jt,_n,Se):Re&&!Re.hasOnce&&(we!==an||ti>0&&ti&64)?ri(Re,Ft,Jt,!1,!0):(we===an&&ti&384||!me&&fi&16)&&ri(Ne,Ft,Jt),Se&&Ve(Tt)}(Ji&&(Ri=Ke&&Ke.onVnodeUnmounted)||Ei)&&ka(()=>{Ri&&kc(Ri,Ft,Tt),Ei&&Kh(Tt,null,Ft,"unmounted")},Jt)},Ve=Tt=>{const{type:Ft,el:Jt,anchor:Se,transition:me}=Tt;if(Ft===an){je(Jt,Se);return}if(Ft===I_){mt(Tt);return}const we=()=>{c(Jt),me&&!me.persisted&&me.afterLeave&&me.afterLeave()};if(Tt.shapeFlag&1&&me&&!me.persisted){const{leave:Ke,delayLeave:$e}=me,Ne=()=>Ke(Jt,we);$e?$e(Tt.el,we,Ne):Ne()}else we()},je=(Tt,Ft)=>{let Jt;for(;Tt!==Ft;)Jt=R(Tt),c(Tt),Tt=Jt;c(Ft)},Xe=(Tt,Ft,Jt)=>{const{bum:Se,scope:me,job:we,subTree:Ke,um:$e,m:Ne,a:Re}=Tt;cw(Ne),cw(Re),Se&&P_(Se),me.stop(),we&&(we.flags|=8,ce(Ke,Tt,Ft,Jt)),$e&&ka($e,Ft),ka(()=>{Tt.isUnmounted=!0},Ft)},ri=(Tt,Ft,Jt,Se=!1,me=!1,we=0)=>{for(let Ke=we;Ke<Tt.length;Ke++)ce(Tt[Ke],Ft,Jt,Se,me)},vi=Tt=>{if(Tt.shapeFlag&6)return vi(Tt.component.subTree);if(Tt.shapeFlag&128)return Tt.suspense.next();const Ft=R(Tt.anchor||Tt.el),Jt=Ft&&Ft[aI];return Jt?R(Jt):Ft};let Ii=!1;const Qe=(Tt,Ft,Jt)=>{Tt==null?Ft._vnode&&ce(Ft._vnode,null,null,!0):W(Ft._vnode||null,Tt,Ft,null,null,null,Jt),Ft._vnode=Tt,Ii||(Ii=!0,tw(),iS(),Ii=!1)},_n={p:W,um:ce,m:$t,r:Ve,mt:ye,mc:Rt,pc:oe,pbc:Nt,n:vi,o:n};return{render:Qe,hydrate:void 0,createApp:II(Qe)}}function rv({type:n,props:t},i){return i==="svg"&&n==="foreignObject"||i==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:i}function Yh({effect:n,job:t},i){i?(n.flags|=32,t.flags|=4):(n.flags&=-33,t.flags&=-5)}function VI(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function CS(n,t,i=!1){const l=n.children,c=t.children;if(ki(l)&&ki(c))for(let d=0;d<l.length;d++){const _=l[d];let v=c[d];v.shapeFlag&1&&!v.dynamicChildren&&((v.patchFlag<=0||v.patchFlag===32)&&(v=c[d]=sh(c[d]),v.el=_.el),!i&&v.patchFlag!==-2&&CS(_,v)),v.type===Pg&&v.patchFlag!==-1&&(v.el=_.el),v.type===No&&!v.el&&(v.el=_.el)}}function UI(n){const t=n.slice(),i=[0];let l,c,d,_,v;const r=n.length;for(l=0;l<r;l++){const E=n[l];if(E!==0){if(c=i[i.length-1],n[c]<E){t[l]=c,i.push(l);continue}for(d=0,_=i.length-1;d<_;)v=d+_>>1,n[i[v]]<E?d=v+1:_=v;E<n[i[d]]&&(d>0&&(t[l]=i[d-1]),i[d]=l)}}for(d=i.length,_=i[d-1];d-- >0;)i[d]=_,_=t[_];return i}function AS(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:AS(t)}function cw(n){if(n)for(let t=0;t<n.length;t++)n[t].flags|=8}const $I=Symbol.for("v-scx"),WI=()=>k_($I);function qr(n,t,i){return PS(n,t,i)}function PS(n,t,i=ts){const{immediate:l,deep:c,flush:d,once:_}=i,v=Kr({},i),r=t&&l||!t&&d!=="post";let E;if(tm){if(d==="sync"){const j=WI();E=j.__watcherHandles||(j.__watcherHandles=[])}else if(!r){const j=()=>{};return j.stop=Nc,j.resume=Nc,j.pause=Nc,j}}const C=go;v.call=(j,G,W)=>tc(j,C,G,W);let z=!1;d==="post"?v.scheduler=j=>{ka(j,C&&C.suspense)}:d!=="sync"&&(z=!0,v.scheduler=(j,G)=>{G?j():Lx(j)}),v.augmentJob=j=>{t&&(j.flags|=4),z&&(j.flags|=2,C&&(j.id=C.uid,j.i=C))};const R=nI(n,t,v);return tm&&(E?E.push(R):r&&R()),R}function ZI(n,t,i){const l=this.proxy,c=Vs(n)?n.includes(".")?kS(l,n):()=>l[n]:n.bind(l,l);let d;qi(t)?d=t:(d=t.handler,i=t);const _=vm(this),v=PS(c,d.bind(l),i);return _(),v}function kS(n,t){const i=t.split(".");return()=>{let l=n;for(let c=0;c<i.length&&l;c++)l=l[i[c]];return l}}const GI=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${yl(t)}Modifiers`]||n[`${Sd(t)}Modifiers`];function HI(n,t,...i){if(n.isUnmounted)return;const l=n.vnode.props||ts;let c=i;const d=t.startsWith("update:"),_=d&&GI(l,t.slice(7));_&&(_.trim&&(c=i.map(C=>Vs(C)?C.trim():C)),_.number&&(c=i.map(Z_)));let v,r=l[v=Jy(t)]||l[v=Jy(yl(t))];!r&&d&&(r=l[v=Jy(Sd(t))]),r&&tc(r,n,6,c);const E=l[v+"Once"];if(E){if(!n.emitted)n.emitted={};else if(n.emitted[v])return;n.emitted[v]=!0,tc(E,n,6,c)}}const qI=new WeakMap;function IS(n,t,i=!1){const l=i?qI:t.emitsCache,c=l.get(n);if(c!==void 0)return c;const d=n.emits;let _={},v=!1;if(!qi(n)){const r=E=>{const C=IS(E,t,!0);C&&(v=!0,Kr(_,C))};!i&&t.mixins.length&&t.mixins.forEach(r),n.extends&&r(n.extends),n.mixins&&n.mixins.forEach(r)}return!d&&!v?(Wn(n)&&l.set(n,null),null):(ki(d)?d.forEach(r=>_[r]=null):Kr(_,d),Wn(n)&&l.set(n,_),_)}function Ag(n,t){return!n||!yg(t)?!1:(t=t.slice(2).replace(/Once$/,""),Bn(n,t[0].toLowerCase()+t.slice(1))||Bn(n,Sd(t))||Bn(n,t))}function uw(n){const{type:t,vnode:i,proxy:l,withProxy:c,propsOptions:[d],slots:_,attrs:v,emit:r,render:E,renderCache:C,props:z,data:R,setupState:j,ctx:G,inheritAttrs:W}=n,Q=X_(n);let rt,ft;try{if(i.shapeFlag&4){const mt=c||l,bt=mt;rt=Rc(E.call(bt,mt,C,z,j,R,G)),ft=v}else{const mt=t;rt=Rc(mt.length>1?mt(z,{attrs:v,slots:_,emit:r}):mt(z,null)),ft=t.props?v:XI(v)}}catch(mt){jp.length=0,Sg(mt,n,1),rt=vo(No)}let xt=rt;if(ft&&W!==!1){const mt=Object.keys(ft),{shapeFlag:bt}=xt;mt.length&&bt&7&&(d&&mt.some(wx)&&(ft=KI(ft,d)),xt=vh(xt,ft,!1,!0))}return i.dirs&&(xt=vh(xt,null,!1,!0),xt.dirs=xt.dirs?xt.dirs.concat(i.dirs):i.dirs),i.transition&&Jp(xt,i.transition),rt=xt,X_(Q),rt}const XI=n=>{let t;for(const i in n)(i==="class"||i==="style"||yg(i))&&((t||(t={}))[i]=n[i]);return t},KI=(n,t)=>{const i={};for(const l in n)(!wx(l)||!(l.slice(9)in t))&&(i[l]=n[l]);return i};function YI(n,t,i){const{props:l,children:c,component:d}=n,{props:_,children:v,patchFlag:r}=t,E=d.emitsOptions;if(t.dirs||t.transition)return!0;if(i&&r>=0){if(r&1024)return!0;if(r&16)return l?hw(l,_,E):!!_;if(r&8){const C=t.dynamicProps;for(let z=0;z<C.length;z++){const R=C[z];if(_[R]!==l[R]&&!Ag(E,R))return!0}}}else return(c||v)&&(!v||!v.$stable)?!0:l===_?!1:l?_?hw(l,_,E):!0:!!_;return!1}function hw(n,t,i){const l=Object.keys(t);if(l.length!==Object.keys(n).length)return!0;for(let c=0;c<l.length;c++){const d=l[c];if(t[d]!==n[d]&&!Ag(i,d))return!0}return!1}function JI({vnode:n,parent:t},i){for(;t;){const l=t.subTree;if(l.suspense&&l.suspense.activeBranch===n&&(l.el=n.el),l===n)(n=t.vnode).el=i,t=t.parent;else break}}const LS=n=>n.__isSuspense;function QI(n,t){t&&t.pendingBranch?ki(n)?t.effects.push(...n):t.effects.push(n):oI(n)}const an=Symbol.for("v-fgt"),Pg=Symbol.for("v-txt"),No=Symbol.for("v-cmt"),I_=Symbol.for("v-stc"),jp=[];let Oa=null;function Ye(n=!1){jp.push(Oa=n?null:[])}function tL(){jp.pop(),Oa=jp[jp.length-1]||null}let Qp=1;function J_(n,t=!1){Qp+=n,n<0&&Oa&&t&&(Oa.hasOnce=!0)}function DS(n){return n.dynamicChildren=Qp>0?Oa||ff:null,tL(),Qp>0&&Oa&&Oa.push(n),n}function ii(n,t,i,l,c,d){return DS(ht(n,t,i,l,c,d,!0))}function zS(n,t,i,l,c){return DS(vo(n,t,i,l,c,!0))}function Q_(n){return n?n.__v_isVNode===!0:!1}function hd(n,t){return n.type===t.type&&n.key===t.key}const OS=({key:n})=>n??null,L_=({ref:n,ref_key:t,ref_for:i})=>(typeof n=="number"&&(n=""+n),n!=null?Vs(n)||bo(n)||qi(n)?{i:za,r:n,k:t,f:!!i}:n:null);function ht(n,t=null,i=null,l=0,c=null,d=n===an?0:1,_=!1,v=!1){const r={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&OS(t),ref:t&&L_(t),scopeId:sS,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:l,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:za};return v?(Ox(r,i),d&128&&n.normalize(r)):i&&(r.shapeFlag|=Vs(i)?8:16),Qp>0&&!_&&Oa&&(r.patchFlag>0||d&6)&&r.patchFlag!==32&&Oa.push(r),r}const vo=eL;function eL(n,t=null,i=null,l=0,c=null,d=!1){if((!n||n===mS)&&(n=No),Q_(n)){const v=vh(n,t,!0);return i&&Ox(v,i),Qp>0&&!d&&Oa&&(v.shapeFlag&6?Oa[Oa.indexOf(n)]=v:Oa.push(v)),v.patchFlag=-2,v}if(dL(n)&&(n=n.__vccOpts),t){t=iL(t);let{class:v,style:r}=t;v&&!Vs(v)&&(t.class=$c(v)),Wn(r)&&(Ix(r)&&!ki(r)&&(r=Kr({},r)),t.style=fl(r))}const _=Vs(n)?1:LS(n)?128:oS(n)?64:Wn(n)?4:qi(n)?2:0;return ht(n,t,i,l,c,_,d,!0)}function iL(n){return n?Ix(n)||bS(n)?Kr({},n):n:null}function vh(n,t,i=!1,l=!1){const{props:c,ref:d,patchFlag:_,children:v,transition:r}=n,E=t?nL(c||{},t):c,C={__v_isVNode:!0,__v_skip:!0,type:n.type,props:E,key:E&&OS(E),ref:t&&t.ref?i&&d?ki(d)?d.concat(L_(t)):[d,L_(t)]:L_(t):d,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:v,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==an?_===-1?16:_|16:_,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:r,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&vh(n.ssContent),ssFallback:n.ssFallback&&vh(n.ssFallback),placeholder:n.placeholder,el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return r&&l&&Jp(C,r.clone(C)),C}function sn(n=" ",t=0){return vo(Pg,null,n,t)}function D_(n,t){const i=vo(I_,null,n);return i.staticCount=t,i}function cr(n="",t=!1){return t?(Ye(),zS(No,null,n)):vo(No,null,n)}function Rc(n){return n==null||typeof n=="boolean"?vo(No):ki(n)?vo(an,null,n.slice()):Q_(n)?sh(n):vo(Pg,null,String(n))}function sh(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:vh(n)}function Ox(n,t){let i=0;const{shapeFlag:l}=n;if(t==null)t=null;else if(ki(t))i=16;else if(typeof t=="object")if(l&65){const c=t.default;c&&(c._c&&(c._d=!1),Ox(n,c()),c._c&&(c._d=!0));return}else{i=32;const c=t._;!c&&!bS(t)?t._ctx=za:c===3&&za&&(za.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else qi(t)?(t={default:t,_ctx:za},i=32):(t=String(t),l&64?(i=16,t=[sn(t)]):i=8);n.children=t,n.shapeFlag|=i}function nL(...n){const t={};for(let i=0;i<n.length;i++){const l=n[i];for(const c in l)if(c==="class")t.class!==l.class&&(t.class=$c([t.class,l.class]));else if(c==="style")t.style=fl([t.style,l.style]);else if(yg(c)){const d=t[c],_=l[c];_&&d!==_&&!(ki(d)&&d.includes(_))&&(t[c]=d?[].concat(d,_):_)}else c!==""&&(t[c]=l[c])}return t}function kc(n,t,i,l=null){tc(n,t,7,[i,l])}const sL=yS();let rL=0;function oL(n,t,i){const l=n.type,c=(t?t.appContext:n.appContext)||sL,d={uid:rL++,vnode:n,type:l,parent:t,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Pk(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(c.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:TS(l,c),emitsOptions:IS(l,c),emit:null,emitted:null,propsDefaults:ts,inheritAttrs:l.inheritAttrs,ctx:ts,data:ts,props:ts,attrs:ts,slots:ts,refs:ts,setupState:ts,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=t?t.root:d,d.emit=HI.bind(null,d),n.ce&&n.ce(d),d}let go=null;const RS=()=>go||za;let tg,Gv;{const n=wg(),t=(i,l)=>{let c;return(c=n[i])||(c=n[i]=[]),c.push(l),d=>{c.length>1?c.forEach(_=>_(d)):c[0](d)}};tg=t("__VUE_INSTANCE_SETTERS__",i=>go=i),Gv=t("__VUE_SSR_SETTERS__",i=>tm=i)}const vm=n=>{const t=go;return tg(n),n.scope.on(),()=>{n.scope.off(),tg(t)}},dw=()=>{go&&go.scope.off(),tg(null)};function BS(n){return n.vnode.shapeFlag&4}let tm=!1;function aL(n,t=!1,i=!1){t&&Gv(t);const{props:l,children:c}=n.vnode,d=BS(n);DI(n,l,d,t),BI(n,c,i||t);const _=d?lL(n,t):void 0;return t&&Gv(!1),_}function lL(n,t){const i=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,EI);const{setup:l}=i;if(l){Du();const c=n.setupContext=l.length>1?uL(n):null,d=vm(n),_=ym(l,n,0,[n.props,c]),v=LE(_);if(zu(),d(),(v||n.sp)&&!Fp(n)&&dS(n),v){if(_.then(dw,dw),t)return _.then(r=>{fw(n,r)}).catch(r=>{Sg(r,n,0)});n.asyncDep=_}else fw(n,_)}else FS(n)}function fw(n,t,i){qi(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Wn(t)&&(n.setupState=QE(t)),FS(n)}function FS(n,t,i){const l=n.type;n.render||(n.render=l.render||Nc);{const c=vm(n);Du();try{SI(n)}finally{zu(),c()}}}const cL={get(n,t){return _o(n,"get",""),n[t]}};function uL(n){const t=i=>{n.exposed=i||{}};return{attrs:new Proxy(n.attrs,cL),slots:n.slots,emit:n.emit,expose:t}}function kg(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(QE(Kk(n.exposed)),{get(t,i){if(i in t)return t[i];if(i in Np)return Np[i](n)},has(t,i){return i in t||i in Np}})):n.proxy}function hL(n,t=!0){return qi(n)?n.displayName||n.name:n.name||t&&n.__name}function dL(n){return qi(n)&&"__vccOpts"in n}const Er=(n,t)=>eI(n,t,tm);function fL(n,t,i){try{J_(-1);const l=arguments.length;return l===2?Wn(t)&&!ki(t)?Q_(t)?vo(n,null,[t]):vo(n,t):vo(n,null,t):(l>3?i=Array.prototype.slice.call(arguments,2):l===3&&Q_(i)&&(i=[i]),vo(n,t,i))}finally{J_(1)}}const pL="3.5.22";/**
* @vue/runtime-dom v3.5.22
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Hv;const pw=typeof window<"u"&&window.trustedTypes;if(pw)try{Hv=pw.createPolicy("vue",{createHTML:n=>n})}catch{}const NS=Hv?n=>Hv.createHTML(n):n=>n,mL="http://www.w3.org/2000/svg",_L="http://www.w3.org/1998/Math/MathML",wu=typeof document<"u"?document:null,mw=wu&&wu.createElement("template"),gL={insert:(n,t,i)=>{t.insertBefore(n,i||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,i,l)=>{const c=t==="svg"?wu.createElementNS(mL,n):t==="mathml"?wu.createElementNS(_L,n):i?wu.createElement(n,{is:i}):wu.createElement(n);return n==="select"&&l&&l.multiple!=null&&c.setAttribute("multiple",l.multiple),c},createText:n=>wu.createTextNode(n),createComment:n=>wu.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>wu.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,i,l,c,d){const _=i?i.previousSibling:t.lastChild;if(c&&(c===d||c.nextSibling))for(;t.insertBefore(c.cloneNode(!0),i),!(c===d||!(c=c.nextSibling)););else{mw.innerHTML=NS(l==="svg"?`<svg>${n}</svg>`:l==="mathml"?`<math>${n}</math>`:n);const v=mw.content;if(l==="svg"||l==="mathml"){const r=v.firstChild;for(;r.firstChild;)v.appendChild(r.firstChild);v.removeChild(r)}t.insertBefore(v,i)}return[_?_.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}},ih="transition",gp="animation",em=Symbol("_vtc"),jS={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},yL=Kr({},aS,jS),vL=n=>(n.displayName="Transition",n.props=yL,n),xL=vL((n,{slots:t})=>fL(uI,bL(n),t)),Jh=(n,t=[])=>{ki(n)?n.forEach(i=>i(...t)):n&&n(...t)},_w=n=>n?ki(n)?n.some(t=>t.length>1):n.length>1:!1;function bL(n){const t={};for(const Wt in n)Wt in jS||(t[Wt]=n[Wt]);if(n.css===!1)return t;const{name:i="v",type:l,duration:c,enterFromClass:d=`${i}-enter-from`,enterActiveClass:_=`${i}-enter-active`,enterToClass:v=`${i}-enter-to`,appearFromClass:r=d,appearActiveClass:E=_,appearToClass:C=v,leaveFromClass:z=`${i}-leave-from`,leaveActiveClass:R=`${i}-leave-active`,leaveToClass:j=`${i}-leave-to`}=n,G=wL(c),W=G&&G[0],Q=G&&G[1],{onBeforeEnter:rt,onEnter:ft,onEnterCancelled:xt,onLeave:mt,onLeaveCancelled:bt,onBeforeAppear:Ot=rt,onAppear:zt=ft,onAppearCancelled:Rt=xt}=t,Bt=(Wt,ae,ye,He)=>{Wt._enterCancelled=He,Qh(Wt,ae?C:v),Qh(Wt,ae?E:_),ye&&ye()},Nt=(Wt,ae)=>{Wt._isLeaving=!1,Qh(Wt,z),Qh(Wt,j),Qh(Wt,R),ae&&ae()},ee=Wt=>(ae,ye)=>{const He=Wt?zt:ft,de=()=>Bt(ae,Wt,ye);Jh(He,[ae,de]),gw(()=>{Qh(ae,Wt?r:d),yu(ae,Wt?C:v),_w(He)||yw(ae,l,W,de)})};return Kr(t,{onBeforeEnter(Wt){Jh(rt,[Wt]),yu(Wt,d),yu(Wt,_)},onBeforeAppear(Wt){Jh(Ot,[Wt]),yu(Wt,r),yu(Wt,E)},onEnter:ee(!1),onAppear:ee(!0),onLeave(Wt,ae){Wt._isLeaving=!0;const ye=()=>Nt(Wt,ae);yu(Wt,z),Wt._enterCancelled?(yu(Wt,R),bw(Wt)):(bw(Wt),yu(Wt,R)),gw(()=>{Wt._isLeaving&&(Qh(Wt,z),yu(Wt,j),_w(mt)||yw(Wt,l,Q,ye))}),Jh(mt,[Wt,ye])},onEnterCancelled(Wt){Bt(Wt,!1,void 0,!0),Jh(xt,[Wt])},onAppearCancelled(Wt){Bt(Wt,!0,void 0,!0),Jh(Rt,[Wt])},onLeaveCancelled(Wt){Nt(Wt),Jh(bt,[Wt])}})}function wL(n){if(n==null)return null;if(Wn(n))return[ov(n.enter),ov(n.leave)];{const t=ov(n);return[t,t]}}function ov(n){return xk(n)}function yu(n,t){t.split(/\s+/).forEach(i=>i&&n.classList.add(i)),(n[em]||(n[em]=new Set)).add(t)}function Qh(n,t){t.split(/\s+/).forEach(l=>l&&n.classList.remove(l));const i=n[em];i&&(i.delete(t),i.size||(n[em]=void 0))}function gw(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let TL=0;function yw(n,t,i,l){const c=n._endId=++TL,d=()=>{c===n._endId&&l()};if(i!=null)return setTimeout(d,i);const{type:_,timeout:v,propCount:r}=EL(n,t);if(!_)return l();const E=_+"end";let C=0;const z=()=>{n.removeEventListener(E,R),d()},R=j=>{j.target===n&&++C>=r&&z()};setTimeout(()=>{C<r&&z()},v+1),n.addEventListener(E,R)}function EL(n,t){const i=window.getComputedStyle(n),l=G=>(i[G]||"").split(", "),c=l(`${ih}Delay`),d=l(`${ih}Duration`),_=vw(c,d),v=l(`${gp}Delay`),r=l(`${gp}Duration`),E=vw(v,r);let C=null,z=0,R=0;t===ih?_>0&&(C=ih,z=_,R=d.length):t===gp?E>0&&(C=gp,z=E,R=r.length):(z=Math.max(_,E),C=z>0?_>E?ih:gp:null,R=C?C===ih?d.length:r.length:0);const j=C===ih&&/\b(?:transform|all)(?:,|$)/.test(l(`${ih}Property`).toString());return{type:C,timeout:z,propCount:R,hasTransform:j}}function vw(n,t){for(;n.length<t.length;)n=n.concat(n);return Math.max(...t.map((i,l)=>xw(i)+xw(n[l])))}function xw(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function bw(n){return(n?n.ownerDocument:document).body.offsetHeight}function SL(n,t,i){const l=n[em];l&&(t=(t?[t,...l]:[...l]).join(" ")),t==null?n.removeAttribute("class"):i?n.setAttribute("class",t):n.className=t}const ww=Symbol("_vod"),ML=Symbol("_vsh"),CL=Symbol(""),AL=/(?:^|;)\s*display\s*:/;function PL(n,t,i){const l=n.style,c=Vs(i);let d=!1;if(i&&!c){if(t)if(Vs(t))for(const _ of t.split(";")){const v=_.slice(0,_.indexOf(":")).trim();i[v]==null&&z_(l,v,"")}else for(const _ in t)i[_]==null&&z_(l,_,"");for(const _ in i)_==="display"&&(d=!0),z_(l,_,i[_])}else if(c){if(t!==i){const _=l[CL];_&&(i+=";"+_),l.cssText=i,d=AL.test(i)}}else t&&n.removeAttribute("style");ww in n&&(n[ww]=d?l.display:"",n[ML]&&(l.display="none"))}const Tw=/\s*!important$/;function z_(n,t,i){if(ki(i))i.forEach(l=>z_(n,t,l));else if(i==null&&(i=""),t.startsWith("--"))n.setProperty(t,i);else{const l=kL(n,t);Tw.test(i)?n.setProperty(Sd(l),i.replace(Tw,""),"important"):n[l]=i}}const Ew=["Webkit","Moz","ms"],av={};function kL(n,t){const i=av[t];if(i)return i;let l=yl(t);if(l!=="filter"&&l in n)return av[t]=l;l=bg(l);for(let c=0;c<Ew.length;c++){const d=Ew[c]+l;if(d in n)return av[t]=d}return t}const Sw="http://www.w3.org/1999/xlink";function Mw(n,t,i,l,c,d=Mk(t)){l&&t.startsWith("xlink:")?i==null?n.removeAttributeNS(Sw,t.slice(6,t.length)):n.setAttributeNS(Sw,t,i):i==null||d&&!RE(i)?n.removeAttribute(t):n.setAttribute(t,d?"":Uc(i)?String(i):i)}function Cw(n,t,i,l,c){if(t==="innerHTML"||t==="textContent"){i!=null&&(n[t]=t==="innerHTML"?NS(i):i);return}const d=n.tagName;if(t==="value"&&d!=="PROGRESS"&&!d.includes("-")){const v=d==="OPTION"?n.getAttribute("value")||"":n.value,r=i==null?n.type==="checkbox"?"on":"":String(i);(v!==r||!("_value"in n))&&(n.value=r),i==null&&n.removeAttribute(t),n._value=i;return}let _=!1;if(i===""||i==null){const v=typeof n[t];v==="boolean"?i=RE(i):i==null&&v==="string"?(i="",_=!0):v==="number"&&(i=0,_=!0)}try{n[t]=i}catch{}_&&n.removeAttribute(c||t)}function dd(n,t,i,l){n.addEventListener(t,i,l)}function IL(n,t,i,l){n.removeEventListener(t,i,l)}const Aw=Symbol("_vei");function LL(n,t,i,l,c=null){const d=n[Aw]||(n[Aw]={}),_=d[t];if(l&&_)_.value=l;else{const[v,r]=DL(t);if(l){const E=d[t]=RL(l,c);dd(n,v,E,r)}else _&&(IL(n,v,_,r),d[t]=void 0)}}const Pw=/(?:Once|Passive|Capture)$/;function DL(n){let t;if(Pw.test(n)){t={};let l;for(;l=n.match(Pw);)n=n.slice(0,n.length-l[0].length),t[l[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Sd(n.slice(2)),t]}let lv=0;const zL=Promise.resolve(),OL=()=>lv||(zL.then(()=>lv=0),lv=Date.now());function RL(n,t){const i=l=>{if(!l._vts)l._vts=Date.now();else if(l._vts<=i.attached)return;tc(BL(l,i.value),t,5,[l])};return i.value=n,i.attached=OL(),i}function BL(n,t){if(ki(t)){const i=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{i.call(n),n._stopped=!0},t.map(l=>c=>!c._stopped&&l&&l(c))}else return t}const kw=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,FL=(n,t,i,l,c,d)=>{const _=c==="svg";t==="class"?SL(n,l,_):t==="style"?PL(n,i,l):yg(t)?wx(t)||LL(n,t,i,l,d):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):NL(n,t,l,_))?(Cw(n,t,l),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Mw(n,t,l,_,d,t!=="value")):n._isVueCE&&(/[A-Z]/.test(t)||!Vs(l))?Cw(n,yl(t),l,d,t):(t==="true-value"?n._trueValue=l:t==="false-value"&&(n._falseValue=l),Mw(n,t,l,_))};function NL(n,t,i,l){if(l)return!!(t==="innerHTML"||t==="textContent"||t in n&&kw(t)&&qi(i));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const c=n.tagName;if(c==="IMG"||c==="VIDEO"||c==="CANVAS"||c==="SOURCE")return!1}return kw(t)&&Vs(i)?!1:t in n}const eg=n=>{const t=n.props["onUpdate:modelValue"]||!1;return ki(t)?i=>P_(t,i):t};function jL(n){n.target.composing=!0}function Iw(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const yf=Symbol("_assign"),zc={created(n,{modifiers:{lazy:t,trim:i,number:l}},c){n[yf]=eg(c);const d=l||c.props&&c.props.type==="number";dd(n,t?"change":"input",_=>{if(_.target.composing)return;let v=n.value;i&&(v=v.trim()),d&&(v=Z_(v)),n[yf](v)}),i&&dd(n,"change",()=>{n.value=n.value.trim()}),t||(dd(n,"compositionstart",jL),dd(n,"compositionend",Iw),dd(n,"change",Iw))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:i,modifiers:{lazy:l,trim:c,number:d}},_){if(n[yf]=eg(_),n.composing)return;const v=(d||n.type==="number")&&!/^0\d/.test(n.value)?Z_(n.value):n.value,r=t??"";v!==r&&(document.activeElement===n&&n.type!=="range"&&(l&&t===i||c&&n.value.trim()===r)||(n.value=r))}},jc={deep:!0,created(n,{value:t,modifiers:{number:i}},l){const c=vg(t);dd(n,"change",()=>{const d=Array.prototype.filter.call(n.options,_=>_.selected).map(_=>i?Z_(ig(_)):ig(_));n[yf](n.multiple?c?new Set(d):d:d[0]),n._assigning=!0,Kp(()=>{n._assigning=!1})}),n[yf]=eg(l)},mounted(n,{value:t}){Lw(n,t)},beforeUpdate(n,t,i){n[yf]=eg(i)},updated(n,{value:t}){n._assigning||Lw(n,t)}};function Lw(n,t){const i=n.multiple,l=ki(t);if(!(i&&!l&&!vg(t))){for(let c=0,d=n.options.length;c<d;c++){const _=n.options[c],v=ig(_);if(i)if(l){const r=typeof v;r==="string"||r==="number"?_.selected=t.some(E=>String(E)===String(v)):_.selected=Ak(t,v)>-1}else _.selected=t.has(v);else if(Tg(ig(_),t)){n.selectedIndex!==c&&(n.selectedIndex=c);return}}!i&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function ig(n){return"_value"in n?n._value:n.value}const VL=["ctrl","shift","alt","meta"],UL={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>VL.some(i=>n[`${i}Key`]&&!t.includes(i))},md=(n,t)=>{const i=n._withMods||(n._withMods={}),l=t.join(".");return i[l]||(i[l]=((c,...d)=>{for(let _=0;_<t.length;_++){const v=UL[t[_]];if(v&&v(c,t))return}return n(c,...d)}))},$L=Kr({patchProp:FL},gL);let Dw;function WL(){return Dw||(Dw=NI($L))}const ZL=((...n)=>{const t=WL().createApp(...n),{mount:i}=t;return t.mount=l=>{const c=HL(l);if(!c)return;const d=t._component;!qi(d)&&!d.render&&!d.template&&(d.template=c.innerHTML),c.nodeType===1&&(c.textContent="");const _=i(c,!1,GL(c));return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),_},t});function GL(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function HL(n){return Vs(n)?document.querySelector(n):n}function Rx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var O_={exports:{}},qL=O_.exports,zw;function XL(){return zw||(zw=1,(function(n,t){(function(i,l){n.exports=l()})(qL,function(){return(function(i){function l(d){if(c[d])return c[d].exports;var _=c[d]={exports:{},id:d,loaded:!1};return i[d].call(_.exports,_,_.exports,l),_.loaded=!0,_.exports}var c={};return l.m=i,l.c=c,l.p="dist/",l(0)})([function(i,l,c){function d(ye){return ye&&ye.__esModule?ye:{default:ye}}var _=Object.assign||function(ye){for(var He=1;He<arguments.length;He++){var de=arguments[He];for(var he in de)Object.prototype.hasOwnProperty.call(de,he)&&(ye[he]=de[he])}return ye},v=c(1),r=(d(v),c(6)),E=d(r),C=c(7),z=d(C),R=c(8),j=d(R),G=c(9),W=d(G),Q=c(10),rt=d(Q),ft=c(11),xt=d(ft),mt=c(14),bt=d(mt),Ot=[],zt=!1,Rt={offset:120,delay:0,easing:"ease",duration:400,disable:!1,once:!1,startEvent:"DOMContentLoaded",throttleDelay:99,debounceDelay:50,disableMutationObserver:!1},Bt=function(){var ye=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(ye&&(zt=!0),zt)return Ot=(0,xt.default)(Ot,Rt),(0,rt.default)(Ot,Rt.once),Ot},Nt=function(){Ot=(0,bt.default)(),Bt()},ee=function(){Ot.forEach(function(ye,He){ye.node.removeAttribute("data-aos"),ye.node.removeAttribute("data-aos-easing"),ye.node.removeAttribute("data-aos-duration"),ye.node.removeAttribute("data-aos-delay")})},Wt=function(ye){return ye===!0||ye==="mobile"&&W.default.mobile()||ye==="phone"&&W.default.phone()||ye==="tablet"&&W.default.tablet()||typeof ye=="function"&&ye()===!0},ae=function(ye){Rt=_(Rt,ye),Ot=(0,bt.default)();var He=document.all&&!window.atob;return Wt(Rt.disable)||He?ee():(Rt.disableMutationObserver||j.default.isSupported()||(console.info(`
      aos: MutationObserver is not supported on this browser,
      code mutations observing has been disabled.
      You may have to call "refreshHard()" by yourself.
    `),Rt.disableMutationObserver=!0),document.querySelector("body").setAttribute("data-aos-easing",Rt.easing),document.querySelector("body").setAttribute("data-aos-duration",Rt.duration),document.querySelector("body").setAttribute("data-aos-delay",Rt.delay),Rt.startEvent==="DOMContentLoaded"&&["complete","interactive"].indexOf(document.readyState)>-1?Bt(!0):Rt.startEvent==="load"?window.addEventListener(Rt.startEvent,function(){Bt(!0)}):document.addEventListener(Rt.startEvent,function(){Bt(!0)}),window.addEventListener("resize",(0,z.default)(Bt,Rt.debounceDelay,!0)),window.addEventListener("orientationchange",(0,z.default)(Bt,Rt.debounceDelay,!0)),window.addEventListener("scroll",(0,E.default)(function(){(0,rt.default)(Ot,Rt.once)},Rt.throttleDelay)),Rt.disableMutationObserver||j.default.ready("[data-aos]",Nt),Ot)};i.exports={init:ae,refresh:Bt,refreshHard:Nt}},function(i,l){},,,,,function(i,l){(function(c){function d(Wt,ae,ye){function He(Jt){var Se=je,me=Xe;return je=Xe=void 0,_n=Jt,vi=Wt.apply(me,Se)}function de(Jt){return _n=Jt,Ii=setTimeout(Oe,ae),ls?He(Jt):vi}function he(Jt){var Se=Jt-Qe,me=Jt-_n,we=ae-Se;return Tt?Nt(we,ri-me):we}function oe(Jt){var Se=Jt-Qe,me=Jt-_n;return Qe===void 0||Se>=ae||Se<0||Tt&&me>=ri}function Oe(){var Jt=ee();return oe(Jt)?Ue(Jt):void(Ii=setTimeout(Oe,he(Jt)))}function Ue(Jt){return Ii=void 0,Ft&&je?He(Jt):(je=Xe=void 0,vi)}function $t(){Ii!==void 0&&clearTimeout(Ii),_n=0,je=Qe=Xe=Ii=void 0}function ce(){return Ii===void 0?vi:Ue(ee())}function Ve(){var Jt=ee(),Se=oe(Jt);if(je=arguments,Xe=this,Qe=Jt,Se){if(Ii===void 0)return de(Qe);if(Tt)return Ii=setTimeout(Oe,ae),He(Qe)}return Ii===void 0&&(Ii=setTimeout(Oe,ae)),vi}var je,Xe,ri,vi,Ii,Qe,_n=0,ls=!1,Tt=!1,Ft=!0;if(typeof Wt!="function")throw new TypeError(R);return ae=C(ae)||0,v(ye)&&(ls=!!ye.leading,Tt="maxWait"in ye,ri=Tt?Bt(C(ye.maxWait)||0,ae):ri,Ft="trailing"in ye?!!ye.trailing:Ft),Ve.cancel=$t,Ve.flush=ce,Ve}function _(Wt,ae,ye){var He=!0,de=!0;if(typeof Wt!="function")throw new TypeError(R);return v(ye)&&(He="leading"in ye?!!ye.leading:He,de="trailing"in ye?!!ye.trailing:de),d(Wt,ae,{leading:He,maxWait:ae,trailing:de})}function v(Wt){var ae=typeof Wt>"u"?"undefined":z(Wt);return!!Wt&&(ae=="object"||ae=="function")}function r(Wt){return!!Wt&&(typeof Wt>"u"?"undefined":z(Wt))=="object"}function E(Wt){return(typeof Wt>"u"?"undefined":z(Wt))=="symbol"||r(Wt)&&Rt.call(Wt)==G}function C(Wt){if(typeof Wt=="number")return Wt;if(E(Wt))return j;if(v(Wt)){var ae=typeof Wt.valueOf=="function"?Wt.valueOf():Wt;Wt=v(ae)?ae+"":ae}if(typeof Wt!="string")return Wt===0?Wt:+Wt;Wt=Wt.replace(W,"");var ye=rt.test(Wt);return ye||ft.test(Wt)?xt(Wt.slice(2),ye?2:8):Q.test(Wt)?j:+Wt}var z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Wt){return typeof Wt}:function(Wt){return Wt&&typeof Symbol=="function"&&Wt.constructor===Symbol&&Wt!==Symbol.prototype?"symbol":typeof Wt},R="Expected a function",j=NaN,G="[object Symbol]",W=/^\s+|\s+$/g,Q=/^[-+]0x[0-9a-f]+$/i,rt=/^0b[01]+$/i,ft=/^0o[0-7]+$/i,xt=parseInt,mt=(typeof c>"u"?"undefined":z(c))=="object"&&c&&c.Object===Object&&c,bt=(typeof self>"u"?"undefined":z(self))=="object"&&self&&self.Object===Object&&self,Ot=mt||bt||Function("return this")(),zt=Object.prototype,Rt=zt.toString,Bt=Math.max,Nt=Math.min,ee=function(){return Ot.Date.now()};i.exports=_}).call(l,(function(){return this})())},function(i,l){(function(c){function d(ee,Wt,ae){function ye(Ft){var Jt=Ve,Se=je;return Ve=je=void 0,Qe=Ft,ri=ee.apply(Se,Jt)}function He(Ft){return Qe=Ft,vi=setTimeout(oe,Wt),_n?ye(Ft):ri}function de(Ft){var Jt=Ft-Ii,Se=Ft-Qe,me=Wt-Jt;return ls?Bt(me,Xe-Se):me}function he(Ft){var Jt=Ft-Ii,Se=Ft-Qe;return Ii===void 0||Jt>=Wt||Jt<0||ls&&Se>=Xe}function oe(){var Ft=Nt();return he(Ft)?Oe(Ft):void(vi=setTimeout(oe,de(Ft)))}function Oe(Ft){return vi=void 0,Tt&&Ve?ye(Ft):(Ve=je=void 0,ri)}function Ue(){vi!==void 0&&clearTimeout(vi),Qe=0,Ve=Ii=je=vi=void 0}function $t(){return vi===void 0?ri:Oe(Nt())}function ce(){var Ft=Nt(),Jt=he(Ft);if(Ve=arguments,je=this,Ii=Ft,Jt){if(vi===void 0)return He(Ii);if(ls)return vi=setTimeout(oe,Wt),ye(Ii)}return vi===void 0&&(vi=setTimeout(oe,Wt)),ri}var Ve,je,Xe,ri,vi,Ii,Qe=0,_n=!1,ls=!1,Tt=!0;if(typeof ee!="function")throw new TypeError(z);return Wt=E(Wt)||0,_(ae)&&(_n=!!ae.leading,ls="maxWait"in ae,Xe=ls?Rt(E(ae.maxWait)||0,Wt):Xe,Tt="trailing"in ae?!!ae.trailing:Tt),ce.cancel=Ue,ce.flush=$t,ce}function _(ee){var Wt=typeof ee>"u"?"undefined":C(ee);return!!ee&&(Wt=="object"||Wt=="function")}function v(ee){return!!ee&&(typeof ee>"u"?"undefined":C(ee))=="object"}function r(ee){return(typeof ee>"u"?"undefined":C(ee))=="symbol"||v(ee)&&zt.call(ee)==j}function E(ee){if(typeof ee=="number")return ee;if(r(ee))return R;if(_(ee)){var Wt=typeof ee.valueOf=="function"?ee.valueOf():ee;ee=_(Wt)?Wt+"":Wt}if(typeof ee!="string")return ee===0?ee:+ee;ee=ee.replace(G,"");var ae=Q.test(ee);return ae||rt.test(ee)?ft(ee.slice(2),ae?2:8):W.test(ee)?R:+ee}var C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee},z="Expected a function",R=NaN,j="[object Symbol]",G=/^\s+|\s+$/g,W=/^[-+]0x[0-9a-f]+$/i,Q=/^0b[01]+$/i,rt=/^0o[0-7]+$/i,ft=parseInt,xt=(typeof c>"u"?"undefined":C(c))=="object"&&c&&c.Object===Object&&c,mt=(typeof self>"u"?"undefined":C(self))=="object"&&self&&self.Object===Object&&self,bt=xt||mt||Function("return this")(),Ot=Object.prototype,zt=Ot.toString,Rt=Math.max,Bt=Math.min,Nt=function(){return bt.Date.now()};i.exports=d}).call(l,(function(){return this})())},function(i,l){function c(C){var z=void 0,R=void 0;for(z=0;z<C.length;z+=1)if(R=C[z],R.dataset&&R.dataset.aos||R.children&&c(R.children))return!0;return!1}function d(){return window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver}function _(){return!!d()}function v(C,z){var R=window.document,j=d(),G=new j(r);E=z,G.observe(R.documentElement,{childList:!0,subtree:!0,removedNodes:!0})}function r(C){C&&C.forEach(function(z){var R=Array.prototype.slice.call(z.addedNodes),j=Array.prototype.slice.call(z.removedNodes),G=R.concat(j);if(c(G))return E()})}Object.defineProperty(l,"__esModule",{value:!0});var E=function(){};l.default={isSupported:_,ready:v}},function(i,l){function c(R,j){if(!(R instanceof j))throw new TypeError("Cannot call a class as a function")}function d(){return navigator.userAgent||navigator.vendor||window.opera||""}Object.defineProperty(l,"__esModule",{value:!0});var _=(function(){function R(j,G){for(var W=0;W<G.length;W++){var Q=G[W];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(j,Q.key,Q)}}return function(j,G,W){return G&&R(j.prototype,G),W&&R(j,W),j}})(),v=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i,r=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,E=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,C=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,z=(function(){function R(){c(this,R)}return _(R,[{key:"phone",value:function(){var j=d();return!(!v.test(j)&&!r.test(j.substr(0,4)))}},{key:"mobile",value:function(){var j=d();return!(!E.test(j)&&!C.test(j.substr(0,4)))}},{key:"tablet",value:function(){return this.mobile()&&!this.phone()}}]),R})();l.default=new z},function(i,l){Object.defineProperty(l,"__esModule",{value:!0});var c=function(_,v,r){var E=_.node.getAttribute("data-aos-once");v>_.position?_.node.classList.add("aos-animate"):typeof E<"u"&&(E==="false"||!r&&E!=="true")&&_.node.classList.remove("aos-animate")},d=function(_,v){var r=window.pageYOffset,E=window.innerHeight;_.forEach(function(C,z){c(C,E+r,v)})};l.default=d},function(i,l,c){function d(E){return E&&E.__esModule?E:{default:E}}Object.defineProperty(l,"__esModule",{value:!0});var _=c(12),v=d(_),r=function(E,C){return E.forEach(function(z,R){z.node.classList.add("aos-init"),z.position=(0,v.default)(z.node,C.offset)}),E};l.default=r},function(i,l,c){function d(E){return E&&E.__esModule?E:{default:E}}Object.defineProperty(l,"__esModule",{value:!0});var _=c(13),v=d(_),r=function(E,C){var z=0,R=0,j=window.innerHeight,G={offset:E.getAttribute("data-aos-offset"),anchor:E.getAttribute("data-aos-anchor"),anchorPlacement:E.getAttribute("data-aos-anchor-placement")};switch(G.offset&&!isNaN(G.offset)&&(R=parseInt(G.offset)),G.anchor&&document.querySelectorAll(G.anchor)&&(E=document.querySelectorAll(G.anchor)[0]),z=(0,v.default)(E).top,G.anchorPlacement){case"top-bottom":break;case"center-bottom":z+=E.offsetHeight/2;break;case"bottom-bottom":z+=E.offsetHeight;break;case"top-center":z+=j/2;break;case"bottom-center":z+=j/2+E.offsetHeight;break;case"center-center":z+=j/2+E.offsetHeight/2;break;case"top-top":z+=j;break;case"bottom-top":z+=E.offsetHeight+j;break;case"center-top":z+=E.offsetHeight/2+j}return G.anchorPlacement||G.offset||isNaN(C)||(R=C),z+R};l.default=r},function(i,l){Object.defineProperty(l,"__esModule",{value:!0});var c=function(d){for(var _=0,v=0;d&&!isNaN(d.offsetLeft)&&!isNaN(d.offsetTop);)_+=d.offsetLeft-(d.tagName!="BODY"?d.scrollLeft:0),v+=d.offsetTop-(d.tagName!="BODY"?d.scrollTop:0),d=d.offsetParent;return{top:v,left:_}};l.default=c},function(i,l){Object.defineProperty(l,"__esModule",{value:!0});var c=function(d){return d=d||document.querySelectorAll("[data-aos]"),Array.prototype.map.call(d,function(_){return{node:_}})};l.default=c}])})})(O_)),O_.exports}var KL=XL();const d_=Rx(KL);function Tu(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function VS(n,t){n.prototype=Object.create(t.prototype),n.prototype.constructor=n,n.__proto__=t}/*!
 * GSAP 3.13.0
 * https://gsap.com
 *
 * @license Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Ba={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Tf={duration:.5,overwrite:!1,delay:0},Bx,Xr,_s,pl=1e8,Qn=1/pl,qv=Math.PI*2,YL=qv/4,JL=0,US=Math.sqrt,QL=Math.cos,tD=Math.sin,Nr=function(t){return typeof t=="string"},Ns=function(t){return typeof t=="function"},Ou=function(t){return typeof t=="number"},Fx=function(t){return typeof t>"u"},Wc=function(t){return typeof t=="object"},ua=function(t){return t!==!1},Nx=function(){return typeof window<"u"},f_=function(t){return Ns(t)||Nr(t)},$S=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},wo=Array.isArray,Xv=/(?:-?\.?\d|\.)+/gi,WS=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,uf=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,cv=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,ZS=/[+-]=-?[.\d]+/,GS=/[^,'"\[\]\s]+/gi,eD=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Ps,Oc,Kv,jx,Fa={},ng={},HS,qS=function(t){return(ng=Ef(t,Fa))&&pa},Vx=function(t,i){return console.warn("Invalid property",t,"set to",i,"Missing plugin? gsap.registerPlugin()")},im=function(t,i){return!i&&console.warn(t)},XS=function(t,i){return t&&(Fa[t]=i)&&ng&&(ng[t]=i)||Fa},nm=function(){return 0},iD={suppressEvents:!0,isStart:!0,kill:!1},R_={suppressEvents:!0,kill:!1},nD={suppressEvents:!0},Ux={},mh=[],Yv={},KS,La={},uv={},Ow=30,B_=[],$x="",Wx=function(t){var i=t[0],l,c;if(Wc(i)||Ns(i)||(t=[t]),!(l=(i._gsap||{}).harness)){for(c=B_.length;c--&&!B_[c].targetTest(i););l=B_[c]}for(c=t.length;c--;)t[c]&&(t[c]._gsap||(t[c]._gsap=new xM(t[c],l)))||t.splice(c,1);return t},_d=function(t){return t._gsap||Wx(ml(t))[0]._gsap},YS=function(t,i,l){return(l=t[i])&&Ns(l)?t[i]():Fx(l)&&t.getAttribute&&t.getAttribute(i)||l},ha=function(t,i){return(t=t.split(",")).forEach(i)||t},Xs=function(t){return Math.round(t*1e5)/1e5||0},lr=function(t){return Math.round(t*1e7)/1e7||0},vf=function(t,i){var l=i.charAt(0),c=parseFloat(i.substr(2));return t=parseFloat(t),l==="+"?t+c:l==="-"?t-c:l==="*"?t*c:t/c},sD=function(t,i){for(var l=i.length,c=0;t.indexOf(i[c])<0&&++c<l;);return c<l},sg=function(){var t=mh.length,i=mh.slice(0),l,c;for(Yv={},mh.length=0,l=0;l<t;l++)c=i[l],c&&c._lazy&&(c.render(c._lazy[0],c._lazy[1],!0)._lazy=0)},Zx=function(t){return!!(t._initted||t._startAt||t.add)},JS=function(t,i,l,c){mh.length&&!Xr&&sg(),t.render(i,l,!!(Xr&&i<0&&Zx(t))),mh.length&&!Xr&&sg()},QS=function(t){var i=parseFloat(t);return(i||i===0)&&(t+"").match(GS).length<2?i:Nr(t)?t.trim():t},tM=function(t){return t},Na=function(t,i){for(var l in i)l in t||(t[l]=i[l]);return t},rD=function(t){return function(i,l){for(var c in l)c in i||c==="duration"&&t||c==="ease"||(i[c]=l[c])}},Ef=function(t,i){for(var l in i)t[l]=i[l];return t},Rw=function n(t,i){for(var l in i)l!=="__proto__"&&l!=="constructor"&&l!=="prototype"&&(t[l]=Wc(i[l])?n(t[l]||(t[l]={}),i[l]):i[l]);return t},rg=function(t,i){var l={},c;for(c in t)c in i||(l[c]=t[c]);return l},Vp=function(t){var i=t.parent||Ps,l=t.keyframes?rD(wo(t.keyframes)):Na;if(ua(t.inherit))for(;i;)l(t,i.vars.defaults),i=i.parent||i._dp;return t},oD=function(t,i){for(var l=t.length,c=l===i.length;c&&l--&&t[l]===i[l];);return l<0},eM=function(t,i,l,c,d){var _=t[c],v;if(d)for(v=i[d];_&&_[d]>v;)_=_._prev;return _?(i._next=_._next,_._next=i):(i._next=t[l],t[l]=i),i._next?i._next._prev=i:t[c]=i,i._prev=_,i.parent=i._dp=t,i},Ig=function(t,i,l,c){l===void 0&&(l="_first"),c===void 0&&(c="_last");var d=i._prev,_=i._next;d?d._next=_:t[l]===i&&(t[l]=_),_?_._prev=d:t[c]===i&&(t[c]=d),i._next=i._prev=i.parent=null},xh=function(t,i){t.parent&&(!i||t.parent.autoRemoveChildren)&&t.parent.remove&&t.parent.remove(t),t._act=0},gd=function(t,i){if(t&&(!i||i._end>t._dur||i._start<0))for(var l=t;l;)l._dirty=1,l=l.parent;return t},aD=function(t){for(var i=t.parent;i&&i.parent;)i._dirty=1,i.totalDuration(),i=i.parent;return t},Jv=function(t,i,l,c){return t._startAt&&(Xr?t._startAt.revert(R_):t.vars.immediateRender&&!t.vars.autoRevert||t._startAt.render(i,!0,c))},lD=function n(t){return!t||t._ts&&n(t.parent)},Bw=function(t){return t._repeat?Sf(t._tTime,t=t.duration()+t._rDelay)*t:0},Sf=function(t,i){var l=Math.floor(t=lr(t/i));return t&&l===t?l-1:l},og=function(t,i){return(t-i._start)*i._ts+(i._ts>=0?0:i._dirty?i.totalDuration():i._tDur)},Lg=function(t){return t._end=lr(t._start+(t._tDur/Math.abs(t._ts||t._rts||Qn)||0))},Dg=function(t,i){var l=t._dp;return l&&l.smoothChildTiming&&t._ts&&(t._start=lr(l._time-(t._ts>0?i/t._ts:((t._dirty?t.totalDuration():t._tDur)-i)/-t._ts)),Lg(t),l._dirty||gd(l,t)),t},iM=function(t,i){var l;if((i._time||!i._dur&&i._initted||i._start<t._time&&(i._dur||!i.add))&&(l=og(t.rawTime(),i),(!i._dur||xm(0,i.totalDuration(),l)-i._tTime>Qn)&&i.render(l,!0)),gd(t,i)._dp&&t._initted&&t._time>=t._dur&&t._ts){if(t._dur<t.duration())for(l=t;l._dp;)l.rawTime()>=0&&l.totalTime(l._tTime),l=l._dp;t._zTime=-Qn}},Bc=function(t,i,l,c){return i.parent&&xh(i),i._start=lr((Ou(l)?l:l||t!==Ps?dl(t,l,i):t._time)+i._delay),i._end=lr(i._start+(i.totalDuration()/Math.abs(i.timeScale())||0)),eM(t,i,"_first","_last",t._sort?"_start":0),Qv(i)||(t._recent=i),c||iM(t,i),t._ts<0&&Dg(t,t._tTime),t},nM=function(t,i){return(Fa.ScrollTrigger||Vx("scrollTrigger",i))&&Fa.ScrollTrigger.create(i,t)},sM=function(t,i,l,c,d){if(Hx(t,i,d),!t._initted)return 1;if(!l&&t._pt&&!Xr&&(t._dur&&t.vars.lazy!==!1||!t._dur&&t.vars.lazy)&&KS!==Da.frame)return mh.push(t),t._lazy=[d,c],1},cD=function n(t){var i=t.parent;return i&&i._ts&&i._initted&&!i._lock&&(i.rawTime()<0||n(i))},Qv=function(t){var i=t.data;return i==="isFromStart"||i==="isStart"},uD=function(t,i,l,c){var d=t.ratio,_=i<0||!i&&(!t._start&&cD(t)&&!(!t._initted&&Qv(t))||(t._ts<0||t._dp._ts<0)&&!Qv(t))?0:1,v=t._rDelay,r=0,E,C,z;if(v&&t._repeat&&(r=xm(0,t._tDur,i),C=Sf(r,v),t._yoyo&&C&1&&(_=1-_),C!==Sf(t._tTime,v)&&(d=1-_,t.vars.repeatRefresh&&t._initted&&t.invalidate())),_!==d||Xr||c||t._zTime===Qn||!i&&t._zTime){if(!t._initted&&sM(t,i,c,l,r))return;for(z=t._zTime,t._zTime=i||(l?Qn:0),l||(l=i&&!z),t.ratio=_,t._from&&(_=1-_),t._time=0,t._tTime=r,E=t._pt;E;)E.r(_,E.d),E=E._next;i<0&&Jv(t,i,l,!0),t._onUpdate&&!l&&Ra(t,"onUpdate"),r&&t._repeat&&!l&&t.parent&&Ra(t,"onRepeat"),(i>=t._tDur||i<0)&&t.ratio===_&&(_&&xh(t,1),!l&&!Xr&&(Ra(t,_?"onComplete":"onReverseComplete",!0),t._prom&&t._prom()))}else t._zTime||(t._zTime=i)},hD=function(t,i,l){var c;if(l>i)for(c=t._first;c&&c._start<=l;){if(c.data==="isPause"&&c._start>i)return c;c=c._next}else for(c=t._last;c&&c._start>=l;){if(c.data==="isPause"&&c._start<i)return c;c=c._prev}},Mf=function(t,i,l,c){var d=t._repeat,_=lr(i)||0,v=t._tTime/t._tDur;return v&&!c&&(t._time*=_/t._dur),t._dur=_,t._tDur=d?d<0?1e10:lr(_*(d+1)+t._rDelay*d):_,v>0&&!c&&Dg(t,t._tTime=t._tDur*v),t.parent&&Lg(t),l||gd(t.parent,t),t},Fw=function(t){return t instanceof jo?gd(t):Mf(t,t._dur)},dD={_start:0,endTime:nm,totalDuration:nm},dl=function n(t,i,l){var c=t.labels,d=t._recent||dD,_=t.duration()>=pl?d.endTime(!1):t._dur,v,r,E;return Nr(i)&&(isNaN(i)||i in c)?(r=i.charAt(0),E=i.substr(-1)==="%",v=i.indexOf("="),r==="<"||r===">"?(v>=0&&(i=i.replace(/=/,"")),(r==="<"?d._start:d.endTime(d._repeat>=0))+(parseFloat(i.substr(1))||0)*(E?(v<0?d:l).totalDuration()/100:1)):v<0?(i in c||(c[i]=_),c[i]):(r=parseFloat(i.charAt(v-1)+i.substr(v+1)),E&&l&&(r=r/100*(wo(l)?l[0]:l).totalDuration()),v>1?n(t,i.substr(0,v-1),l)+r:_+r)):i==null?_:+i},Up=function(t,i,l){var c=Ou(i[1]),d=(c?2:1)+(t<2?0:1),_=i[d],v,r;if(c&&(_.duration=i[1]),_.parent=l,t){for(v=_,r=l;r&&!("immediateRender"in v);)v=r.vars.defaults||{},r=ua(r.vars.inherit)&&r.parent;_.immediateRender=ua(v.immediateRender),t<2?_.runBackwards=1:_.startAt=i[d-1]}return new or(i[0],_,i[d+1])},Eh=function(t,i){return t||t===0?i(t):i},xm=function(t,i,l){return l<t?t:l>i?i:l},yo=function(t,i){return!Nr(t)||!(i=eD.exec(t))?"":i[1]},fD=function(t,i,l){return Eh(l,function(c){return xm(t,i,c)})},tx=[].slice,rM=function(t,i){return t&&Wc(t)&&"length"in t&&(!i&&!t.length||t.length-1 in t&&Wc(t[0]))&&!t.nodeType&&t!==Oc},pD=function(t,i,l){return l===void 0&&(l=[]),t.forEach(function(c){var d;return Nr(c)&&!i||rM(c,1)?(d=l).push.apply(d,ml(c)):l.push(c)})||l},ml=function(t,i,l){return _s&&!i&&_s.selector?_s.selector(t):Nr(t)&&!l&&(Kv||!Cf())?tx.call((i||jx).querySelectorAll(t),0):wo(t)?pD(t,l):rM(t)?tx.call(t,0):t?[t]:[]},ex=function(t){return t=ml(t)[0]||im("Invalid scope")||{},function(i){var l=t.current||t.nativeElement||t;return ml(i,l.querySelectorAll?l:l===t?im("Invalid scope")||jx.createElement("div"):t)}},oM=function(t){return t.sort(function(){return .5-Math.random()})},aM=function(t){if(Ns(t))return t;var i=Wc(t)?t:{each:t},l=yd(i.ease),c=i.from||0,d=parseFloat(i.base)||0,_={},v=c>0&&c<1,r=isNaN(c)||v,E=i.axis,C=c,z=c;return Nr(c)?C=z={center:.5,edges:.5,end:1}[c]||0:!v&&r&&(C=c[0],z=c[1]),function(R,j,G){var W=(G||i).length,Q=_[W],rt,ft,xt,mt,bt,Ot,zt,Rt,Bt;if(!Q){if(Bt=i.grid==="auto"?0:(i.grid||[1,pl])[1],!Bt){for(zt=-pl;zt<(zt=G[Bt++].getBoundingClientRect().left)&&Bt<W;);Bt<W&&Bt--}for(Q=_[W]=[],rt=r?Math.min(Bt,W)*C-.5:c%Bt,ft=Bt===pl?0:r?W*z/Bt-.5:c/Bt|0,zt=0,Rt=pl,Ot=0;Ot<W;Ot++)xt=Ot%Bt-rt,mt=ft-(Ot/Bt|0),Q[Ot]=bt=E?Math.abs(E==="y"?mt:xt):US(xt*xt+mt*mt),bt>zt&&(zt=bt),bt<Rt&&(Rt=bt);c==="random"&&oM(Q),Q.max=zt-Rt,Q.min=Rt,Q.v=W=(parseFloat(i.amount)||parseFloat(i.each)*(Bt>W?W-1:E?E==="y"?W/Bt:Bt:Math.max(Bt,W/Bt))||0)*(c==="edges"?-1:1),Q.b=W<0?d-W:d,Q.u=yo(i.amount||i.each)||0,l=l&&W<0?gM(l):l}return W=(Q[R]-Q.min)/Q.max||0,lr(Q.b+(l?l(W):W)*Q.v)+Q.u}},ix=function(t){var i=Math.pow(10,((t+"").split(".")[1]||"").length);return function(l){var c=lr(Math.round(parseFloat(l)/t)*t*i);return(c-c%1)/i+(Ou(l)?0:yo(l))}},lM=function(t,i){var l=wo(t),c,d;return!l&&Wc(t)&&(c=l=t.radius||pl,t.values?(t=ml(t.values),(d=!Ou(t[0]))&&(c*=c)):t=ix(t.increment)),Eh(i,l?Ns(t)?function(_){return d=t(_),Math.abs(d-_)<=c?d:_}:function(_){for(var v=parseFloat(d?_.x:_),r=parseFloat(d?_.y:0),E=pl,C=0,z=t.length,R,j;z--;)d?(R=t[z].x-v,j=t[z].y-r,R=R*R+j*j):R=Math.abs(t[z]-v),R<E&&(E=R,C=z);return C=!c||E<=c?t[C]:_,d||C===_||Ou(_)?C:C+yo(_)}:ix(t))},cM=function(t,i,l,c){return Eh(wo(t)?!i:l===!0?!!(l=0):!c,function(){return wo(t)?t[~~(Math.random()*t.length)]:(l=l||1e-5)&&(c=l<1?Math.pow(10,(l+"").length-2):1)&&Math.floor(Math.round((t-l/2+Math.random()*(i-t+l*.99))/l)*l*c)/c})},mD=function(){for(var t=arguments.length,i=new Array(t),l=0;l<t;l++)i[l]=arguments[l];return function(c){return i.reduce(function(d,_){return _(d)},c)}},_D=function(t,i){return function(l){return t(parseFloat(l))+(i||yo(l))}},gD=function(t,i,l){return hM(t,i,0,1,l)},uM=function(t,i,l){return Eh(l,function(c){return t[~~i(c)]})},yD=function n(t,i,l){var c=i-t;return wo(t)?uM(t,n(0,t.length),i):Eh(l,function(d){return(c+(d-t)%c)%c+t})},vD=function n(t,i,l){var c=i-t,d=c*2;return wo(t)?uM(t,n(0,t.length-1),i):Eh(l,function(_){return _=(d+(_-t)%d)%d||0,t+(_>c?d-_:_)})},sm=function(t){for(var i=0,l="",c,d,_,v;~(c=t.indexOf("random(",i));)_=t.indexOf(")",c),v=t.charAt(c+7)==="[",d=t.substr(c+7,_-c-7).match(v?GS:Xv),l+=t.substr(i,c-i)+cM(v?d:+d[0],v?0:+d[1],+d[2]||1e-5),i=_+1;return l+t.substr(i,t.length-i)},hM=function(t,i,l,c,d){var _=i-t,v=c-l;return Eh(d,function(r){return l+((r-t)/_*v||0)})},xD=function n(t,i,l,c){var d=isNaN(t+i)?0:function(j){return(1-j)*t+j*i};if(!d){var _=Nr(t),v={},r,E,C,z,R;if(l===!0&&(c=1)&&(l=null),_)t={p:t},i={p:i};else if(wo(t)&&!wo(i)){for(C=[],z=t.length,R=z-2,E=1;E<z;E++)C.push(n(t[E-1],t[E]));z--,d=function(G){G*=z;var W=Math.min(R,~~G);return C[W](G-W)},l=i}else c||(t=Ef(wo(t)?[]:{},t));if(!C){for(r in i)Gx.call(v,t,r,"get",i[r]);d=function(G){return Kx(G,v)||(_?t.p:t)}}}return Eh(l,d)},Nw=function(t,i,l){var c=t.labels,d=pl,_,v,r;for(_ in c)v=c[_]-i,v<0==!!l&&v&&d>(v=Math.abs(v))&&(r=_,d=v);return r},Ra=function(t,i,l){var c=t.vars,d=c[i],_=_s,v=t._ctx,r,E,C;if(d)return r=c[i+"Params"],E=c.callbackScope||t,l&&mh.length&&sg(),v&&(_s=v),C=r?d.apply(E,r):d.call(E),_s=_,C},Cp=function(t){return xh(t),t.scrollTrigger&&t.scrollTrigger.kill(!!Xr),t.progress()<1&&Ra(t,"onInterrupt"),t},hf,dM=[],fM=function(t){if(t)if(t=!t.name&&t.default||t,Nx()||t.headless){var i=t.name,l=Ns(t),c=i&&!l&&t.init?function(){this._props=[]}:t,d={init:nm,render:Kx,add:Gx,kill:RD,modifier:OD,rawVars:0},_={targetTest:0,get:0,getSetter:Xx,aliases:{},register:0};if(Cf(),t!==c){if(La[i])return;Na(c,Na(rg(t,d),_)),Ef(c.prototype,Ef(d,rg(t,_))),La[c.prop=i]=c,t.targetTest&&(B_.push(c),Ux[i]=1),i=(i==="css"?"CSS":i.charAt(0).toUpperCase()+i.substr(1))+"Plugin"}XS(i,c),t.register&&t.register(pa,c,da)}else dM.push(t)},Jn=255,Ap={aqua:[0,Jn,Jn],lime:[0,Jn,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Jn],navy:[0,0,128],white:[Jn,Jn,Jn],olive:[128,128,0],yellow:[Jn,Jn,0],orange:[Jn,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Jn,0,0],pink:[Jn,192,203],cyan:[0,Jn,Jn],transparent:[Jn,Jn,Jn,0]},hv=function(t,i,l){return t+=t<0?1:t>1?-1:0,(t*6<1?i+(l-i)*t*6:t<.5?l:t*3<2?i+(l-i)*(2/3-t)*6:i)*Jn+.5|0},pM=function(t,i,l){var c=t?Ou(t)?[t>>16,t>>8&Jn,t&Jn]:0:Ap.black,d,_,v,r,E,C,z,R,j,G;if(!c){if(t.substr(-1)===","&&(t=t.substr(0,t.length-1)),Ap[t])c=Ap[t];else if(t.charAt(0)==="#"){if(t.length<6&&(d=t.charAt(1),_=t.charAt(2),v=t.charAt(3),t="#"+d+d+_+_+v+v+(t.length===5?t.charAt(4)+t.charAt(4):"")),t.length===9)return c=parseInt(t.substr(1,6),16),[c>>16,c>>8&Jn,c&Jn,parseInt(t.substr(7),16)/255];t=parseInt(t.substr(1),16),c=[t>>16,t>>8&Jn,t&Jn]}else if(t.substr(0,3)==="hsl"){if(c=G=t.match(Xv),!i)r=+c[0]%360/360,E=+c[1]/100,C=+c[2]/100,_=C<=.5?C*(E+1):C+E-C*E,d=C*2-_,c.length>3&&(c[3]*=1),c[0]=hv(r+1/3,d,_),c[1]=hv(r,d,_),c[2]=hv(r-1/3,d,_);else if(~t.indexOf("="))return c=t.match(WS),l&&c.length<4&&(c[3]=1),c}else c=t.match(Xv)||Ap.transparent;c=c.map(Number)}return i&&!G&&(d=c[0]/Jn,_=c[1]/Jn,v=c[2]/Jn,z=Math.max(d,_,v),R=Math.min(d,_,v),C=(z+R)/2,z===R?r=E=0:(j=z-R,E=C>.5?j/(2-z-R):j/(z+R),r=z===d?(_-v)/j+(_<v?6:0):z===_?(v-d)/j+2:(d-_)/j+4,r*=60),c[0]=~~(r+.5),c[1]=~~(E*100+.5),c[2]=~~(C*100+.5)),l&&c.length<4&&(c[3]=1),c},mM=function(t){var i=[],l=[],c=-1;return t.split(_h).forEach(function(d){var _=d.match(uf)||[];i.push.apply(i,_),l.push(c+=_.length+1)}),i.c=l,i},jw=function(t,i,l){var c="",d=(t+c).match(_h),_=i?"hsla(":"rgba(",v=0,r,E,C,z;if(!d)return t;if(d=d.map(function(R){return(R=pM(R,i,1))&&_+(i?R[0]+","+R[1]+"%,"+R[2]+"%,"+R[3]:R.join(","))+")"}),l&&(C=mM(t),r=l.c,r.join(c)!==C.c.join(c)))for(E=t.replace(_h,"1").split(uf),z=E.length-1;v<z;v++)c+=E[v]+(~r.indexOf(v)?d.shift()||_+"0,0,0,0)":(C.length?C:d.length?d:l).shift());if(!E)for(E=t.split(_h),z=E.length-1;v<z;v++)c+=E[v]+d[v];return c+E[z]},_h=(function(){var n="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",t;for(t in Ap)n+="|"+t+"\\b";return new RegExp(n+")","gi")})(),bD=/hsl[a]?\(/,_M=function(t){var i=t.join(" "),l;if(_h.lastIndex=0,_h.test(i))return l=bD.test(i),t[1]=jw(t[1],l),t[0]=jw(t[0],l,mM(t[1])),!0},rm,Da=(function(){var n=Date.now,t=500,i=33,l=n(),c=l,d=1e3/240,_=d,v=[],r,E,C,z,R,j,G=function W(Q){var rt=n()-c,ft=Q===!0,xt,mt,bt,Ot;if((rt>t||rt<0)&&(l+=rt-i),c+=rt,bt=c-l,xt=bt-_,(xt>0||ft)&&(Ot=++z.frame,R=bt-z.time*1e3,z.time=bt=bt/1e3,_+=xt+(xt>=d?4:d-xt),mt=1),ft||(r=E(W)),mt)for(j=0;j<v.length;j++)v[j](bt,R,Ot,Q)};return z={time:0,frame:0,tick:function(){G(!0)},deltaRatio:function(Q){return R/(1e3/(Q||60))},wake:function(){HS&&(!Kv&&Nx()&&(Oc=Kv=window,jx=Oc.document||{},Fa.gsap=pa,(Oc.gsapVersions||(Oc.gsapVersions=[])).push(pa.version),qS(ng||Oc.GreenSockGlobals||!Oc.gsap&&Oc||{}),dM.forEach(fM)),C=typeof requestAnimationFrame<"u"&&requestAnimationFrame,r&&z.sleep(),E=C||function(Q){return setTimeout(Q,_-z.time*1e3+1|0)},rm=1,G(2))},sleep:function(){(C?cancelAnimationFrame:clearTimeout)(r),rm=0,E=nm},lagSmoothing:function(Q,rt){t=Q||1/0,i=Math.min(rt||33,t)},fps:function(Q){d=1e3/(Q||240),_=z.time*1e3+d},add:function(Q,rt,ft){var xt=rt?function(mt,bt,Ot,zt){Q(mt,bt,Ot,zt),z.remove(xt)}:Q;return z.remove(Q),v[ft?"unshift":"push"](xt),Cf(),xt},remove:function(Q,rt){~(rt=v.indexOf(Q))&&v.splice(rt,1)&&j>=rt&&j--},_listeners:v},z})(),Cf=function(){return!rm&&Da.wake()},fn={},wD=/^[\d.\-M][\d.\-,\s]/,TD=/["']/g,ED=function(t){for(var i={},l=t.substr(1,t.length-3).split(":"),c=l[0],d=1,_=l.length,v,r,E;d<_;d++)r=l[d],v=d!==_-1?r.lastIndexOf(","):r.length,E=r.substr(0,v),i[c]=isNaN(E)?E.replace(TD,"").trim():+E,c=r.substr(v+1).trim();return i},SD=function(t){var i=t.indexOf("(")+1,l=t.indexOf(")"),c=t.indexOf("(",i);return t.substring(i,~c&&c<l?t.indexOf(")",l+1):l)},MD=function(t){var i=(t+"").split("("),l=fn[i[0]];return l&&i.length>1&&l.config?l.config.apply(null,~t.indexOf("{")?[ED(i[1])]:SD(t).split(",").map(QS)):fn._CE&&wD.test(t)?fn._CE("",t):l},gM=function(t){return function(i){return 1-t(1-i)}},yM=function n(t,i){for(var l=t._first,c;l;)l instanceof jo?n(l,i):l.vars.yoyoEase&&(!l._yoyo||!l._repeat)&&l._yoyo!==i&&(l.timeline?n(l.timeline,i):(c=l._ease,l._ease=l._yEase,l._yEase=c,l._yoyo=i)),l=l._next},yd=function(t,i){return t&&(Ns(t)?t:fn[t]||MD(t))||i},Ad=function(t,i,l,c){l===void 0&&(l=function(r){return 1-i(1-r)}),c===void 0&&(c=function(r){return r<.5?i(r*2)/2:1-i((1-r)*2)/2});var d={easeIn:i,easeOut:l,easeInOut:c},_;return ha(t,function(v){fn[v]=Fa[v]=d,fn[_=v.toLowerCase()]=l;for(var r in d)fn[_+(r==="easeIn"?".in":r==="easeOut"?".out":".inOut")]=fn[v+"."+r]=d[r]}),d},vM=function(t){return function(i){return i<.5?(1-t(1-i*2))/2:.5+t((i-.5)*2)/2}},dv=function n(t,i,l){var c=i>=1?i:1,d=(l||(t?.3:.45))/(i<1?i:1),_=d/qv*(Math.asin(1/c)||0),v=function(C){return C===1?1:c*Math.pow(2,-10*C)*tD((C-_)*d)+1},r=t==="out"?v:t==="in"?function(E){return 1-v(1-E)}:vM(v);return d=qv/d,r.config=function(E,C){return n(t,E,C)},r},fv=function n(t,i){i===void 0&&(i=1.70158);var l=function(_){return _?--_*_*((i+1)*_+i)+1:0},c=t==="out"?l:t==="in"?function(d){return 1-l(1-d)}:vM(l);return c.config=function(d){return n(t,d)},c};ha("Linear,Quad,Cubic,Quart,Quint,Strong",function(n,t){var i=t<5?t+1:t;Ad(n+",Power"+(i-1),t?function(l){return Math.pow(l,i)}:function(l){return l},function(l){return 1-Math.pow(1-l,i)},function(l){return l<.5?Math.pow(l*2,i)/2:1-Math.pow((1-l)*2,i)/2})});fn.Linear.easeNone=fn.none=fn.Linear.easeIn;Ad("Elastic",dv("in"),dv("out"),dv());(function(n,t){var i=1/t,l=2*i,c=2.5*i,d=function(v){return v<i?n*v*v:v<l?n*Math.pow(v-1.5/t,2)+.75:v<c?n*(v-=2.25/t)*v+.9375:n*Math.pow(v-2.625/t,2)+.984375};Ad("Bounce",function(_){return 1-d(1-_)},d)})(7.5625,2.75);Ad("Expo",function(n){return Math.pow(2,10*(n-1))*n+n*n*n*n*n*n*(1-n)});Ad("Circ",function(n){return-(US(1-n*n)-1)});Ad("Sine",function(n){return n===1?1:-QL(n*YL)+1});Ad("Back",fv("in"),fv("out"),fv());fn.SteppedEase=fn.steps=Fa.SteppedEase={config:function(t,i){t===void 0&&(t=1);var l=1/t,c=t+(i?0:1),d=i?1:0,_=1-Qn;return function(v){return((c*xm(0,_,v)|0)+d)*l}}};Tf.ease=fn["quad.out"];ha("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(n){return $x+=n+","+n+"Params,"});var xM=function(t,i){this.id=JL++,t._gsap=this,this.target=t,this.harness=i,this.get=i?i.get:YS,this.set=i?i.getSetter:Xx},om=(function(){function n(i){this.vars=i,this._delay=+i.delay||0,(this._repeat=i.repeat===1/0?-2:i.repeat||0)&&(this._rDelay=i.repeatDelay||0,this._yoyo=!!i.yoyo||!!i.yoyoEase),this._ts=1,Mf(this,+i.duration,1,1),this.data=i.data,_s&&(this._ctx=_s,_s.data.push(this)),rm||Da.wake()}var t=n.prototype;return t.delay=function(l){return l||l===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+l-this._delay),this._delay=l,this):this._delay},t.duration=function(l){return arguments.length?this.totalDuration(this._repeat>0?l+(l+this._rDelay)*this._repeat:l):this.totalDuration()&&this._dur},t.totalDuration=function(l){return arguments.length?(this._dirty=0,Mf(this,this._repeat<0?l:(l-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(l,c){if(Cf(),!arguments.length)return this._tTime;var d=this._dp;if(d&&d.smoothChildTiming&&this._ts){for(Dg(this,l),!d._dp||d.parent||iM(d,this);d&&d.parent;)d.parent._time!==d._start+(d._ts>=0?d._tTime/d._ts:(d.totalDuration()-d._tTime)/-d._ts)&&d.totalTime(d._tTime,!0),d=d.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&l<this._tDur||this._ts<0&&l>0||!this._tDur&&!l)&&Bc(this._dp,this,this._start-this._delay)}return(this._tTime!==l||!this._dur&&!c||this._initted&&Math.abs(this._zTime)===Qn||!l&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=l),JS(this,l,c)),this},t.time=function(l,c){return arguments.length?this.totalTime(Math.min(this.totalDuration(),l+Bw(this))%(this._dur+this._rDelay)||(l?this._dur:0),c):this._time},t.totalProgress=function(l,c){return arguments.length?this.totalTime(this.totalDuration()*l,c):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},t.progress=function(l,c){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-l:l)+Bw(this),c):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(l,c){var d=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(l-1)*d,c):this._repeat?Sf(this._tTime,d)+1:1},t.timeScale=function(l,c){if(!arguments.length)return this._rts===-Qn?0:this._rts;if(this._rts===l)return this;var d=this.parent&&this._ts?og(this.parent._time,this):this._tTime;return this._rts=+l||0,this._ts=this._ps||l===-Qn?0:this._rts,this.totalTime(xm(-Math.abs(this._delay),this.totalDuration(),d),c!==!1),Lg(this),aD(this)},t.paused=function(l){return arguments.length?(this._ps!==l&&(this._ps=l,l?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Cf(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Qn&&(this._tTime-=Qn)))),this):this._ps},t.startTime=function(l){if(arguments.length){this._start=l;var c=this.parent||this._dp;return c&&(c._sort||!this.parent)&&Bc(c,this,l-this._delay),this}return this._start},t.endTime=function(l){return this._start+(ua(l)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(l){var c=this.parent||this._dp;return c?l&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?og(c.rawTime(l),this):this._tTime:this._tTime},t.revert=function(l){l===void 0&&(l=nD);var c=Xr;return Xr=l,Zx(this)&&(this.timeline&&this.timeline.revert(l),this.totalTime(-.01,l.suppressEvents)),this.data!=="nested"&&l.kill!==!1&&this.kill(),Xr=c,this},t.globalTime=function(l){for(var c=this,d=arguments.length?l:c.rawTime();c;)d=c._start+d/(Math.abs(c._ts)||1),c=c._dp;return!this.parent&&this._sat?this._sat.globalTime(l):d},t.repeat=function(l){return arguments.length?(this._repeat=l===1/0?-2:l,Fw(this)):this._repeat===-2?1/0:this._repeat},t.repeatDelay=function(l){if(arguments.length){var c=this._time;return this._rDelay=l,Fw(this),c?this.time(c):this}return this._rDelay},t.yoyo=function(l){return arguments.length?(this._yoyo=l,this):this._yoyo},t.seek=function(l,c){return this.totalTime(dl(this,l),ua(c))},t.restart=function(l,c){return this.play().totalTime(l?-this._delay:0,ua(c)),this._dur||(this._zTime=-Qn),this},t.play=function(l,c){return l!=null&&this.seek(l,c),this.reversed(!1).paused(!1)},t.reverse=function(l,c){return l!=null&&this.seek(l||this.totalDuration(),c),this.reversed(!0).paused(!1)},t.pause=function(l,c){return l!=null&&this.seek(l,c),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(l){return arguments.length?(!!l!==this.reversed()&&this.timeScale(-this._rts||(l?-Qn:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-Qn,this},t.isActive=function(){var l=this.parent||this._dp,c=this._start,d;return!!(!l||this._ts&&this._initted&&l.isActive()&&(d=l.rawTime(!0))>=c&&d<this.endTime(!0)-Qn)},t.eventCallback=function(l,c,d){var _=this.vars;return arguments.length>1?(c?(_[l]=c,d&&(_[l+"Params"]=d),l==="onUpdate"&&(this._onUpdate=c)):delete _[l],this):_[l]},t.then=function(l){var c=this;return new Promise(function(d){var _=Ns(l)?l:tM,v=function(){var E=c.then;c.then=null,Ns(_)&&(_=_(c))&&(_.then||_===c)&&(c.then=E),d(_),c.then=E};c._initted&&c.totalProgress()===1&&c._ts>=0||!c._tTime&&c._ts<0?v():c._prom=v})},t.kill=function(){Cp(this)},n})();Na(om.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Qn,_prom:0,_ps:!1,_rts:1});var jo=(function(n){VS(t,n);function t(l,c){var d;return l===void 0&&(l={}),d=n.call(this,l)||this,d.labels={},d.smoothChildTiming=!!l.smoothChildTiming,d.autoRemoveChildren=!!l.autoRemoveChildren,d._sort=ua(l.sortChildren),Ps&&Bc(l.parent||Ps,Tu(d),c),l.reversed&&d.reverse(),l.paused&&d.paused(!0),l.scrollTrigger&&nM(Tu(d),l.scrollTrigger),d}var i=t.prototype;return i.to=function(c,d,_){return Up(0,arguments,this),this},i.from=function(c,d,_){return Up(1,arguments,this),this},i.fromTo=function(c,d,_,v){return Up(2,arguments,this),this},i.set=function(c,d,_){return d.duration=0,d.parent=this,Vp(d).repeatDelay||(d.repeat=0),d.immediateRender=!!d.immediateRender,new or(c,d,dl(this,_),1),this},i.call=function(c,d,_){return Bc(this,or.delayedCall(0,c,d),_)},i.staggerTo=function(c,d,_,v,r,E,C){return _.duration=d,_.stagger=_.stagger||v,_.onComplete=E,_.onCompleteParams=C,_.parent=this,new or(c,_,dl(this,r)),this},i.staggerFrom=function(c,d,_,v,r,E,C){return _.runBackwards=1,Vp(_).immediateRender=ua(_.immediateRender),this.staggerTo(c,d,_,v,r,E,C)},i.staggerFromTo=function(c,d,_,v,r,E,C,z){return v.startAt=_,Vp(v).immediateRender=ua(v.immediateRender),this.staggerTo(c,d,v,r,E,C,z)},i.render=function(c,d,_){var v=this._time,r=this._dirty?this.totalDuration():this._tDur,E=this._dur,C=c<=0?0:lr(c),z=this._zTime<0!=c<0&&(this._initted||!E),R,j,G,W,Q,rt,ft,xt,mt,bt,Ot,zt;if(this!==Ps&&C>r&&c>=0&&(C=r),C!==this._tTime||_||z){if(v!==this._time&&E&&(C+=this._time-v,c+=this._time-v),R=C,mt=this._start,xt=this._ts,rt=!xt,z&&(E||(v=this._zTime),(c||!d)&&(this._zTime=c)),this._repeat){if(Ot=this._yoyo,Q=E+this._rDelay,this._repeat<-1&&c<0)return this.totalTime(Q*100+c,d,_);if(R=lr(C%Q),C===r?(W=this._repeat,R=E):(bt=lr(C/Q),W=~~bt,W&&W===bt&&(R=E,W--),R>E&&(R=E)),bt=Sf(this._tTime,Q),!v&&this._tTime&&bt!==W&&this._tTime-bt*Q-this._dur<=0&&(bt=W),Ot&&W&1&&(R=E-R,zt=1),W!==bt&&!this._lock){var Rt=Ot&&bt&1,Bt=Rt===(Ot&&W&1);if(W<bt&&(Rt=!Rt),v=Rt?0:C%E?E:C,this._lock=1,this.render(v||(zt?0:lr(W*Q)),d,!E)._lock=0,this._tTime=C,!d&&this.parent&&Ra(this,"onRepeat"),this.vars.repeatRefresh&&!zt&&(this.invalidate()._lock=1),v&&v!==this._time||rt!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(E=this._dur,r=this._tDur,Bt&&(this._lock=2,v=Rt?E:-1e-4,this.render(v,!0),this.vars.repeatRefresh&&!zt&&this.invalidate()),this._lock=0,!this._ts&&!rt)return this;yM(this,zt)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(ft=hD(this,lr(v),lr(R)),ft&&(C-=R-(R=ft._start))),this._tTime=C,this._time=R,this._act=!xt,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=c,v=0),!v&&C&&!d&&!bt&&(Ra(this,"onStart"),this._tTime!==C))return this;if(R>=v&&c>=0)for(j=this._first;j;){if(G=j._next,(j._act||R>=j._start)&&j._ts&&ft!==j){if(j.parent!==this)return this.render(c,d,_);if(j.render(j._ts>0?(R-j._start)*j._ts:(j._dirty?j.totalDuration():j._tDur)+(R-j._start)*j._ts,d,_),R!==this._time||!this._ts&&!rt){ft=0,G&&(C+=this._zTime=-Qn);break}}j=G}else{j=this._last;for(var Nt=c<0?c:R;j;){if(G=j._prev,(j._act||Nt<=j._end)&&j._ts&&ft!==j){if(j.parent!==this)return this.render(c,d,_);if(j.render(j._ts>0?(Nt-j._start)*j._ts:(j._dirty?j.totalDuration():j._tDur)+(Nt-j._start)*j._ts,d,_||Xr&&Zx(j)),R!==this._time||!this._ts&&!rt){ft=0,G&&(C+=this._zTime=Nt?-Qn:Qn);break}}j=G}}if(ft&&!d&&(this.pause(),ft.render(R>=v?0:-Qn)._zTime=R>=v?1:-1,this._ts))return this._start=mt,Lg(this),this.render(c,d,_);this._onUpdate&&!d&&Ra(this,"onUpdate",!0),(C===r&&this._tTime>=this.totalDuration()||!C&&v)&&(mt===this._start||Math.abs(xt)!==Math.abs(this._ts))&&(this._lock||((c||!E)&&(C===r&&this._ts>0||!C&&this._ts<0)&&xh(this,1),!d&&!(c<0&&!v)&&(C||v||!r)&&(Ra(this,C===r&&c>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(C<r&&this.timeScale()>0)&&this._prom())))}return this},i.add=function(c,d){var _=this;if(Ou(d)||(d=dl(this,d,c)),!(c instanceof om)){if(wo(c))return c.forEach(function(v){return _.add(v,d)}),this;if(Nr(c))return this.addLabel(c,d);if(Ns(c))c=or.delayedCall(0,c);else return this}return this!==c?Bc(this,c,d):this},i.getChildren=function(c,d,_,v){c===void 0&&(c=!0),d===void 0&&(d=!0),_===void 0&&(_=!0),v===void 0&&(v=-pl);for(var r=[],E=this._first;E;)E._start>=v&&(E instanceof or?d&&r.push(E):(_&&r.push(E),c&&r.push.apply(r,E.getChildren(!0,d,_)))),E=E._next;return r},i.getById=function(c){for(var d=this.getChildren(1,1,1),_=d.length;_--;)if(d[_].vars.id===c)return d[_]},i.remove=function(c){return Nr(c)?this.removeLabel(c):Ns(c)?this.killTweensOf(c):(c.parent===this&&Ig(this,c),c===this._recent&&(this._recent=this._last),gd(this))},i.totalTime=function(c,d){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=lr(Da.time-(this._ts>0?c/this._ts:(this.totalDuration()-c)/-this._ts))),n.prototype.totalTime.call(this,c,d),this._forcing=0,this):this._tTime},i.addLabel=function(c,d){return this.labels[c]=dl(this,d),this},i.removeLabel=function(c){return delete this.labels[c],this},i.addPause=function(c,d,_){var v=or.delayedCall(0,d||nm,_);return v.data="isPause",this._hasPause=1,Bc(this,v,dl(this,c))},i.removePause=function(c){var d=this._first;for(c=dl(this,c);d;)d._start===c&&d.data==="isPause"&&xh(d),d=d._next},i.killTweensOf=function(c,d,_){for(var v=this.getTweensOf(c,_),r=v.length;r--;)oh!==v[r]&&v[r].kill(c,d);return this},i.getTweensOf=function(c,d){for(var _=[],v=ml(c),r=this._first,E=Ou(d),C;r;)r instanceof or?sD(r._targets,v)&&(E?(!oh||r._initted&&r._ts)&&r.globalTime(0)<=d&&r.globalTime(r.totalDuration())>d:!d||r.isActive())&&_.push(r):(C=r.getTweensOf(v,d)).length&&_.push.apply(_,C),r=r._next;return _},i.tweenTo=function(c,d){d=d||{};var _=this,v=dl(_,c),r=d,E=r.startAt,C=r.onStart,z=r.onStartParams,R=r.immediateRender,j,G=or.to(_,Na({ease:d.ease||"none",lazy:!1,immediateRender:!1,time:v,overwrite:"auto",duration:d.duration||Math.abs((v-(E&&"time"in E?E.time:_._time))/_.timeScale())||Qn,onStart:function(){if(_.pause(),!j){var Q=d.duration||Math.abs((v-(E&&"time"in E?E.time:_._time))/_.timeScale());G._dur!==Q&&Mf(G,Q,0,1).render(G._time,!0,!0),j=1}C&&C.apply(G,z||[])}},d));return R?G.render(0):G},i.tweenFromTo=function(c,d,_){return this.tweenTo(d,Na({startAt:{time:dl(this,c)}},_))},i.recent=function(){return this._recent},i.nextLabel=function(c){return c===void 0&&(c=this._time),Nw(this,dl(this,c))},i.previousLabel=function(c){return c===void 0&&(c=this._time),Nw(this,dl(this,c),1)},i.currentLabel=function(c){return arguments.length?this.seek(c,!0):this.previousLabel(this._time+Qn)},i.shiftChildren=function(c,d,_){_===void 0&&(_=0);for(var v=this._first,r=this.labels,E;v;)v._start>=_&&(v._start+=c,v._end+=c),v=v._next;if(d)for(E in r)r[E]>=_&&(r[E]+=c);return gd(this)},i.invalidate=function(c){var d=this._first;for(this._lock=0;d;)d.invalidate(c),d=d._next;return n.prototype.invalidate.call(this,c)},i.clear=function(c){c===void 0&&(c=!0);for(var d=this._first,_;d;)_=d._next,this.remove(d),d=_;return this._dp&&(this._time=this._tTime=this._pTime=0),c&&(this.labels={}),gd(this)},i.totalDuration=function(c){var d=0,_=this,v=_._last,r=pl,E,C,z;if(arguments.length)return _.timeScale((_._repeat<0?_.duration():_.totalDuration())/(_.reversed()?-c:c));if(_._dirty){for(z=_.parent;v;)E=v._prev,v._dirty&&v.totalDuration(),C=v._start,C>r&&_._sort&&v._ts&&!_._lock?(_._lock=1,Bc(_,v,C-v._delay,1)._lock=0):r=C,C<0&&v._ts&&(d-=C,(!z&&!_._dp||z&&z.smoothChildTiming)&&(_._start+=C/_._ts,_._time-=C,_._tTime-=C),_.shiftChildren(-C,!1,-1/0),r=0),v._end>d&&v._ts&&(d=v._end),v=E;Mf(_,_===Ps&&_._time>d?_._time:d,1,1),_._dirty=0}return _._tDur},t.updateRoot=function(c){if(Ps._ts&&(JS(Ps,og(c,Ps)),KS=Da.frame),Da.frame>=Ow){Ow+=Ba.autoSleep||120;var d=Ps._first;if((!d||!d._ts)&&Ba.autoSleep&&Da._listeners.length<2){for(;d&&!d._ts;)d=d._next;d||Da.sleep()}}},t})(om);Na(jo.prototype,{_lock:0,_hasPause:0,_forcing:0});var CD=function(t,i,l,c,d,_,v){var r=new da(this._pt,t,i,0,1,MM,null,d),E=0,C=0,z,R,j,G,W,Q,rt,ft;for(r.b=l,r.e=c,l+="",c+="",(rt=~c.indexOf("random("))&&(c=sm(c)),_&&(ft=[l,c],_(ft,t,i),l=ft[0],c=ft[1]),R=l.match(cv)||[];z=cv.exec(c);)G=z[0],W=c.substring(E,z.index),j?j=(j+1)%5:W.substr(-5)==="rgba("&&(j=1),G!==R[C++]&&(Q=parseFloat(R[C-1])||0,r._pt={_next:r._pt,p:W||C===1?W:",",s:Q,c:G.charAt(1)==="="?vf(Q,G)-Q:parseFloat(G)-Q,m:j&&j<4?Math.round:0},E=cv.lastIndex);return r.c=E<c.length?c.substring(E,c.length):"",r.fp=v,(ZS.test(c)||rt)&&(r.e=0),this._pt=r,r},Gx=function(t,i,l,c,d,_,v,r,E,C){Ns(c)&&(c=c(d||0,t,_));var z=t[i],R=l!=="get"?l:Ns(z)?E?t[i.indexOf("set")||!Ns(t["get"+i.substr(3)])?i:"get"+i.substr(3)](E):t[i]():z,j=Ns(z)?E?LD:EM:qx,G;if(Nr(c)&&(~c.indexOf("random(")&&(c=sm(c)),c.charAt(1)==="="&&(G=vf(R,c)+(yo(R)||0),(G||G===0)&&(c=G))),!C||R!==c||nx)return!isNaN(R*c)&&c!==""?(G=new da(this._pt,t,i,+R||0,c-(R||0),typeof z=="boolean"?zD:SM,0,j),E&&(G.fp=E),v&&G.modifier(v,this,t),this._pt=G):(!z&&!(i in t)&&Vx(i,c),CD.call(this,t,i,R,c,j,r||Ba.stringFilter,E))},AD=function(t,i,l,c,d){if(Ns(t)&&(t=$p(t,d,i,l,c)),!Wc(t)||t.style&&t.nodeType||wo(t)||$S(t))return Nr(t)?$p(t,d,i,l,c):t;var _={},v;for(v in t)_[v]=$p(t[v],d,i,l,c);return _},bM=function(t,i,l,c,d,_){var v,r,E,C;if(La[t]&&(v=new La[t]).init(d,v.rawVars?i[t]:AD(i[t],c,d,_,l),l,c,_)!==!1&&(l._pt=r=new da(l._pt,d,t,0,1,v.render,v,0,v.priority),l!==hf))for(E=l._ptLookup[l._targets.indexOf(d)],C=v._props.length;C--;)E[v._props[C]]=r;return v},oh,nx,Hx=function n(t,i,l){var c=t.vars,d=c.ease,_=c.startAt,v=c.immediateRender,r=c.lazy,E=c.onUpdate,C=c.runBackwards,z=c.yoyoEase,R=c.keyframes,j=c.autoRevert,G=t._dur,W=t._startAt,Q=t._targets,rt=t.parent,ft=rt&&rt.data==="nested"?rt.vars.targets:Q,xt=t._overwrite==="auto"&&!Bx,mt=t.timeline,bt,Ot,zt,Rt,Bt,Nt,ee,Wt,ae,ye,He,de,he;if(mt&&(!R||!d)&&(d="none"),t._ease=yd(d,Tf.ease),t._yEase=z?gM(yd(z===!0?d:z,Tf.ease)):0,z&&t._yoyo&&!t._repeat&&(z=t._yEase,t._yEase=t._ease,t._ease=z),t._from=!mt&&!!c.runBackwards,!mt||R&&!c.stagger){if(Wt=Q[0]?_d(Q[0]).harness:0,de=Wt&&c[Wt.prop],bt=rg(c,Ux),W&&(W._zTime<0&&W.progress(1),i<0&&C&&v&&!j?W.render(-1,!0):W.revert(C&&G?R_:iD),W._lazy=0),_){if(xh(t._startAt=or.set(Q,Na({data:"isStart",overwrite:!1,parent:rt,immediateRender:!0,lazy:!W&&ua(r),startAt:null,delay:0,onUpdate:E&&function(){return Ra(t,"onUpdate")},stagger:0},_))),t._startAt._dp=0,t._startAt._sat=t,i<0&&(Xr||!v&&!j)&&t._startAt.revert(R_),v&&G&&i<=0&&l<=0){i&&(t._zTime=i);return}}else if(C&&G&&!W){if(i&&(v=!1),zt=Na({overwrite:!1,data:"isFromStart",lazy:v&&!W&&ua(r),immediateRender:v,stagger:0,parent:rt},bt),de&&(zt[Wt.prop]=de),xh(t._startAt=or.set(Q,zt)),t._startAt._dp=0,t._startAt._sat=t,i<0&&(Xr?t._startAt.revert(R_):t._startAt.render(-1,!0)),t._zTime=i,!v)n(t._startAt,Qn,Qn);else if(!i)return}for(t._pt=t._ptCache=0,r=G&&ua(r)||r&&!G,Ot=0;Ot<Q.length;Ot++){if(Bt=Q[Ot],ee=Bt._gsap||Wx(Q)[Ot]._gsap,t._ptLookup[Ot]=ye={},Yv[ee.id]&&mh.length&&sg(),He=ft===Q?Ot:ft.indexOf(Bt),Wt&&(ae=new Wt).init(Bt,de||bt,t,He,ft)!==!1&&(t._pt=Rt=new da(t._pt,Bt,ae.name,0,1,ae.render,ae,0,ae.priority),ae._props.forEach(function(oe){ye[oe]=Rt}),ae.priority&&(Nt=1)),!Wt||de)for(zt in bt)La[zt]&&(ae=bM(zt,bt,t,He,Bt,ft))?ae.priority&&(Nt=1):ye[zt]=Rt=Gx.call(t,Bt,zt,"get",bt[zt],He,ft,0,c.stringFilter);t._op&&t._op[Ot]&&t.kill(Bt,t._op[Ot]),xt&&t._pt&&(oh=t,Ps.killTweensOf(Bt,ye,t.globalTime(i)),he=!t.parent,oh=0),t._pt&&r&&(Yv[ee.id]=1)}Nt&&CM(t),t._onInit&&t._onInit(t)}t._onUpdate=E,t._initted=(!t._op||t._pt)&&!he,R&&i<=0&&mt.render(pl,!0,!0)},PD=function(t,i,l,c,d,_,v,r){var E=(t._pt&&t._ptCache||(t._ptCache={}))[i],C,z,R,j;if(!E)for(E=t._ptCache[i]=[],R=t._ptLookup,j=t._targets.length;j--;){if(C=R[j][i],C&&C.d&&C.d._pt)for(C=C.d._pt;C&&C.p!==i&&C.fp!==i;)C=C._next;if(!C)return nx=1,t.vars[i]="+=0",Hx(t,v),nx=0,r?im(i+" not eligible for reset"):1;E.push(C)}for(j=E.length;j--;)z=E[j],C=z._pt||z,C.s=(c||c===0)&&!d?c:C.s+(c||0)+_*C.c,C.c=l-C.s,z.e&&(z.e=Xs(l)+yo(z.e)),z.b&&(z.b=C.s+yo(z.b))},kD=function(t,i){var l=t[0]?_d(t[0]).harness:0,c=l&&l.aliases,d,_,v,r;if(!c)return i;d=Ef({},i);for(_ in c)if(_ in d)for(r=c[_].split(","),v=r.length;v--;)d[r[v]]=d[_];return d},ID=function(t,i,l,c){var d=i.ease||c||"power1.inOut",_,v;if(wo(i))v=l[t]||(l[t]=[]),i.forEach(function(r,E){return v.push({t:E/(i.length-1)*100,v:r,e:d})});else for(_ in i)v=l[_]||(l[_]=[]),_==="ease"||v.push({t:parseFloat(t),v:i[_],e:d})},$p=function(t,i,l,c,d){return Ns(t)?t.call(i,l,c,d):Nr(t)&&~t.indexOf("random(")?sm(t):t},wM=$x+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",TM={};ha(wM+",id,stagger,delay,duration,paused,scrollTrigger",function(n){return TM[n]=1});var or=(function(n){VS(t,n);function t(l,c,d,_){var v;typeof c=="number"&&(d.duration=c,c=d,d=null),v=n.call(this,_?c:Vp(c))||this;var r=v.vars,E=r.duration,C=r.delay,z=r.immediateRender,R=r.stagger,j=r.overwrite,G=r.keyframes,W=r.defaults,Q=r.scrollTrigger,rt=r.yoyoEase,ft=c.parent||Ps,xt=(wo(l)||$S(l)?Ou(l[0]):"length"in c)?[l]:ml(l),mt,bt,Ot,zt,Rt,Bt,Nt,ee;if(v._targets=xt.length?Wx(xt):im("GSAP target "+l+" not found. https://gsap.com",!Ba.nullTargetWarn)||[],v._ptLookup=[],v._overwrite=j,G||R||f_(E)||f_(C)){if(c=v.vars,mt=v.timeline=new jo({data:"nested",defaults:W||{},targets:ft&&ft.data==="nested"?ft.vars.targets:xt}),mt.kill(),mt.parent=mt._dp=Tu(v),mt._start=0,R||f_(E)||f_(C)){if(zt=xt.length,Nt=R&&aM(R),Wc(R))for(Rt in R)~wM.indexOf(Rt)&&(ee||(ee={}),ee[Rt]=R[Rt]);for(bt=0;bt<zt;bt++)Ot=rg(c,TM),Ot.stagger=0,rt&&(Ot.yoyoEase=rt),ee&&Ef(Ot,ee),Bt=xt[bt],Ot.duration=+$p(E,Tu(v),bt,Bt,xt),Ot.delay=(+$p(C,Tu(v),bt,Bt,xt)||0)-v._delay,!R&&zt===1&&Ot.delay&&(v._delay=C=Ot.delay,v._start+=C,Ot.delay=0),mt.to(Bt,Ot,Nt?Nt(bt,Bt,xt):0),mt._ease=fn.none;mt.duration()?E=C=0:v.timeline=0}else if(G){Vp(Na(mt.vars.defaults,{ease:"none"})),mt._ease=yd(G.ease||c.ease||"none");var Wt=0,ae,ye,He;if(wo(G))G.forEach(function(de){return mt.to(xt,de,">")}),mt.duration();else{Ot={};for(Rt in G)Rt==="ease"||Rt==="easeEach"||ID(Rt,G[Rt],Ot,G.easeEach);for(Rt in Ot)for(ae=Ot[Rt].sort(function(de,he){return de.t-he.t}),Wt=0,bt=0;bt<ae.length;bt++)ye=ae[bt],He={ease:ye.e,duration:(ye.t-(bt?ae[bt-1].t:0))/100*E},He[Rt]=ye.v,mt.to(xt,He,Wt),Wt+=He.duration;mt.duration()<E&&mt.to({},{duration:E-mt.duration()})}}E||v.duration(E=mt.duration())}else v.timeline=0;return j===!0&&!Bx&&(oh=Tu(v),Ps.killTweensOf(xt),oh=0),Bc(ft,Tu(v),d),c.reversed&&v.reverse(),c.paused&&v.paused(!0),(z||!E&&!G&&v._start===lr(ft._time)&&ua(z)&&lD(Tu(v))&&ft.data!=="nested")&&(v._tTime=-Qn,v.render(Math.max(0,-C)||0)),Q&&nM(Tu(v),Q),v}var i=t.prototype;return i.render=function(c,d,_){var v=this._time,r=this._tDur,E=this._dur,C=c<0,z=c>r-Qn&&!C?r:c<Qn?0:c,R,j,G,W,Q,rt,ft,xt,mt;if(!E)uD(this,c,d,_);else if(z!==this._tTime||!c||_||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==C||this._lazy){if(R=z,xt=this.timeline,this._repeat){if(W=E+this._rDelay,this._repeat<-1&&C)return this.totalTime(W*100+c,d,_);if(R=lr(z%W),z===r?(G=this._repeat,R=E):(Q=lr(z/W),G=~~Q,G&&G===Q?(R=E,G--):R>E&&(R=E)),rt=this._yoyo&&G&1,rt&&(mt=this._yEase,R=E-R),Q=Sf(this._tTime,W),R===v&&!_&&this._initted&&G===Q)return this._tTime=z,this;G!==Q&&(xt&&this._yEase&&yM(xt,rt),this.vars.repeatRefresh&&!rt&&!this._lock&&R!==W&&this._initted&&(this._lock=_=1,this.render(lr(W*G),!0).invalidate()._lock=0))}if(!this._initted){if(sM(this,C?c:R,_,d,z))return this._tTime=0,this;if(v!==this._time&&!(_&&this.vars.repeatRefresh&&G!==Q))return this;if(E!==this._dur)return this.render(c,d,_)}if(this._tTime=z,this._time=R,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=ft=(mt||this._ease)(R/E),this._from&&(this.ratio=ft=1-ft),!v&&z&&!d&&!Q&&(Ra(this,"onStart"),this._tTime!==z))return this;for(j=this._pt;j;)j.r(ft,j.d),j=j._next;xt&&xt.render(c<0?c:xt._dur*xt._ease(R/this._dur),d,_)||this._startAt&&(this._zTime=c),this._onUpdate&&!d&&(C&&Jv(this,c,d,_),Ra(this,"onUpdate")),this._repeat&&G!==Q&&this.vars.onRepeat&&!d&&this.parent&&Ra(this,"onRepeat"),(z===this._tDur||!z)&&this._tTime===z&&(C&&!this._onUpdate&&Jv(this,c,!0,!0),(c||!E)&&(z===this._tDur&&this._ts>0||!z&&this._ts<0)&&xh(this,1),!d&&!(C&&!v)&&(z||v||rt)&&(Ra(this,z===r?"onComplete":"onReverseComplete",!0),this._prom&&!(z<r&&this.timeScale()>0)&&this._prom()))}return this},i.targets=function(){return this._targets},i.invalidate=function(c){return(!c||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(c),n.prototype.invalidate.call(this,c)},i.resetTo=function(c,d,_,v,r){rm||Da.wake(),this._ts||this.play();var E=Math.min(this._dur,(this._dp._time-this._start)*this._ts),C;return this._initted||Hx(this,E),C=this._ease(E/this._dur),PD(this,c,d,_,v,C,E,r)?this.resetTo(c,d,_,v,1):(Dg(this,0),this.parent||eM(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},i.kill=function(c,d){if(d===void 0&&(d="all"),!c&&(!d||d==="all"))return this._lazy=this._pt=0,this.parent?Cp(this):this.scrollTrigger&&this.scrollTrigger.kill(!!Xr),this;if(this.timeline){var _=this.timeline.totalDuration();return this.timeline.killTweensOf(c,d,oh&&oh.vars.overwrite!==!0)._first||Cp(this),this.parent&&_!==this.timeline.totalDuration()&&Mf(this,this._dur*this.timeline._tDur/_,0,1),this}var v=this._targets,r=c?ml(c):v,E=this._ptLookup,C=this._pt,z,R,j,G,W,Q,rt;if((!d||d==="all")&&oD(v,r))return d==="all"&&(this._pt=0),Cp(this);for(z=this._op=this._op||[],d!=="all"&&(Nr(d)&&(W={},ha(d,function(ft){return W[ft]=1}),d=W),d=kD(v,d)),rt=v.length;rt--;)if(~r.indexOf(v[rt])){R=E[rt],d==="all"?(z[rt]=d,G=R,j={}):(j=z[rt]=z[rt]||{},G=d);for(W in G)Q=R&&R[W],Q&&((!("kill"in Q.d)||Q.d.kill(W)===!0)&&Ig(this,Q,"_pt"),delete R[W]),j!=="all"&&(j[W]=1)}return this._initted&&!this._pt&&C&&Cp(this),this},t.to=function(c,d){return new t(c,d,arguments[2])},t.from=function(c,d){return Up(1,arguments)},t.delayedCall=function(c,d,_,v){return new t(d,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:c,onComplete:d,onReverseComplete:d,onCompleteParams:_,onReverseCompleteParams:_,callbackScope:v})},t.fromTo=function(c,d,_){return Up(2,arguments)},t.set=function(c,d){return d.duration=0,d.repeatDelay||(d.repeat=0),new t(c,d)},t.killTweensOf=function(c,d,_){return Ps.killTweensOf(c,d,_)},t})(om);Na(or.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});ha("staggerTo,staggerFrom,staggerFromTo",function(n){or[n]=function(){var t=new jo,i=tx.call(arguments,0);return i.splice(n==="staggerFromTo"?5:4,0,0),t[n].apply(t,i)}});var qx=function(t,i,l){return t[i]=l},EM=function(t,i,l){return t[i](l)},LD=function(t,i,l,c){return t[i](c.fp,l)},DD=function(t,i,l){return t.setAttribute(i,l)},Xx=function(t,i){return Ns(t[i])?EM:Fx(t[i])&&t.setAttribute?DD:qx},SM=function(t,i){return i.set(i.t,i.p,Math.round((i.s+i.c*t)*1e6)/1e6,i)},zD=function(t,i){return i.set(i.t,i.p,!!(i.s+i.c*t),i)},MM=function(t,i){var l=i._pt,c="";if(!t&&i.b)c=i.b;else if(t===1&&i.e)c=i.e;else{for(;l;)c=l.p+(l.m?l.m(l.s+l.c*t):Math.round((l.s+l.c*t)*1e4)/1e4)+c,l=l._next;c+=i.c}i.set(i.t,i.p,c,i)},Kx=function(t,i){for(var l=i._pt;l;)l.r(t,l.d),l=l._next},OD=function(t,i,l,c){for(var d=this._pt,_;d;)_=d._next,d.p===c&&d.modifier(t,i,l),d=_},RD=function(t){for(var i=this._pt,l,c;i;)c=i._next,i.p===t&&!i.op||i.op===t?Ig(this,i,"_pt"):i.dep||(l=1),i=c;return!l},BD=function(t,i,l,c){c.mSet(t,i,c.m.call(c.tween,l,c.mt),c)},CM=function(t){for(var i=t._pt,l,c,d,_;i;){for(l=i._next,c=d;c&&c.pr>i.pr;)c=c._next;(i._prev=c?c._prev:_)?i._prev._next=i:d=i,(i._next=c)?c._prev=i:_=i,i=l}t._pt=d},da=(function(){function n(i,l,c,d,_,v,r,E,C){this.t=l,this.s=d,this.c=_,this.p=c,this.r=v||SM,this.d=r||this,this.set=E||qx,this.pr=C||0,this._next=i,i&&(i._prev=this)}var t=n.prototype;return t.modifier=function(l,c,d){this.mSet=this.mSet||this.set,this.set=BD,this.m=l,this.mt=d,this.tween=c},n})();ha($x+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(n){return Ux[n]=1});Fa.TweenMax=Fa.TweenLite=or;Fa.TimelineLite=Fa.TimelineMax=jo;Ps=new jo({sortChildren:!1,defaults:Tf,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});Ba.stringFilter=_M;var vd=[],F_={},FD=[],Vw=0,ND=0,pv=function(t){return(F_[t]||FD).map(function(i){return i()})},sx=function(){var t=Date.now(),i=[];t-Vw>2&&(pv("matchMediaInit"),vd.forEach(function(l){var c=l.queries,d=l.conditions,_,v,r,E;for(v in c)_=Oc.matchMedia(c[v]).matches,_&&(r=1),_!==d[v]&&(d[v]=_,E=1);E&&(l.revert(),r&&i.push(l))}),pv("matchMediaRevert"),i.forEach(function(l){return l.onMatch(l,function(c){return l.add(null,c)})}),Vw=t,pv("matchMedia"))},AM=(function(){function n(i,l){this.selector=l&&ex(l),this.data=[],this._r=[],this.isReverted=!1,this.id=ND++,i&&this.add(i)}var t=n.prototype;return t.add=function(l,c,d){Ns(l)&&(d=c,c=l,l=Ns);var _=this,v=function(){var E=_s,C=_.selector,z;return E&&E!==_&&E.data.push(_),d&&(_.selector=ex(d)),_s=_,z=c.apply(_,arguments),Ns(z)&&_._r.push(z),_s=E,_.selector=C,_.isReverted=!1,z};return _.last=v,l===Ns?v(_,function(r){return _.add(null,r)}):l?_[l]=v:v},t.ignore=function(l){var c=_s;_s=null,l(this),_s=c},t.getTweens=function(){var l=[];return this.data.forEach(function(c){return c instanceof n?l.push.apply(l,c.getTweens()):c instanceof or&&!(c.parent&&c.parent.data==="nested")&&l.push(c)}),l},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(l,c){var d=this;if(l?(function(){for(var v=d.getTweens(),r=d.data.length,E;r--;)E=d.data[r],E.data==="isFlip"&&(E.revert(),E.getChildren(!0,!0,!1).forEach(function(C){return v.splice(v.indexOf(C),1)}));for(v.map(function(C){return{g:C._dur||C._delay||C._sat&&!C._sat.vars.immediateRender?C.globalTime(0):-1/0,t:C}}).sort(function(C,z){return z.g-C.g||-1/0}).forEach(function(C){return C.t.revert(l)}),r=d.data.length;r--;)E=d.data[r],E instanceof jo?E.data!=="nested"&&(E.scrollTrigger&&E.scrollTrigger.revert(),E.kill()):!(E instanceof or)&&E.revert&&E.revert(l);d._r.forEach(function(C){return C(l,d)}),d.isReverted=!0})():this.data.forEach(function(v){return v.kill&&v.kill()}),this.clear(),c)for(var _=vd.length;_--;)vd[_].id===this.id&&vd.splice(_,1)},t.revert=function(l){this.kill(l||{})},n})(),jD=(function(){function n(i){this.contexts=[],this.scope=i,_s&&_s.data.push(this)}var t=n.prototype;return t.add=function(l,c,d){Wc(l)||(l={matches:l});var _=new AM(0,d||this.scope),v=_.conditions={},r,E,C;_s&&!_.selector&&(_.selector=_s.selector),this.contexts.push(_),c=_.add("onMatch",c),_.queries=l;for(E in l)E==="all"?C=1:(r=Oc.matchMedia(l[E]),r&&(vd.indexOf(_)<0&&vd.push(_),(v[E]=r.matches)&&(C=1),r.addListener?r.addListener(sx):r.addEventListener("change",sx)));return C&&c(_,function(z){return _.add(null,z)}),this},t.revert=function(l){this.kill(l||{})},t.kill=function(l){this.contexts.forEach(function(c){return c.kill(l,!0)})},n})(),ag={registerPlugin:function(){for(var t=arguments.length,i=new Array(t),l=0;l<t;l++)i[l]=arguments[l];i.forEach(function(c){return fM(c)})},timeline:function(t){return new jo(t)},getTweensOf:function(t,i){return Ps.getTweensOf(t,i)},getProperty:function(t,i,l,c){Nr(t)&&(t=ml(t)[0]);var d=_d(t||{}).get,_=l?tM:QS;return l==="native"&&(l=""),t&&(i?_((La[i]&&La[i].get||d)(t,i,l,c)):function(v,r,E){return _((La[v]&&La[v].get||d)(t,v,r,E))})},quickSetter:function(t,i,l){if(t=ml(t),t.length>1){var c=t.map(function(C){return pa.quickSetter(C,i,l)}),d=c.length;return function(C){for(var z=d;z--;)c[z](C)}}t=t[0]||{};var _=La[i],v=_d(t),r=v.harness&&(v.harness.aliases||{})[i]||i,E=_?function(C){var z=new _;hf._pt=0,z.init(t,l?C+l:C,hf,0,[t]),z.render(1,z),hf._pt&&Kx(1,hf)}:v.set(t,r);return _?E:function(C){return E(t,r,l?C+l:C,v,1)}},quickTo:function(t,i,l){var c,d=pa.to(t,Na((c={},c[i]="+=0.1",c.paused=!0,c.stagger=0,c),l||{})),_=function(r,E,C){return d.resetTo(i,r,E,C)};return _.tween=d,_},isTweening:function(t){return Ps.getTweensOf(t,!0).length>0},defaults:function(t){return t&&t.ease&&(t.ease=yd(t.ease,Tf.ease)),Rw(Tf,t||{})},config:function(t){return Rw(Ba,t||{})},registerEffect:function(t){var i=t.name,l=t.effect,c=t.plugins,d=t.defaults,_=t.extendTimeline;(c||"").split(",").forEach(function(v){return v&&!La[v]&&!Fa[v]&&im(i+" effect requires "+v+" plugin.")}),uv[i]=function(v,r,E){return l(ml(v),Na(r||{},d),E)},_&&(jo.prototype[i]=function(v,r,E){return this.add(uv[i](v,Wc(r)?r:(E=r)&&{},this),E)})},registerEase:function(t,i){fn[t]=yd(i)},parseEase:function(t,i){return arguments.length?yd(t,i):fn},getById:function(t){return Ps.getById(t)},exportRoot:function(t,i){t===void 0&&(t={});var l=new jo(t),c,d;for(l.smoothChildTiming=ua(t.smoothChildTiming),Ps.remove(l),l._dp=0,l._time=l._tTime=Ps._time,c=Ps._first;c;)d=c._next,(i||!(!c._dur&&c instanceof or&&c.vars.onComplete===c._targets[0]))&&Bc(l,c,c._start-c._delay),c=d;return Bc(Ps,l,0),l},context:function(t,i){return t?new AM(t,i):_s},matchMedia:function(t){return new jD(t)},matchMediaRefresh:function(){return vd.forEach(function(t){var i=t.conditions,l,c;for(c in i)i[c]&&(i[c]=!1,l=1);l&&t.revert()})||sx()},addEventListener:function(t,i){var l=F_[t]||(F_[t]=[]);~l.indexOf(i)||l.push(i)},removeEventListener:function(t,i){var l=F_[t],c=l&&l.indexOf(i);c>=0&&l.splice(c,1)},utils:{wrap:yD,wrapYoyo:vD,distribute:aM,random:cM,snap:lM,normalize:gD,getUnit:yo,clamp:fD,splitColor:pM,toArray:ml,selector:ex,mapRange:hM,pipe:mD,unitize:_D,interpolate:xD,shuffle:oM},install:qS,effects:uv,ticker:Da,updateRoot:jo.updateRoot,plugins:La,globalTimeline:Ps,core:{PropTween:da,globals:XS,Tween:or,Timeline:jo,Animation:om,getCache:_d,_removeLinkedListItem:Ig,reverting:function(){return Xr},context:function(t){return t&&_s&&(_s.data.push(t),t._ctx=_s),_s},suppressOverwrites:function(t){return Bx=t}}};ha("to,from,fromTo,delayedCall,set,killTweensOf",function(n){return ag[n]=or[n]});Da.add(jo.updateRoot);hf=ag.to({},{duration:0});var VD=function(t,i){for(var l=t._pt;l&&l.p!==i&&l.op!==i&&l.fp!==i;)l=l._next;return l},UD=function(t,i){var l=t._targets,c,d,_;for(c in i)for(d=l.length;d--;)_=t._ptLookup[d][c],_&&(_=_.d)&&(_._pt&&(_=VD(_,c)),_&&_.modifier&&_.modifier(i[c],t,l[d],c))},mv=function(t,i){return{name:t,headless:1,rawVars:1,init:function(c,d,_){_._onInit=function(v){var r,E;if(Nr(d)&&(r={},ha(d,function(C){return r[C]=1}),d=r),i){r={};for(E in d)r[E]=i(d[E]);d=r}UD(v,d)}}}},pa=ag.registerPlugin({name:"attr",init:function(t,i,l,c,d){var _,v,r;this.tween=l;for(_ in i)r=t.getAttribute(_)||"",v=this.add(t,"setAttribute",(r||0)+"",i[_],c,d,0,0,_),v.op=_,v.b=r,this._props.push(_)},render:function(t,i){for(var l=i._pt;l;)Xr?l.set(l.t,l.p,l.b,l):l.r(t,l.d),l=l._next}},{name:"endArray",headless:1,init:function(t,i){for(var l=i.length;l--;)this.add(t,l,t[l]||0,i[l],0,0,0,0,0,1)}},mv("roundProps",ix),mv("modifiers"),mv("snap",lM))||ag;or.version=jo.version=pa.version="3.13.0";HS=1;Nx()&&Cf();fn.Power0;fn.Power1;fn.Power2;fn.Power3;fn.Power4;fn.Linear;fn.Quad;fn.Cubic;fn.Quart;fn.Quint;fn.Strong;fn.Elastic;fn.Back;fn.SteppedEase;fn.Bounce;fn.Sine;fn.Expo;fn.Circ;/*!
 * CSSPlugin 3.13.0
 * https://gsap.com
 *
 * Copyright 2008-2025, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license
 * @author: Jack Doyle, jack@greensock.com
*/var Uw,ah,xf,Yx,fd,$w,Jx,$D=function(){return typeof window<"u"},Ru={},ld=180/Math.PI,bf=Math.PI/180,of=Math.atan2,Ww=1e8,Qx=/([A-Z])/g,WD=/(left|right|width|margin|padding|x)/i,ZD=/[\s,\(]\S/,Fc={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},rx=function(t,i){return i.set(i.t,i.p,Math.round((i.s+i.c*t)*1e4)/1e4+i.u,i)},GD=function(t,i){return i.set(i.t,i.p,t===1?i.e:Math.round((i.s+i.c*t)*1e4)/1e4+i.u,i)},HD=function(t,i){return i.set(i.t,i.p,t?Math.round((i.s+i.c*t)*1e4)/1e4+i.u:i.b,i)},qD=function(t,i){var l=i.s+i.c*t;i.set(i.t,i.p,~~(l+(l<0?-.5:.5))+i.u,i)},PM=function(t,i){return i.set(i.t,i.p,t?i.e:i.b,i)},kM=function(t,i){return i.set(i.t,i.p,t!==1?i.b:i.e,i)},XD=function(t,i,l){return t.style[i]=l},KD=function(t,i,l){return t.style.setProperty(i,l)},YD=function(t,i,l){return t._gsap[i]=l},JD=function(t,i,l){return t._gsap.scaleX=t._gsap.scaleY=l},QD=function(t,i,l,c,d){var _=t._gsap;_.scaleX=_.scaleY=l,_.renderTransform(d,_)},tz=function(t,i,l,c,d){var _=t._gsap;_[i]=l,_.renderTransform(d,_)},ks="transform",fa=ks+"Origin",ez=function n(t,i){var l=this,c=this.target,d=c.style,_=c._gsap;if(t in Ru&&d){if(this.tfm=this.tfm||{},t!=="transform")t=Fc[t]||t,~t.indexOf(",")?t.split(",").forEach(function(v){return l.tfm[v]=Mu(c,v)}):this.tfm[t]=_.x?_[t]:Mu(c,t),t===fa&&(this.tfm.zOrigin=_.zOrigin);else return Fc.transform.split(",").forEach(function(v){return n.call(l,v,i)});if(this.props.indexOf(ks)>=0)return;_.svg&&(this.svgo=c.getAttribute("data-svg-origin"),this.props.push(fa,i,"")),t=ks}(d||i)&&this.props.push(t,i,d[t])},IM=function(t){t.translate&&(t.removeProperty("translate"),t.removeProperty("scale"),t.removeProperty("rotate"))},iz=function(){var t=this.props,i=this.target,l=i.style,c=i._gsap,d,_;for(d=0;d<t.length;d+=3)t[d+1]?t[d+1]===2?i[t[d]](t[d+2]):i[t[d]]=t[d+2]:t[d+2]?l[t[d]]=t[d+2]:l.removeProperty(t[d].substr(0,2)==="--"?t[d]:t[d].replace(Qx,"-$1").toLowerCase());if(this.tfm){for(_ in this.tfm)c[_]=this.tfm[_];c.svg&&(c.renderTransform(),i.setAttribute("data-svg-origin",this.svgo||"")),d=Jx(),(!d||!d.isStart)&&!l[ks]&&(IM(l),c.zOrigin&&l[fa]&&(l[fa]+=" "+c.zOrigin+"px",c.zOrigin=0,c.renderTransform()),c.uncache=1)}},LM=function(t,i){var l={target:t,props:[],revert:iz,save:ez};return t._gsap||pa.core.getCache(t),i&&t.style&&t.nodeType&&i.split(",").forEach(function(c){return l.save(c)}),l},DM,ox=function(t,i){var l=ah.createElementNS?ah.createElementNS((i||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):ah.createElement(t);return l&&l.style?l:ah.createElement(t)},_l=function n(t,i,l){var c=getComputedStyle(t);return c[i]||c.getPropertyValue(i.replace(Qx,"-$1").toLowerCase())||c.getPropertyValue(i)||!l&&n(t,Af(i)||i,1)||""},Zw="O,Moz,ms,Ms,Webkit".split(","),Af=function(t,i,l){var c=i||fd,d=c.style,_=5;if(t in d&&!l)return t;for(t=t.charAt(0).toUpperCase()+t.substr(1);_--&&!(Zw[_]+t in d););return _<0?null:(_===3?"ms":_>=0?Zw[_]:"")+t},ax=function(){$D()&&window.document&&(Uw=window,ah=Uw.document,xf=ah.documentElement,fd=ox("div")||{style:{}},ox("div"),ks=Af(ks),fa=ks+"Origin",fd.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",DM=!!Af("perspective"),Jx=pa.core.reverting,Yx=1)},Gw=function(t){var i=t.ownerSVGElement,l=ox("svg",i&&i.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),c=t.cloneNode(!0),d;c.style.display="block",l.appendChild(c),xf.appendChild(l);try{d=c.getBBox()}catch{}return l.removeChild(c),xf.removeChild(l),d},Hw=function(t,i){for(var l=i.length;l--;)if(t.hasAttribute(i[l]))return t.getAttribute(i[l])},zM=function(t){var i,l;try{i=t.getBBox()}catch{i=Gw(t),l=1}return i&&(i.width||i.height)||l||(i=Gw(t)),i&&!i.width&&!i.x&&!i.y?{x:+Hw(t,["x","cx","x1"])||0,y:+Hw(t,["y","cy","y1"])||0,width:0,height:0}:i},OM=function(t){return!!(t.getCTM&&(!t.parentNode||t.ownerSVGElement)&&zM(t))},wd=function(t,i){if(i){var l=t.style,c;i in Ru&&i!==fa&&(i=ks),l.removeProperty?(c=i.substr(0,2),(c==="ms"||i.substr(0,6)==="webkit")&&(i="-"+i),l.removeProperty(c==="--"?i:i.replace(Qx,"-$1").toLowerCase())):l.removeAttribute(i)}},lh=function(t,i,l,c,d,_){var v=new da(t._pt,i,l,0,1,_?kM:PM);return t._pt=v,v.b=c,v.e=d,t._props.push(l),v},qw={deg:1,rad:1,turn:1},nz={grid:1,flex:1},bh=function n(t,i,l,c){var d=parseFloat(l)||0,_=(l+"").trim().substr((d+"").length)||"px",v=fd.style,r=WD.test(i),E=t.tagName.toLowerCase()==="svg",C=(E?"client":"offset")+(r?"Width":"Height"),z=100,R=c==="px",j=c==="%",G,W,Q,rt;if(c===_||!d||qw[c]||qw[_])return d;if(_!=="px"&&!R&&(d=n(t,i,l,"px")),rt=t.getCTM&&OM(t),(j||_==="%")&&(Ru[i]||~i.indexOf("adius")))return G=rt?t.getBBox()[r?"width":"height"]:t[C],Xs(j?d/G*z:d/100*G);if(v[r?"width":"height"]=z+(R?_:c),W=c!=="rem"&&~i.indexOf("adius")||c==="em"&&t.appendChild&&!E?t:t.parentNode,rt&&(W=(t.ownerSVGElement||{}).parentNode),(!W||W===ah||!W.appendChild)&&(W=ah.body),Q=W._gsap,Q&&j&&Q.width&&r&&Q.time===Da.time&&!Q.uncache)return Xs(d/Q.width*z);if(j&&(i==="height"||i==="width")){var ft=t.style[i];t.style[i]=z+c,G=t[C],ft?t.style[i]=ft:wd(t,i)}else(j||_==="%")&&!nz[_l(W,"display")]&&(v.position=_l(t,"position")),W===t&&(v.position="static"),W.appendChild(fd),G=fd[C],W.removeChild(fd),v.position="absolute";return r&&j&&(Q=_d(W),Q.time=Da.time,Q.width=W[C]),Xs(R?G*d/z:G&&d?z/G*d:0)},Mu=function(t,i,l,c){var d;return Yx||ax(),i in Fc&&i!=="transform"&&(i=Fc[i],~i.indexOf(",")&&(i=i.split(",")[0])),Ru[i]&&i!=="transform"?(d=lm(t,c),d=i!=="transformOrigin"?d[i]:d.svg?d.origin:cg(_l(t,fa))+" "+d.zOrigin+"px"):(d=t.style[i],(!d||d==="auto"||c||~(d+"").indexOf("calc("))&&(d=lg[i]&&lg[i](t,i,l)||_l(t,i)||YS(t,i)||(i==="opacity"?1:0))),l&&!~(d+"").trim().indexOf(" ")?bh(t,i,d,l)+l:d},sz=function(t,i,l,c){if(!l||l==="none"){var d=Af(i,t,1),_=d&&_l(t,d,1);_&&_!==l?(i=d,l=_):i==="borderColor"&&(l=_l(t,"borderTopColor"))}var v=new da(this._pt,t.style,i,0,1,MM),r=0,E=0,C,z,R,j,G,W,Q,rt,ft,xt,mt,bt;if(v.b=l,v.e=c,l+="",c+="",c.substring(0,6)==="var(--"&&(c=_l(t,c.substring(4,c.indexOf(")")))),c==="auto"&&(W=t.style[i],t.style[i]=c,c=_l(t,i)||c,W?t.style[i]=W:wd(t,i)),C=[l,c],_M(C),l=C[0],c=C[1],R=l.match(uf)||[],bt=c.match(uf)||[],bt.length){for(;z=uf.exec(c);)Q=z[0],ft=c.substring(r,z.index),G?G=(G+1)%5:(ft.substr(-5)==="rgba("||ft.substr(-5)==="hsla(")&&(G=1),Q!==(W=R[E++]||"")&&(j=parseFloat(W)||0,mt=W.substr((j+"").length),Q.charAt(1)==="="&&(Q=vf(j,Q)+mt),rt=parseFloat(Q),xt=Q.substr((rt+"").length),r=uf.lastIndex-xt.length,xt||(xt=xt||Ba.units[i]||mt,r===c.length&&(c+=xt,v.e+=xt)),mt!==xt&&(j=bh(t,i,W,xt)||0),v._pt={_next:v._pt,p:ft||E===1?ft:",",s:j,c:rt-j,m:G&&G<4||i==="zIndex"?Math.round:0});v.c=r<c.length?c.substring(r,c.length):""}else v.r=i==="display"&&c==="none"?kM:PM;return ZS.test(c)&&(v.e=0),this._pt=v,v},Xw={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},rz=function(t){var i=t.split(" "),l=i[0],c=i[1]||"50%";return(l==="top"||l==="bottom"||c==="left"||c==="right")&&(t=l,l=c,c=t),i[0]=Xw[l]||l,i[1]=Xw[c]||c,i.join(" ")},oz=function(t,i){if(i.tween&&i.tween._time===i.tween._dur){var l=i.t,c=l.style,d=i.u,_=l._gsap,v,r,E;if(d==="all"||d===!0)c.cssText="",r=1;else for(d=d.split(","),E=d.length;--E>-1;)v=d[E],Ru[v]&&(r=1,v=v==="transformOrigin"?fa:ks),wd(l,v);r&&(wd(l,ks),_&&(_.svg&&l.removeAttribute("transform"),c.scale=c.rotate=c.translate="none",lm(l,1),_.uncache=1,IM(c)))}},lg={clearProps:function(t,i,l,c,d){if(d.data!=="isFromStart"){var _=t._pt=new da(t._pt,i,l,0,0,oz);return _.u=c,_.pr=-10,_.tween=d,t._props.push(l),1}}},am=[1,0,0,1,0,0],RM={},BM=function(t){return t==="matrix(1, 0, 0, 1, 0, 0)"||t==="none"||!t},Kw=function(t){var i=_l(t,ks);return BM(i)?am:i.substr(7).match(WS).map(Xs)},t0=function(t,i){var l=t._gsap||_d(t),c=t.style,d=Kw(t),_,v,r,E;return l.svg&&t.getAttribute("transform")?(r=t.transform.baseVal.consolidate().matrix,d=[r.a,r.b,r.c,r.d,r.e,r.f],d.join(",")==="1,0,0,1,0,0"?am:d):(d===am&&!t.offsetParent&&t!==xf&&!l.svg&&(r=c.display,c.display="block",_=t.parentNode,(!_||!t.offsetParent&&!t.getBoundingClientRect().width)&&(E=1,v=t.nextElementSibling,xf.appendChild(t)),d=Kw(t),r?c.display=r:wd(t,"display"),E&&(v?_.insertBefore(t,v):_?_.appendChild(t):xf.removeChild(t))),i&&d.length>6?[d[0],d[1],d[4],d[5],d[12],d[13]]:d)},lx=function(t,i,l,c,d,_){var v=t._gsap,r=d||t0(t,!0),E=v.xOrigin||0,C=v.yOrigin||0,z=v.xOffset||0,R=v.yOffset||0,j=r[0],G=r[1],W=r[2],Q=r[3],rt=r[4],ft=r[5],xt=i.split(" "),mt=parseFloat(xt[0])||0,bt=parseFloat(xt[1])||0,Ot,zt,Rt,Bt;l?r!==am&&(zt=j*Q-G*W)&&(Rt=mt*(Q/zt)+bt*(-W/zt)+(W*ft-Q*rt)/zt,Bt=mt*(-G/zt)+bt*(j/zt)-(j*ft-G*rt)/zt,mt=Rt,bt=Bt):(Ot=zM(t),mt=Ot.x+(~xt[0].indexOf("%")?mt/100*Ot.width:mt),bt=Ot.y+(~(xt[1]||xt[0]).indexOf("%")?bt/100*Ot.height:bt)),c||c!==!1&&v.smooth?(rt=mt-E,ft=bt-C,v.xOffset=z+(rt*j+ft*W)-rt,v.yOffset=R+(rt*G+ft*Q)-ft):v.xOffset=v.yOffset=0,v.xOrigin=mt,v.yOrigin=bt,v.smooth=!!c,v.origin=i,v.originIsAbsolute=!!l,t.style[fa]="0px 0px",_&&(lh(_,v,"xOrigin",E,mt),lh(_,v,"yOrigin",C,bt),lh(_,v,"xOffset",z,v.xOffset),lh(_,v,"yOffset",R,v.yOffset)),t.setAttribute("data-svg-origin",mt+" "+bt)},lm=function(t,i){var l=t._gsap||new xM(t);if("x"in l&&!i&&!l.uncache)return l;var c=t.style,d=l.scaleX<0,_="px",v="deg",r=getComputedStyle(t),E=_l(t,fa)||"0",C,z,R,j,G,W,Q,rt,ft,xt,mt,bt,Ot,zt,Rt,Bt,Nt,ee,Wt,ae,ye,He,de,he,oe,Oe,Ue,$t,ce,Ve,je,Xe;return C=z=R=W=Q=rt=ft=xt=mt=0,j=G=1,l.svg=!!(t.getCTM&&OM(t)),r.translate&&((r.translate!=="none"||r.scale!=="none"||r.rotate!=="none")&&(c[ks]=(r.translate!=="none"?"translate3d("+(r.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(r.rotate!=="none"?"rotate("+r.rotate+") ":"")+(r.scale!=="none"?"scale("+r.scale.split(" ").join(",")+") ":"")+(r[ks]!=="none"?r[ks]:"")),c.scale=c.rotate=c.translate="none"),zt=t0(t,l.svg),l.svg&&(l.uncache?(oe=t.getBBox(),E=l.xOrigin-oe.x+"px "+(l.yOrigin-oe.y)+"px",he=""):he=!i&&t.getAttribute("data-svg-origin"),lx(t,he||E,!!he||l.originIsAbsolute,l.smooth!==!1,zt)),bt=l.xOrigin||0,Ot=l.yOrigin||0,zt!==am&&(ee=zt[0],Wt=zt[1],ae=zt[2],ye=zt[3],C=He=zt[4],z=de=zt[5],zt.length===6?(j=Math.sqrt(ee*ee+Wt*Wt),G=Math.sqrt(ye*ye+ae*ae),W=ee||Wt?of(Wt,ee)*ld:0,ft=ae||ye?of(ae,ye)*ld+W:0,ft&&(G*=Math.abs(Math.cos(ft*bf))),l.svg&&(C-=bt-(bt*ee+Ot*ae),z-=Ot-(bt*Wt+Ot*ye))):(Xe=zt[6],Ve=zt[7],Ue=zt[8],$t=zt[9],ce=zt[10],je=zt[11],C=zt[12],z=zt[13],R=zt[14],Rt=of(Xe,ce),Q=Rt*ld,Rt&&(Bt=Math.cos(-Rt),Nt=Math.sin(-Rt),he=He*Bt+Ue*Nt,oe=de*Bt+$t*Nt,Oe=Xe*Bt+ce*Nt,Ue=He*-Nt+Ue*Bt,$t=de*-Nt+$t*Bt,ce=Xe*-Nt+ce*Bt,je=Ve*-Nt+je*Bt,He=he,de=oe,Xe=Oe),Rt=of(-ae,ce),rt=Rt*ld,Rt&&(Bt=Math.cos(-Rt),Nt=Math.sin(-Rt),he=ee*Bt-Ue*Nt,oe=Wt*Bt-$t*Nt,Oe=ae*Bt-ce*Nt,je=ye*Nt+je*Bt,ee=he,Wt=oe,ae=Oe),Rt=of(Wt,ee),W=Rt*ld,Rt&&(Bt=Math.cos(Rt),Nt=Math.sin(Rt),he=ee*Bt+Wt*Nt,oe=He*Bt+de*Nt,Wt=Wt*Bt-ee*Nt,de=de*Bt-He*Nt,ee=he,He=oe),Q&&Math.abs(Q)+Math.abs(W)>359.9&&(Q=W=0,rt=180-rt),j=Xs(Math.sqrt(ee*ee+Wt*Wt+ae*ae)),G=Xs(Math.sqrt(de*de+Xe*Xe)),Rt=of(He,de),ft=Math.abs(Rt)>2e-4?Rt*ld:0,mt=je?1/(je<0?-je:je):0),l.svg&&(he=t.getAttribute("transform"),l.forceCSS=t.setAttribute("transform","")||!BM(_l(t,ks)),he&&t.setAttribute("transform",he))),Math.abs(ft)>90&&Math.abs(ft)<270&&(d?(j*=-1,ft+=W<=0?180:-180,W+=W<=0?180:-180):(G*=-1,ft+=ft<=0?180:-180)),i=i||l.uncache,l.x=C-((l.xPercent=C&&(!i&&l.xPercent||(Math.round(t.offsetWidth/2)===Math.round(-C)?-50:0)))?t.offsetWidth*l.xPercent/100:0)+_,l.y=z-((l.yPercent=z&&(!i&&l.yPercent||(Math.round(t.offsetHeight/2)===Math.round(-z)?-50:0)))?t.offsetHeight*l.yPercent/100:0)+_,l.z=R+_,l.scaleX=Xs(j),l.scaleY=Xs(G),l.rotation=Xs(W)+v,l.rotationX=Xs(Q)+v,l.rotationY=Xs(rt)+v,l.skewX=ft+v,l.skewY=xt+v,l.transformPerspective=mt+_,(l.zOrigin=parseFloat(E.split(" ")[2])||!i&&l.zOrigin||0)&&(c[fa]=cg(E)),l.xOffset=l.yOffset=0,l.force3D=Ba.force3D,l.renderTransform=l.svg?lz:DM?FM:az,l.uncache=0,l},cg=function(t){return(t=t.split(" "))[0]+" "+t[1]},_v=function(t,i,l){var c=yo(i);return Xs(parseFloat(i)+parseFloat(bh(t,"x",l+"px",c)))+c},az=function(t,i){i.z="0px",i.rotationY=i.rotationX="0deg",i.force3D=0,FM(t,i)},td="0deg",yp="0px",ed=") ",FM=function(t,i){var l=i||this,c=l.xPercent,d=l.yPercent,_=l.x,v=l.y,r=l.z,E=l.rotation,C=l.rotationY,z=l.rotationX,R=l.skewX,j=l.skewY,G=l.scaleX,W=l.scaleY,Q=l.transformPerspective,rt=l.force3D,ft=l.target,xt=l.zOrigin,mt="",bt=rt==="auto"&&t&&t!==1||rt===!0;if(xt&&(z!==td||C!==td)){var Ot=parseFloat(C)*bf,zt=Math.sin(Ot),Rt=Math.cos(Ot),Bt;Ot=parseFloat(z)*bf,Bt=Math.cos(Ot),_=_v(ft,_,zt*Bt*-xt),v=_v(ft,v,-Math.sin(Ot)*-xt),r=_v(ft,r,Rt*Bt*-xt+xt)}Q!==yp&&(mt+="perspective("+Q+ed),(c||d)&&(mt+="translate("+c+"%, "+d+"%) "),(bt||_!==yp||v!==yp||r!==yp)&&(mt+=r!==yp||bt?"translate3d("+_+", "+v+", "+r+") ":"translate("+_+", "+v+ed),E!==td&&(mt+="rotate("+E+ed),C!==td&&(mt+="rotateY("+C+ed),z!==td&&(mt+="rotateX("+z+ed),(R!==td||j!==td)&&(mt+="skew("+R+", "+j+ed),(G!==1||W!==1)&&(mt+="scale("+G+", "+W+ed),ft.style[ks]=mt||"translate(0, 0)"},lz=function(t,i){var l=i||this,c=l.xPercent,d=l.yPercent,_=l.x,v=l.y,r=l.rotation,E=l.skewX,C=l.skewY,z=l.scaleX,R=l.scaleY,j=l.target,G=l.xOrigin,W=l.yOrigin,Q=l.xOffset,rt=l.yOffset,ft=l.forceCSS,xt=parseFloat(_),mt=parseFloat(v),bt,Ot,zt,Rt,Bt;r=parseFloat(r),E=parseFloat(E),C=parseFloat(C),C&&(C=parseFloat(C),E+=C,r+=C),r||E?(r*=bf,E*=bf,bt=Math.cos(r)*z,Ot=Math.sin(r)*z,zt=Math.sin(r-E)*-R,Rt=Math.cos(r-E)*R,E&&(C*=bf,Bt=Math.tan(E-C),Bt=Math.sqrt(1+Bt*Bt),zt*=Bt,Rt*=Bt,C&&(Bt=Math.tan(C),Bt=Math.sqrt(1+Bt*Bt),bt*=Bt,Ot*=Bt)),bt=Xs(bt),Ot=Xs(Ot),zt=Xs(zt),Rt=Xs(Rt)):(bt=z,Rt=R,Ot=zt=0),(xt&&!~(_+"").indexOf("px")||mt&&!~(v+"").indexOf("px"))&&(xt=bh(j,"x",_,"px"),mt=bh(j,"y",v,"px")),(G||W||Q||rt)&&(xt=Xs(xt+G-(G*bt+W*zt)+Q),mt=Xs(mt+W-(G*Ot+W*Rt)+rt)),(c||d)&&(Bt=j.getBBox(),xt=Xs(xt+c/100*Bt.width),mt=Xs(mt+d/100*Bt.height)),Bt="matrix("+bt+","+Ot+","+zt+","+Rt+","+xt+","+mt+")",j.setAttribute("transform",Bt),ft&&(j.style[ks]=Bt)},cz=function(t,i,l,c,d){var _=360,v=Nr(d),r=parseFloat(d)*(v&&~d.indexOf("rad")?ld:1),E=r-c,C=c+E+"deg",z,R;return v&&(z=d.split("_")[1],z==="short"&&(E%=_,E!==E%(_/2)&&(E+=E<0?_:-_)),z==="cw"&&E<0?E=(E+_*Ww)%_-~~(E/_)*_:z==="ccw"&&E>0&&(E=(E-_*Ww)%_-~~(E/_)*_)),t._pt=R=new da(t._pt,i,l,c,E,GD),R.e=C,R.u="deg",t._props.push(l),R},Yw=function(t,i){for(var l in i)t[l]=i[l];return t},uz=function(t,i,l){var c=Yw({},l._gsap),d="perspective,force3D,transformOrigin,svgOrigin",_=l.style,v,r,E,C,z,R,j,G;c.svg?(E=l.getAttribute("transform"),l.setAttribute("transform",""),_[ks]=i,v=lm(l,1),wd(l,ks),l.setAttribute("transform",E)):(E=getComputedStyle(l)[ks],_[ks]=i,v=lm(l,1),_[ks]=E);for(r in Ru)E=c[r],C=v[r],E!==C&&d.indexOf(r)<0&&(j=yo(E),G=yo(C),z=j!==G?bh(l,r,E,G):parseFloat(E),R=parseFloat(C),t._pt=new da(t._pt,v,r,z,R-z,rx),t._pt.u=G||0,t._props.push(r));Yw(v,c)};ha("padding,margin,Width,Radius",function(n,t){var i="Top",l="Right",c="Bottom",d="Left",_=(t<3?[i,l,c,d]:[i+d,i+l,c+l,c+d]).map(function(v){return t<2?n+v:"border"+v+n});lg[t>1?"border"+n:n]=function(v,r,E,C,z){var R,j;if(arguments.length<4)return R=_.map(function(G){return Mu(v,G,E)}),j=R.join(" "),j.split(R[0]).length===5?R[0]:j;R=(C+"").split(" "),j={},_.forEach(function(G,W){return j[G]=R[W]=R[W]||R[(W-1)/2|0]}),v.init(r,j,z)}});var NM={name:"css",register:ax,targetTest:function(t){return t.style&&t.nodeType},init:function(t,i,l,c,d){var _=this._props,v=t.style,r=l.vars.startAt,E,C,z,R,j,G,W,Q,rt,ft,xt,mt,bt,Ot,zt,Rt;Yx||ax(),this.styles=this.styles||LM(t),Rt=this.styles.props,this.tween=l;for(W in i)if(W!=="autoRound"&&(C=i[W],!(La[W]&&bM(W,i,l,c,t,d)))){if(j=typeof C,G=lg[W],j==="function"&&(C=C.call(l,c,t,d),j=typeof C),j==="string"&&~C.indexOf("random(")&&(C=sm(C)),G)G(this,t,W,C,l)&&(zt=1);else if(W.substr(0,2)==="--")E=(getComputedStyle(t).getPropertyValue(W)+"").trim(),C+="",_h.lastIndex=0,_h.test(E)||(Q=yo(E),rt=yo(C)),rt?Q!==rt&&(E=bh(t,W,E,rt)+rt):Q&&(C+=Q),this.add(v,"setProperty",E,C,c,d,0,0,W),_.push(W),Rt.push(W,0,v[W]);else if(j!=="undefined"){if(r&&W in r?(E=typeof r[W]=="function"?r[W].call(l,c,t,d):r[W],Nr(E)&&~E.indexOf("random(")&&(E=sm(E)),yo(E+"")||E==="auto"||(E+=Ba.units[W]||yo(Mu(t,W))||""),(E+"").charAt(1)==="="&&(E=Mu(t,W))):E=Mu(t,W),R=parseFloat(E),ft=j==="string"&&C.charAt(1)==="="&&C.substr(0,2),ft&&(C=C.substr(2)),z=parseFloat(C),W in Fc&&(W==="autoAlpha"&&(R===1&&Mu(t,"visibility")==="hidden"&&z&&(R=0),Rt.push("visibility",0,v.visibility),lh(this,v,"visibility",R?"inherit":"hidden",z?"inherit":"hidden",!z)),W!=="scale"&&W!=="transform"&&(W=Fc[W],~W.indexOf(",")&&(W=W.split(",")[0]))),xt=W in Ru,xt){if(this.styles.save(W),j==="string"&&C.substring(0,6)==="var(--"&&(C=_l(t,C.substring(4,C.indexOf(")"))),z=parseFloat(C)),mt||(bt=t._gsap,bt.renderTransform&&!i.parseTransform||lm(t,i.parseTransform),Ot=i.smoothOrigin!==!1&&bt.smooth,mt=this._pt=new da(this._pt,v,ks,0,1,bt.renderTransform,bt,0,-1),mt.dep=1),W==="scale")this._pt=new da(this._pt,bt,"scaleY",bt.scaleY,(ft?vf(bt.scaleY,ft+z):z)-bt.scaleY||0,rx),this._pt.u=0,_.push("scaleY",W),W+="X";else if(W==="transformOrigin"){Rt.push(fa,0,v[fa]),C=rz(C),bt.svg?lx(t,C,0,Ot,0,this):(rt=parseFloat(C.split(" ")[2])||0,rt!==bt.zOrigin&&lh(this,bt,"zOrigin",bt.zOrigin,rt),lh(this,v,W,cg(E),cg(C)));continue}else if(W==="svgOrigin"){lx(t,C,1,Ot,0,this);continue}else if(W in RM){cz(this,bt,W,R,ft?vf(R,ft+C):C);continue}else if(W==="smoothOrigin"){lh(this,bt,"smooth",bt.smooth,C);continue}else if(W==="force3D"){bt[W]=C;continue}else if(W==="transform"){uz(this,C,t);continue}}else W in v||(W=Af(W)||W);if(xt||(z||z===0)&&(R||R===0)&&!ZD.test(C)&&W in v)Q=(E+"").substr((R+"").length),z||(z=0),rt=yo(C)||(W in Ba.units?Ba.units[W]:Q),Q!==rt&&(R=bh(t,W,E,rt)),this._pt=new da(this._pt,xt?bt:v,W,R,(ft?vf(R,ft+z):z)-R,!xt&&(rt==="px"||W==="zIndex")&&i.autoRound!==!1?qD:rx),this._pt.u=rt||0,Q!==rt&&rt!=="%"&&(this._pt.b=E,this._pt.r=HD);else if(W in v)sz.call(this,t,W,E,ft?ft+C:C);else if(W in t)this.add(t,W,E||t[W],ft?ft+C:C,c,d);else if(W!=="parseTransform"){Vx(W,C);continue}xt||(W in v?Rt.push(W,0,v[W]):typeof t[W]=="function"?Rt.push(W,2,t[W]()):Rt.push(W,1,E||t[W])),_.push(W)}}zt&&CM(this)},render:function(t,i){if(i.tween._time||!Jx())for(var l=i._pt;l;)l.r(t,l.d),l=l._next;else i.styles.revert()},get:Mu,aliases:Fc,getSetter:function(t,i,l){var c=Fc[i];return c&&c.indexOf(",")<0&&(i=c),i in Ru&&i!==fa&&(t._gsap.x||Mu(t,"x"))?l&&$w===l?i==="scale"?JD:YD:($w=l||{})&&(i==="scale"?QD:tz):t.style&&!Fx(t.style[i])?XD:~i.indexOf("-")?KD:Xx(t,i)},core:{_removeProperty:wd,_getMatrix:t0}};pa.utils.checkPrefix=Af;pa.core.getStyleSaver=LM;(function(n,t,i,l){var c=ha(n+","+t+","+i,function(d){Ru[d]=1});ha(t,function(d){Ba.units[d]="deg",RM[d]=1}),Fc[c[13]]=n+","+t,ha(l,function(d){var _=d.split(":");Fc[_[1]]=c[_[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");ha("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(n){Ba.units[n]="px"});pa.registerPlugin(NM);var cx=pa.registerPlugin(NM)||pa;cx.core.Tween;const hz="/singatrainlogo.png",jM="singatrain-app-state";function dz(){if(typeof window>"u")return null;try{const n=window.localStorage.getItem(jM);return n?JSON.parse(n):null}catch{return null}}function gv(n){typeof window>"u"||window.localStorage.setItem(jM,JSON.stringify({favorites:n.favorites,user:n.user,darkMode:n.darkMode}))}const fz={name:"Guest User",email:"",memberSince:"",favorites:[]},yv=dz(),Tr=gm({activeTab:"dashboard",darkMode:yv?.darkMode??(typeof window>"u"||!window.matchMedia?!1:window.matchMedia("(prefers-color-scheme: dark)").matches),favorites:yv?.favorites??[],user:{...fz,...yv?.user||{}}});function bm(){const n=Er(()=>Tr.favorites.length);function t(r){Tr.activeTab=r}function i(r){Tr.darkMode=r,typeof document<"u"&&document.body.classList.toggle("dark-mode",r)}function l(){i(!Tr.darkMode)}function c(r){if(!r||!r.station)return;Tr.favorites.some(C=>C.station===r.station&&C.label===r.label)||Tr.favorites.push({...r})}function d(r){const E=Tr.favorites.findIndex(C=>C.station===r);E!==-1&&Tr.favorites.splice(E,1)}function _(){Tr.favorites.splice(0,Tr.favorites.length)}function v(r){Tr.user={...Tr.user,...r}}return qr(()=>Tr.darkMode,r=>{typeof document<"u"&&document.body.classList.toggle("dark-mode",r),gv(Tr)},{immediate:!0}),qr(()=>Tr.favorites,()=>gv(Tr),{deep:!0}),qr(()=>Tr.user,()=>gv(Tr),{deep:!0}),{state:Tr,favoritesCount:n,setActiveTab:t,setDarkMode:i,toggleDarkMode:l,addFavorite:c,removeFavorite:d,clearFavorites:_,updateUser:v}}const pz={class:"navbar navbar-expand-lg fixed-top premium-navbar"},mz={class:"container"},_z={class:"collapse navbar-collapse",id:"singatrainNav"},gz={class:"navbar-nav ms-auto mb-2 mb-lg-0"},yz=["onClick"],vz={class:"material-icons me-1 align-middle","aria-hidden":"true"},xz={class:"align-middle"},bz={class:"ms-lg-3 mt-3 mt-lg-0"},wz={class:"material-icons"},Tz={class:"toggle-label"},Ez={__name:"Navbar",setup(n){const t=[{key:"dashboard",label:"Dashboard",icon:"space_dashboard"},{key:"live",label:"Live Tracker",icon:"tram"},{key:"route",label:"Route Planner",icon:"alt_route"},{key:"fare",label:"Fare Calculator",icon:"payments"},{key:"meetup",label:"Meet-up",icon:"groups"},{key:"profile",label:"Profile",icon:"account_circle"},{key:"firstLast",label:"First & Last",icon:"schedule"}],{state:i,setActiveTab:l,toggleDarkMode:c}=bm();return(d,_)=>(Ye(),ii("nav",pz,[ht("div",mz,[ht("a",{class:"navbar-brand",href:"#",onClick:_[0]||(_[0]=md(v=>es(l)("dashboard"),["prevent"]))},[..._[2]||(_[2]=[ht("img",{src:hz,alt:"SingaTrain logo",class:"me-2",style:{height:"36px"}},null,-1),ht("span",null,"SingaTrain",-1)])]),_[3]||(_[3]=ht("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#singatrainNav","aria-controls":"singatrainNav","aria-expanded":"false","aria-label":"Toggle navigation"},[ht("span",{class:"material-icons"},"menu")],-1)),ht("div",_z,[ht("ul",gz,[(Ye(),ii(an,null,gs(t,v=>ht("li",{key:v.key,class:"nav-item"},[ht("a",{href:"#",class:$c(["nav-link",{active:es(i).activeTab===v.key}]),onClick:md(r=>es(l)(v.key),["prevent"])},[ht("span",vz,Ge(v.icon),1),ht("span",xz,Ge(v.label),1)],10,yz)])),64))]),ht("div",bz,[ht("button",{id:"themeToggle",class:$c(["theme-toggle",{active:es(i).darkMode}]),type:"button",onClick:_[1]||(_[1]=v=>es(c)())},[ht("span",wz,Ge(es(i).darkMode?"light_mode":"dark_mode"),1),ht("span",Tz,Ge(es(i).darkMode?"Day Mode":"Night Mode"),1)],2)])])])]))}},Sz="/MRT-Map.png",ch={NSL:["Jurong East","Bukit Batok","Bukit Gombak","Choa Chu Kang","Yew Tee","Kranji","Marsiling","Woodlands","Admiralty","Sembawang","Canberra","Yishun","Khatib","Yio Chu Kang","Ang Mo Kio","Bishan","Braddell","Toa Payoh","Novena","Newton","Orchard","Somerset","Dhoby Ghaut","City Hall","Raffles Place","Marina Bay","Marina South Pier"],EWL:["Pasir Ris","Tampines","Simei","Tanah Merah","Bedok","Kembangan","Eunos","Paya Lebar","Aljunied","Kallang","Lavender","Bugis","City Hall","Raffles Place","Tanjong Pagar","Outram Park","Tiong Bahru","Redhill","Queenstown","Commonwealth","Buona Vista","Dover","Clementi","Jurong East","Chinese Garden","Lakeside","Boon Lay","Pioneer","Joo Koon","Gul Circle","Tuas Crescent","Tuas West Road","Tuas Link"],CGL:["Tanah Merah","Expo","Changi Airport"],DTL:["Bukit Panjang","Cashew","Hillview","Beauty World","King Albert Park","Sixth Avenue","Tan Kah Kee","Botanic Gardens","Stevens","Newton","Little India","Rochor","Bugis","Promenade","Bayfront","Downtown","Telok Ayer","Chinatown","Fort Canning","Bencoolen","Jalan Besar","Bendemeer","Geylang Bahru","Mattar","MacPherson","Ubi","Kaki Bukit","Bedok North","Bedok Reservoir","Tampines West","Tampines","Tampines East","Upper Changi","Expo"],CCL:["Dhoby Ghaut","Bras Basah","Esplanade","Promenade","Bayfront","Nicoll Highway","Stadium","Mountbatten","Dakota","Paya Lebar","MacPherson","Tai Seng","Bartley","Serangoon","Lorong Chuan","Bishan","Marymount","Caldecott","Botanic Gardens","Farrer Road","Holland Village","Buona Vista","one-north","Kent Ridge","Haw Par Villa","Pasir Panjang","Labrador Park","Telok Blangah","HarbourFront"],NEL:["HarbourFront","Outram Park","Chinatown","Clarke Quay","Dhoby Ghaut","Little India","Farrer Park","Boon Keng","Potong Pasir","Woodleigh","Serangoon","Kovan","Hougang","Buangkok","Sengkang","Punggol","Punggol Coast"],TEL:["Woodlands North","Woodlands","Woodlands South","Springleaf","Lentor","Mayflower","Bright Hill","Upper Thomson","Caldecott","Stevens","Napier","Orchard Boulevard","Orchard","Great World","Havelock","Outram Park","Maxwell","Shenton Way","Marina Bay","Gardens By The Bay","Tanjong Rhu","Katong Park","Tanjong Katong","Marine Parade","Marine Terrace","Siglap","Bayshore"],BPL:["Choa Chu Kang","South View","Keat Hong","Teck Whye","Phoenix","Bukit Panjang","Petir","Pending","Bangkit","Fajar","Segar","Jelapang","Senja"],SWPL:["Sengkang","Cheng Lim","Farmway","Kupang","Thanggam","Fernvale","Layar","Tongkang","Renjong"],SEPL:["Sengkang","Compassvale","Rumbia","Bakau","Kangkar","Ranggung"],PEPLRT:["Punggol","Cove","Meridian","Coral Edge","Riviera","Kadaloor","Oasis","Damai"],PWLRT:["Punggol","Sam Kee","Punggol Point","Samudera","Nibong","Sumang","Soo Teck"]},Mz=[...new Set(Object.values(ch).flat())].sort((n,t)=>n.localeCompare(t)),N_={Bishan:["North-South Line","Circle Line"],"Dhoby Ghaut":["North-South Line","North-East Line","Circle Line"],"Jurong East":["North-South Line","East-West Line","Jurong Region Line"],"Marina Bay":["North-South Line","Circle Line","Thomson-East Coast Line"],Woodlands:["North-South Line","Thomson-East Coast Line"],"Paya Lebar":["East-West Line","Circle Line"],HarbourFront:["North-East Line","Circle Line"]},Cz={"North-South Line":"#d42e12","East-West Line":"#009645","Circle Line":"#fa9e0d","Downtown Line":"#005ec4","North-East Line":"#9900aa","Thomson-East Coast Line":"#9d5b25","Jurong Region Line":"#00a0a8","LRT Line":"#748477"},p_=[{station:"Marina Bay",line:"North-South Line"},{station:"Paya Lebar",line:"Circle Line"},{station:"Woodlands",line:"Thomson-East Coast Line"},{station:"Dhoby Ghaut",line:"North-East Line"},{station:"Jurong East",line:"East-West Line"}],Az=5e3,Pz={default:{peak:[60,180],shoulder:[120,240],offPeak:[180,360]}},Jw={enabled:!0,probability:.2,checkEvery:4,durationRangeSeconds:[180,300]};function j_(n,t){return Math.floor(Math.random()*(t-n+1))+n}function kz(n,t,i){const l=n[t]||n.default,c=l[i]||l.offPeak||n.default.offPeak;return Array.isArray(c)?c:n.default.offPeak}function vv(n=new Date){const t=n.getHours();return t>=7&&t<9||t>=17&&t<20?"peak":t>=6&&t<7||t>=9&&t<11||t>=16&&t<17||t>=20&&t<22?"shoulder":"offPeak"}function xv(n,t,i,l){const[c,d]=kz(n,t,l),_=j_(c,d);return i+_}function df(n){return Cz[n]||"#6b7280"}function VM(n={}){const t={stationLines:N_,lineIntervals:Pz,updateIntervalMs:3e4,trainsPerLine:3,delay:{...Jw},...n,delay:{...Jw,...n.delay||{}}},i={arrivals:{},delayFlags:{},cycles:0,intervalId:null};function l(j,G){i.arrivals[j]||(i.arrivals[j]={}),Array.isArray(i.arrivals[j][G])||(i.arrivals[j][G]=[])}function c(j,G){l(j,G);const W=i.arrivals[j][G];W.length=0;let Q=0;const rt=vv();for(let ft=0;ft<t.trainsPerLine;ft+=1)Q=xv(t.lineIntervals,G,Q,rt),W.push(Q)}function d(){Object.entries(t.stationLines).forEach(([j,G])=>{G.forEach(W=>{l(j,W);const Q=i.arrivals[j][W];if(!Q.length)c(j,W);else for(;Q.length<t.trainsPerLine;){const rt=Q[Q.length-1]||0;Q.push(xv(t.lineIntervals,W,rt,vv()))}})})}function _(j=Date.now()){Object.keys(i.delayFlags).forEach(G=>{const W=i.delayFlags[G];W&&(Object.keys(W).forEach(Q=>{W[Q]<j&&delete W[Q]}),Object.keys(W).length||delete i.delayFlags[G])})}function v(){if(!t.delay.enabled||i.cycles%t.delay.checkEvery!==0||Math.random()>t.delay.probability)return;const j=Object.keys(i.arrivals);if(!j.length)return;const G=j[j_(0,j.length-1)],W=Object.keys(i.arrivals[G]||{});if(!W.length)return;const Q=W[j_(0,W.length-1)],rt=i.arrivals[G][Q];if(!rt?.length)return;const[ft,xt]=t.delay.durationRangeSeconds,mt=j_(ft,xt);for(let bt=0;bt<rt.length;bt+=1)rt[bt]+=mt;i.delayFlags[G]||(i.delayFlags[G]={}),i.delayFlags[G][Q]=Date.now()+mt*1e3}function r(){i.cycles+=1;const j=t.updateIntervalMs/1e3;_(),Object.entries(i.arrivals).forEach(([G,W])=>{Object.entries(W).forEach(([Q,rt])=>{for(let ft=0;ft<rt.length;ft+=1)rt[ft]=Math.max(0,rt[ft]-j);for(;rt.length&&rt[0]<=0;)rt.shift();for(;rt.length<t.trainsPerLine;){const ft=rt.length?rt[rt.length-1]:0;rt.push(xv(t.lineIntervals,Q,ft,vv()))}})}),v()}function E(){d(),i.intervalId===null&&(i.intervalId=setInterval(r,t.updateIntervalMs),r())}function C(){i.intervalId!==null&&(clearInterval(i.intervalId),i.intervalId=null)}function z({returnSeconds:j=!1}={}){const G={};return Object.entries(i.arrivals).forEach(([W,Q])=>{G[W]={},Object.entries(Q).forEach(([rt,ft])=>{G[W][rt]=ft.map(xt=>j?Math.max(0,Math.round(xt)):Math.max(0,Math.ceil(xt/60)))})}),G}function R(j){return z()[j]||{}}return{config:t,start:E,stop:C,refresh:r,getArrivals:z,getStationArrivals:R}}const Iz={class:"dashboard-view"},Lz={class:"hero row align-items-center gy-5"},Dz={class:"col-lg-6 hero-intro","data-aos":"fade-up"},zz={class:"hero-cta"},Oz={class:"live-tools mt-5","data-aos":"fade-up","data-aos-delay":"150"},Rz={class:"ticker-station d-flex align-items-center gap-2"},Bz={class:"ticker-line text-muted mt-1"},Fz={class:"live-clock"},Nz={class:"ticker-times"},jz={key:0,class:"text-muted small"},Vz={class:"row g-4 mt-4"},Uz={class:"col-lg-6","data-aos":"fade-up","data-aos-delay":"250"},$z={class:"section-card h-100"},Wz={class:"list-unstyled mt-3"},Zz={key:0,class:"text-muted"},Gz={class:"fw-semibold"},Hz={class:"text-muted small"},qz=["onClick"],Xz={class:"col-lg-6","data-aos":"fade-up","data-aos-delay":"350"},Kz={class:"section-card h-100"},Qw={__name:"Dashboard",setup(n){const t=VM({updateIntervalMs:1e3}),i=gm({index:0,station:p_[0],arrivals:[],lineColor:df(p_[0].line)}),l=Yi("--:--:--"),c=Yi(null),d=Yi(null),{state:_,setActiveTab:v,removeFavorite:r}=bm(),E=Er(()=>_.favorites);function C(j){return j<=0?"Arriving":j<60?"<1 min":`${Math.ceil(j/60)} min`}function z(j=!1){j||(i.index=(i.index+1)%p_.length),i.station=p_[i.index],i.lineColor=df(i.station.line);const G=t.getStationArrivals(i.station.station);i.arrivals=(G?.[i.station.line]||[]).slice(0,3)}function R(){const j=new Date;l.value=j.toLocaleTimeString(void 0,{hour12:!1})}return Md(()=>{t.start(),z(!0),R(),c.value=window.setInterval(()=>z(!1),Az),d.value=window.setInterval(R,1e3)}),Cd(()=>{t.stop(),c.value&&(clearInterval(c.value),c.value=null),d.value&&(clearInterval(d.value),d.value=null)}),(j,G)=>(Ye(),ii("section",Iz,[ht("div",Lz,[ht("div",Dz,[G[5]||(G[5]=ht("h1",{class:"mb-3"},"Singapores smartest commute companion.",-1)),G[6]||(G[6]=ht("p",null," Plan, monitor, and optimise every MRT journey with live arrivals, disruption-aware routing, fare insights, and collaborative meet-up tools  all in one polished interface. ",-1)),ht("div",zz,[ht("button",{class:"btn btn-primary px-4 py-3 hover-float",onClick:G[0]||(G[0]=W=>es(v)("live"))},[...G[3]||(G[3]=[ht("span",{class:"material-icons me-2"},"tram",-1),sn(" Live Tracker ",-1)])]),ht("button",{class:"btn btn-outline-danger px-4 py-3 hover-float",onClick:G[1]||(G[1]=W=>es(v)("route"))},[...G[4]||(G[4]=[ht("span",{class:"material-icons me-2"},"alt_route",-1),sn(" Plan a Route ",-1)])])])]),G[7]||(G[7]=ht("div",{class:"col-lg-6 hero-illustration text-center","data-aos":"fade-left"},[ht("img",{src:Sz,alt:"SingaTrain map illustration",class:"img-fluid rounded-4 shadow"})],-1))]),ht("div",Oz,[ht("div",{class:"live-ticker-card w-100",style:fl({borderColor:i.lineColor})},[ht("div",null,[G[9]||(G[9]=ht("div",{class:"ticker-label text-uppercase fw-semibold"},"Next arrivals",-1)),ht("div",Rz,[G[8]||(G[8]=ht("span",{class:"material-icons text-danger"},"ev_station",-1)),ht("span",null,Ge(i.station?.station),1)]),ht("div",Bz,[ht("span",{class:"material-icons",style:fl({color:i.lineColor})},"timeline",4),sn(" "+Ge(i.station?.line),1)])]),ht("div",Fz,[ht("span",null,Ge(l.value),1)]),ht("div",Nz,[(Ye(!0),ii(an,null,gs(i.arrivals,(W,Q)=>(Ye(),ii("span",{key:Q,class:"ticker-pill",style:fl({borderColor:i.lineColor,color:i.lineColor})},[G[10]||(G[10]=ht("span",{class:"material-icons"},"train",-1)),sn(" "+Ge(C(W)),1)],4))),128)),i.arrivals.length?cr("",!0):(Ye(),ii("span",jz,"Fetching arrivals"))])],4)]),ht("div",Vz,[ht("div",Uz,[ht("div",$z,[G[13]||(G[13]=ht("h2",{class:"section-title mb-3"},"Personalised commute",-1)),G[14]||(G[14]=ht("p",{class:"text-muted"}," Your favourite stations are pinned across dashboards, live tracking, and route planning for quick access wherever you roam. ",-1)),ht("ul",Wz,[E.value.length?cr("",!0):(Ye(),ii("li",Zz,[...G[11]||(G[11]=[ht("span",{class:"material-icons me-2 align-middle"},"star_border",-1),sn(" Add favourites from the Live Tracker to see them here. ",-1)])])),(Ye(!0),ii(an,null,gs(E.value,W=>(Ye(),ii("li",{key:W.station,class:"d-flex align-items-center gap-3 py-2 border-bottom"},[G[12]||(G[12]=ht("span",{class:"material-icons text-danger"},"star_rate",-1)),ht("div",null,[ht("div",Gz,Ge(W.label||W.station),1),ht("div",Hz,Ge(W.station),1)]),ht("button",{class:"btn btn-sm btn-outline-danger ms-auto",onClick:Q=>es(r)(W.station)}," Remove ",8,qz)]))),128))])])]),ht("div",Xz,[ht("div",Kz,[G[16]||(G[16]=D_('<h2 class="section-title mb-3">Whats popular now</h2><ul class="list-unstyled mb-0"><li class="d-flex align-items-center gap-3 py-2 border-bottom"><span class="material-icons text-primary">flash_on</span><div><div class="fw-semibold">Dynamic route visualiser</div><div class="text-muted small">Leaflet-powered map with transfer-aware walking times.</div></div></li><li class="d-flex align-items-center gap-3 py-2 border-bottom"><span class="material-icons text-success">insights</span><div><div class="fw-semibold">Fare insights</div><div class="text-muted small">Distance-based fares + monthly pass break-even analysis.</div></div></li><li class="d-flex align-items-center gap-3 py-2"><span class="material-icons text-warning">diversity_3</span><div><div class="fw-semibold">Meet halfway</div><div class="text-muted small">Suggests the fairest interchange for your group in seconds.</div></div></li></ul>',2)),ht("button",{class:"btn btn-primary mt-3 w-100",onClick:G[2]||(G[2]=W=>es(v)("meetup"))},[...G[15]||(G[15]=[ht("span",{class:"material-icons me-2"},"groups",-1),sn(" Try the Meet-up Planner ",-1)])])])])])]))}},Yz={class:"section-card"},Jz={class:"row g-3"},Qz={class:"col-md-6"},tO=["value"],eO={class:"col-md-6"},iO=["value"],nO={class:"live-tools mt-4"},sO={class:"ticker-station d-flex align-items-center gap-2"},rO={class:"ticker-line text-muted mt-1"},oO={class:"material-icons"},aO={class:"ticker-times"},lO={key:0,class:"text-muted small"},cO={class:"mt-4"},uO={class:"mb-3"},hO={class:"arrival-details"},dO={class:"d-flex justify-content-between align-items-center"},fO={class:"countdown"},pO={class:"progress-bar"},mO={class:"d-flex gap-2 mt-2 flex-wrap"},_O={__name:"LiveTracker",setup(n){const t=VM({updateIntervalMs:1e3}),i=Yi(null),l=Object.keys(N_),c=Yi(l[0]),d=Yi(N_[c.value][0]),_=Yi([]),{addFavorite:v}=bm(),r=Er(()=>N_[c.value]||[]),E=Er(()=>{const rt=_.value.find(ft=>ft.name===d.value);return rt?rt.times:[]}),C=Er(()=>df(d.value)),z=Er(()=>{const rt=E.value[0]??1/0;return rt<=60?"Arriving":rt<=240?"On Time":rt<=420?"Slight delay":"Delayed"}),R=Er(()=>{switch(z.value){case"Arriving":return"status-arriving";case"On Time":return"status-on-time";case"Slight delay":return"status-departing";default:return"status-delayed"}}),j=Er(()=>{switch(z.value){case"Arriving":return"directions_subway";case"On Time":return"check_circle";case"Slight delay":return"schedule";default:return"error"}});function G(rt){return rt<=0?"Arriving":rt<60?"<1 min":`${Math.ceil(rt/60)} min`}function W(){const rt=t.getStationArrivals(c.value);_.value=Object.entries(rt).map(([ft,xt])=>({name:ft,times:xt,progress:xt.length?Math.max(0,1-Math.min(xt[0],600)/600):0}))}function Q(){v({station:c.value,label:`${c.value}  ${d.value}`})}return qr(c,()=>{const rt=r.value;rt.length&&!rt.includes(d.value)&&(d.value=rt[0]),W()}),qr(d,W),Md(()=>{t.start(),W(),i.value=window.setInterval(W,1e3)}),Cd(()=>{t.stop(),i.value&&(clearInterval(i.value),i.value=null)}),(rt,ft)=>(Ye(),ii("section",Yz,[ht("div",{class:"d-flex flex-wrap justify-content-between align-items-center gap-3 mb-4"},[ft[4]||(ft[4]=ht("div",null,[ht("h2",{class:"section-title mb-1"},"Live Train Tracker"),ht("p",{class:"text-muted mb-0"}," Simulated real-time arrivals with per-line intervals and probabilistic delays. Switch stations to monitor your regular journeys. ")],-1)),ht("div",{class:"d-flex gap-2"},[ht("button",{class:"btn btn-outline-danger hover-float",onClick:W},[...ft[2]||(ft[2]=[ht("span",{class:"material-icons me-1"},"refresh",-1),sn(" Refresh ",-1)])]),ht("button",{class:"btn btn-primary hover-float",onClick:Q},[...ft[3]||(ft[3]=[ht("span",{class:"material-icons me-1"},"star",-1),sn(" Add Favourite ",-1)])])])]),ht("div",Jz,[ht("div",Qz,[ft[5]||(ft[5]=ht("label",{class:"form-label"},"Station",-1)),ar(ht("select",{"onUpdate:modelValue":ft[0]||(ft[0]=xt=>c.value=xt),class:"form-select"},[(Ye(!0),ii(an,null,gs(es(l),xt=>(Ye(),ii("option",{key:xt,value:xt},Ge(xt),9,tO))),128))],512),[[jc,c.value]])]),ht("div",eO,[ft[6]||(ft[6]=ht("label",{class:"form-label"},"Line",-1)),ar(ht("select",{"onUpdate:modelValue":ft[1]||(ft[1]=xt=>d.value=xt),class:"form-select"},[(Ye(!0),ii(an,null,gs(r.value,xt=>(Ye(),ii("option",{key:xt,value:xt},Ge(xt),9,iO))),128))],512),[[jc,d.value]])])]),ht("div",nO,[ht("div",{class:"live-ticker-card w-100",style:fl({borderColor:C.value})},[ht("div",null,[ft[8]||(ft[8]=ht("div",{class:"ticker-label"},"Monitoring",-1)),ht("div",sO,[ft[7]||(ft[7]=ht("span",{class:"material-icons text-danger"},"location_on",-1)),ht("span",null,Ge(c.value),1)]),ht("div",rO,[ht("span",{class:"material-icons",style:fl({color:C.value})},"timeline",4),sn(" "+Ge(d.value),1)])]),ht("div",null,[ft[9]||(ft[9]=ht("div",{class:"small text-muted text-uppercase fw-semibold mb-1"},"Status",-1)),ht("span",{class:$c(["status-pill",R.value])},[ht("span",oO,Ge(j.value),1),sn(" "+Ge(z.value),1)],2)]),ht("div",aO,[(Ye(!0),ii(an,null,gs(E.value,(xt,mt)=>(Ye(),ii("span",{key:mt,class:"ticker-pill",style:fl({borderColor:C.value,color:C.value})},[ft[10]||(ft[10]=ht("span",{class:"material-icons"},"train",-1)),sn(" "+Ge(G(xt)),1)],4))),128)),E.value.length?cr("",!0):(Ye(),ii("span",lO,"Awaiting updates"))])],4)]),ht("div",cO,[ht("h5",uO,"All arrivals at "+Ge(c.value),1),(Ye(!0),ii(an,null,gs(_.value,xt=>(Ye(),ii("div",{class:"arrival-row",key:xt.name},[ht("div",{class:"train-icon",style:fl({color:es(df)(xt.name)})},[...ft[11]||(ft[11]=[ht("span",{class:"material-icons"},"subway",-1)])],4),ht("div",hO,[ht("div",dO,[ht("strong",null,Ge(xt.name),1),ht("span",fO,Ge(G(xt.times[0]??0)),1)]),ht("div",pO,[ht("div",{class:"progress-fill",style:fl({background:es(df)(xt.name),transform:`scaleX(${xt.progress})`})},null,4),ht("div",{class:"progress-glow",style:fl({background:es(df)(xt.name)})},null,4)]),ht("div",mO,[(Ye(!0),ii(an,null,gs(xt.times.slice(0,3),(mt,bt)=>(Ye(),ii("span",{class:"pill",key:bt},Ge(G(mt)),1))),128))])])]))),128))])]))}};var Pp={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var gO=Pp.exports,tT;function yO(){return tT||(tT=1,(function(n,t){(function(i,l){l(t)})(gO,(function(i){var l="1.9.4";function c(f){var x,A,F,q;for(A=1,F=arguments.length;A<F;A++){q=arguments[A];for(x in q)f[x]=q[x]}return f}var d=Object.create||(function(){function f(){}return function(x){return f.prototype=x,new f}})();function _(f,x){var A=Array.prototype.slice;if(f.bind)return f.bind.apply(f,A.call(arguments,1));var F=A.call(arguments,2);return function(){return f.apply(x,F.length?F.concat(A.call(arguments)):arguments)}}var v=0;function r(f){return"_leaflet_id"in f||(f._leaflet_id=++v),f._leaflet_id}function E(f,x,A){var F,q,ot,Pt;return Pt=function(){F=!1,q&&(ot.apply(A,q),q=!1)},ot=function(){F?q=arguments:(f.apply(A,arguments),setTimeout(Pt,x),F=!0)},ot}function C(f,x,A){var F=x[1],q=x[0],ot=F-q;return f===F&&A?f:((f-q)%ot+ot)%ot+q}function z(){return!1}function R(f,x){if(x===!1)return f;var A=Math.pow(10,x===void 0?6:x);return Math.round(f*A)/A}function j(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function G(f){return j(f).split(/\s+/)}function W(f,x){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?d(f.options):{});for(var A in x)f.options[A]=x[A];return f.options}function Q(f,x,A){var F=[];for(var q in f)F.push(encodeURIComponent(A?q.toUpperCase():q)+"="+encodeURIComponent(f[q]));return(!x||x.indexOf("?")===-1?"?":"&")+F.join("&")}var rt=/\{ *([\w_ -]+) *\}/g;function ft(f,x){return f.replace(rt,function(A,F){var q=x[F];if(q===void 0)throw new Error("No value provided for variable "+A);return typeof q=="function"&&(q=q(x)),q})}var xt=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function mt(f,x){for(var A=0;A<f.length;A++)if(f[A]===x)return A;return-1}var bt="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Ot(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var zt=0;function Rt(f){var x=+new Date,A=Math.max(0,16-(x-zt));return zt=x+A,window.setTimeout(f,A)}var Bt=window.requestAnimationFrame||Ot("RequestAnimationFrame")||Rt,Nt=window.cancelAnimationFrame||Ot("CancelAnimationFrame")||Ot("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function ee(f,x,A){if(A&&Bt===Rt)f.call(x);else return Bt.call(window,_(f,x))}function Wt(f){f&&Nt.call(window,f)}var ae={__proto__:null,extend:c,create:d,bind:_,get lastId(){return v},stamp:r,throttle:E,wrapNum:C,falseFn:z,formatNum:R,trim:j,splitWords:G,setOptions:W,getParamString:Q,template:ft,isArray:xt,indexOf:mt,emptyImageUrl:bt,requestFn:Bt,cancelFn:Nt,requestAnimFrame:ee,cancelAnimFrame:Wt};function ye(){}ye.extend=function(f){var x=function(){W(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},A=x.__super__=this.prototype,F=d(A);F.constructor=x,x.prototype=F;for(var q in this)Object.prototype.hasOwnProperty.call(this,q)&&q!=="prototype"&&q!=="__super__"&&(x[q]=this[q]);return f.statics&&c(x,f.statics),f.includes&&(He(f.includes),c.apply(null,[F].concat(f.includes))),c(F,f),delete F.statics,delete F.includes,F.options&&(F.options=A.options?d(A.options):{},c(F.options,f.options)),F._initHooks=[],F.callInitHooks=function(){if(!this._initHooksCalled){A.callInitHooks&&A.callInitHooks.call(this),this._initHooksCalled=!0;for(var ot=0,Pt=F._initHooks.length;ot<Pt;ot++)F._initHooks[ot].call(this)}},x},ye.include=function(f){var x=this.prototype.options;return c(this.prototype,f),f.options&&(this.prototype.options=x,this.mergeOptions(f.options)),this},ye.mergeOptions=function(f){return c(this.prototype.options,f),this},ye.addInitHook=function(f){var x=Array.prototype.slice.call(arguments,1),A=typeof f=="function"?f:function(){this[f].apply(this,x)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(A),this};function He(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=xt(f)?f:[f];for(var x=0;x<f.length;x++)f[x]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var de={on:function(f,x,A){if(typeof f=="object")for(var F in f)this._on(F,f[F],x);else{f=G(f);for(var q=0,ot=f.length;q<ot;q++)this._on(f[q],x,A)}return this},off:function(f,x,A){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var F in f)this._off(F,f[F],x);else{f=G(f);for(var q=arguments.length===1,ot=0,Pt=f.length;ot<Pt;ot++)q?this._off(f[ot]):this._off(f[ot],x,A)}return this},_on:function(f,x,A,F){if(typeof x!="function"){console.warn("wrong listener type: "+typeof x);return}if(this._listens(f,x,A)===!1){A===this&&(A=void 0);var q={fn:x,ctx:A};F&&(q.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(q)}},_off:function(f,x,A){var F,q,ot;if(this._events&&(F=this._events[f],!!F)){if(arguments.length===1){if(this._firingCount)for(q=0,ot=F.length;q<ot;q++)F[q].fn=z;delete this._events[f];return}if(typeof x!="function"){console.warn("wrong listener type: "+typeof x);return}var Pt=this._listens(f,x,A);if(Pt!==!1){var Yt=F[Pt];this._firingCount&&(Yt.fn=z,this._events[f]=F=F.slice()),F.splice(Pt,1)}}},fire:function(f,x,A){if(!this.listens(f,A))return this;var F=c({},x,{type:f,target:this,sourceTarget:x&&x.sourceTarget||this});if(this._events){var q=this._events[f];if(q){this._firingCount=this._firingCount+1||1;for(var ot=0,Pt=q.length;ot<Pt;ot++){var Yt=q[ot],ue=Yt.fn;Yt.once&&this.off(f,ue,Yt.ctx),ue.call(Yt.ctx||this,F)}this._firingCount--}}return A&&this._propagateEvent(F),this},listens:function(f,x,A,F){typeof f!="string"&&console.warn('"string" type argument expected');var q=x;typeof x!="function"&&(F=!!x,q=void 0,A=void 0);var ot=this._events&&this._events[f];if(ot&&ot.length&&this._listens(f,q,A)!==!1)return!0;if(F){for(var Pt in this._eventParents)if(this._eventParents[Pt].listens(f,x,A,F))return!0}return!1},_listens:function(f,x,A){if(!this._events)return!1;var F=this._events[f]||[];if(!x)return!!F.length;A===this&&(A=void 0);for(var q=0,ot=F.length;q<ot;q++)if(F[q].fn===x&&F[q].ctx===A)return q;return!1},once:function(f,x,A){if(typeof f=="object")for(var F in f)this._on(F,f[F],x,!0);else{f=G(f);for(var q=0,ot=f.length;q<ot;q++)this._on(f[q],x,A,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[r(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[r(f)],this},_propagateEvent:function(f){for(var x in this._eventParents)this._eventParents[x].fire(f.type,c({layer:f.target,propagatedFrom:f.target},f),!0)}};de.addEventListener=de.on,de.removeEventListener=de.clearAllEventListeners=de.off,de.addOneTimeEventListener=de.once,de.fireEvent=de.fire,de.hasEventListeners=de.listens;var he=ye.extend(de);function oe(f,x,A){this.x=A?Math.round(f):f,this.y=A?Math.round(x):x}var Oe=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};oe.prototype={clone:function(){return new oe(this.x,this.y)},add:function(f){return this.clone()._add(Ue(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(Ue(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new oe(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new oe(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Oe(this.x),this.y=Oe(this.y),this},distanceTo:function(f){f=Ue(f);var x=f.x-this.x,A=f.y-this.y;return Math.sqrt(x*x+A*A)},equals:function(f){return f=Ue(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=Ue(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+R(this.x)+", "+R(this.y)+")"}};function Ue(f,x,A){return f instanceof oe?f:xt(f)?new oe(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new oe(f.x,f.y):new oe(f,x,A)}function $t(f,x){if(f)for(var A=x?[f,x]:f,F=0,q=A.length;F<q;F++)this.extend(A[F])}$t.prototype={extend:function(f){var x,A;if(!f)return this;if(f instanceof oe||typeof f[0]=="number"||"x"in f)x=A=Ue(f);else if(f=ce(f),x=f.min,A=f.max,!x||!A)return this;return!this.min&&!this.max?(this.min=x.clone(),this.max=A.clone()):(this.min.x=Math.min(x.x,this.min.x),this.max.x=Math.max(A.x,this.max.x),this.min.y=Math.min(x.y,this.min.y),this.max.y=Math.max(A.y,this.max.y)),this},getCenter:function(f){return Ue((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return Ue(this.min.x,this.max.y)},getTopRight:function(){return Ue(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var x,A;return typeof f[0]=="number"||f instanceof oe?f=Ue(f):f=ce(f),f instanceof $t?(x=f.min,A=f.max):x=A=f,x.x>=this.min.x&&A.x<=this.max.x&&x.y>=this.min.y&&A.y<=this.max.y},intersects:function(f){f=ce(f);var x=this.min,A=this.max,F=f.min,q=f.max,ot=q.x>=x.x&&F.x<=A.x,Pt=q.y>=x.y&&F.y<=A.y;return ot&&Pt},overlaps:function(f){f=ce(f);var x=this.min,A=this.max,F=f.min,q=f.max,ot=q.x>x.x&&F.x<A.x,Pt=q.y>x.y&&F.y<A.y;return ot&&Pt},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var x=this.min,A=this.max,F=Math.abs(x.x-A.x)*f,q=Math.abs(x.y-A.y)*f;return ce(Ue(x.x-F,x.y-q),Ue(A.x+F,A.y+q))},equals:function(f){return f?(f=ce(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function ce(f,x){return!f||f instanceof $t?f:new $t(f,x)}function Ve(f,x){if(f)for(var A=x?[f,x]:f,F=0,q=A.length;F<q;F++)this.extend(A[F])}Ve.prototype={extend:function(f){var x=this._southWest,A=this._northEast,F,q;if(f instanceof Xe)F=f,q=f;else if(f instanceof Ve){if(F=f._southWest,q=f._northEast,!F||!q)return this}else return f?this.extend(ri(f)||je(f)):this;return!x&&!A?(this._southWest=new Xe(F.lat,F.lng),this._northEast=new Xe(q.lat,q.lng)):(x.lat=Math.min(F.lat,x.lat),x.lng=Math.min(F.lng,x.lng),A.lat=Math.max(q.lat,A.lat),A.lng=Math.max(q.lng,A.lng)),this},pad:function(f){var x=this._southWest,A=this._northEast,F=Math.abs(x.lat-A.lat)*f,q=Math.abs(x.lng-A.lng)*f;return new Ve(new Xe(x.lat-F,x.lng-q),new Xe(A.lat+F,A.lng+q))},getCenter:function(){return new Xe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Xe(this.getNorth(),this.getWest())},getSouthEast:function(){return new Xe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof Xe||"lat"in f?f=ri(f):f=je(f);var x=this._southWest,A=this._northEast,F,q;return f instanceof Ve?(F=f.getSouthWest(),q=f.getNorthEast()):F=q=f,F.lat>=x.lat&&q.lat<=A.lat&&F.lng>=x.lng&&q.lng<=A.lng},intersects:function(f){f=je(f);var x=this._southWest,A=this._northEast,F=f.getSouthWest(),q=f.getNorthEast(),ot=q.lat>=x.lat&&F.lat<=A.lat,Pt=q.lng>=x.lng&&F.lng<=A.lng;return ot&&Pt},overlaps:function(f){f=je(f);var x=this._southWest,A=this._northEast,F=f.getSouthWest(),q=f.getNorthEast(),ot=q.lat>x.lat&&F.lat<A.lat,Pt=q.lng>x.lng&&F.lng<A.lng;return ot&&Pt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,x){return f?(f=je(f),this._southWest.equals(f.getSouthWest(),x)&&this._northEast.equals(f.getNorthEast(),x)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function je(f,x){return f instanceof Ve?f:new Ve(f,x)}function Xe(f,x,A){if(isNaN(f)||isNaN(x))throw new Error("Invalid LatLng object: ("+f+", "+x+")");this.lat=+f,this.lng=+x,A!==void 0&&(this.alt=+A)}Xe.prototype={equals:function(f,x){if(!f)return!1;f=ri(f);var A=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return A<=(x===void 0?1e-9:x)},toString:function(f){return"LatLng("+R(this.lat,f)+", "+R(this.lng,f)+")"},distanceTo:function(f){return Ii.distance(this,ri(f))},wrap:function(){return Ii.wrapLatLng(this)},toBounds:function(f){var x=180*f/40075017,A=x/Math.cos(Math.PI/180*this.lat);return je([this.lat-x,this.lng-A],[this.lat+x,this.lng+A])},clone:function(){return new Xe(this.lat,this.lng,this.alt)}};function ri(f,x,A){return f instanceof Xe?f:xt(f)&&typeof f[0]!="object"?f.length===3?new Xe(f[0],f[1],f[2]):f.length===2?new Xe(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new Xe(f.lat,"lng"in f?f.lng:f.lon,f.alt):x===void 0?null:new Xe(f,x,A)}var vi={latLngToPoint:function(f,x){var A=this.projection.project(f),F=this.scale(x);return this.transformation._transform(A,F)},pointToLatLng:function(f,x){var A=this.scale(x),F=this.transformation.untransform(f,A);return this.projection.unproject(F)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var x=this.projection.bounds,A=this.scale(f),F=this.transformation.transform(x.min,A),q=this.transformation.transform(x.max,A);return new $t(F,q)},infinite:!1,wrapLatLng:function(f){var x=this.wrapLng?C(f.lng,this.wrapLng,!0):f.lng,A=this.wrapLat?C(f.lat,this.wrapLat,!0):f.lat,F=f.alt;return new Xe(A,x,F)},wrapLatLngBounds:function(f){var x=f.getCenter(),A=this.wrapLatLng(x),F=x.lat-A.lat,q=x.lng-A.lng;if(F===0&&q===0)return f;var ot=f.getSouthWest(),Pt=f.getNorthEast(),Yt=new Xe(ot.lat-F,ot.lng-q),ue=new Xe(Pt.lat-F,Pt.lng-q);return new Ve(Yt,ue)}},Ii=c({},vi,{wrapLng:[-180,180],R:6371e3,distance:function(f,x){var A=Math.PI/180,F=f.lat*A,q=x.lat*A,ot=Math.sin((x.lat-f.lat)*A/2),Pt=Math.sin((x.lng-f.lng)*A/2),Yt=ot*ot+Math.cos(F)*Math.cos(q)*Pt*Pt,ue=2*Math.atan2(Math.sqrt(Yt),Math.sqrt(1-Yt));return this.R*ue}}),Qe=6378137,_n={R:Qe,MAX_LATITUDE:85.0511287798,project:function(f){var x=Math.PI/180,A=this.MAX_LATITUDE,F=Math.max(Math.min(A,f.lat),-A),q=Math.sin(F*x);return new oe(this.R*f.lng*x,this.R*Math.log((1+q)/(1-q))/2)},unproject:function(f){var x=180/Math.PI;return new Xe((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*x,f.x*x/this.R)},bounds:(function(){var f=Qe*Math.PI;return new $t([-f,-f],[f,f])})()};function ls(f,x,A,F){if(xt(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=x,this._c=A,this._d=F}ls.prototype={transform:function(f,x){return this._transform(f.clone(),x)},_transform:function(f,x){return x=x||1,f.x=x*(this._a*f.x+this._b),f.y=x*(this._c*f.y+this._d),f},untransform:function(f,x){return x=x||1,new oe((f.x/x-this._b)/this._a,(f.y/x-this._d)/this._c)}};function Tt(f,x,A,F){return new ls(f,x,A,F)}var Ft=c({},Ii,{code:"EPSG:3857",projection:_n,transformation:(function(){var f=.5/(Math.PI*_n.R);return Tt(f,.5,-f,.5)})()}),Jt=c({},Ft,{code:"EPSG:900913"});function Se(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function me(f,x){var A="",F,q,ot,Pt,Yt,ue;for(F=0,ot=f.length;F<ot;F++){for(Yt=f[F],q=0,Pt=Yt.length;q<Pt;q++)ue=Yt[q],A+=(q?"L":"M")+ue.x+" "+ue.y;A+=x?Le.svg?"z":"x":""}return A||"M0 0"}var we=document.documentElement.style,Ke="ActiveXObject"in window,$e=Ke&&!document.addEventListener,Ne="msLaunchUri"in navigator&&!("documentMode"in document),Re=yi("webkit"),fi=yi("android"),ti=yi("android 2")||yi("android 3"),ci=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),_i=fi&&yi("Google")&&ci<537&&!("AudioNode"in window),Ei=!!window.opera,Ji=!Ne&&yi("chrome"),Ri=yi("gecko")&&!Re&&!Ei&&!Ke,Fn=!Ji&&yi("safari"),Mn=yi("phantom"),zn="OTransition"in we,Vn=navigator.platform.indexOf("Win")===0,Us=Ke&&"transition"in we,Mr="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ti,Cn="MozPerspective"in we,fs=!window.L_DISABLE_3D&&(Us||Mr||Cn)&&!zn&&!Mn,Ys=typeof orientation<"u"||yi("mobile"),Eo=Ys&&Re,ec=Ys&&Mr,Et=!window.PointerEvent&&window.MSPointerEvent,et=!!(window.PointerEvent||Et),nt="ontouchstart"in window||!!window.TouchEvent,wt=!window.L_NO_TOUCH&&(nt||et),Lt=Ys&&Ei,jt=Ys&&Ri,Kt=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,qt=(function(){var f=!1;try{var x=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",z,x),window.removeEventListener("testPassiveEventSupport",z,x)}catch{}return f})(),Vt=(function(){return!!document.createElement("canvas").getContext})(),ne=!!(document.createElementNS&&Se("svg").createSVGRect),Ae=!!ne&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Be=!ne&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var x=f.firstChild;return x.style.behavior="url(#default#VML)",x&&typeof x.adj=="object"}catch{return!1}})(),Pe=navigator.platform.indexOf("Mac")===0,Si=navigator.platform.indexOf("Linux")===0;function yi(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var Le={ie:Ke,ielt9:$e,edge:Ne,webkit:Re,android:fi,android23:ti,androidStock:_i,opera:Ei,chrome:Ji,gecko:Ri,safari:Fn,phantom:Mn,opera12:zn,win:Vn,ie3d:Us,webkit3d:Mr,gecko3d:Cn,any3d:fs,mobile:Ys,mobileWebkit:Eo,mobileWebkit3d:ec,msPointer:Et,pointer:et,touch:wt,touchNative:nt,mobileOpera:Lt,mobileGecko:jt,retina:Kt,passiveEvents:qt,canvas:Vt,svg:ne,vml:Be,inlineSvg:Ae,mac:Pe,linux:Si},Mi=Le.msPointer?"MSPointerDown":"pointerdown",Bi=Le.msPointer?"MSPointerMove":"pointermove",tn=Le.msPointer?"MSPointerUp":"pointerup",An=Le.msPointer?"MSPointerCancel":"pointercancel",ps={touchstart:Mi,touchmove:Bi,touchend:tn,touchcancel:An},Nn={touchstart:So,touchmove:hr,touchend:hr,touchcancel:hr},$s={},cs=!1;function is(f,x,A){return x==="touchstart"&&ja(),Nn[x]?(A=Nn[x].bind(this,A),f.addEventListener(ps[x],A,!1),A):(console.warn("wrong event specified:",x),z)}function ns(f,x,A){if(!ps[x]){console.warn("wrong event specified:",x);return}f.removeEventListener(ps[x],A,!1)}function ur(f){$s[f.pointerId]=f}function Js(f){$s[f.pointerId]&&($s[f.pointerId]=f)}function Ti(f){delete $s[f.pointerId]}function ja(){cs||(document.addEventListener(Mi,ur,!0),document.addEventListener(Bi,Js,!0),document.addEventListener(tn,Ti,!0),document.addEventListener(An,Ti,!0),cs=!0)}function hr(f,x){if(x.pointerType!==(x.MSPOINTER_TYPE_MOUSE||"mouse")){x.touches=[];for(var A in $s)x.touches.push($s[A]);x.changedTouches=[x],f(x)}}function So(f,x){x.MSPOINTER_TYPE_TOUCH&&x.pointerType===x.MSPOINTER_TYPE_TOUCH&&Gn(x),hr(f,x)}function Mo(f){var x={},A,F;for(F in f)A=f[F],x[F]=A&&A.bind?A.bind(f):A;return f=x,x.type="dblclick",x.detail=2,x.isTrusted=!1,x._simulated=!0,x}var jr=200;function Vr(f,x){f.addEventListener("dblclick",x);var A=0,F;function q(ot){if(ot.detail!==1){F=ot.detail;return}if(!(ot.pointerType==="mouse"||ot.sourceCapabilities&&!ot.sourceCapabilities.firesTouchEvents)){var Pt=Hn(ot);if(!(Pt.some(function(ue){return ue instanceof HTMLLabelElement&&ue.attributes.for})&&!Pt.some(function(ue){return ue instanceof HTMLInputElement||ue instanceof HTMLSelectElement}))){var Yt=Date.now();Yt-A<=jr?(F++,F===2&&x(Mo(ot))):F=1,A=Yt}}}return f.addEventListener("click",q),{dblclick:x,simDblclick:q}}function Vo(f,x){f.removeEventListener("dblclick",x.dblclick),f.removeEventListener("click",x.simDblclick)}var Va=Ls(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),dr=Ls(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Cr=dr==="webkitTransition"||dr==="OTransition"?dr+"End":"transitionend";function ma(f){return typeof f=="string"?document.getElementById(f):f}function le(f,x){var A=f.style[x]||f.currentStyle&&f.currentStyle[x];if((!A||A==="auto")&&document.defaultView){var F=document.defaultView.getComputedStyle(f,null);A=F?F[x]:null}return A==="auto"?null:A}function Vi(f,x,A){var F=document.createElement(f);return F.className=x||"",A&&A.appendChild(F),F}function Li(f){var x=f.parentNode;x&&x.removeChild(f)}function Un(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function Uo(f){var x=f.parentNode;x&&x.lastChild!==f&&x.appendChild(f)}function Is(f){var x=f.parentNode;x&&x.firstChild!==f&&x.insertBefore(f,x.firstChild)}function Ua(f,x){if(f.classList!==void 0)return f.classList.contains(x);var A=mi(f);return A.length>0&&new RegExp("(^|\\s)"+x+"(\\s|$)").test(A)}function Fi(f,x){if(f.classList!==void 0)for(var A=G(x),F=0,q=A.length;F<q;F++)f.classList.add(A[F]);else if(!Ua(f,x)){var ot=mi(f);Fe(f,(ot?ot+" ":"")+x)}}function gn(f,x){f.classList!==void 0?f.classList.remove(x):Fe(f,j((" "+mi(f)+" ").replace(" "+x+" "," ")))}function Fe(f,x){f.className.baseVal===void 0?f.className=x:f.className.baseVal=x}function mi(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function hi(f,x){"opacity"in f.style?f.style.opacity=x:"filter"in f.style&&On(f,x)}function On(f,x){var A=!1,F="DXImageTransform.Microsoft.Alpha";try{A=f.filters.item(F)}catch{if(x===1)return}x=Math.round(x*100),A?(A.Enabled=x!==100,A.Opacity=x):f.style.filter+=" progid:"+F+"(opacity="+x+")"}function Ls(f){for(var x=document.documentElement.style,A=0;A<f.length;A++)if(f[A]in x)return f[A];return!1}function xi(f,x,A){var F=x||new oe(0,0);f.style[Va]=(Le.ie3d?"translate("+F.x+"px,"+F.y+"px)":"translate3d("+F.x+"px,"+F.y+"px,0)")+(A?" scale("+A+")":"")}function Ui(f,x){f._leaflet_pos=x,Le.any3d?xi(f,x):(f.style.left=x.x+"px",f.style.top=x.y+"px")}function xs(f){return f._leaflet_pos||new oe(0,0)}var Qs,Zn,on;if("onselectstart"in document)Qs=function(){pi(window,"selectstart",Gn)},Zn=function(){cn(window,"selectstart",Gn)};else{var _a=Ls(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Qs=function(){if(_a){var f=document.documentElement.style;on=f[_a],f[_a]="none"}},Zn=function(){_a&&(document.documentElement.style[_a]=on,on=void 0)}}function Ds(){pi(window,"dragstart",Gn)}function Co(){cn(window,"dragstart",Gn)}var Ao,fr;function ic(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(Ws(),Ao=f,fr=f.style.outlineStyle,f.style.outlineStyle="none",pi(window,"keydown",Ws))}function Ws(){Ao&&(Ao.style.outlineStyle=fr,Ao=void 0,fr=void 0,cn(window,"keydown",Ws))}function Po(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function ga(f){var x=f.getBoundingClientRect();return{x:x.width/f.offsetWidth||1,y:x.height/f.offsetHeight||1,boundingClientRect:x}}var Yr={__proto__:null,TRANSFORM:Va,TRANSITION:dr,TRANSITION_END:Cr,get:ma,getStyle:le,create:Vi,remove:Li,empty:Un,toFront:Uo,toBack:Is,hasClass:Ua,addClass:Fi,removeClass:gn,setClass:Fe,getClass:mi,setOpacity:hi,testProp:Ls,setTransform:xi,setPosition:Ui,getPosition:xs,get disableTextSelection(){return Qs},get enableTextSelection(){return Zn},disableImageDrag:Ds,enableImageDrag:Co,preventOutline:ic,restoreOutline:Ws,getSizedParentNode:Po,getScale:ga};function pi(f,x,A,F){if(x&&typeof x=="object")for(var q in x)us(f,q,x[q],A);else{x=G(x);for(var ot=0,Pt=x.length;ot<Pt;ot++)us(f,x[ot],A,F)}return this}var Xi="_leaflet_events";function cn(f,x,A,F){if(arguments.length===1)vl(f),delete f[Xi];else if(x&&typeof x=="object")for(var q in x)nc(f,q,x[q],A);else if(x=G(x),arguments.length===2)vl(f,function(Yt){return mt(x,Yt)!==-1});else for(var ot=0,Pt=x.length;ot<Pt;ot++)nc(f,x[ot],A,F);return this}function vl(f,x){for(var A in f[Xi]){var F=A.split(/\d/)[0];(!x||x(F))&&nc(f,F,null,null,A)}}var bs={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function us(f,x,A,F){var q=x+r(A)+(F?"_"+r(F):"");if(f[Xi]&&f[Xi][q])return this;var ot=function(Yt){return A.call(F||f,Yt||window.event)},Pt=ot;!Le.touchNative&&Le.pointer&&x.indexOf("touch")===0?ot=is(f,x,ot):Le.touch&&x==="dblclick"?ot=Vr(f,ot):"addEventListener"in f?x==="touchstart"||x==="touchmove"||x==="wheel"||x==="mousewheel"?f.addEventListener(bs[x]||x,ot,Le.passiveEvents?{passive:!1}:!1):x==="mouseenter"||x==="mouseleave"?(ot=function(Yt){Yt=Yt||window.event,Ir(f,Yt)&&Pt(Yt)},f.addEventListener(bs[x],ot,!1)):f.addEventListener(x,Pt,!1):f.attachEvent("on"+x,ot),f[Xi]=f[Xi]||{},f[Xi][q]=ot}function nc(f,x,A,F,q){q=q||x+r(A)+(F?"_"+r(F):"");var ot=f[Xi]&&f[Xi][q];if(!ot)return this;!Le.touchNative&&Le.pointer&&x.indexOf("touch")===0?ns(f,x,ot):Le.touch&&x==="dblclick"?Vo(f,ot):"removeEventListener"in f?f.removeEventListener(bs[x]||x,ot,!1):f.detachEvent("on"+x,ot),f[Xi][q]=null}function Ar(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function yn(f){return us(f,"wheel",Ar),this}function Pr(f){return pi(f,"mousedown touchstart dblclick contextmenu",Ar),f._leaflet_disable_click=!0,this}function Gn(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function pr(f){return Gn(f),Ar(f),this}function Hn(f){if(f.composedPath)return f.composedPath();for(var x=[],A=f.target;A;)x.push(A),A=A.parentNode;return x}function sc(f,x){if(!x)return new oe(f.clientX,f.clientY);var A=ga(x),F=A.boundingClientRect;return new oe((f.clientX-F.left)/A.x-x.clientLeft,(f.clientY-F.top)/A.y-x.clientTop)}var rc=Le.linux&&Le.chrome?window.devicePixelRatio:Le.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function kr(f){return Le.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/rc:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function Ir(f,x){var A=x.relatedTarget;if(!A)return!0;try{for(;A&&A!==f;)A=A.parentNode}catch{return!1}return A!==f}var $a={__proto__:null,on:pi,off:cn,stopPropagation:Ar,disableScrollPropagation:yn,disableClickPropagation:Pr,preventDefault:Gn,stop:pr,getPropagationPath:Hn,getMousePosition:sc,getWheelDelta:kr,isExternalTarget:Ir,addListener:pi,removeListener:cn},Zc=he.extend({run:function(f,x,A,F){this.stop(),this._el=f,this._inProgress=!0,this._duration=A||.25,this._easeOutPower=1/Math.max(F||.5,.2),this._startPos=xs(f),this._offset=x.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ee(this._animate,this),this._step()},_step:function(f){var x=+new Date-this._startTime,A=this._duration*1e3;x<A?this._runFrame(this._easeOut(x/A),f):(this._runFrame(1),this._complete())},_runFrame:function(f,x){var A=this._startPos.add(this._offset.multiplyBy(f));x&&A._round(),Ui(this._el,A),this.fire("step")},_complete:function(){Wt(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),Wi=he.extend({options:{crs:Ft,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,x){x=W(this,x),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=_(this._onResize,this),this._initEvents(),x.maxBounds&&this.setMaxBounds(x.maxBounds),x.zoom!==void 0&&(this._zoom=this._limitZoom(x.zoom)),x.center&&x.zoom!==void 0&&this.setView(ri(x.center),x.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=dr&&Le.any3d&&!Le.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),pi(this._proxy,Cr,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,x,A){if(x=x===void 0?this._zoom:this._limitZoom(x),f=this._limitCenter(ri(f),x,this.options.maxBounds),A=A||{},this._stop(),this._loaded&&!A.reset&&A!==!0){A.animate!==void 0&&(A.zoom=c({animate:A.animate},A.zoom),A.pan=c({animate:A.animate,duration:A.duration},A.pan));var F=this._zoom!==x?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,x,A.zoom):this._tryAnimatedPan(f,A.pan);if(F)return clearTimeout(this._sizeTimer),this}return this._resetView(f,x,A.pan&&A.pan.noMoveStart),this},setZoom:function(f,x){return this._loaded?this.setView(this.getCenter(),f,{zoom:x}):(this._zoom=f,this)},zoomIn:function(f,x){return f=f||(Le.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,x)},zoomOut:function(f,x){return f=f||(Le.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,x)},setZoomAround:function(f,x,A){var F=this.getZoomScale(x),q=this.getSize().divideBy(2),ot=f instanceof oe?f:this.latLngToContainerPoint(f),Pt=ot.subtract(q).multiplyBy(1-1/F),Yt=this.containerPointToLatLng(q.add(Pt));return this.setView(Yt,x,{zoom:A})},_getBoundsCenterZoom:function(f,x){x=x||{},f=f.getBounds?f.getBounds():je(f);var A=Ue(x.paddingTopLeft||x.padding||[0,0]),F=Ue(x.paddingBottomRight||x.padding||[0,0]),q=this.getBoundsZoom(f,!1,A.add(F));if(q=typeof x.maxZoom=="number"?Math.min(x.maxZoom,q):q,q===1/0)return{center:f.getCenter(),zoom:q};var ot=F.subtract(A).divideBy(2),Pt=this.project(f.getSouthWest(),q),Yt=this.project(f.getNorthEast(),q),ue=this.unproject(Pt.add(Yt).divideBy(2).add(ot),q);return{center:ue,zoom:q}},fitBounds:function(f,x){if(f=je(f),!f.isValid())throw new Error("Bounds are not valid.");var A=this._getBoundsCenterZoom(f,x);return this.setView(A.center,A.zoom,x)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,x){return this.setView(f,this._zoom,{pan:x})},panBy:function(f,x){if(f=Ue(f).round(),x=x||{},!f.x&&!f.y)return this.fire("moveend");if(x.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Zc,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),x.noMoveStart||this.fire("movestart"),x.animate!==!1){Fi(this._mapPane,"leaflet-pan-anim");var A=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,A,x.duration||.25,x.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,x,A){if(A=A||{},A.animate===!1||!Le.any3d)return this.setView(f,x,A);this._stop();var F=this.project(this.getCenter()),q=this.project(f),ot=this.getSize(),Pt=this._zoom;f=ri(f),x=x===void 0?Pt:x;var Yt=Math.max(ot.x,ot.y),ue=Yt*this.getZoomScale(Pt,x),Ie=q.distanceTo(F)||1,ni=1.42,wi=ni*ni;function Di(pn){var jl=pn?-1:1,nu=pn?ue:Yt,Uu=ue*ue-Yt*Yt+jl*wi*wi*Ie*Ie,ea=2*nu*wi*Ie,vc=Uu/ea,su=Math.sqrt(vc*vc+1)-vc,Ph=su<1e-9?-18:Math.log(su);return Ph}function $n(pn){return(Math.exp(pn)-Math.exp(-pn))/2}function ss(pn){return(Math.exp(pn)+Math.exp(-pn))/2}function vr(pn){return $n(pn)/ss(pn)}var Hs=Di(0);function Os(pn){return Yt*(ss(Hs)/ss(Hs+ni*pn))}function Bl(pn){return Yt*(ss(Hs)*vr(Hs+ni*pn)-$n(Hs))/wi}function yc(pn){return 1-Math.pow(1-pn,1.5)}var iu=Date.now(),Fl=(Di(1)-Hs)/ni,Nl=A.duration?1e3*A.duration:1e3*Fl*.8;function oo(){var pn=(Date.now()-iu)/Nl,jl=yc(pn)*Fl;pn<=1?(this._flyToFrame=ee(oo,this),this._move(this.unproject(F.add(q.subtract(F).multiplyBy(Bl(jl)/Ie)),Pt),this.getScaleZoom(Yt/Os(jl),Pt),{flyTo:!0})):this._move(f,x)._moveEnd(!0)}return this._moveStart(!0,A.noMoveStart),oo.call(this),this},flyToBounds:function(f,x){var A=this._getBoundsCenterZoom(f,x);return this.flyTo(A.center,A.zoom,x)},setMaxBounds:function(f){return f=je(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var x=this.options.minZoom;return this.options.minZoom=f,this._loaded&&x!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var x=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&x!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,x){this._enforcingBounds=!0;var A=this.getCenter(),F=this._limitCenter(A,this._zoom,je(f));return A.equals(F)||this.panTo(F,x),this._enforcingBounds=!1,this},panInside:function(f,x){x=x||{};var A=Ue(x.paddingTopLeft||x.padding||[0,0]),F=Ue(x.paddingBottomRight||x.padding||[0,0]),q=this.project(this.getCenter()),ot=this.project(f),Pt=this.getPixelBounds(),Yt=ce([Pt.min.add(A),Pt.max.subtract(F)]),ue=Yt.getSize();if(!Yt.contains(ot)){this._enforcingBounds=!0;var Ie=ot.subtract(Yt.getCenter()),ni=Yt.extend(ot).getSize().subtract(ue);q.x+=Ie.x<0?-ni.x:ni.x,q.y+=Ie.y<0?-ni.y:ni.y,this.panTo(this.unproject(q),x),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=c({animate:!1,pan:!0},f===!0?{animate:!0}:f);var x=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var A=this.getSize(),F=x.divideBy(2).round(),q=A.divideBy(2).round(),ot=F.subtract(q);return!ot.x&&!ot.y?this:(f.animate&&f.pan?this.panBy(ot):(f.pan&&this._rawPanBy(ot),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(_(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:x,newSize:A}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=c({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var x=_(this._handleGeolocationResponse,this),A=_(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(x,A,f):navigator.geolocation.getCurrentPosition(x,A,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var x=f.code,A=f.message||(x===1?"permission denied":x===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:x,message:"Geolocation error: "+A+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var x=f.coords.latitude,A=f.coords.longitude,F=new Xe(x,A),q=F.toBounds(f.coords.accuracy*2),ot=this._locateOptions;if(ot.setView){var Pt=this.getBoundsZoom(q);this.setView(F,ot.maxZoom?Math.min(Pt,ot.maxZoom):Pt)}var Yt={latlng:F,bounds:q,timestamp:f.timestamp};for(var ue in f.coords)typeof f.coords[ue]=="number"&&(Yt[ue]=f.coords[ue]);this.fire("locationfound",Yt)}},addHandler:function(f,x){if(!x)return this;var A=this[f]=new x(this);return this._handlers.push(A),this.options[f]&&A.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Li(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(Wt(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)Li(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,x){var A="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),F=Vi("div",A,x||this._mapPane);return f&&(this._panes[f]=F),F},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),x=this.unproject(f.getBottomLeft()),A=this.unproject(f.getTopRight());return new Ve(x,A)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,x,A){f=je(f),A=Ue(A||[0,0]);var F=this.getZoom()||0,q=this.getMinZoom(),ot=this.getMaxZoom(),Pt=f.getNorthWest(),Yt=f.getSouthEast(),ue=this.getSize().subtract(A),Ie=ce(this.project(Yt,F),this.project(Pt,F)).getSize(),ni=Le.any3d?this.options.zoomSnap:1,wi=ue.x/Ie.x,Di=ue.y/Ie.y,$n=x?Math.max(wi,Di):Math.min(wi,Di);return F=this.getScaleZoom($n,F),ni&&(F=Math.round(F/(ni/100))*(ni/100),F=x?Math.ceil(F/ni)*ni:Math.floor(F/ni)*ni),Math.max(q,Math.min(ot,F))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new oe(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,x){var A=this._getTopLeftPoint(f,x);return new $t(A,A.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,x){var A=this.options.crs;return x=x===void 0?this._zoom:x,A.scale(f)/A.scale(x)},getScaleZoom:function(f,x){var A=this.options.crs;x=x===void 0?this._zoom:x;var F=A.zoom(f*A.scale(x));return isNaN(F)?1/0:F},project:function(f,x){return x=x===void 0?this._zoom:x,this.options.crs.latLngToPoint(ri(f),x)},unproject:function(f,x){return x=x===void 0?this._zoom:x,this.options.crs.pointToLatLng(Ue(f),x)},layerPointToLatLng:function(f){var x=Ue(f).add(this.getPixelOrigin());return this.unproject(x)},latLngToLayerPoint:function(f){var x=this.project(ri(f))._round();return x._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(ri(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(je(f))},distance:function(f,x){return this.options.crs.distance(ri(f),ri(x))},containerPointToLayerPoint:function(f){return Ue(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return Ue(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var x=this.containerPointToLayerPoint(Ue(f));return this.layerPointToLatLng(x)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ri(f)))},mouseEventToContainerPoint:function(f){return sc(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var x=this._container=ma(f);if(x){if(x._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");pi(x,"scroll",this._onScroll,this),this._containerId=r(x)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&Le.any3d,Fi(f,"leaflet-container"+(Le.touch?" leaflet-touch":"")+(Le.retina?" leaflet-retina":"")+(Le.ielt9?" leaflet-oldie":"")+(Le.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var x=le(f,"position");x!=="absolute"&&x!=="relative"&&x!=="fixed"&&x!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ui(this._mapPane,new oe(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Fi(f.markerPane,"leaflet-zoom-hide"),Fi(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,x,A){Ui(this._mapPane,new oe(0,0));var F=!this._loaded;this._loaded=!0,x=this._limitZoom(x),this.fire("viewprereset");var q=this._zoom!==x;this._moveStart(q,A)._move(f,x)._moveEnd(q),this.fire("viewreset"),F&&this.fire("load")},_moveStart:function(f,x){return f&&this.fire("zoomstart"),x||this.fire("movestart"),this},_move:function(f,x,A,F){x===void 0&&(x=this._zoom);var q=this._zoom!==x;return this._zoom=x,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),F?A&&A.pinch&&this.fire("zoom",A):((q||A&&A.pinch)&&this.fire("zoom",A),this.fire("move",A)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return Wt(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){Ui(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[r(this._container)]=this;var x=f?cn:pi;x(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&x(window,"resize",this._onResize,this),Le.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){Wt(this._resizeRequest),this._resizeRequest=ee(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,x){for(var A=[],F,q=x==="mouseout"||x==="mouseover",ot=f.target||f.srcElement,Pt=!1;ot;){if(F=this._targets[r(ot)],F&&(x==="click"||x==="preclick")&&this._draggableMoved(F)){Pt=!0;break}if(F&&F.listens(x,!0)&&(q&&!Ir(ot,f)||(A.push(F),q))||ot===this._container)break;ot=ot.parentNode}return!A.length&&!Pt&&!q&&this.listens(x,!0)&&(A=[this]),A},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var x=f.target||f.srcElement;if(!(!this._loaded||x._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(x))){var A=f.type;A==="mousedown"&&ic(x),this._fireDOMEvent(f,A)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,x,A){if(f.type==="click"){var F=c({},f);F.type="preclick",this._fireDOMEvent(F,F.type,A)}var q=this._findEventTargets(f,x);if(A){for(var ot=[],Pt=0;Pt<A.length;Pt++)A[Pt].listens(x,!0)&&ot.push(A[Pt]);q=ot.concat(q)}if(q.length){x==="contextmenu"&&Gn(f);var Yt=q[0],ue={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Ie=Yt.getLatLng&&(!Yt._radius||Yt._radius<=10);ue.containerPoint=Ie?this.latLngToContainerPoint(Yt.getLatLng()):this.mouseEventToContainerPoint(f),ue.layerPoint=this.containerPointToLayerPoint(ue.containerPoint),ue.latlng=Ie?Yt.getLatLng():this.layerPointToLatLng(ue.layerPoint)}for(Pt=0;Pt<q.length;Pt++)if(q[Pt].fire(x,ue,!0),ue.originalEvent._stopped||q[Pt].options.bubblingMouseEvents===!1&&mt(this._mouseEvents,x)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,x=this._handlers.length;f<x;f++)this._handlers[f].disable()},whenReady:function(f,x){return this._loaded?f.call(x||this,{target:this}):this.on("load",f,x),this},_getMapPanePos:function(){return xs(this._mapPane)||new oe(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,x){var A=f&&x!==void 0?this._getNewPixelOrigin(f,x):this.getPixelOrigin();return A.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,x){var A=this.getSize()._divideBy(2);return this.project(f,x)._subtract(A)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,x,A){var F=this._getNewPixelOrigin(A,x);return this.project(f,x)._subtract(F)},_latLngBoundsToNewLayerBounds:function(f,x,A){var F=this._getNewPixelOrigin(A,x);return ce([this.project(f.getSouthWest(),x)._subtract(F),this.project(f.getNorthWest(),x)._subtract(F),this.project(f.getSouthEast(),x)._subtract(F),this.project(f.getNorthEast(),x)._subtract(F)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,x,A){if(!A)return f;var F=this.project(f,x),q=this.getSize().divideBy(2),ot=new $t(F.subtract(q),F.add(q)),Pt=this._getBoundsOffset(ot,A,x);return Math.abs(Pt.x)<=1&&Math.abs(Pt.y)<=1?f:this.unproject(F.add(Pt),x)},_limitOffset:function(f,x){if(!x)return f;var A=this.getPixelBounds(),F=new $t(A.min.add(f),A.max.add(f));return f.add(this._getBoundsOffset(F,x))},_getBoundsOffset:function(f,x,A){var F=ce(this.project(x.getNorthEast(),A),this.project(x.getSouthWest(),A)),q=F.min.subtract(f.min),ot=F.max.subtract(f.max),Pt=this._rebound(q.x,-ot.x),Yt=this._rebound(q.y,-ot.y);return new oe(Pt,Yt)},_rebound:function(f,x){return f+x>0?Math.round(f-x)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(x))},_limitZoom:function(f){var x=this.getMinZoom(),A=this.getMaxZoom(),F=Le.any3d?this.options.zoomSnap:1;return F&&(f=Math.round(f/F)*F),Math.max(x,Math.min(A,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){gn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,x){var A=this._getCenterOffset(f)._trunc();return(x&&x.animate)!==!0&&!this.getSize().contains(A)?!1:(this.panBy(A,x),!0)},_createAnimProxy:function(){var f=this._proxy=Vi("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(x){var A=Va,F=this._proxy.style[A];xi(this._proxy,this.project(x.center,x.zoom),this.getZoomScale(x.zoom,1)),F===this._proxy.style[A]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Li(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),x=this.getZoom();xi(this._proxy,this.project(f,x),this.getZoomScale(x,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,x,A){if(this._animatingZoom)return!0;if(A=A||{},!this._zoomAnimated||A.animate===!1||this._nothingToAnimate()||Math.abs(x-this._zoom)>this.options.zoomAnimationThreshold)return!1;var F=this.getZoomScale(x),q=this._getCenterOffset(f)._divideBy(1-1/F);return A.animate!==!0&&!this.getSize().contains(q)?!1:(ee(function(){this._moveStart(!0,A.noMoveStart||!1)._animateZoom(f,x,!0)},this),!0)},_animateZoom:function(f,x,A,F){this._mapPane&&(A&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=x,Fi(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:x,noUpdate:F}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(_(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&gn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function $o(f,x){return new Wi(f,x)}var qn=ye.extend({options:{position:"topright"},initialize:function(f){W(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var x=this._map;return x&&x.removeControl(this),this.options.position=f,x&&x.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var x=this._container=this.onAdd(f),A=this.getPosition(),F=f._controlCorners[A];return Fi(x,"leaflet-control"),A.indexOf("bottom")!==-1?F.insertBefore(x,F.firstChild):F.appendChild(x),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Li(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),Wo=function(f){return new qn(f)};Wi.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},x="leaflet-",A=this._controlContainer=Vi("div",x+"control-container",this._container);function F(q,ot){var Pt=x+q+" "+x+ot;f[q+ot]=Vi("div",Pt,A)}F("top","left"),F("top","right"),F("bottom","left"),F("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)Li(this._controlCorners[f]);Li(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var mr=qn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,x,A,F){return A<F?-1:F<A?1:0}},initialize:function(f,x,A){W(this,A),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var F in f)this._addLayer(f[F],F);for(F in x)this._addLayer(x[F],F,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var x=0;x<this._layers.length;x++)this._layers[x].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return qn.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,x){return this._addLayer(f,x),this._map?this._update():this},addOverlay:function(f,x){return this._addLayer(f,x,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var x=this._getLayer(r(f));return x&&this._layers.splice(this._layers.indexOf(x),1),this._map?this._update():this},expand:function(){Fi(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(Fi(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):gn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return gn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",x=this._container=Vi("div",f),A=this.options.collapsed;x.setAttribute("aria-haspopup",!0),Pr(x),yn(x);var F=this._section=Vi("section",f+"-list");A&&(this._map.on("click",this.collapse,this),pi(x,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var q=this._layersLink=Vi("a",f+"-toggle",x);q.href="#",q.title="Layers",q.setAttribute("role","button"),pi(q,{keydown:function(ot){ot.keyCode===13&&this._expandSafely()},click:function(ot){Gn(ot),this._expandSafely()}},this),A||this.expand(),this._baseLayersList=Vi("div",f+"-base",F),this._separator=Vi("div",f+"-separator",F),this._overlaysList=Vi("div",f+"-overlays",F),x.appendChild(F)},_getLayer:function(f){for(var x=0;x<this._layers.length;x++)if(this._layers[x]&&r(this._layers[x].layer)===f)return this._layers[x]},_addLayer:function(f,x,A){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:x,overlay:A}),this.options.sortLayers&&this._layers.sort(_(function(F,q){return this.options.sortFunction(F.layer,q.layer,F.name,q.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Un(this._baseLayersList),Un(this._overlaysList),this._layerControlInputs=[];var f,x,A,F,q=0;for(A=0;A<this._layers.length;A++)F=this._layers[A],this._addItem(F),x=x||F.overlay,f=f||!F.overlay,q+=F.overlay?0:1;return this.options.hideSingleBase&&(f=f&&q>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=x&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var x=this._getLayer(r(f.target)),A=x.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;A&&this._map.fire(A,x)},_createRadioElement:function(f,x){var A='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(x?' checked="checked"':"")+"/>",F=document.createElement("div");return F.innerHTML=A,F.firstChild},_addItem:function(f){var x=document.createElement("label"),A=this._map.hasLayer(f.layer),F;f.overlay?(F=document.createElement("input"),F.type="checkbox",F.className="leaflet-control-layers-selector",F.defaultChecked=A):F=this._createRadioElement("leaflet-base-layers_"+r(this),A),this._layerControlInputs.push(F),F.layerId=r(f.layer),pi(F,"click",this._onInputClick,this);var q=document.createElement("span");q.innerHTML=" "+f.name;var ot=document.createElement("span");x.appendChild(ot),ot.appendChild(F),ot.appendChild(q);var Pt=f.overlay?this._overlaysList:this._baseLayersList;return Pt.appendChild(x),this._checkDisabledLayers(),x},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,x,A,F=[],q=[];this._handlingClick=!0;for(var ot=f.length-1;ot>=0;ot--)x=f[ot],A=this._getLayer(x.layerId).layer,x.checked?F.push(A):x.checked||q.push(A);for(ot=0;ot<q.length;ot++)this._map.hasLayer(q[ot])&&this._map.removeLayer(q[ot]);for(ot=0;ot<F.length;ot++)this._map.hasLayer(F[ot])||this._map.addLayer(F[ot]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,x,A,F=this._map.getZoom(),q=f.length-1;q>=0;q--)x=f[q],A=this._getLayer(x.layerId).layer,x.disabled=A.options.minZoom!==void 0&&F<A.options.minZoom||A.options.maxZoom!==void 0&&F>A.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,pi(f,"click",Gn),this.expand();var x=this;setTimeout(function(){cn(f,"click",Gn),x._preventClick=!1})}}),ko=function(f,x,A){return new mr(f,x,A)},Zo=qn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var x="leaflet-control-zoom",A=Vi("div",x+" leaflet-bar"),F=this.options;return this._zoomInButton=this._createButton(F.zoomInText,F.zoomInTitle,x+"-in",A,this._zoomIn),this._zoomOutButton=this._createButton(F.zoomOutText,F.zoomOutTitle,x+"-out",A,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),A},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,x,A,F,q){var ot=Vi("a",A,F);return ot.innerHTML=f,ot.href="#",ot.title=x,ot.setAttribute("role","button"),ot.setAttribute("aria-label",x),Pr(ot),pi(ot,"click",pr),pi(ot,"click",q,this),pi(ot,"click",this._refocusOnMap,this),ot},_updateDisabled:function(){var f=this._map,x="leaflet-disabled";gn(this._zoomInButton,x),gn(this._zoomOutButton,x),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(Fi(this._zoomOutButton,x),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(Fi(this._zoomInButton,x),this._zoomInButton.setAttribute("aria-disabled","true"))}});Wi.mergeOptions({zoomControl:!0}),Wi.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Zo,this.addControl(this.zoomControl))});var Jr=function(f){return new Zo(f)},Wa=qn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var x="leaflet-control-scale",A=Vi("div",x),F=this.options;return this._addScales(F,x+"-line",A),f.on(F.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),A},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,x,A){f.metric&&(this._mScale=Vi("div",x,A)),f.imperial&&(this._iScale=Vi("div",x,A))},_update:function(){var f=this._map,x=f.getSize().y/2,A=f.distance(f.containerPointToLatLng([0,x]),f.containerPointToLatLng([this.options.maxWidth,x]));this._updateScales(A)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var x=this._getRoundNum(f),A=x<1e3?x+" m":x/1e3+" km";this._updateScale(this._mScale,A,x/f)},_updateImperial:function(f){var x=f*3.2808399,A,F,q;x>5280?(A=x/5280,F=this._getRoundNum(A),this._updateScale(this._iScale,F+" mi",F/A)):(q=this._getRoundNum(x),this._updateScale(this._iScale,q+" ft",q/x))},_updateScale:function(f,x,A){f.style.width=Math.round(this.options.maxWidth*A)+"px",f.innerHTML=x},_getRoundNum:function(f){var x=Math.pow(10,(Math.floor(f)+"").length-1),A=f/x;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:1,x*A}}),ya=function(f){return new Wa(f)},Za='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ga=qn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Le.inlineSvg?Za+" ":"")+"Leaflet</a>"},initialize:function(f){W(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Vi("div","leaflet-control-attribution"),Pr(this._container);for(var x in f._layers)f._layers[x].getAttribution&&this.addAttribution(f._layers[x].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var x in this._attributions)this._attributions[x]&&f.push(x);var A=[];this.options.prefix&&A.push(this.options.prefix),f.length&&A.push(f.join(", ")),this._container.innerHTML=A.join(' <span aria-hidden="true">|</span> ')}}});Wi.mergeOptions({attributionControl:!0}),Wi.addInitHook(function(){this.options.attributionControl&&new Ga().addTo(this)});var xl=function(f){return new Ga(f)};qn.Layers=mr,qn.Zoom=Zo,qn.Scale=Wa,qn.Attribution=Ga,Wo.layers=ko,Wo.zoom=Jr,Wo.scale=ya,Wo.attribution=xl;var Lr=ye.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Lr.addTo=function(f,x){return f.addHandler(x,this),this};var Gc={Events:de},Go=Le.touch?"touchstart mousedown":"mousedown",Ni=he.extend({options:{clickTolerance:3},initialize:function(f,x,A,F){W(this,F),this._element=f,this._dragStartTarget=x||f,this._preventOutline=A},enable:function(){this._enabled||(pi(this._dragStartTarget,Go,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ni._dragging===this&&this.finishDrag(!0),cn(this._dragStartTarget,Go,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!Ua(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){Ni._dragging===this&&this.finishDrag();return}if(!(Ni._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(Ni._dragging=this,this._preventOutline&&ic(this._element),Ds(),Qs(),!this._moving)){this.fire("down");var x=f.touches?f.touches[0]:f,A=Po(this._element);this._startPoint=new oe(x.clientX,x.clientY),this._startPos=xs(this._element),this._parentScale=ga(A);var F=f.type==="mousedown";pi(document,F?"mousemove":"touchmove",this._onMove,this),pi(document,F?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var x=f.touches&&f.touches.length===1?f.touches[0]:f,A=new oe(x.clientX,x.clientY)._subtract(this._startPoint);!A.x&&!A.y||Math.abs(A.x)+Math.abs(A.y)<this.options.clickTolerance||(A.x/=this._parentScale.x,A.y/=this._parentScale.y,Gn(f),this._moved||(this.fire("dragstart"),this._moved=!0,Fi(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Fi(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(A),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),Ui(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){gn(document.body,"leaflet-dragging"),this._lastTarget&&(gn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),cn(document,"mousemove touchmove",this._onMove,this),cn(document,"mouseup touchend touchcancel",this._onUp,this),Co(),Zn();var x=this._moved&&this._moving;this._moving=!1,Ni._dragging=!1,x&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function bl(f,x,A){var F,q=[1,4,2,8],ot,Pt,Yt,ue,Ie,ni,wi,Di;for(ot=0,ni=f.length;ot<ni;ot++)f[ot]._code=Ur(f[ot],x);for(Yt=0;Yt<4;Yt++){for(wi=q[Yt],F=[],ot=0,ni=f.length,Pt=ni-1;ot<ni;Pt=ot++)ue=f[ot],Ie=f[Pt],ue._code&wi?Ie._code&wi||(Di=Sl(Ie,ue,wi,x,A),Di._code=Ur(Di,x),F.push(Di)):(Ie._code&wi&&(Di=Sl(Ie,ue,wi,x,A),Di._code=Ur(Di,x),F.push(Di)),F.push(ue));f=F}return f}function oc(f,x){var A,F,q,ot,Pt,Yt,ue,Ie,ni;if(!f||f.length===0)throw new Error("latlngs not passed");Zs(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var wi=ri([0,0]),Di=je(f),$n=Di.getNorthWest().distanceTo(Di.getSouthWest())*Di.getNorthEast().distanceTo(Di.getNorthWest());$n<1700&&(wi=ac(f));var ss=f.length,vr=[];for(A=0;A<ss;A++){var Hs=ri(f[A]);vr.push(x.project(ri([Hs.lat-wi.lat,Hs.lng-wi.lng])))}for(Yt=ue=Ie=0,A=0,F=ss-1;A<ss;F=A++)q=vr[A],ot=vr[F],Pt=q.y*ot.x-ot.y*q.x,ue+=(q.x+ot.x)*Pt,Ie+=(q.y+ot.y)*Pt,Yt+=Pt*3;Yt===0?ni=vr[0]:ni=[ue/Yt,Ie/Yt];var Os=x.unproject(Ue(ni));return ri([Os.lat+wi.lat,Os.lng+wi.lng])}function ac(f){for(var x=0,A=0,F=0,q=0;q<f.length;q++){var ot=ri(f[q]);x+=ot.lat,A+=ot.lng,F++}return ri([x/F,A/F])}var wl={__proto__:null,clipPolygon:bl,polygonCenter:oc,centroid:ac};function lc(f,x){if(!x||!f.length)return f.slice();var A=x*x;return f=Qr(f,A),f=Ha(f,A),f}function Tl(f,x,A){return Math.sqrt(Xo(f,x,A,!0))}function Dr(f,x,A){return Xo(f,x,A)}function Ha(f,x){var A=f.length,F=typeof Uint8Array<"u"?Uint8Array:Array,q=new F(A);q[0]=q[A-1]=1,Ho(f,q,x,0,A-1);var ot,Pt=[];for(ot=0;ot<A;ot++)q[ot]&&Pt.push(f[ot]);return Pt}function Ho(f,x,A,F,q){var ot=0,Pt,Yt,ue;for(Yt=F+1;Yt<=q-1;Yt++)ue=Xo(f[Yt],f[F],f[q],!0),ue>ot&&(Pt=Yt,ot=ue);ot>A&&(x[Pt]=1,Ho(f,x,A,F,Pt),Ho(f,x,A,Pt,q))}function Qr(f,x){for(var A=[f[0]],F=1,q=0,ot=f.length;F<ot;F++)cc(f[F],f[q])>x&&(A.push(f[F]),q=F);return q<ot-1&&A.push(f[ot-1]),A}var qo;function El(f,x,A,F,q){var ot=F?qo:Ur(f,A),Pt=Ur(x,A),Yt,ue,Ie;for(qo=Pt;;){if(!(ot|Pt))return[f,x];if(ot&Pt)return!1;Yt=ot||Pt,ue=Sl(f,x,Yt,A,q),Ie=Ur(ue,A),Yt===ot?(f=ue,ot=Ie):(x=ue,Pt=Ie)}}function Sl(f,x,A,F,q){var ot=x.x-f.x,Pt=x.y-f.y,Yt=F.min,ue=F.max,Ie,ni;return A&8?(Ie=f.x+ot*(ue.y-f.y)/Pt,ni=ue.y):A&4?(Ie=f.x+ot*(Yt.y-f.y)/Pt,ni=Yt.y):A&2?(Ie=ue.x,ni=f.y+Pt*(ue.x-f.x)/ot):A&1&&(Ie=Yt.x,ni=f.y+Pt*(Yt.x-f.x)/ot),new oe(Ie,ni,q)}function Ur(f,x){var A=0;return f.x<x.min.x?A|=1:f.x>x.max.x&&(A|=2),f.y<x.min.y?A|=4:f.y>x.max.y&&(A|=8),A}function cc(f,x){var A=x.x-f.x,F=x.y-f.y;return A*A+F*F}function Xo(f,x,A,F){var q=x.x,ot=x.y,Pt=A.x-q,Yt=A.y-ot,ue=Pt*Pt+Yt*Yt,Ie;return ue>0&&(Ie=((f.x-q)*Pt+(f.y-ot)*Yt)/ue,Ie>1?(q=A.x,ot=A.y):Ie>0&&(q+=Pt*Ie,ot+=Yt*Ie)),Pt=f.x-q,Yt=f.y-ot,F?Pt*Pt+Yt*Yt:new oe(q,ot)}function Zs(f){return!xt(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function to(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Zs(f)}function eo(f,x){var A,F,q,ot,Pt,Yt,ue,Ie;if(!f||f.length===0)throw new Error("latlngs not passed");Zs(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var ni=ri([0,0]),wi=je(f),Di=wi.getNorthWest().distanceTo(wi.getSouthWest())*wi.getNorthEast().distanceTo(wi.getNorthWest());Di<1700&&(ni=ac(f));var $n=f.length,ss=[];for(A=0;A<$n;A++){var vr=ri(f[A]);ss.push(x.project(ri([vr.lat-ni.lat,vr.lng-ni.lng])))}for(A=0,F=0;A<$n-1;A++)F+=ss[A].distanceTo(ss[A+1])/2;if(F===0)Ie=ss[0];else for(A=0,ot=0;A<$n-1;A++)if(Pt=ss[A],Yt=ss[A+1],q=Pt.distanceTo(Yt),ot+=q,ot>F){ue=(ot-F)/q,Ie=[Yt.x-ue*(Yt.x-Pt.x),Yt.y-ue*(Yt.y-Pt.y)];break}var Hs=x.unproject(Ue(Ie));return ri([Hs.lat+ni.lat,Hs.lng+ni.lng])}var Hi={__proto__:null,simplify:lc,pointToSegmentDistance:Tl,closestPointOnSegment:Dr,clipSegment:El,_getEdgeIntersection:Sl,_getBitCode:Ur,_sqClosestPointOnSegment:Xo,isFlat:Zs,_flat:to,polylineCenter:eo},io={project:function(f){return new oe(f.lng,f.lat)},unproject:function(f){return new Xe(f.y,f.x)},bounds:new $t([-180,-90],[180,90])},uc={R:6378137,R_MINOR:6356752314245179e-9,bounds:new $t([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var x=Math.PI/180,A=this.R,F=f.lat*x,q=this.R_MINOR/A,ot=Math.sqrt(1-q*q),Pt=ot*Math.sin(F),Yt=Math.tan(Math.PI/4-F/2)/Math.pow((1-Pt)/(1+Pt),ot/2);return F=-A*Math.log(Math.max(Yt,1e-10)),new oe(f.lng*x*A,F)},unproject:function(f){for(var x=180/Math.PI,A=this.R,F=this.R_MINOR/A,q=Math.sqrt(1-F*F),ot=Math.exp(-f.y/A),Pt=Math.PI/2-2*Math.atan(ot),Yt=0,ue=.1,Ie;Yt<15&&Math.abs(ue)>1e-7;Yt++)Ie=q*Math.sin(Pt),Ie=Math.pow((1-Ie)/(1+Ie),q/2),ue=Math.PI/2-2*Math.atan(ot*Ie)-Pt,Pt+=ue;return new Xe(Pt*x,f.x*x/A)}},Hc={__proto__:null,LonLat:io,Mercator:uc,SphericalMercator:_n},Nu=c({},Ii,{code:"EPSG:3395",projection:uc,transformation:(function(){var f=.5/(Math.PI*uc.R);return Tt(f,.5,-f,.5)})()}),Ko=c({},Ii,{code:"EPSG:4326",projection:io,transformation:Tt(1/180,1,-1/180,.5)}),qc=c({},vi,{projection:io,transformation:Tt(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,x){var A=x.lng-f.lng,F=x.lat-f.lat;return Math.sqrt(A*A+F*F)},infinite:!0});vi.Earth=Ii,vi.EPSG3395=Nu,vi.EPSG3857=Ft,vi.EPSG900913=Jt,vi.EPSG4326=Ko,vi.Simple=qc;var $r=he.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[r(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[r(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var x=f.target;if(x.hasLayer(this)){if(this._map=x,this._zoomAnimated=x._zoomAnimated,this.getEvents){var A=this.getEvents();x.on(A,this),this.once("remove",function(){x.off(A,this)},this)}this.onAdd(x),this.fire("add"),x.fire("layeradd",{layer:this})}}});Wi.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var x=r(f);return this._layers[x]?this:(this._layers[x]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var x=r(f);return this._layers[x]?(this._loaded&&f.onRemove(this),delete this._layers[x],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return r(f)in this._layers},eachLayer:function(f,x){for(var A in this._layers)f.call(x,this._layers[A]);return this},_addLayers:function(f){f=f?xt(f)?f:[f]:[];for(var x=0,A=f.length;x<A;x++)this.addLayer(f[x])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[r(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var x=r(f);this._zoomBoundLayers[x]&&(delete this._zoomBoundLayers[x],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,x=-1/0,A=this._getZoomSpan();for(var F in this._zoomBoundLayers){var q=this._zoomBoundLayers[F].options;f=q.minZoom===void 0?f:Math.min(f,q.minZoom),x=q.maxZoom===void 0?x:Math.max(x,q.maxZoom)}this._layersMaxZoom=x===-1/0?void 0:x,this._layersMinZoom=f===1/0?void 0:f,A!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var qa=$r.extend({initialize:function(f,x){W(this,x),this._layers={};var A,F;if(f)for(A=0,F=f.length;A<F;A++)this.addLayer(f[A])},addLayer:function(f){var x=this.getLayerId(f);return this._layers[x]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var x=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[x]&&this._map.removeLayer(this._layers[x]),delete this._layers[x],this},hasLayer:function(f){var x=typeof f=="number"?f:this.getLayerId(f);return x in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var x=Array.prototype.slice.call(arguments,1),A,F;for(A in this._layers)F=this._layers[A],F[f]&&F[f].apply(F,x);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,x){for(var A in this._layers)f.call(x,this._layers[A]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return r(f)}}),Ch=function(f,x){return new qa(f,x)},Xn=qa.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),qa.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),qa.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new Ve;for(var x in this._layers){var A=this._layers[x];f.extend(A.getBounds?A.getBounds():A.getLatLng())}return f}}),hc=function(f,x){return new Xn(f,x)},Io=ye.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){W(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,x){var A=this._getIconUrl(f);if(!A){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var F=this._createImg(A,x&&x.tagName==="IMG"?x:null);return this._setIconStyles(F,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(F.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),F},_setIconStyles:function(f,x){var A=this.options,F=A[x+"Size"];typeof F=="number"&&(F=[F,F]);var q=Ue(F),ot=Ue(x==="shadow"&&A.shadowAnchor||A.iconAnchor||q&&q.divideBy(2,!0));f.className="leaflet-marker-"+x+" "+(A.className||""),ot&&(f.style.marginLeft=-ot.x+"px",f.style.marginTop=-ot.y+"px"),q&&(f.style.width=q.x+"px",f.style.height=q.y+"px")},_createImg:function(f,x){return x=x||document.createElement("img"),x.src=f,x},_getIconUrl:function(f){return Le.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function Ml(f){return new Io(f)}var Xa=Io.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Xa.imagePath!="string"&&(Xa.imagePath=this._detectIconPath()),(this.options.imagePath||Xa.imagePath)+Io.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var x=function(A,F,q){var ot=F.exec(A);return ot&&ot[q]};return f=x(f,/^url\((['"])?(.+)\1\)$/,2),f&&x(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Vi("div","leaflet-default-icon-path",document.body),x=le(f,"background-image")||le(f,"backgroundImage");if(document.body.removeChild(f),x=this._stripUrl(x),x)return x;var A=document.querySelector('link[href$="leaflet.css"]');return A?A.href.substring(0,A.href.length-11-1):""}}),Xc=Lr.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new Ni(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Fi(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&gn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var x=this._marker,A=x._map,F=this._marker.options.autoPanSpeed,q=this._marker.options.autoPanPadding,ot=xs(x._icon),Pt=A.getPixelBounds(),Yt=A.getPixelOrigin(),ue=ce(Pt.min._subtract(Yt).add(q),Pt.max._subtract(Yt).subtract(q));if(!ue.contains(ot)){var Ie=Ue((Math.max(ue.max.x,ot.x)-ue.max.x)/(Pt.max.x-ue.max.x)-(Math.min(ue.min.x,ot.x)-ue.min.x)/(Pt.min.x-ue.min.x),(Math.max(ue.max.y,ot.y)-ue.max.y)/(Pt.max.y-ue.max.y)-(Math.min(ue.min.y,ot.y)-ue.min.y)/(Pt.min.y-ue.min.y)).multiplyBy(F);A.panBy(Ie,{animate:!1}),this._draggable._newPos._add(Ie),this._draggable._startPos._add(Ie),Ui(x._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=ee(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(Wt(this._panRequest),this._panRequest=ee(this._adjustPan.bind(this,f)))},_onDrag:function(f){var x=this._marker,A=x._shadow,F=xs(x._icon),q=x._map.layerPointToLatLng(F);A&&Ui(A,F),x._latlng=q,f.latlng=q,f.oldLatLng=this._oldLatLng,x.fire("move",f).fire("drag",f)},_onDragEnd:function(f){Wt(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),Cl=$r.extend({options:{icon:new Xa,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,x){W(this,x),this._latlng=ri(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var x=this._latlng;return this._latlng=ri(f),this.update(),this.fire("move",{oldLatLng:x,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,x="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),A=f.icon.createIcon(this._icon),F=!1;A!==this._icon&&(this._icon&&this._removeIcon(),F=!0,f.title&&(A.title=f.title),A.tagName==="IMG"&&(A.alt=f.alt||"")),Fi(A,x),f.keyboard&&(A.tabIndex="0",A.setAttribute("role","button")),this._icon=A,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&pi(A,"focus",this._panOnFocus,this);var q=f.icon.createShadow(this._shadow),ot=!1;q!==this._shadow&&(this._removeShadow(),ot=!0),q&&(Fi(q,x),q.alt=""),this._shadow=q,f.opacity<1&&this._updateOpacity(),F&&this.getPane().appendChild(this._icon),this._initInteraction(),q&&ot&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&cn(this._icon,"focus",this._panOnFocus,this),Li(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Li(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&Ui(this._icon,f),this._shadow&&Ui(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var x=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(x)},_initInteraction:function(){if(this.options.interactive&&(Fi(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Xc)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Xc(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&hi(this._icon,f),this._shadow&&hi(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var x=this.options.icon.options,A=x.iconSize?Ue(x.iconSize):Ue(0,0),F=x.iconAnchor?Ue(x.iconAnchor):Ue(0,0);f.panInside(this._latlng,{paddingTopLeft:F,paddingBottomRight:A.subtract(F)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Yo(f,x){return new Cl(f,x)}var _r=$r.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return W(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Ka=_r.extend({options:{fill:!0,radius:10},initialize:function(f,x){W(this,x),this._latlng=ri(f),this._radius=this.options.radius},setLatLng:function(f){var x=this._latlng;return this._latlng=ri(f),this.redraw(),this.fire("move",{oldLatLng:x,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var x=f&&f.radius||this._radius;return _r.prototype.setStyle.call(this,f),this.setRadius(x),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,x=this._radiusY||f,A=this._clickTolerance(),F=[f+A,x+A];this._pxBounds=new $t(this._point.subtract(F),this._point.add(F))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ya(f,x){return new Ka(f,x)}var Al=Ka.extend({initialize:function(f,x,A){if(typeof x=="number"&&(x=c({},A,{radius:x})),W(this,x),this._latlng=ri(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new Ve(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:_r.prototype.setStyle,_project:function(){var f=this._latlng.lng,x=this._latlng.lat,A=this._map,F=A.options.crs;if(F.distance===Ii.distance){var q=Math.PI/180,ot=this._mRadius/Ii.R/q,Pt=A.project([x+ot,f]),Yt=A.project([x-ot,f]),ue=Pt.add(Yt).divideBy(2),Ie=A.unproject(ue).lat,ni=Math.acos((Math.cos(ot*q)-Math.sin(x*q)*Math.sin(Ie*q))/(Math.cos(x*q)*Math.cos(Ie*q)))/q;(isNaN(ni)||ni===0)&&(ni=ot/Math.cos(Math.PI/180*x)),this._point=ue.subtract(A.getPixelOrigin()),this._radius=isNaN(ni)?0:ue.x-A.project([Ie,f-ni]).x,this._radiusY=ue.y-Pt.y}else{var wi=F.unproject(F.project(this._latlng).subtract([this._mRadius,0]));this._point=A.latLngToLayerPoint(this._latlng),this._radius=this._point.x-A.latLngToLayerPoint(wi).x}this._updateBounds()}});function no(f,x,A){return new Al(f,x,A)}var gr=_r.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,x){W(this,x),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var x=1/0,A=null,F=Xo,q,ot,Pt=0,Yt=this._parts.length;Pt<Yt;Pt++)for(var ue=this._parts[Pt],Ie=1,ni=ue.length;Ie<ni;Ie++){q=ue[Ie-1],ot=ue[Ie];var wi=F(f,q,ot,!0);wi<x&&(x=wi,A=F(f,q,ot))}return A&&(A.distance=Math.sqrt(x)),A},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return eo(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,x){return x=x||this._defaultShape(),f=ri(f),x.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new Ve,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return Zs(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var x=[],A=Zs(f),F=0,q=f.length;F<q;F++)A?(x[F]=ri(f[F]),this._bounds.extend(x[F])):x[F]=this._convertLatLngs(f[F]);return x},_project:function(){var f=new $t;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),x=new oe(f,f);this._rawPxBounds&&(this._pxBounds=new $t([this._rawPxBounds.min.subtract(x),this._rawPxBounds.max.add(x)]))},_projectLatlngs:function(f,x,A){var F=f[0]instanceof Xe,q=f.length,ot,Pt;if(F){for(Pt=[],ot=0;ot<q;ot++)Pt[ot]=this._map.latLngToLayerPoint(f[ot]),A.extend(Pt[ot]);x.push(Pt)}else for(ot=0;ot<q;ot++)this._projectLatlngs(f[ot],x,A)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var x=this._parts,A,F,q,ot,Pt,Yt,ue;for(A=0,q=0,ot=this._rings.length;A<ot;A++)for(ue=this._rings[A],F=0,Pt=ue.length;F<Pt-1;F++)Yt=El(ue[F],ue[F+1],f,F,!0),Yt&&(x[q]=x[q]||[],x[q].push(Yt[0]),(Yt[1]!==ue[F+1]||F===Pt-2)&&(x[q].push(Yt[1]),q++))}},_simplifyPoints:function(){for(var f=this._parts,x=this.options.smoothFactor,A=0,F=f.length;A<F;A++)f[A]=lc(f[A],x)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,x){var A,F,q,ot,Pt,Yt,ue=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(A=0,ot=this._parts.length;A<ot;A++)for(Yt=this._parts[A],F=0,Pt=Yt.length,q=Pt-1;F<Pt;q=F++)if(!(!x&&F===0)&&Tl(f,Yt[q],Yt[F])<=ue)return!0;return!1}});function dc(f,x){return new gr(f,x)}gr._flat=to;var so=gr.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return oc(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var x=gr.prototype._convertLatLngs.call(this,f),A=x.length;return A>=2&&x[0]instanceof Xe&&x[0].equals(x[A-1])&&x.pop(),x},_setLatLngs:function(f){gr.prototype._setLatLngs.call(this,f),Zs(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Zs(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,x=this.options.weight,A=new oe(x,x);if(f=new $t(f.min.subtract(A),f.max.add(A)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var F=0,q=this._rings.length,ot;F<q;F++)ot=bl(this._rings[F],f,!0),ot.length&&this._parts.push(ot)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var x=!1,A,F,q,ot,Pt,Yt,ue,Ie;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(ot=0,ue=this._parts.length;ot<ue;ot++)for(A=this._parts[ot],Pt=0,Ie=A.length,Yt=Ie-1;Pt<Ie;Yt=Pt++)F=A[Pt],q=A[Yt],F.y>f.y!=q.y>f.y&&f.x<(q.x-F.x)*(f.y-F.y)/(q.y-F.y)+F.x&&(x=!x);return x||gr.prototype._containsPoint.call(this,f,!0)}});function Pl(f,x){return new so(f,x)}var zr=Xn.extend({initialize:function(f,x){W(this,x),this._layers={},f&&this.addData(f)},addData:function(f){var x=xt(f)?f:f.features,A,F,q;if(x){for(A=0,F=x.length;A<F;A++)q=x[A],(q.geometries||q.geometry||q.features||q.coordinates)&&this.addData(q);return this}var ot=this.options;if(ot.filter&&!ot.filter(f))return this;var Pt=Ja(f,ot);return Pt?(Pt.feature=el(f),Pt.defaultOptions=Pt.options,this.resetStyle(Pt),ot.onEachFeature&&ot.onEachFeature(f,Pt),this.addLayer(Pt)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=c({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(x){this._setLayerStyle(x,f)},this)},_setLayerStyle:function(f,x){f.setStyle&&(typeof x=="function"&&(x=x(f.feature)),f.setStyle(x))}});function Ja(f,x){var A=f.type==="Feature"?f.geometry:f,F=A?A.coordinates:null,q=[],ot=x&&x.pointToLayer,Pt=x&&x.coordsToLatLng||Qa,Yt,ue,Ie,ni;if(!F&&!A)return null;switch(A.type){case"Point":return Yt=Pt(F),Gs(ot,f,Yt,x);case"MultiPoint":for(Ie=0,ni=F.length;Ie<ni;Ie++)Yt=Pt(F[Ie]),q.push(Gs(ot,f,Yt,x));return new Xn(q);case"LineString":case"MultiLineString":return ue=Jo(F,A.type==="LineString"?0:1,Pt),new gr(ue,x);case"Polygon":case"MultiPolygon":return ue=Jo(F,A.type==="Polygon"?1:2,Pt),new so(ue,x);case"GeometryCollection":for(Ie=0,ni=A.geometries.length;Ie<ni;Ie++){var wi=Ja({geometry:A.geometries[Ie],type:"Feature",properties:f.properties},x);wi&&q.push(wi)}return new Xn(q);case"FeatureCollection":for(Ie=0,ni=A.features.length;Ie<ni;Ie++){var Di=Ja(A.features[Ie],x);Di&&q.push(Di)}return new Xn(q);default:throw new Error("Invalid GeoJSON object.")}}function Gs(f,x,A,F){return f?f(x,A):new Cl(A,F&&F.markersInheritOptions&&F)}function Qa(f){return new Xe(f[1],f[0],f[2])}function Jo(f,x,A){for(var F=[],q=0,ot=f.length,Pt;q<ot;q++)Pt=x?Jo(f[q],x-1,A):(A||Qa)(f[q]),F.push(Pt);return F}function kl(f,x){return f=ri(f),f.alt!==void 0?[R(f.lng,x),R(f.lat,x),R(f.alt,x)]:[R(f.lng,x),R(f.lat,x)]}function va(f,x,A,F){for(var q=[],ot=0,Pt=f.length;ot<Pt;ot++)q.push(x?va(f[ot],Zs(f[ot])?0:x-1,A,F):kl(f[ot],F));return!x&&A&&q.length>0&&q.push(q[0].slice()),q}function tl(f,x){return f.feature?c({},f.feature,{geometry:x}):el(x)}function el(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var fc={toGeoJSON:function(f){return tl(this,{type:"Point",coordinates:kl(this.getLatLng(),f)})}};Cl.include(fc),Al.include(fc),Ka.include(fc),gr.include({toGeoJSON:function(f){var x=!Zs(this._latlngs),A=va(this._latlngs,x?1:0,!1,f);return tl(this,{type:(x?"Multi":"")+"LineString",coordinates:A})}}),so.include({toGeoJSON:function(f){var x=!Zs(this._latlngs),A=x&&!Zs(this._latlngs[0]),F=va(this._latlngs,A?2:x?1:0,!0,f);return x||(F=[F]),tl(this,{type:(A?"Multi":"")+"Polygon",coordinates:F})}}),qa.include({toMultiPoint:function(f){var x=[];return this.eachLayer(function(A){x.push(A.toGeoJSON(f).geometry.coordinates)}),tl(this,{type:"MultiPoint",coordinates:x})},toGeoJSON:function(f){var x=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(x==="MultiPoint")return this.toMultiPoint(f);var A=x==="GeometryCollection",F=[];return this.eachLayer(function(q){if(q.toGeoJSON){var ot=q.toGeoJSON(f);if(A)F.push(ot.geometry);else{var Pt=el(ot);Pt.type==="FeatureCollection"?F.push.apply(F,Pt.features):F.push(Pt)}}}),A?tl(this,{geometries:F,type:"GeometryCollection"}):{type:"FeatureCollection",features:F}}});function il(f,x){return new zr(f,x)}var ju=il,xa=$r.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,x,A){this._url=f,this._bounds=je(x),W(this,A)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Fi(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Li(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&Uo(this._image),this},bringToBack:function(){return this._map&&Is(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=je(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",x=this._image=f?this._url:Vi("img");if(Fi(x,"leaflet-image-layer"),this._zoomAnimated&&Fi(x,"leaflet-zoom-animated"),this.options.className&&Fi(x,this.options.className),x.onselectstart=z,x.onmousemove=z,x.onload=_(this.fire,this,"load"),x.onerror=_(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(x.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=x.src;return}x.src=this._url,x.alt=this.options.alt},_animateZoom:function(f){var x=this._map.getZoomScale(f.zoom),A=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;xi(this._image,A,x)},_reset:function(){var f=this._image,x=new $t(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),A=x.getSize();Ui(f,x.min),f.style.width=A.x+"px",f.style.height=A.y+"px"},_updateOpacity:function(){hi(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),Kc=function(f,x,A){return new xa(f,x,A)},Qo=xa.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",x=this._image=f?this._url:Vi("video");if(Fi(x,"leaflet-image-layer"),this._zoomAnimated&&Fi(x,"leaflet-zoom-animated"),this.options.className&&Fi(x,this.options.className),x.onselectstart=z,x.onmousemove=z,x.onloadeddata=_(this.fire,this,"load"),f){for(var A=x.getElementsByTagName("source"),F=[],q=0;q<A.length;q++)F.push(A[q].src);this._url=A.length>0?F:[x.src];return}xt(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(x.style,"objectFit")&&(x.style.objectFit="fill"),x.autoplay=!!this.options.autoplay,x.loop=!!this.options.loop,x.muted=!!this.options.muted,x.playsInline=!!this.options.playsInline;for(var ot=0;ot<this._url.length;ot++){var Pt=Vi("source");Pt.src=this._url[ot],x.appendChild(Pt)}}});function Yc(f,x,A){return new Qo(f,x,A)}var Vu=xa.extend({_initImage:function(){var f=this._image=this._url;Fi(f,"leaflet-image-layer"),this._zoomAnimated&&Fi(f,"leaflet-zoom-animated"),this.options.className&&Fi(f,this.options.className),f.onselectstart=z,f.onmousemove=z}});function Ah(f,x,A){return new Vu(f,x,A)}var zs=$r.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,x){f&&(f instanceof Xe||xt(f))?(this._latlng=ri(f),W(this,x)):(W(this,f),this._source=x),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&hi(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&hi(this._container,1),this.bringToFront(),this.options.interactive&&(Fi(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(hi(this._container,0),this._removeTimeout=setTimeout(_(Li,void 0,this._container),200)):Li(this._container),this.options.interactive&&(gn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=ri(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Uo(this._container),this},bringToBack:function(){return this._map&&Is(this._container),this},_prepareOpen:function(f){var x=this._source;if(!x._map)return!1;if(x instanceof Xn){x=null;var A=this._source._layers;for(var F in A)if(A[F]._map){x=A[F];break}if(!x)return!1;this._source=x}if(!f)if(x.getCenter)f=x.getCenter();else if(x.getLatLng)f=x.getLatLng();else if(x.getBounds)f=x.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,x=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof x=="string")f.innerHTML=x;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(x)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),x=Ue(this.options.offset),A=this._getAnchor();this._zoomAnimated?Ui(this._container,f.add(A)):x=x.add(f).add(A);var F=this._containerBottom=-x.y,q=this._containerLeft=-Math.round(this._containerWidth/2)+x.x;this._container.style.bottom=F+"px",this._container.style.left=q+"px"}},_getAnchor:function(){return[0,0]}});Wi.include({_initOverlay:function(f,x,A,F){var q=x;return q instanceof f||(q=new f(F).setContent(x)),A&&q.setLatLng(A),q}}),$r.include({_initOverlay:function(f,x,A,F){var q=A;return q instanceof f?(W(q,F),q._source=this):(q=x&&!F?x:new f(F,this),q.setContent(A)),q}});var Or=zs.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,zs.prototype.openOn.call(this,f)},onAdd:function(f){zs.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof _r||this._source.on("preclick",Ar))},onRemove:function(f){zs.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof _r||this._source.off("preclick",Ar))},getEvents:function(){var f=zs.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",x=this._container=Vi("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),A=this._wrapper=Vi("div",f+"-content-wrapper",x);if(this._contentNode=Vi("div",f+"-content",A),Pr(x),yn(this._contentNode),pi(x,"contextmenu",Ar),this._tipContainer=Vi("div",f+"-tip-container",x),this._tip=Vi("div",f+"-tip",this._tipContainer),this.options.closeButton){var F=this._closeButton=Vi("a",f+"-close-button",x);F.setAttribute("role","button"),F.setAttribute("aria-label","Close popup"),F.href="#close",F.innerHTML='<span aria-hidden="true">&#215;</span>',pi(F,"click",function(q){Gn(q),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,x=f.style;x.width="",x.whiteSpace="nowrap";var A=f.offsetWidth;A=Math.min(A,this.options.maxWidth),A=Math.max(A,this.options.minWidth),x.width=A+1+"px",x.whiteSpace="",x.height="";var F=f.offsetHeight,q=this.options.maxHeight,ot="leaflet-popup-scrolled";q&&F>q?(x.height=q+"px",Fi(f,ot)):gn(f,ot),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var x=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),A=this._getAnchor();Ui(this._container,x.add(A))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,x=parseInt(le(this._container,"marginBottom"),10)||0,A=this._container.offsetHeight+x,F=this._containerWidth,q=new oe(this._containerLeft,-A-this._containerBottom);q._add(xs(this._container));var ot=f.layerPointToContainerPoint(q),Pt=Ue(this.options.autoPanPadding),Yt=Ue(this.options.autoPanPaddingTopLeft||Pt),ue=Ue(this.options.autoPanPaddingBottomRight||Pt),Ie=f.getSize(),ni=0,wi=0;ot.x+F+ue.x>Ie.x&&(ni=ot.x+F-Ie.x+ue.x),ot.x-ni-Yt.x<0&&(ni=ot.x-Yt.x),ot.y+A+ue.y>Ie.y&&(wi=ot.y+A-Ie.y+ue.y),ot.y-wi-Yt.y<0&&(wi=ot.y-Yt.y),(ni||wi)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([ni,wi]))}},_getAnchor:function(){return Ue(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Jc=function(f,x){return new Or(f,x)};Wi.mergeOptions({closePopupOnClick:!0}),Wi.include({openPopup:function(f,x,A){return this._initOverlay(Or,f,x,A).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),$r.include({bindPopup:function(f,x){return this._popup=this._initOverlay(Or,this._popup,f,x),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof Xn||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){pr(f);var x=f.layer||f.target;if(this._popup._source===x&&!(x instanceof _r)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=x,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var ba=zs.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){zs.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){zs.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=zs.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",x=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Vi("div",x),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+r(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var x,A,F=this._map,q=this._container,ot=F.latLngToContainerPoint(F.getCenter()),Pt=F.layerPointToContainerPoint(f),Yt=this.options.direction,ue=q.offsetWidth,Ie=q.offsetHeight,ni=Ue(this.options.offset),wi=this._getAnchor();Yt==="top"?(x=ue/2,A=Ie):Yt==="bottom"?(x=ue/2,A=0):Yt==="center"?(x=ue/2,A=Ie/2):Yt==="right"?(x=0,A=Ie/2):Yt==="left"?(x=ue,A=Ie/2):Pt.x<ot.x?(Yt="right",x=0,A=Ie/2):(Yt="left",x=ue+(ni.x+wi.x)*2,A=Ie/2),f=f.subtract(Ue(x,A,!0)).add(ni).add(wi),gn(q,"leaflet-tooltip-right"),gn(q,"leaflet-tooltip-left"),gn(q,"leaflet-tooltip-top"),gn(q,"leaflet-tooltip-bottom"),Fi(q,"leaflet-tooltip-"+Yt),Ui(q,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&hi(this._container,f)},_animateZoom:function(f){var x=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(x)},_getAnchor:function(){return Ue(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),wa=function(f,x){return new ba(f,x)};Wi.include({openTooltip:function(f,x,A){return this._initOverlay(ba,f,x,A).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),$r.include({bindTooltip:function(f,x){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ba,this._tooltip,f,x),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var x=f?"off":"on",A={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?A.add=this._openTooltip:(A.mouseover=this._openTooltip,A.mouseout=this.closeTooltip,A.click=this._openTooltip,this._map?this._addFocusListeners():A.add=this._addFocusListeners),this._tooltip.options.sticky&&(A.mousemove=this._moveTooltip),this[x](A),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof Xn||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var x=typeof f.getElement=="function"&&f.getElement();x&&(pi(x,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),pi(x,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var x=typeof f.getElement=="function"&&f.getElement();x&&x.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var x=this;this._map.once("moveend",function(){x._openOnceFlag=!1,x._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var x=f.latlng,A,F;this._tooltip.options.sticky&&f.originalEvent&&(A=this._map.mouseEventToContainerPoint(f.originalEvent),F=this._map.containerPointToLayerPoint(A),x=this._map.layerPointToLatLng(F)),this._tooltip.setLatLng(x)}});var pc=Io.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var x=f&&f.tagName==="DIV"?f:document.createElement("div"),A=this.options;if(A.html instanceof Element?(Un(x),x.appendChild(A.html)):x.innerHTML=A.html!==!1?A.html:"",A.bgPos){var F=Ue(A.bgPos);x.style.backgroundPosition=-F.x+"px "+-F.y+"px"}return this._setIconStyles(x,"icon"),x},createShadow:function(){return null}});function Qc(f){return new pc(f)}Io.Default=Xa;var tr=$r.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Le.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){W(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),Li(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Uo(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Is(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=E(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof oe?f:new oe(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var x=this.getPane().children,A=-f(-1/0,1/0),F=0,q=x.length,ot;F<q;F++)ot=x[F].style.zIndex,x[F]!==this._container&&ot&&(A=f(A,+ot));isFinite(A)&&(this.options.zIndex=A+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Le.ielt9){hi(this._container,this.options.opacity);var f=+new Date,x=!1,A=!1;for(var F in this._tiles){var q=this._tiles[F];if(!(!q.current||!q.loaded)){var ot=Math.min(1,(f-q.loaded)/200);hi(q.el,ot),ot<1?x=!0:(q.active?A=!0:this._onOpaqueTile(q),q.active=!0)}}A&&!this._noPrune&&this._pruneTiles(),x&&(Wt(this._fadeFrame),this._fadeFrame=ee(this._updateOpacity,this))}},_onOpaqueTile:z,_initContainer:function(){this._container||(this._container=Vi("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,x=this.options.maxZoom;if(f!==void 0){for(var A in this._levels)A=Number(A),this._levels[A].el.children.length||A===f?(this._levels[A].el.style.zIndex=x-Math.abs(f-A),this._onUpdateLevel(A)):(Li(this._levels[A].el),this._removeTilesAtZoom(A),this._onRemoveLevel(A),delete this._levels[A]);var F=this._levels[f],q=this._map;return F||(F=this._levels[f]={},F.el=Vi("div","leaflet-tile-container leaflet-zoom-animated",this._container),F.el.style.zIndex=x,F.origin=q.project(q.unproject(q.getPixelOrigin()),f).round(),F.zoom=f,this._setZoomTransform(F,q.getCenter(),q.getZoom()),z(F.el.offsetWidth),this._onCreateLevel(F)),this._level=F,F}},_onUpdateLevel:z,_onRemoveLevel:z,_onCreateLevel:z,_pruneTiles:function(){if(this._map){var f,x,A=this._map.getZoom();if(A>this.options.maxZoom||A<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)x=this._tiles[f],x.retain=x.current;for(f in this._tiles)if(x=this._tiles[f],x.current&&!x.active){var F=x.coords;this._retainParent(F.x,F.y,F.z,F.z-5)||this._retainChildren(F.x,F.y,F.z,F.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var x in this._tiles)this._tiles[x].coords.z===f&&this._removeTile(x)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)Li(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,x,A,F){var q=Math.floor(f/2),ot=Math.floor(x/2),Pt=A-1,Yt=new oe(+q,+ot);Yt.z=+Pt;var ue=this._tileCoordsToKey(Yt),Ie=this._tiles[ue];return Ie&&Ie.active?(Ie.retain=!0,!0):(Ie&&Ie.loaded&&(Ie.retain=!0),Pt>F?this._retainParent(q,ot,Pt,F):!1)},_retainChildren:function(f,x,A,F){for(var q=2*f;q<2*f+2;q++)for(var ot=2*x;ot<2*x+2;ot++){var Pt=new oe(q,ot);Pt.z=A+1;var Yt=this._tileCoordsToKey(Pt),ue=this._tiles[Yt];if(ue&&ue.active){ue.retain=!0;continue}else ue&&ue.loaded&&(ue.retain=!0);A+1<F&&this._retainChildren(q,ot,A+1,F)}},_resetView:function(f){var x=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),x,x)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var x=this.options;return x.minNativeZoom!==void 0&&f<x.minNativeZoom?x.minNativeZoom:x.maxNativeZoom!==void 0&&x.maxNativeZoom<f?x.maxNativeZoom:f},_setView:function(f,x,A,F){var q=Math.round(x);this.options.maxZoom!==void 0&&q>this.options.maxZoom||this.options.minZoom!==void 0&&q<this.options.minZoom?q=void 0:q=this._clampZoom(q);var ot=this.options.updateWhenZooming&&q!==this._tileZoom;(!F||ot)&&(this._tileZoom=q,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),q!==void 0&&this._update(f),A||this._pruneTiles(),this._noPrune=!!A),this._setZoomTransforms(f,x)},_setZoomTransforms:function(f,x){for(var A in this._levels)this._setZoomTransform(this._levels[A],f,x)},_setZoomTransform:function(f,x,A){var F=this._map.getZoomScale(A,f.zoom),q=f.origin.multiplyBy(F).subtract(this._map._getNewPixelOrigin(x,A)).round();Le.any3d?xi(f.el,q,F):Ui(f.el,q)},_resetGrid:function(){var f=this._map,x=f.options.crs,A=this._tileSize=this.getTileSize(),F=this._tileZoom,q=this._map.getPixelWorldBounds(this._tileZoom);q&&(this._globalTileRange=this._pxBoundsToTileRange(q)),this._wrapX=x.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,x.wrapLng[0]],F).x/A.x),Math.ceil(f.project([0,x.wrapLng[1]],F).x/A.y)],this._wrapY=x.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([x.wrapLat[0],0],F).y/A.x),Math.ceil(f.project([x.wrapLat[1],0],F).y/A.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var x=this._map,A=x._animatingZoom?Math.max(x._animateToZoom,x.getZoom()):x.getZoom(),F=x.getZoomScale(A,this._tileZoom),q=x.project(f,this._tileZoom).floor(),ot=x.getSize().divideBy(F*2);return new $t(q.subtract(ot),q.add(ot))},_update:function(f){var x=this._map;if(x){var A=this._clampZoom(x.getZoom());if(f===void 0&&(f=x.getCenter()),this._tileZoom!==void 0){var F=this._getTiledPixelBounds(f),q=this._pxBoundsToTileRange(F),ot=q.getCenter(),Pt=[],Yt=this.options.keepBuffer,ue=new $t(q.getBottomLeft().subtract([Yt,-Yt]),q.getTopRight().add([Yt,-Yt]));if(!(isFinite(q.min.x)&&isFinite(q.min.y)&&isFinite(q.max.x)&&isFinite(q.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ie in this._tiles){var ni=this._tiles[Ie].coords;(ni.z!==this._tileZoom||!ue.contains(new oe(ni.x,ni.y)))&&(this._tiles[Ie].current=!1)}if(Math.abs(A-this._tileZoom)>1){this._setView(f,A);return}for(var wi=q.min.y;wi<=q.max.y;wi++)for(var Di=q.min.x;Di<=q.max.x;Di++){var $n=new oe(Di,wi);if($n.z=this._tileZoom,!!this._isValidTile($n)){var ss=this._tiles[this._tileCoordsToKey($n)];ss?ss.current=!0:Pt.push($n)}}if(Pt.sort(function(Hs,Os){return Hs.distanceTo(ot)-Os.distanceTo(ot)}),Pt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var vr=document.createDocumentFragment();for(Di=0;Di<Pt.length;Di++)this._addTile(Pt[Di],vr);this._level.el.appendChild(vr)}}}},_isValidTile:function(f){var x=this._map.options.crs;if(!x.infinite){var A=this._globalTileRange;if(!x.wrapLng&&(f.x<A.min.x||f.x>A.max.x)||!x.wrapLat&&(f.y<A.min.y||f.y>A.max.y))return!1}if(!this.options.bounds)return!0;var F=this._tileCoordsToBounds(f);return je(this.options.bounds).overlaps(F)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var x=this._map,A=this.getTileSize(),F=f.scaleBy(A),q=F.add(A),ot=x.unproject(F,f.z),Pt=x.unproject(q,f.z);return[ot,Pt]},_tileCoordsToBounds:function(f){var x=this._tileCoordsToNwSe(f),A=new Ve(x[0],x[1]);return this.options.noWrap||(A=this._map.wrapLatLngBounds(A)),A},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var x=f.split(":"),A=new oe(+x[0],+x[1]);return A.z=+x[2],A},_removeTile:function(f){var x=this._tiles[f];x&&(Li(x.el),delete this._tiles[f],this.fire("tileunload",{tile:x.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){Fi(f,"leaflet-tile");var x=this.getTileSize();f.style.width=x.x+"px",f.style.height=x.y+"px",f.onselectstart=z,f.onmousemove=z,Le.ielt9&&this.options.opacity<1&&hi(f,this.options.opacity)},_addTile:function(f,x){var A=this._getTilePos(f),F=this._tileCoordsToKey(f),q=this.createTile(this._wrapCoords(f),_(this._tileReady,this,f));this._initTile(q),this.createTile.length<2&&ee(_(this._tileReady,this,f,null,q)),Ui(q,A),this._tiles[F]={el:q,coords:f,current:!0},x.appendChild(q),this.fire("tileloadstart",{tile:q,coords:f})},_tileReady:function(f,x,A){x&&this.fire("tileerror",{error:x,tile:A,coords:f});var F=this._tileCoordsToKey(f);A=this._tiles[F],A&&(A.loaded=+new Date,this._map._fadeAnimated?(hi(A.el,0),Wt(this._fadeFrame),this._fadeFrame=ee(this._updateOpacity,this)):(A.active=!0,this._pruneTiles()),x||(Fi(A.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:A.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Le.ielt9||!this._map._fadeAnimated?ee(this._pruneTiles,this):setTimeout(_(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var x=new oe(this._wrapX?C(f.x,this._wrapX):f.x,this._wrapY?C(f.y,this._wrapY):f.y);return x.z=f.z,x},_pxBoundsToTileRange:function(f){var x=this.getTileSize();return new $t(f.min.unscaleBy(x).floor(),f.max.unscaleBy(x).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function mc(f){return new tr(f)}var ws=tr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,x){this._url=f,x=W(this,x),x.detectRetina&&Le.retina&&x.maxZoom>0?(x.tileSize=Math.floor(x.tileSize/2),x.zoomReverse?(x.zoomOffset--,x.minZoom=Math.min(x.maxZoom,x.minZoom+1)):(x.zoomOffset++,x.maxZoom=Math.max(x.minZoom,x.maxZoom-1)),x.minZoom=Math.max(0,x.minZoom)):x.zoomReverse?x.minZoom=Math.min(x.maxZoom,x.minZoom):x.maxZoom=Math.max(x.minZoom,x.maxZoom),typeof x.subdomains=="string"&&(x.subdomains=x.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,x){return this._url===f&&x===void 0&&(x=!0),this._url=f,x||this.redraw(),this},createTile:function(f,x){var A=document.createElement("img");return pi(A,"load",_(this._tileOnLoad,this,x,A)),pi(A,"error",_(this._tileOnError,this,x,A)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(A.referrerPolicy=this.options.referrerPolicy),A.alt="",A.src=this.getTileUrl(f),A},getTileUrl:function(f){var x={r:Le.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var A=this._globalTileRange.max.y-f.y;this.options.tms&&(x.y=A),x["-y"]=A}return ft(this._url,c(x,this.options))},_tileOnLoad:function(f,x){Le.ielt9?setTimeout(_(f,this,null,x),0):f(null,x)},_tileOnError:function(f,x,A){var F=this.options.errorTileUrl;F&&x.getAttribute("src")!==F&&(x.src=F),f(A,x)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,x=this.options.maxZoom,A=this.options.zoomReverse,F=this.options.zoomOffset;return A&&(f=x-f),f+F},_getSubdomain:function(f){var x=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[x]},_abortLoading:function(){var f,x;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(x=this._tiles[f].el,x.onload=z,x.onerror=z,!x.complete)){x.src=bt;var A=this._tiles[f].coords;Li(x),delete this._tiles[f],this.fire("tileabort",{tile:x,coords:A})}},_removeTile:function(f){var x=this._tiles[f];if(x)return x.el.setAttribute("src",bt),tr.prototype._removeTile.call(this,f)},_tileReady:function(f,x,A){if(!(!this._map||A&&A.getAttribute("src")===bt))return tr.prototype._tileReady.call(this,f,x,A)}});function nl(f,x){return new ws(f,x)}var _c=ws.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,x){this._url=f;var A=c({},this.defaultWmsParams);for(var F in x)F in this.options||(A[F]=x[F]);x=W(this,x);var q=x.detectRetina&&Le.retina?2:1,ot=this.getTileSize();A.width=ot.x*q,A.height=ot.y*q,this.wmsParams=A},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var x=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[x]=this._crs.code,ws.prototype.onAdd.call(this,f)},getTileUrl:function(f){var x=this._tileCoordsToNwSe(f),A=this._crs,F=ce(A.project(x[0]),A.project(x[1])),q=F.min,ot=F.max,Pt=(this._wmsVersion>=1.3&&this._crs===Ko?[q.y,q.x,ot.y,ot.x]:[q.x,q.y,ot.x,ot.y]).join(","),Yt=ws.prototype.getTileUrl.call(this,f);return Yt+Q(this.wmsParams,Yt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Pt},setParams:function(f,x){return c(this.wmsParams,f),x||this.redraw(),this}});function ta(f,x){return new _c(f,x)}ws.WMS=_c,nl.wms=ta;var er=$r.extend({options:{padding:.1},initialize:function(f){W(this,f),r(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Fi(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,x){var A=this._map.getZoomScale(x,this._zoom),F=this._map.getSize().multiplyBy(.5+this.options.padding),q=this._map.project(this._center,x),ot=F.multiplyBy(-A).add(q).subtract(this._map._getNewPixelOrigin(f,x));Le.any3d?xi(this._container,ot,A):Ui(this._container,ot)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,x=this._map.getSize(),A=this._map.containerPointToLayerPoint(x.multiplyBy(-f)).round();this._bounds=new $t(A,A.add(x.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Il=er.extend({options:{tolerance:0},getEvents:function(){var f=er.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){er.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");pi(f,"mousemove",this._onMouseMove,this),pi(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),pi(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){Wt(this._redrawRequest),delete this._ctx,Li(this._container),cn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var x in this._layers)f=this._layers[x],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){er.prototype._update.call(this);var f=this._bounds,x=this._container,A=f.getSize(),F=Le.retina?2:1;Ui(x,f.min),x.width=F*A.x,x.height=F*A.y,x.style.width=A.x+"px",x.style.height=A.y+"px",Le.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){er.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[r(f)]=f;var x=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=x),this._drawLast=x,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var x=f._order,A=x.next,F=x.prev;A?A.prev=F:this._drawLast=F,F?F.next=A:this._drawFirst=A,delete f._order,delete this._layers[r(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var x=f.options.dashArray.split(/[, ]+/),A=[],F,q;for(q=0;q<x.length;q++){if(F=Number(x[q]),isNaN(F))return;A.push(F)}f.options._dashArray=A}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||ee(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var x=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new $t,this._redrawBounds.extend(f._pxBounds.min.subtract([x,x])),this._redrawBounds.extend(f._pxBounds.max.add([x,x]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var x=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,x.x,x.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,x=this._redrawBounds;if(this._ctx.save(),x){var A=x.getSize();this._ctx.beginPath(),this._ctx.rect(x.min.x,x.min.y,A.x,A.y),this._ctx.clip()}this._drawing=!0;for(var F=this._drawFirst;F;F=F.next)f=F.layer,(!x||f._pxBounds&&f._pxBounds.intersects(x))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,x){if(this._drawing){var A,F,q,ot,Pt=f._parts,Yt=Pt.length,ue=this._ctx;if(Yt){for(ue.beginPath(),A=0;A<Yt;A++){for(F=0,q=Pt[A].length;F<q;F++)ot=Pt[A][F],ue[F?"lineTo":"moveTo"](ot.x,ot.y);x&&ue.closePath()}this._fillStroke(ue,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var x=f._point,A=this._ctx,F=Math.max(Math.round(f._radius),1),q=(Math.max(Math.round(f._radiusY),1)||F)/F;q!==1&&(A.save(),A.scale(1,q)),A.beginPath(),A.arc(x.x,x.y/q,F,0,Math.PI*2,!1),q!==1&&A.restore(),this._fillStroke(A,f)}},_fillStroke:function(f,x){var A=x.options;A.fill&&(f.globalAlpha=A.fillOpacity,f.fillStyle=A.fillColor||A.color,f.fill(A.fillRule||"evenodd")),A.stroke&&A.weight!==0&&(f.setLineDash&&f.setLineDash(x.options&&x.options._dashArray||[]),f.globalAlpha=A.opacity,f.lineWidth=A.weight,f.strokeStyle=A.color,f.lineCap=A.lineCap,f.lineJoin=A.lineJoin,f.stroke())},_onClick:function(f){for(var x=this._map.mouseEventToLayerPoint(f),A,F,q=this._drawFirst;q;q=q.next)A=q.layer,A.options.interactive&&A._containsPoint(x)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(A))&&(F=A);this._fireEvent(F?[F]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var x=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,x)}},_handleMouseOut:function(f){var x=this._hoveredLayer;x&&(gn(this._container,"leaflet-interactive"),this._fireEvent([x],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,x){if(!this._mouseHoverThrottled){for(var A,F,q=this._drawFirst;q;q=q.next)A=q.layer,A.options.interactive&&A._containsPoint(x)&&(F=A);F!==this._hoveredLayer&&(this._handleMouseOut(f),F&&(Fi(this._container,"leaflet-interactive"),this._fireEvent([F],f,"mouseover"),this._hoveredLayer=F)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(_(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,x,A){this._map._fireDOMEvent(x,A||x.type,f)},_bringToFront:function(f){var x=f._order;if(x){var A=x.next,F=x.prev;if(A)A.prev=F;else return;F?F.next=A:A&&(this._drawFirst=A),x.prev=this._drawLast,this._drawLast.next=x,x.next=null,this._drawLast=x,this._requestRedraw(f)}},_bringToBack:function(f){var x=f._order;if(x){var A=x.next,F=x.prev;if(F)F.next=A;else return;A?A.prev=F:F&&(this._drawLast=F),x.prev=null,x.next=this._drawFirst,this._drawFirst.prev=x,this._drawFirst=x,this._requestRedraw(f)}}});function Ll(f){return Le.canvas?new Il(f):null}var Zi=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Dl={_initContainer:function(){this._container=Vi("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(er.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var x=f._container=Zi("shape");Fi(x,"leaflet-vml-shape "+(this.options.className||"")),x.coordsize="1 1",f._path=Zi("path"),x.appendChild(f._path),this._updateStyle(f),this._layers[r(f)]=f},_addPath:function(f){var x=f._container;this._container.appendChild(x),f.options.interactive&&f.addInteractiveTarget(x)},_removePath:function(f){var x=f._container;Li(x),f.removeInteractiveTarget(x),delete this._layers[r(f)]},_updateStyle:function(f){var x=f._stroke,A=f._fill,F=f.options,q=f._container;q.stroked=!!F.stroke,q.filled=!!F.fill,F.stroke?(x||(x=f._stroke=Zi("stroke")),q.appendChild(x),x.weight=F.weight+"px",x.color=F.color,x.opacity=F.opacity,F.dashArray?x.dashStyle=xt(F.dashArray)?F.dashArray.join(" "):F.dashArray.replace(/( *, *)/g," "):x.dashStyle="",x.endcap=F.lineCap.replace("butt","flat"),x.joinstyle=F.lineJoin):x&&(q.removeChild(x),f._stroke=null),F.fill?(A||(A=f._fill=Zi("fill")),q.appendChild(A),A.color=F.fillColor||F.color,A.opacity=F.fillOpacity):A&&(q.removeChild(A),f._fill=null)},_updateCircle:function(f){var x=f._point.round(),A=Math.round(f._radius),F=Math.round(f._radiusY||A);this._setPath(f,f._empty()?"M0 0":"AL "+x.x+","+x.y+" "+A+","+F+" 0,"+65535*360)},_setPath:function(f,x){f._path.v=x},_bringToFront:function(f){Uo(f._container)},_bringToBack:function(f){Is(f._container)}},yr=Le.vml?Zi:Se,Lo=er.extend({_initContainer:function(){this._container=yr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=yr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Li(this._container),cn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){er.prototype._update.call(this);var f=this._bounds,x=f.getSize(),A=this._container;(!this._svgSize||!this._svgSize.equals(x))&&(this._svgSize=x,A.setAttribute("width",x.x),A.setAttribute("height",x.y)),Ui(A,f.min),A.setAttribute("viewBox",[f.min.x,f.min.y,x.x,x.y].join(" ")),this.fire("update")}},_initPath:function(f){var x=f._path=yr("path");f.options.className&&Fi(x,f.options.className),f.options.interactive&&Fi(x,"leaflet-interactive"),this._updateStyle(f),this._layers[r(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){Li(f._path),f.removeInteractiveTarget(f._path),delete this._layers[r(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var x=f._path,A=f.options;x&&(A.stroke?(x.setAttribute("stroke",A.color),x.setAttribute("stroke-opacity",A.opacity),x.setAttribute("stroke-width",A.weight),x.setAttribute("stroke-linecap",A.lineCap),x.setAttribute("stroke-linejoin",A.lineJoin),A.dashArray?x.setAttribute("stroke-dasharray",A.dashArray):x.removeAttribute("stroke-dasharray"),A.dashOffset?x.setAttribute("stroke-dashoffset",A.dashOffset):x.removeAttribute("stroke-dashoffset")):x.setAttribute("stroke","none"),A.fill?(x.setAttribute("fill",A.fillColor||A.color),x.setAttribute("fill-opacity",A.fillOpacity),x.setAttribute("fill-rule",A.fillRule||"evenodd")):x.setAttribute("fill","none"))},_updatePoly:function(f,x){this._setPath(f,me(f._parts,x))},_updateCircle:function(f){var x=f._point,A=Math.max(Math.round(f._radius),1),F=Math.max(Math.round(f._radiusY),1)||A,q="a"+A+","+F+" 0 1,0 ",ot=f._empty()?"M0 0":"M"+(x.x-A)+","+x.y+q+A*2+",0 "+q+-A*2+",0 ";this._setPath(f,ot)},_setPath:function(f,x){f._path.setAttribute("d",x)},_bringToFront:function(f){Uo(f._path)},_bringToBack:function(f){Is(f._path)}});Le.vml&&Lo.include(Dl);function Ta(f){return Le.svg||Le.vml?new Lo(f):null}Wi.include({getRenderer:function(f){var x=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return x||(x=this._renderer=this._createRenderer()),this.hasLayer(x)||this.addLayer(x),x},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var x=this._paneRenderers[f];return x===void 0&&(x=this._createRenderer({pane:f}),this._paneRenderers[f]=x),x},_createRenderer:function(f){return this.options.preferCanvas&&Ll(f)||Ta(f)}});var tu=so.extend({initialize:function(f,x){so.prototype.initialize.call(this,this._boundsToLatLngs(f),x)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=je(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function gc(f,x){return new tu(f,x)}Lo.create=yr,Lo.pointsToPath=me,zr.geometryToLayer=Ja,zr.coordsToLatLng=Qa,zr.coordsToLatLngs=Jo,zr.latLngToCoords=kl,zr.latLngsToCoords=va,zr.getFeature=tl,zr.asFeature=el,Wi.mergeOptions({boxZoom:!0});var ro=Lr.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){pi(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){cn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Li(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Qs(),Ds(),this._startPoint=this._map.mouseEventToContainerPoint(f),pi(document,{contextmenu:pr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Vi("div","leaflet-zoom-box",this._container),Fi(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var x=new $t(this._point,this._startPoint),A=x.getSize();Ui(this._box,x.min),this._box.style.width=A.x+"px",this._box.style.height=A.y+"px"},_finish:function(){this._moved&&(Li(this._box),gn(this._container,"leaflet-crosshair")),Zn(),Co(),cn(document,{contextmenu:pr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(_(this._resetState,this),0);var x=new Ve(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(x).fire("boxzoomend",{boxZoomBounds:x})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Wi.addInitHook("addHandler","boxZoom",ro),Wi.mergeOptions({doubleClickZoom:!0});var eu=Lr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var x=this._map,A=x.getZoom(),F=x.options.zoomDelta,q=f.originalEvent.shiftKey?A-F:A+F;x.options.doubleClickZoom==="center"?x.setZoom(q):x.setZoomAround(f.containerPoint,q)}});Wi.addInitHook("addHandler","doubleClickZoom",eu),Wi.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var zl=Lr.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new Ni(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}Fi(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){gn(this._map._container,"leaflet-grab"),gn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var x=je(this._map.options.maxBounds);this._offsetLimit=ce(this._map.latLngToContainerPoint(x.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(x.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var x=this._lastTime=+new Date,A=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(A),this._times.push(x),this._prunePositions(x)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),x=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=x.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,x){return f-(f-x)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),x=this._offsetLimit;f.x<x.min.x&&(f.x=this._viscousLimit(f.x,x.min.x)),f.y<x.min.y&&(f.y=this._viscousLimit(f.y,x.min.y)),f.x>x.max.x&&(f.x=this._viscousLimit(f.x,x.max.x)),f.y>x.max.y&&(f.y=this._viscousLimit(f.y,x.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,x=Math.round(f/2),A=this._initialWorldOffset,F=this._draggable._newPos.x,q=(F-x+A)%f+x-A,ot=(F+x+A)%f-x-A,Pt=Math.abs(q+A)<Math.abs(ot+A)?q:ot;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Pt},_onDragEnd:function(f){var x=this._map,A=x.options,F=!A.inertia||f.noInertia||this._times.length<2;if(x.fire("dragend",f),F)x.fire("moveend");else{this._prunePositions(+new Date);var q=this._lastPos.subtract(this._positions[0]),ot=(this._lastTime-this._times[0])/1e3,Pt=A.easeLinearity,Yt=q.multiplyBy(Pt/ot),ue=Yt.distanceTo([0,0]),Ie=Math.min(A.inertiaMaxSpeed,ue),ni=Yt.multiplyBy(Ie/ue),wi=Ie/(A.inertiaDeceleration*Pt),Di=ni.multiplyBy(-wi/2).round();!Di.x&&!Di.y?x.fire("moveend"):(Di=x._limitOffset(Di,x.options.maxBounds),ee(function(){x.panBy(Di,{duration:wi,easeLinearity:Pt,noMoveStart:!0,animate:!0})}))}}});Wi.addInitHook("addHandler","dragging",zl),Wi.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ea=Lr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),pi(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),cn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,x=document.documentElement,A=f.scrollTop||x.scrollTop,F=f.scrollLeft||x.scrollLeft;this._map._container.focus(),window.scrollTo(F,A)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var x=this._panKeys={},A=this.keyCodes,F,q;for(F=0,q=A.left.length;F<q;F++)x[A.left[F]]=[-1*f,0];for(F=0,q=A.right.length;F<q;F++)x[A.right[F]]=[f,0];for(F=0,q=A.down.length;F<q;F++)x[A.down[F]]=[0,f];for(F=0,q=A.up.length;F<q;F++)x[A.up[F]]=[0,-1*f]},_setZoomDelta:function(f){var x=this._zoomKeys={},A=this.keyCodes,F,q;for(F=0,q=A.zoomIn.length;F<q;F++)x[A.zoomIn[F]]=f;for(F=0,q=A.zoomOut.length;F<q;F++)x[A.zoomOut[F]]=-f},_addHooks:function(){pi(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){cn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var x=f.keyCode,A=this._map,F;if(x in this._panKeys){if(!A._panAnim||!A._panAnim._inProgress)if(F=this._panKeys[x],f.shiftKey&&(F=Ue(F).multiplyBy(3)),A.options.maxBounds&&(F=A._limitOffset(Ue(F),A.options.maxBounds)),A.options.worldCopyJump){var q=A.wrapLatLng(A.unproject(A.project(A.getCenter()).add(F)));A.panTo(q)}else A.panBy(F)}else if(x in this._zoomKeys)A.setZoom(A.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[x]);else if(x===27&&A._popup&&A._popup.options.closeOnEscapeKey)A.closePopup();else return;pr(f)}}});Wi.addInitHook("addHandler","keyboard",Ea),Wi.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Sa=Lr.extend({addHooks:function(){pi(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){cn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var x=kr(f),A=this._map.options.wheelDebounceTime;this._delta+=x,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var F=Math.max(A-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(_(this._performZoom,this),F),pr(f)},_performZoom:function(){var f=this._map,x=f.getZoom(),A=this._map.options.zoomSnap||0;f._stop();var F=this._delta/(this._map.options.wheelPxPerZoomLevel*4),q=4*Math.log(2/(1+Math.exp(-Math.abs(F))))/Math.LN2,ot=A?Math.ceil(q/A)*A:q,Pt=f._limitZoom(x+(this._delta>0?ot:-ot))-x;this._delta=0,this._startTime=null,Pt&&(f.options.scrollWheelZoom==="center"?f.setZoom(x+Pt):f.setZoomAround(this._lastMousePos,x+Pt))}});Wi.addInitHook("addHandler","scrollWheelZoom",Sa);var Ol=600;Wi.mergeOptions({tapHold:Le.touchNative&&Le.safari&&Le.mobile,tapTolerance:15});var Do=Lr.extend({addHooks:function(){pi(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){cn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var x=f.touches[0];this._startPos=this._newPos=new oe(x.clientX,x.clientY),this._holdTimeout=setTimeout(_(function(){this._cancel(),this._isTapValid()&&(pi(document,"touchend",Gn),pi(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",x))},this),Ol),pi(document,"touchend touchcancel contextmenu",this._cancel,this),pi(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){cn(document,"touchend",Gn),cn(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),cn(document,"touchend touchcancel contextmenu",this._cancel,this),cn(document,"touchmove",this._onMove,this)},_onMove:function(f){var x=f.touches[0];this._newPos=new oe(x.clientX,x.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,x){var A=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:x.screenX,screenY:x.screenY,clientX:x.clientX,clientY:x.clientY});A._simulated=!0,x.target.dispatchEvent(A)}});Wi.addInitHook("addHandler","tapHold",Do),Wi.mergeOptions({touchZoom:Le.touch,bounceAtZoomLimits:!0});var sl=Lr.extend({addHooks:function(){Fi(this._map._container,"leaflet-touch-zoom"),pi(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){gn(this._map._container,"leaflet-touch-zoom"),cn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var x=this._map;if(!(!f.touches||f.touches.length!==2||x._animatingZoom||this._zooming)){var A=x.mouseEventToContainerPoint(f.touches[0]),F=x.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=x.getSize()._divideBy(2),this._startLatLng=x.containerPointToLatLng(this._centerPoint),x.options.touchZoom!=="center"&&(this._pinchStartLatLng=x.containerPointToLatLng(A.add(F)._divideBy(2))),this._startDist=A.distanceTo(F),this._startZoom=x.getZoom(),this._moved=!1,this._zooming=!0,x._stop(),pi(document,"touchmove",this._onTouchMove,this),pi(document,"touchend touchcancel",this._onTouchEnd,this),Gn(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var x=this._map,A=x.mouseEventToContainerPoint(f.touches[0]),F=x.mouseEventToContainerPoint(f.touches[1]),q=A.distanceTo(F)/this._startDist;if(this._zoom=x.getScaleZoom(q,this._startZoom),!x.options.bounceAtZoomLimits&&(this._zoom<x.getMinZoom()&&q<1||this._zoom>x.getMaxZoom()&&q>1)&&(this._zoom=x._limitZoom(this._zoom)),x.options.touchZoom==="center"){if(this._center=this._startLatLng,q===1)return}else{var ot=A._add(F)._divideBy(2)._subtract(this._centerPoint);if(q===1&&ot.x===0&&ot.y===0)return;this._center=x.unproject(x.project(this._pinchStartLatLng,this._zoom).subtract(ot),this._zoom)}this._moved||(x._moveStart(!0,!1),this._moved=!0),Wt(this._animRequest);var Pt=_(x._move,x,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ee(Pt,this,!0),Gn(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,Wt(this._animRequest),cn(document,"touchmove",this._onTouchMove,this),cn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Wi.addInitHook("addHandler","touchZoom",sl),Wi.BoxZoom=ro,Wi.DoubleClickZoom=eu,Wi.Drag=zl,Wi.Keyboard=Ea,Wi.ScrollWheelZoom=Sa,Wi.TapHold=Do,Wi.TouchZoom=sl,i.Bounds=$t,i.Browser=Le,i.CRS=vi,i.Canvas=Il,i.Circle=Al,i.CircleMarker=Ka,i.Class=ye,i.Control=qn,i.DivIcon=pc,i.DivOverlay=zs,i.DomEvent=$a,i.DomUtil=Yr,i.Draggable=Ni,i.Evented=he,i.FeatureGroup=Xn,i.GeoJSON=zr,i.GridLayer=tr,i.Handler=Lr,i.Icon=Io,i.ImageOverlay=xa,i.LatLng=Xe,i.LatLngBounds=Ve,i.Layer=$r,i.LayerGroup=qa,i.LineUtil=Hi,i.Map=Wi,i.Marker=Cl,i.Mixin=Gc,i.Path=_r,i.Point=oe,i.PolyUtil=wl,i.Polygon=so,i.Polyline=gr,i.Popup=Or,i.PosAnimation=Zc,i.Projection=Hc,i.Rectangle=tu,i.Renderer=er,i.SVG=Lo,i.SVGOverlay=Vu,i.TileLayer=ws,i.Tooltip=ba,i.Transformation=ls,i.Util=ae,i.VideoOverlay=Qo,i.bind=_,i.bounds=ce,i.canvas=Ll,i.circle=no,i.circleMarker=Ya,i.control=Wo,i.divIcon=Qc,i.extend=c,i.featureGroup=hc,i.geoJSON=il,i.geoJson=ju,i.gridLayer=mc,i.icon=Ml,i.imageOverlay=Kc,i.latLng=ri,i.latLngBounds=je,i.layerGroup=Ch,i.map=$o,i.marker=Yo,i.point=Ue,i.polygon=Pl,i.polyline=dc,i.popup=Jc,i.rectangle=gc,i.setOptions=W,i.stamp=r,i.svg=Ta,i.svgOverlay=Ah,i.tileLayer=nl,i.tooltip=wa,i.transformation=Tt,i.version=l,i.videoOverlay=Yc;var Rl=window.L;i.noConflict=function(){return window.L=Rl,this},window.L=i}))})(Pp,Pp.exports)),Pp.exports}var vO=yO();const id=Rx(vO),xO=`EW1 Pasir Ris/ 6840, 1600
EW2,DT32 Tampines/ 6840,1895
EW3 Simei / 6840, 2050
EW4,CG Tanah Merah/ 6815,2203
CG1,DT35 Expo/ 7215, 2490
CG2 Changi Airport/ 7500,2490
EW5 Bedok/ 6283,2203
EW6 Kembangan/ 5886,2416
EW7 Eunos/ 5650, 2650
EW8,CC9 Paya Lebar/ 5400,2900
EW9 Aljunied / 5170, 3130
EW10 Kallang/ 5000,3310
EW11 Lavender/ 4815,3490
EW12,DT14 Bugis/ 4610, 3695
EW13,NS25 City Hall/ 4185,4130
EW14,NS26 Raffles Place/ 4180,4380
EW15 Tanjong Pagar/ 3444,4495
EW16,NE3,TE17 Outram Park/ 3200,4120
EW17 Tiong Bahru/ 2865,3930
EW18 Redhill/ 2680, 3750
EW19 Queenstown/ 2500, 3580
EW20 Commonwealth/ 2345, 3420
EW21,CC22 Buona Vista/ 2100, 3265
EW22 Dover/ 1815, 3265
EW23 Clementi/ 1550, 3265
EW24,NS1 Jurong East/ 1160, 3265
EW25 Chinese Garden/ 850,3265
EW26 Lakeside/ 560, 3265
EW27 Boon Lay/ 300, 2975
EW28 Pioneer/ 300, 2750
EW29 Joo Koon/ 300, 2525
EW30 Gul Circle/ 300, 2290
EW31 Tuas Crescent/ 300, 2060
EW32 Tuas West Road/ 300,1830
EW33 Tuas Link/ 300,1600
NS2 Bukit Batok/ 1160, 2755
NS3 Bukit Gombak/ 1160,2360
NS4,BP1 Choa Chu Kang/ 1160, 1928
NS5 Yew Tee/ 1160, 1460
NS7 Kranji/1160, 1030
NS8 Marsiling/ 1400,540
NS9,TE2 Woodlands/1983,437
NS10 Admiralty/2360,437
NS11 Sembawang/2710,437
NS12 Canberra/3060,437
NS13 Yishun/3411,550
NS14 Khatib/3600,765
NS15 Yio Chu Kang/3640,1030
NS16 Ang Mo Kio/3640, 1300
NS17,CC15 Bishan/3640, 1607
NS18 Braddell/ 3640,1780
NS19 Toa Payoh/ 3640, 2035
NS20 Novena/ 3490,2330
NS21,DT11 Newton/ 3376,2511
NS22,TE14 Orchard/ 2990,2928
NS23 Somerset/ 3253,3203
NS24,NE6,CC1 Dhoby Ghaut/3690,3635
NS27,TE20,CE2 Marina Bay/ 4323,4758
NS28 Marina South Pier / 4478,4988
CC2 Bras Basah/ 4223,3757
CC3 Esplanade/ 4592,4127
CC4,DT15 Promenade/5072,4256
CE1,DT16 Bayfront/ 4727,4583
CC5 Nicoll Highway/5270,3980
CC6 Stadium/5365,3740
CC7 Mountbatten/5427,3484
CC8 Dakota/5442,3225
CC10,DT26 MacPherson/5283,2558
CC11 Tai Seng/5096,2255
CC12 Bartley/4866,2020
CC13,NE12 Serangoon/4525,1785
CC14 Lorong Chuan/4127, 1640
CC16 Marymount/3225,1684
CC17,TE9 Caldecott/2927,1838
CC19,DT9 Botanic Gardens/2404,2299
CC20 Farrer Road/2227,2625
CC21 Holland Village/2135,2890
CC23 one-north/2111,3489
CC24 Kent Ridge/2164,3748
CC25 Haw Par Villa/2255,3983
CC26 Pasir Panjang/2371,4189
CC27 Labrador Park/2529,4391
CC28 Telok Blangah/2731,4587
CC29,NE1 HarbourFront/ 3057,4784
NE4,DT19 Chinatown/3441,3911
NE5 Clarke Quay/3565,3752
NE7,DT12 Little India/3916,2994
NE8 Farrer Park/3911,2745
NE9 Boon Keng/3911,2510
NE10 Potong Pasir/4065,2265
NE11 Woodleigh/4290,2035
NE13 Kovan/4727,1588
NE14 Hougang/4904,1411
NE15 Buangkok/5072,1257
NE16,STC Sengkang/5235,1080
SW1 Cheng Lim/5132,798
SW2 Farmway/5038,702
SW3 Kupang/4949,616
SW4 Thanggam/4824,593
SW5 Fernvale/4740,672
SW6 Layar/4782,778
SW7 Tongkang/4873,867
SW8 Renjong/4962,950
SE1 Compassvale/5595,1258
SE2 Rumbia/5698,1357
SE3 Bakau/5703,1532
SE4 Kangkar/5523,1514
SE5 Ranggung/5400,1400
NE17,PTC Punggol/5600,710
PE1 Cove/5772,906
PE2 Meridian/5861,1027
PE3 Coral Edge/5949,1115
PE4 Riviera/6124,1123
PE5 Kadaloor/6144,978
PE6 Oasis/6043,879
PE7 Damai/5942,786
PW1 Sam Kee/5533,372
PW3 Punggol Point/5371,212
PW4 Samudera/5206,207
PW5 Nibong/5181,352
PW6 Sumang/5267,436
PW7 Soo Teck/5341,512
NE18 Punggol Coast/5758,552
DT1,BP6 Bukit Panjang/1742,1244
BP2 South View/1289,1745
BP3 Keat Hong/1289,1553
BP4 Teck Whye/1289,1381
BP5 Phoenix/1482,1182
BP7 Petir/1836,990
BP8 Pending/1860,860
BP9 Bangkit/1860, 736
BP10 Fajar/1745,615
BP11 Segar/1625,736
BP12 Jelapang/1625,860
BP13 Senja/1648,980
DT2 Cashew/1742,1436
DT3 Hillview/1742,1566
DT5 Beauty World/1742,1830
DT6 King Albert Park/1742,1960
DT7 Sixth Avenue/1742,2090
DT8 Tan Kah Kee/2009,2289
DT10,TE11 Stevens/2924,2292
DT13 Rochor/4158,3233
DT17 Downtown/4422,4659
DT18 Telok Ayer/3937,4386
DT20 Fort Canning/3419,3634
DT21 Bencoolen/4295,3552
DT22 Jalan Besar/4493,3354
DT23 Bendemeer/4757,3093
DT24 Geylang Bahru/4926,2917
DT25 Mattar/5109,2729
DT27 Ubi/5500,2344
DT28 Kaki Bukit/5698,2146
DT29 Bedok North/5884,1960
DT30 Bedok Reservoir/6216,1902
DT31 Tampines West/6545,1902
DT33 Tampines East/7216,2051
DT34 Upper Changi/7212,2234
TE1 Woodlands North/1741,182
TE3 Woodlands South/2148,613
TE4 Springleaf/2312,771
TE5 Lentor/2463,934
TE6 Mayflower/2621,1092
TE7 Bright Hill/2785,1262
TE8 Upper Thomson/2931,1553
TE12 Napier/2931,2518
TE13 Orchard Boulevard/2931,2724
TE15 Great World/2931,3173
TE16 Havelock/2931,3422
TE18 Maxwell/3513,4278
TE19 Shenton Way/3920,4672
TE22 Gardens By The Bay/5351,4557
TE23 Tanjong Rhu/5746,4150
TE24 Katong Park/5910,3992
TE25 Tanjong Katong/6061,3829
TE26 Marine Parade/6219,3677
TE27 Marine Terrace/6383,3513
TE28 Siglap/6535,3361
TE29 Bayshore/6680,3222`;function bO(){return xO.split(`
`).map(n=>n.trim()).filter(Boolean).map(n=>{const[t,i]=n.split("/");if(!i)return null;const l=t.trim(),c=i.trim(),d=l.match(/^([A-Za-z0-9,-]+)\s+(.*)$/),_=d?d[1].split(",").map(R=>R.trim()):[],v=(d?d[2]:l).trim(),[r="0",E="0"]=c.split(",").map(R=>R.trim()),C=Number(r),z=Number(E);return{name:v,codes:_,position:{x:C,y:z}}}).filter(Boolean)}const eT=new Set(["BPL","SWPL","SEPL","PEPLRT","PWLRT"]),rh=new Map;let iT=!1;function Eu(n,t){return`${n} (${t})`}function vp(n,t,i=1){rh.has(n)||rh.set(n,[]),rh.has(t)||rh.set(t,[]),rh.get(n).push({to:t,weight:i}),rh.get(t).push({to:n,weight:i})}function wO(){if(iT)return;Object.entries(ch).forEach(([t,i])=>{i.forEach((l,c)=>{const d=Eu(l,t);if(c>0&&vp(d,Eu(i[c-1],t),1),c<i.length-1&&vp(d,Eu(i[c+1],t),1),eT.has(t)&&c===i.length-1&&c>0){const _=Eu(i[1],t);vp(d,_,1)}if(eT.has(t)&&c===1&&i.length>2){const _=Eu(i[i.length-1],t);vp(d,_,1)}})});const n=new Map;Object.entries(ch).forEach(([t,i])=>{i.forEach(l=>{n.has(l)||n.set(l,[]),n.get(l).push(t)})}),n.forEach((t,i)=>{if(!(t.length<2))for(let l=0;l<t.length;l+=1)for(let c=l+1;c<t.length;c+=1)vp(Eu(i,t[l]),Eu(i,t[c]),.5)}),iT=!0}function TO(n,t){if(!n||!t)return null;wO();const i=Object.keys(ch).filter(R=>ch[R].includes(n)).map(R=>Eu(n,R)),l=Object.keys(ch).filter(R=>ch[R].includes(t)).map(R=>Eu(t,R));if(!i.length||!l.length)return null;const c=new Map,d=new Map,_=[];function v(R,j){_.push({node:R,distance:j}),_.sort((G,W)=>G.distance-W.distance)}rh.forEach((R,j)=>c.set(j,1/0)),i.forEach(R=>{c.set(R,0),v(R,0)});const r=new Set(l);let E=null;for(;_.length;){const{node:R,distance:j}=_.shift();if(j!==c.get(R))continue;if(r.has(R)){E=R;break}(rh.get(R)||[]).forEach(({to:W,weight:Q})=>{const rt=j+Q;rt<c.get(W)&&(c.set(W,rt),d.set(W,R),v(W,rt))})}if(!E)return null;const C=[];let z=E;for(;z;){const R=z.match(/^(.*) \((.*)\)$/);C.unshift({station:R?R[1]:z,line:R?R[2]:"?"}),z=d.get(z)}return{steps:C,totalWeight:c.get(E)}}function EO(n){const t=Math.max(0,Math.round(n)),i=Math.max(0,Math.round((n-t)*2));return Math.round(t*2.2+i*4+3)}function SO(n){const t=Math.max(0,Math.round(n)),i=Math.round((n-t)*2);return Number((t*1.1+i*.3).toFixed(1))}function MO(n,t){const i=ch[n.line]||[],l=i.indexOf(n.station),c=i.indexOf(t.station);return Math.abs(c-l)}function CO(n){if(!n?.steps?.length)return[];const t=[];let i=0;for(;i<n.steps.length-1;){const l=n.steps[i];let c=i+1;for(;c<n.steps.length&&n.steps[c].line===l.line;)c+=1;const d=n.steps[c-1];t.push({line:l.line,from:l.station,to:d.station,stops:MO(l,d)}),i=c}return t}function e0(){return{allStations:Mz,shortestPath:TO,estimateTimeMinutes:EO,estimateDistanceKm:SO,summariseSegments:CO}}const AO={class:"section-card"},PO={class:"col-md-5"},kO=["value"],IO={class:"col-md-5"},LO=["value"],DO={key:0,class:"alert alert-danger mt-4"},zO={key:1,class:"mt-4"},OO={class:"row g-4"},RO={class:"col-lg-5"},BO={class:"border rounded-3 p-3 bg-light mb-3"},FO={class:"d-flex align-items-center gap-3 mb-2"},NO={class:"fs-4 fw-bold"},jO={class:"d-flex align-items-center gap-3"},VO={class:"fs-4 fw-bold"},UO={class:"station-chip"},$O={class:"station-chip"},WO={class:"d-block text-muted"},ZO={__name:"RoutePlanner",setup(n){const{allStations:t,shortestPath:i,estimateTimeMinutes:l,estimateDistanceKm:c,summariseSegments:d}=e0(),_=Yi("Jurong East"),v=Yi("Marina Bay"),r=Yi(null),E=Yi(""),C=bO(),z=new Map(C.map(Ot=>[Ot.name.toLowerCase(),Ot]));let R=null,j=null,G=null,W=null,Q=null;function rt(Ot){return z.get(Ot.toLowerCase())||null}function ft(){[_.value,v.value]=[v.value,_.value]}function xt(){if(E.value="",r.value=null,_.value===v.value){E.value="Please choose two different stations.";return}const Ot=i(_.value,v.value);if(!Ot){E.value="No valid MRT route found between these stations.";return}const zt=l(Ot.totalWeight),Rt=c(Ot.totalWeight),Bt=d(Ot);r.value={path:Ot,estimatedTime:zt,distanceKm:Rt,segments:Bt},Kp(()=>mt(Ot))}function mt(Ot){if(!R||!j)return;Q&&(R.removeLayer(Q),Q=null),G&&(R.removeLayer(G),G=null),W&&(R.removeLayer(W),W=null);const zt=[];Ot.steps.forEach(Rt=>{const Bt=rt(Rt.station);if(!Bt)return;const Nt=R.unproject([Bt.position.x,Bt.position.y],R.getMaxZoom());zt.push(Nt)}),zt.length&&(G=id.circleMarker(zt[0],{radius:9,color:"#22c55e",fillColor:"#22c55e",fillOpacity:1}).addTo(R),G.bindPopup(`<strong>Start</strong><br>${Ot.steps[0].station}`).openPopup(),W=id.circleMarker(zt[zt.length-1],{radius:9,color:"#ef4444",fillColor:"#ef4444",fillOpacity:1}).addTo(R),W.bindPopup(`<strong>End</strong><br>${Ot.steps[Ot.steps.length-1].station}`),Q=id.polyline(zt,{color:"#f97316",weight:6,opacity:.8}).addTo(R),R.fitBounds(id.latLngBounds(zt),{padding:[50,50]}))}function bt(){if(R)return;const Ot="/MRT-Map.png",zt=new Image;zt.onload=()=>{const Rt=zt.width,Bt=zt.height;R=id.map("routeVisualizerMap",{crs:id.CRS.Simple,minZoom:-2,maxZoom:2,attributionControl:!1}),j=[R.unproject([0,Bt],R.getMaxZoom()),R.unproject([Rt,0],R.getMaxZoom())],id.imageOverlay(Ot,j).addTo(R),R.fitBounds(j),setTimeout(()=>R.invalidateSize(),150),r.value&&mt(r.value.path)},zt.src=Ot}return Md(()=>{bt()}),Cd(()=>{R&&(R.remove(),R=null)}),(Ot,zt)=>(Ye(),ii("section",AO,[zt[15]||(zt[15]=ht("h2",{class:"section-title mb-3"},"Intelligent Route Planner",-1)),zt[16]||(zt[16]=ht("p",{class:"text-muted"}," Find the fastest MRT journey with interchange-aware timing estimates. Visualise the path on the network map and inspect each segment for transfers and stop counts. ",-1)),ht("form",{class:"row g-3 align-items-end mt-1",onSubmit:md(xt,["prevent"])},[ht("div",PO,[zt[2]||(zt[2]=ht("label",{class:"form-label",for:"routeStart"},"From",-1)),ar(ht("select",{id:"routeStart","onUpdate:modelValue":zt[0]||(zt[0]=Rt=>_.value=Rt),class:"form-select"},[(Ye(!0),ii(an,null,gs(es(t),Rt=>(Ye(),ii("option",{key:Rt,value:Rt},Ge(Rt),9,kO))),128))],512),[[jc,_.value]])]),ht("div",IO,[zt[3]||(zt[3]=ht("label",{class:"form-label",for:"routeEnd"},"To",-1)),ar(ht("select",{id:"routeEnd","onUpdate:modelValue":zt[1]||(zt[1]=Rt=>v.value=Rt),class:"form-select"},[(Ye(!0),ii(an,null,gs(es(t),Rt=>(Ye(),ii("option",{key:Rt,value:Rt},Ge(Rt),9,LO))),128))],512),[[jc,v.value]])]),ht("div",{class:"col-md-2 d-flex gap-2"},[ht("button",{class:"btn btn-outline-danger flex-grow-1",type:"button",onClick:ft},[...zt[4]||(zt[4]=[ht("span",{class:"material-icons align-middle me-1"},"swap_vert",-1),sn(" Swap ",-1)])]),zt[5]||(zt[5]=ht("button",{class:"btn btn-primary flex-grow-1",type:"submit"},[ht("span",{class:"material-icons align-middle me-1"},"alt_route"),sn(" Plan ")],-1))])],32),E.value?(Ye(),ii("div",DO,Ge(E.value),1)):cr("",!0),r.value?(Ye(),ii("div",zO,[ht("div",OO,[ht("div",RO,[ht("div",BO,[ht("div",FO,[zt[7]||(zt[7]=ht("span",{class:"material-icons text-danger fs-3"},"timer",-1)),ht("div",null,[zt[6]||(zt[6]=ht("div",{class:"fw-semibold text-uppercase small text-muted"},"Estimated travel time",-1)),ht("div",NO,Ge(r.value.estimatedTime)+" min",1)])]),ht("div",jO,[zt[9]||(zt[9]=ht("span",{class:"material-icons text-primary fs-3"},"straighten",-1)),ht("div",null,[zt[8]||(zt[8]=ht("div",{class:"fw-semibold text-uppercase small text-muted"},"Approx distance",-1)),ht("div",VO,Ge(r.value.distanceKm)+" km",1)])])]),zt[13]||(zt[13]=ht("h5",{class:"mb-3"},"Segments",-1)),(Ye(!0),ii(an,null,gs(r.value.segments,Rt=>(Ye(),ii("div",{key:Rt.from+Rt.line,class:"route-step"},[zt[10]||(zt[10]=sn(" Take ",-1)),ht("strong",null,Ge(Rt.line),1),zt[11]||(zt[11]=sn(" from ",-1)),ht("span",UO,Ge(Rt.from),1),zt[12]||(zt[12]=sn(" to ",-1)),ht("span",$O,Ge(Rt.to),1),ht("small",WO,Ge(Rt.stops)+" stops",1)]))),128))]),zt[14]||(zt[14]=ht("div",{class:"col-lg-7"},[ht("div",{class:"border rounded-4 overflow-hidden",style:{"min-height":"420px"}},[ht("div",{id:"routeVisualizerMap",style:{height:"420px",width:"100%"}})])],-1))])])):cr("",!0)]))}};function nT(n){return typeof n=="function"?n():es(n)}typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const sT=()=>{};function GO(n,t){function i(...l){return new Promise((c,d)=>{Promise.resolve(n(()=>t.apply(this,l),{fn:t,thisArg:this,args:l})).then(c).catch(d)})}return i}const HO=n=>n();function qO(n,t={}){let i,l,c=sT;const d=v=>{clearTimeout(v),c(),c=sT};return v=>{const r=nT(n),E=nT(t.maxWait);return i&&d(i),r<=0||E!==void 0&&E<=0?(l&&(d(l),l=null),Promise.resolve(v())):new Promise((C,z)=>{c=t.rejectOnCancel?z:C,E&&!l&&(l=setTimeout(()=>{i&&d(i),l=null,C(v())},E)),i=setTimeout(()=>{l&&d(l),l=null,C(v())},r)})}}function XO(n,t,i={}){const{eventFilter:l=HO,...c}=i;return qr(n,GO(l,t),c)}function KO(n,t,i={}){const{debounce:l=0,maxWait:c=void 0,...d}=i;return XO(n,t,{...d,eventFilter:qO(l,{maxWait:c})})}/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function wm(n){return n+.5|0}const uh=(n,t,i)=>Math.max(Math.min(n,i),t);function kp(n){return uh(wm(n*2.55),0,255)}function gh(n){return uh(wm(n*255),0,255)}function Cu(n){return uh(wm(n/2.55)/100,0,1)}function rT(n){return uh(wm(n*100),0,100)}const hl={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},ux=[..."0123456789ABCDEF"],YO=n=>ux[n&15],JO=n=>ux[(n&240)>>4]+ux[n&15],m_=n=>(n&240)>>4===(n&15),QO=n=>m_(n.r)&&m_(n.g)&&m_(n.b)&&m_(n.a);function t3(n){var t=n.length,i;return n[0]==="#"&&(t===4||t===5?i={r:255&hl[n[1]]*17,g:255&hl[n[2]]*17,b:255&hl[n[3]]*17,a:t===5?hl[n[4]]*17:255}:(t===7||t===9)&&(i={r:hl[n[1]]<<4|hl[n[2]],g:hl[n[3]]<<4|hl[n[4]],b:hl[n[5]]<<4|hl[n[6]],a:t===9?hl[n[7]]<<4|hl[n[8]]:255})),i}const e3=(n,t)=>n<255?t(n):"";function i3(n){var t=QO(n)?YO:JO;return n?"#"+t(n.r)+t(n.g)+t(n.b)+e3(n.a,t):void 0}const n3=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function UM(n,t,i){const l=t*Math.min(i,1-i),c=(d,_=(d+n/30)%12)=>i-l*Math.max(Math.min(_-3,9-_,1),-1);return[c(0),c(8),c(4)]}function s3(n,t,i){const l=(c,d=(c+n/60)%6)=>i-i*t*Math.max(Math.min(d,4-d,1),0);return[l(5),l(3),l(1)]}function r3(n,t,i){const l=UM(n,1,.5);let c;for(t+i>1&&(c=1/(t+i),t*=c,i*=c),c=0;c<3;c++)l[c]*=1-t-i,l[c]+=t;return l}function o3(n,t,i,l,c){return n===c?(t-i)/l+(t<i?6:0):t===c?(i-n)/l+2:(n-t)/l+4}function i0(n){const i=n.r/255,l=n.g/255,c=n.b/255,d=Math.max(i,l,c),_=Math.min(i,l,c),v=(d+_)/2;let r,E,C;return d!==_&&(C=d-_,E=v>.5?C/(2-d-_):C/(d+_),r=o3(i,l,c,C,d),r=r*60+.5),[r|0,E||0,v]}function n0(n,t,i,l){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,i,l)).map(gh)}function s0(n,t,i){return n0(UM,n,t,i)}function a3(n,t,i){return n0(r3,n,t,i)}function l3(n,t,i){return n0(s3,n,t,i)}function $M(n){return(n%360+360)%360}function c3(n){const t=n3.exec(n);let i=255,l;if(!t)return;t[5]!==l&&(i=t[6]?kp(+t[5]):gh(+t[5]));const c=$M(+t[2]),d=+t[3]/100,_=+t[4]/100;return t[1]==="hwb"?l=a3(c,d,_):t[1]==="hsv"?l=l3(c,d,_):l=s0(c,d,_),{r:l[0],g:l[1],b:l[2],a:i}}function u3(n,t){var i=i0(n);i[0]=$M(i[0]+t),i=s0(i),n.r=i[0],n.g=i[1],n.b=i[2]}function h3(n){if(!n)return;const t=i0(n),i=t[0],l=rT(t[1]),c=rT(t[2]);return n.a<255?`hsla(${i}, ${l}%, ${c}%, ${Cu(n.a)})`:`hsl(${i}, ${l}%, ${c}%)`}const oT={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},aT={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function d3(){const n={},t=Object.keys(aT),i=Object.keys(oT);let l,c,d,_,v;for(l=0;l<t.length;l++){for(_=v=t[l],c=0;c<i.length;c++)d=i[c],v=v.replace(d,oT[d]);d=parseInt(aT[_],16),n[v]=[d>>16&255,d>>8&255,d&255]}return n}let __;function f3(n){__||(__=d3(),__.transparent=[0,0,0,0]);const t=__[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const p3=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function m3(n){const t=p3.exec(n);let i=255,l,c,d;if(t){if(t[7]!==l){const _=+t[7];i=t[8]?kp(_):uh(_*255,0,255)}return l=+t[1],c=+t[3],d=+t[5],l=255&(t[2]?kp(l):uh(l,0,255)),c=255&(t[4]?kp(c):uh(c,0,255)),d=255&(t[6]?kp(d):uh(d,0,255)),{r:l,g:c,b:d,a:i}}}function _3(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Cu(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const bv=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,af=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function g3(n,t,i){const l=af(Cu(n.r)),c=af(Cu(n.g)),d=af(Cu(n.b));return{r:gh(bv(l+i*(af(Cu(t.r))-l))),g:gh(bv(c+i*(af(Cu(t.g))-c))),b:gh(bv(d+i*(af(Cu(t.b))-d))),a:n.a+i*(t.a-n.a)}}function g_(n,t,i){if(n){let l=i0(n);l[t]=Math.max(0,Math.min(l[t]+l[t]*i,t===0?360:1)),l=s0(l),n.r=l[0],n.g=l[1],n.b=l[2]}}function WM(n,t){return n&&Object.assign(t||{},n)}function lT(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=gh(n[3]))):(t=WM(n,{r:0,g:0,b:0,a:1}),t.a=gh(t.a)),t}function y3(n){return n.charAt(0)==="r"?m3(n):c3(n)}class cm{constructor(t){if(t instanceof cm)return t;const i=typeof t;let l;i==="object"?l=lT(t):i==="string"&&(l=t3(t)||f3(t)||y3(t)),this._rgb=l,this._valid=!!l}get valid(){return this._valid}get rgb(){var t=WM(this._rgb);return t&&(t.a=Cu(t.a)),t}set rgb(t){this._rgb=lT(t)}rgbString(){return this._valid?_3(this._rgb):void 0}hexString(){return this._valid?i3(this._rgb):void 0}hslString(){return this._valid?h3(this._rgb):void 0}mix(t,i){if(t){const l=this.rgb,c=t.rgb;let d;const _=i===d?.5:i,v=2*_-1,r=l.a-c.a,E=((v*r===-1?v:(v+r)/(1+v*r))+1)/2;d=1-E,l.r=255&E*l.r+d*c.r+.5,l.g=255&E*l.g+d*c.g+.5,l.b=255&E*l.b+d*c.b+.5,l.a=_*l.a+(1-_)*c.a,this.rgb=l}return this}interpolate(t,i){return t&&(this._rgb=g3(this._rgb,t._rgb,i)),this}clone(){return new cm(this.rgb)}alpha(t){return this._rgb.a=gh(t),this}clearer(t){const i=this._rgb;return i.a*=1-t,this}greyscale(){const t=this._rgb,i=wm(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=i,this}opaquer(t){const i=this._rgb;return i.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return g_(this._rgb,2,t),this}darken(t){return g_(this._rgb,2,-t),this}saturate(t){return g_(this._rgb,1,t),this}desaturate(t){return g_(this._rgb,1,-t),this}rotate(t){return u3(this._rgb,t),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function vu(){}const v3=(()=>{let n=0;return()=>n++})();function rn(n){return n==null}function ys(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function ln(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function js(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Ia(n,t){return js(n)?n:t}function Gi(n,t){return typeof n>"u"?t:n}const x3=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,ZM=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function as(n,t,i){if(n&&typeof n.call=="function")return n.apply(i,t)}function jn(n,t,i,l){let c,d,_;if(ys(n))for(d=n.length,c=0;c<d;c++)t.call(i,n[c],c);else if(ln(n))for(_=Object.keys(n),d=_.length,c=0;c<d;c++)t.call(i,n[_[c]],_[c])}function ug(n,t){let i,l,c,d;if(!n||!t||n.length!==t.length)return!1;for(i=0,l=n.length;i<l;++i)if(c=n[i],d=t[i],c.datasetIndex!==d.datasetIndex||c.index!==d.index)return!1;return!0}function hg(n){if(ys(n))return n.map(hg);if(ln(n)){const t=Object.create(null),i=Object.keys(n),l=i.length;let c=0;for(;c<l;++c)t[i[c]]=hg(n[i[c]]);return t}return n}function GM(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function b3(n,t,i,l){if(!GM(n))return;const c=t[n],d=i[n];ln(c)&&ln(d)?um(c,d,l):t[n]=hg(d)}function um(n,t,i){const l=ys(t)?t:[t],c=l.length;if(!ln(n))return n;i=i||{};const d=i.merger||b3;let _;for(let v=0;v<c;++v){if(_=l[v],!ln(_))continue;const r=Object.keys(_);for(let E=0,C=r.length;E<C;++E)d(r[E],n,_,i)}return n}function Wp(n,t){return um(n,t,{merger:w3})}function w3(n,t,i){if(!GM(n))return;const l=t[n],c=i[n];ln(l)&&ln(c)?Wp(l,c):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=hg(c))}const cT={"":n=>n,x:n=>n.x,y:n=>n.y};function T3(n){const t=n.split("."),i=[];let l="";for(const c of t)l+=c,l.endsWith("\\")?l=l.slice(0,-1)+".":(i.push(l),l="");return i}function E3(n){const t=T3(n);return i=>{for(const l of t){if(l==="")break;i=i&&i[l]}return i}}function wh(n,t){return(cT[t]||(cT[t]=E3(t)))(n)}function r0(n){return n.charAt(0).toUpperCase()+n.slice(1)}const hm=n=>typeof n<"u",Th=n=>typeof n=="function",uT=(n,t)=>{if(n.size!==t.size)return!1;for(const i of n)if(!t.has(i))return!1;return!0};function S3(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Sn=Math.PI,ds=2*Sn,M3=ds+Sn,dg=Number.POSITIVE_INFINITY,C3=Sn/180,Ks=Sn/2,nd=Sn/4,hT=Sn*2/3,hh=Math.log10,Vc=Math.sign;function Zp(n,t,i){return Math.abs(n-t)<i}function dT(n){const t=Math.round(n);n=Zp(n,t,n/1e3)?t:n;const i=Math.pow(10,Math.floor(hh(n))),l=n/i;return(l<=1?1:l<=2?2:l<=5?5:10)*i}function A3(n){const t=[],i=Math.sqrt(n);let l;for(l=1;l<i;l++)n%l===0&&(t.push(l),t.push(n/l));return i===(i|0)&&t.push(i),t.sort((c,d)=>c-d).pop(),t}function P3(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Pf(n){return!P3(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function k3(n,t){const i=Math.round(n);return i-t<=n&&i+t>=n}function HM(n,t,i){let l,c,d;for(l=0,c=n.length;l<c;l++)d=n[l][i],isNaN(d)||(t.min=Math.min(t.min,d),t.max=Math.max(t.max,d))}function Jl(n){return n*(Sn/180)}function o0(n){return n*(180/Sn)}function fT(n){if(!js(n))return;let t=1,i=0;for(;Math.round(n*t)/t!==n;)t*=10,i++;return i}function qM(n,t){const i=t.x-n.x,l=t.y-n.y,c=Math.sqrt(i*i+l*l);let d=Math.atan2(l,i);return d<-.5*Sn&&(d+=ds),{angle:d,distance:c}}function hx(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function I3(n,t){return(n-t+M3)%ds-Sn}function mo(n){return(n%ds+ds)%ds}function dm(n,t,i,l){const c=mo(n),d=mo(t),_=mo(i),v=mo(d-c),r=mo(_-c),E=mo(c-d),C=mo(c-_);return c===d||c===_||l&&d===_||v>r&&E<C}function Fr(n,t,i){return Math.max(t,Math.min(i,n))}function L3(n){return Fr(n,-32768,32767)}function ku(n,t,i,l=1e-6){return n>=Math.min(t,i)-l&&n<=Math.max(t,i)+l}function a0(n,t,i){i=i||(_=>n[_]<t);let l=n.length-1,c=0,d;for(;l-c>1;)d=c+l>>1,i(d)?c=d:l=d;return{lo:c,hi:l}}const Iu=(n,t,i,l)=>a0(n,i,l?c=>{const d=n[c][t];return d<i||d===i&&n[c+1][t]===i}:c=>n[c][t]<i),D3=(n,t,i)=>a0(n,i,l=>n[l][t]>=i);function z3(n,t,i){let l=0,c=n.length;for(;l<c&&n[l]<t;)l++;for(;c>l&&n[c-1]>i;)c--;return l>0||c<n.length?n.slice(l,c):n}const XM=["push","pop","shift","splice","unshift"];function O3(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),XM.forEach(i=>{const l="_onData"+r0(i),c=n[i];Object.defineProperty(n,i,{configurable:!0,enumerable:!1,value(...d){const _=c.apply(this,d);return n._chartjs.listeners.forEach(v=>{typeof v[l]=="function"&&v[l](...d)}),_}})})}function pT(n,t){const i=n._chartjs;if(!i)return;const l=i.listeners,c=l.indexOf(t);c!==-1&&l.splice(c,1),!(l.length>0)&&(XM.forEach(d=>{delete n[d]}),delete n._chartjs)}function KM(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const YM=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function JM(n,t){let i=[],l=!1;return function(...c){i=c,l||(l=!0,YM.call(window,()=>{l=!1,n.apply(t,i)}))}}function R3(n,t){let i;return function(...l){return t?(clearTimeout(i),i=setTimeout(n,t,l)):n.apply(this,l),t}}const l0=n=>n==="start"?"left":n==="end"?"right":"center",po=(n,t,i)=>n==="start"?t:n==="end"?i:(t+i)/2,B3=(n,t,i,l)=>n===(l?"left":"right")?i:n==="center"?(t+i)/2:t;function QM(n,t,i){const l=t.length;let c=0,d=l;if(n._sorted){const{iScale:_,vScale:v,_parsed:r}=n,E=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,C=_.axis,{min:z,max:R,minDefined:j,maxDefined:G}=_.getUserBounds();if(j){if(c=Math.min(Iu(r,C,z).lo,i?l:Iu(t,C,_.getPixelForValue(z)).lo),E){const W=r.slice(0,c+1).reverse().findIndex(Q=>!rn(Q[v.axis]));c-=Math.max(0,W)}c=Fr(c,0,l-1)}if(G){let W=Math.max(Iu(r,_.axis,R,!0).hi+1,i?0:Iu(t,C,_.getPixelForValue(R),!0).hi+1);if(E){const Q=r.slice(W-1).findIndex(rt=>!rn(rt[v.axis]));W+=Math.max(0,Q)}d=Fr(W,c,l)-c}else d=l-c}return{start:c,count:d}}function tC(n){const{xScale:t,yScale:i,_scaleRanges:l}=n,c={xmin:t.min,xmax:t.max,ymin:i.min,ymax:i.max};if(!l)return n._scaleRanges=c,!0;const d=l.xmin!==t.min||l.xmax!==t.max||l.ymin!==i.min||l.ymax!==i.max;return Object.assign(l,c),d}const y_=n=>n===0||n===1,mT=(n,t,i)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*ds/i)),_T=(n,t,i)=>Math.pow(2,-10*n)*Math.sin((n-t)*ds/i)+1,Gp={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Ks)+1,easeOutSine:n=>Math.sin(n*Ks),easeInOutSine:n=>-.5*(Math.cos(Sn*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>y_(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>y_(n)?n:mT(n,.075,.3),easeOutElastic:n=>y_(n)?n:_T(n,.075,.3),easeInOutElastic(n){return y_(n)?n:n<.5?.5*mT(n*2,.1125,.45):.5+.5*_T(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Gp.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Gp.easeInBounce(n*2)*.5:Gp.easeOutBounce(n*2-1)*.5+.5};function c0(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function gT(n){return c0(n)?n:new cm(n)}function wv(n){return c0(n)?n:new cm(n).saturate(.5).darken(.1).hexString()}const F3=["x","y","borderWidth","radius","tension"],N3=["color","borderColor","backgroundColor"];function j3(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:N3},numbers:{type:"number",properties:F3}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function V3(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const yT=new Map;function U3(n,t){t=t||{};const i=n+JSON.stringify(t);let l=yT.get(i);return l||(l=new Intl.NumberFormat(n,t),yT.set(i,l)),l}function Tm(n,t,i){return U3(t,i).format(n)}const eC={values(n){return ys(n)?n:""+n},numeric(n,t,i){if(n===0)return"0";const l=this.chart.options.locale;let c,d=n;if(i.length>1){const E=Math.max(Math.abs(i[0].value),Math.abs(i[i.length-1].value));(E<1e-4||E>1e15)&&(c="scientific"),d=$3(n,i)}const _=hh(Math.abs(d)),v=isNaN(_)?1:Math.max(Math.min(-1*Math.floor(_),20),0),r={notation:c,minimumFractionDigits:v,maximumFractionDigits:v};return Object.assign(r,this.options.ticks.format),Tm(n,l,r)},logarithmic(n,t,i){if(n===0)return"0";const l=i[t].significand||n/Math.pow(10,Math.floor(hh(n)));return[1,2,3,5,10,15].includes(l)||t>.8*i.length?eC.numeric.call(this,n,t,i):""}};function $3(n,t){let i=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(i)>=1&&n!==Math.floor(n)&&(i=n-Math.floor(n)),i}var zg={formatters:eC};function W3(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,i)=>i.lineWidth,tickColor:(t,i)=>i.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:zg.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Td=Object.create(null),dx=Object.create(null);function Hp(n,t){if(!t)return n;const i=t.split(".");for(let l=0,c=i.length;l<c;++l){const d=i[l];n=n[d]||(n[d]=Object.create(null))}return n}function Tv(n,t,i){return typeof t=="string"?um(Hp(n,t),i):um(Hp(n,""),t)}class Z3{constructor(t,i){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=l=>l.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(l,c)=>wv(c.backgroundColor),this.hoverBorderColor=(l,c)=>wv(c.borderColor),this.hoverColor=(l,c)=>wv(c.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(i)}set(t,i){return Tv(this,t,i)}get(t){return Hp(this,t)}describe(t,i){return Tv(dx,t,i)}override(t,i){return Tv(Td,t,i)}route(t,i,l,c){const d=Hp(this,t),_=Hp(this,l),v="_"+i;Object.defineProperties(d,{[v]:{value:d[i],writable:!0},[i]:{enumerable:!0,get(){const r=this[v],E=_[c];return ln(r)?Object.assign({},E,r):Gi(r,E)},set(r){this[v]=r}}})}apply(t){t.forEach(i=>i(this))}}var vs=new Z3({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[j3,V3,W3]);function G3(n){return!n||rn(n.size)||rn(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function fg(n,t,i,l,c){let d=t[c];return d||(d=t[c]=n.measureText(c).width,i.push(c)),d>l&&(l=d),l}function H3(n,t,i,l){l=l||{};let c=l.data=l.data||{},d=l.garbageCollect=l.garbageCollect||[];l.font!==t&&(c=l.data={},d=l.garbageCollect=[],l.font=t),n.save(),n.font=t;let _=0;const v=i.length;let r,E,C,z,R;for(r=0;r<v;r++)if(z=i[r],z!=null&&!ys(z))_=fg(n,c,d,_,z);else if(ys(z))for(E=0,C=z.length;E<C;E++)R=z[E],R!=null&&!ys(R)&&(_=fg(n,c,d,_,R));n.restore();const j=d.length/2;if(j>i.length){for(r=0;r<j;r++)delete c[d[r]];d.splice(0,j)}return _}function sd(n,t,i){const l=n.currentDevicePixelRatio,c=i!==0?Math.max(i/2,.5):0;return Math.round((t-c)*l)/l+c}function vT(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function fx(n,t,i,l){iC(n,t,i,l,null)}function iC(n,t,i,l,c){let d,_,v,r,E,C,z,R;const j=t.pointStyle,G=t.rotation,W=t.radius;let Q=(G||0)*C3;if(j&&typeof j=="object"&&(d=j.toString(),d==="[object HTMLImageElement]"||d==="[object HTMLCanvasElement]")){n.save(),n.translate(i,l),n.rotate(Q),n.drawImage(j,-j.width/2,-j.height/2,j.width,j.height),n.restore();return}if(!(isNaN(W)||W<=0)){switch(n.beginPath(),j){default:c?n.ellipse(i,l,c/2,W,0,0,ds):n.arc(i,l,W,0,ds),n.closePath();break;case"triangle":C=c?c/2:W,n.moveTo(i+Math.sin(Q)*C,l-Math.cos(Q)*W),Q+=hT,n.lineTo(i+Math.sin(Q)*C,l-Math.cos(Q)*W),Q+=hT,n.lineTo(i+Math.sin(Q)*C,l-Math.cos(Q)*W),n.closePath();break;case"rectRounded":E=W*.516,r=W-E,_=Math.cos(Q+nd)*r,z=Math.cos(Q+nd)*(c?c/2-E:r),v=Math.sin(Q+nd)*r,R=Math.sin(Q+nd)*(c?c/2-E:r),n.arc(i-z,l-v,E,Q-Sn,Q-Ks),n.arc(i+R,l-_,E,Q-Ks,Q),n.arc(i+z,l+v,E,Q,Q+Ks),n.arc(i-R,l+_,E,Q+Ks,Q+Sn),n.closePath();break;case"rect":if(!G){r=Math.SQRT1_2*W,C=c?c/2:r,n.rect(i-C,l-r,2*C,2*r);break}Q+=nd;case"rectRot":z=Math.cos(Q)*(c?c/2:W),_=Math.cos(Q)*W,v=Math.sin(Q)*W,R=Math.sin(Q)*(c?c/2:W),n.moveTo(i-z,l-v),n.lineTo(i+R,l-_),n.lineTo(i+z,l+v),n.lineTo(i-R,l+_),n.closePath();break;case"crossRot":Q+=nd;case"cross":z=Math.cos(Q)*(c?c/2:W),_=Math.cos(Q)*W,v=Math.sin(Q)*W,R=Math.sin(Q)*(c?c/2:W),n.moveTo(i-z,l-v),n.lineTo(i+z,l+v),n.moveTo(i+R,l-_),n.lineTo(i-R,l+_);break;case"star":z=Math.cos(Q)*(c?c/2:W),_=Math.cos(Q)*W,v=Math.sin(Q)*W,R=Math.sin(Q)*(c?c/2:W),n.moveTo(i-z,l-v),n.lineTo(i+z,l+v),n.moveTo(i+R,l-_),n.lineTo(i-R,l+_),Q+=nd,z=Math.cos(Q)*(c?c/2:W),_=Math.cos(Q)*W,v=Math.sin(Q)*W,R=Math.sin(Q)*(c?c/2:W),n.moveTo(i-z,l-v),n.lineTo(i+z,l+v),n.moveTo(i+R,l-_),n.lineTo(i-R,l+_);break;case"line":_=c?c/2:Math.cos(Q)*W,v=Math.sin(Q)*W,n.moveTo(i-_,l-v),n.lineTo(i+_,l+v);break;case"dash":n.moveTo(i,l),n.lineTo(i+Math.cos(Q)*(c?c/2:W),l+Math.sin(Q)*W);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function Lu(n,t,i){return i=i||.5,!t||n&&n.x>t.left-i&&n.x<t.right+i&&n.y>t.top-i&&n.y<t.bottom+i}function Og(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function Rg(n){n.restore()}function q3(n,t,i,l,c){if(!t)return n.lineTo(i.x,i.y);if(c==="middle"){const d=(t.x+i.x)/2;n.lineTo(d,t.y),n.lineTo(d,i.y)}else c==="after"!=!!l?n.lineTo(t.x,i.y):n.lineTo(i.x,t.y);n.lineTo(i.x,i.y)}function X3(n,t,i,l){if(!t)return n.lineTo(i.x,i.y);n.bezierCurveTo(l?t.cp1x:t.cp2x,l?t.cp1y:t.cp2y,l?i.cp2x:i.cp1x,l?i.cp2y:i.cp1y,i.x,i.y)}function K3(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),rn(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function Y3(n,t,i,l,c){if(c.strikethrough||c.underline){const d=n.measureText(l),_=t-d.actualBoundingBoxLeft,v=t+d.actualBoundingBoxRight,r=i-d.actualBoundingBoxAscent,E=i+d.actualBoundingBoxDescent,C=c.strikethrough?(r+E)/2:E;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=c.decorationWidth||2,n.moveTo(_,C),n.lineTo(v,C),n.stroke()}}function J3(n,t){const i=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=i}function Ed(n,t,i,l,c,d={}){const _=ys(t)?t:[t],v=d.strokeWidth>0&&d.strokeColor!=="";let r,E;for(n.save(),n.font=c.string,K3(n,d),r=0;r<_.length;++r)E=_[r],d.backdrop&&J3(n,d.backdrop),v&&(d.strokeColor&&(n.strokeStyle=d.strokeColor),rn(d.strokeWidth)||(n.lineWidth=d.strokeWidth),n.strokeText(E,i,l,d.maxWidth)),n.fillText(E,i,l,d.maxWidth),Y3(n,i,l,E,d),l+=Number(c.lineHeight);n.restore()}function fm(n,t){const{x:i,y:l,w:c,h:d,radius:_}=t;n.arc(i+_.topLeft,l+_.topLeft,_.topLeft,1.5*Sn,Sn,!0),n.lineTo(i,l+d-_.bottomLeft),n.arc(i+_.bottomLeft,l+d-_.bottomLeft,_.bottomLeft,Sn,Ks,!0),n.lineTo(i+c-_.bottomRight,l+d),n.arc(i+c-_.bottomRight,l+d-_.bottomRight,_.bottomRight,Ks,0,!0),n.lineTo(i+c,l+_.topRight),n.arc(i+c-_.topRight,l+_.topRight,_.topRight,0,-Ks,!0),n.lineTo(i+_.topLeft,l)}const Q3=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,tR=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function eR(n,t){const i=(""+n).match(Q3);if(!i||i[1]==="normal")return t*1.2;switch(n=+i[2],i[3]){case"px":return n;case"%":n/=100;break}return t*n}const iR=n=>+n||0;function u0(n,t){const i={},l=ln(t),c=l?Object.keys(t):t,d=ln(n)?l?_=>Gi(n[_],n[t[_]]):_=>n[_]:()=>n;for(const _ of c)i[_]=iR(d(_));return i}function nC(n){return u0(n,{top:"y",right:"x",bottom:"y",left:"x"})}function xd(n){return u0(n,["topLeft","topRight","bottomLeft","bottomRight"])}function To(n){const t=nC(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Sr(n,t){n=n||{},t=t||vs.font;let i=Gi(n.size,t.size);typeof i=="string"&&(i=parseInt(i,10));let l=Gi(n.style,t.style);l&&!(""+l).match(tR)&&(console.warn('Invalid font style specified: "'+l+'"'),l=void 0);const c={family:Gi(n.family,t.family),lineHeight:eR(Gi(n.lineHeight,t.lineHeight),i),size:i,style:l,weight:Gi(n.weight,t.weight),string:""};return c.string=G3(c),c}function Ip(n,t,i,l){let c,d,_;for(c=0,d=n.length;c<d;++c)if(_=n[c],_!==void 0&&_!==void 0)return _}function nR(n,t,i){const{min:l,max:c}=n,d=ZM(t,(c-l)/2),_=(v,r)=>i&&v===0?0:v+r;return{min:_(l,-Math.abs(d)),max:_(c,d)}}function Sh(n,t){return Object.assign(Object.create(n),t)}function h0(n,t=[""],i,l,c=()=>n[0]){const d=i||n;typeof l>"u"&&(l=aC("_fallback",n));const _={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:d,_fallback:l,_getTarget:c,override:v=>h0([v,...n],t,d,l)};return new Proxy(_,{deleteProperty(v,r){return delete v[r],delete v._keys,delete n[0][r],!0},get(v,r){return rC(v,r,()=>hR(r,t,n,v))},getOwnPropertyDescriptor(v,r){return Reflect.getOwnPropertyDescriptor(v._scopes[0],r)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(v,r){return bT(v).includes(r)},ownKeys(v){return bT(v)},set(v,r,E){const C=v._storage||(v._storage=c());return v[r]=C[r]=E,delete v._keys,!0}})}function kf(n,t,i,l){const c={_cacheable:!1,_proxy:n,_context:t,_subProxy:i,_stack:new Set,_descriptors:sC(n,l),setContext:d=>kf(n,d,i,l),override:d=>kf(n.override(d),t,i,l)};return new Proxy(c,{deleteProperty(d,_){return delete d[_],delete n[_],!0},get(d,_,v){return rC(d,_,()=>rR(d,_,v))},getOwnPropertyDescriptor(d,_){return d._descriptors.allKeys?Reflect.has(n,_)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,_)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(d,_){return Reflect.has(n,_)},ownKeys(){return Reflect.ownKeys(n)},set(d,_,v){return n[_]=v,delete d[_],!0}})}function sC(n,t={scriptable:!0,indexable:!0}){const{_scriptable:i=t.scriptable,_indexable:l=t.indexable,_allKeys:c=t.allKeys}=n;return{allKeys:c,scriptable:i,indexable:l,isScriptable:Th(i)?i:()=>i,isIndexable:Th(l)?l:()=>l}}const sR=(n,t)=>n?n+r0(t):t,d0=(n,t)=>ln(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function rC(n,t,i){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];const l=i();return n[t]=l,l}function rR(n,t,i){const{_proxy:l,_context:c,_subProxy:d,_descriptors:_}=n;let v=l[t];return Th(v)&&_.isScriptable(t)&&(v=oR(t,v,n,i)),ys(v)&&v.length&&(v=aR(t,v,n,_.isIndexable)),d0(t,v)&&(v=kf(v,c,d&&d[t],_)),v}function oR(n,t,i,l){const{_proxy:c,_context:d,_subProxy:_,_stack:v}=i;if(v.has(n))throw new Error("Recursion detected: "+Array.from(v).join("->")+"->"+n);v.add(n);let r=t(d,_||l);return v.delete(n),d0(n,r)&&(r=f0(c._scopes,c,n,r)),r}function aR(n,t,i,l){const{_proxy:c,_context:d,_subProxy:_,_descriptors:v}=i;if(typeof d.index<"u"&&l(n))return t[d.index%t.length];if(ln(t[0])){const r=t,E=c._scopes.filter(C=>C!==r);t=[];for(const C of r){const z=f0(E,c,n,C);t.push(kf(z,d,_&&_[n],v))}}return t}function oC(n,t,i){return Th(n)?n(t,i):n}const lR=(n,t)=>n===!0?t:typeof n=="string"?wh(t,n):void 0;function cR(n,t,i,l,c){for(const d of t){const _=lR(i,d);if(_){n.add(_);const v=oC(_._fallback,i,c);if(typeof v<"u"&&v!==i&&v!==l)return v}else if(_===!1&&typeof l<"u"&&i!==l)return null}return!1}function f0(n,t,i,l){const c=t._rootScopes,d=oC(t._fallback,i,l),_=[...n,...c],v=new Set;v.add(l);let r=xT(v,_,i,d||i,l);return r===null||typeof d<"u"&&d!==i&&(r=xT(v,_,d,r,l),r===null)?!1:h0(Array.from(v),[""],c,d,()=>uR(t,i,l))}function xT(n,t,i,l,c){for(;i;)i=cR(n,t,i,l,c);return i}function uR(n,t,i){const l=n._getTarget();t in l||(l[t]={});const c=l[t];return ys(c)&&ln(i)?i:c||{}}function hR(n,t,i,l){let c;for(const d of t)if(c=aC(sR(d,n),i),typeof c<"u")return d0(n,c)?f0(i,l,n,c):c}function aC(n,t){for(const i of t){if(!i)continue;const l=i[n];if(typeof l<"u")return l}}function bT(n){let t=n._keys;return t||(t=n._keys=dR(n._scopes)),t}function dR(n){const t=new Set;for(const i of n)for(const l of Object.keys(i).filter(c=>!c.startsWith("_")))t.add(l);return Array.from(t)}function lC(n,t,i,l){const{iScale:c}=n,{key:d="r"}=this._parsing,_=new Array(l);let v,r,E,C;for(v=0,r=l;v<r;++v)E=v+i,C=t[E],_[v]={r:c.parse(wh(C,d),E)};return _}const fR=Number.EPSILON||1e-14,If=(n,t)=>t<n.length&&!n[t].skip&&n[t],cC=n=>n==="x"?"y":"x";function pR(n,t,i,l){const c=n.skip?t:n,d=t,_=i.skip?t:i,v=hx(d,c),r=hx(_,d);let E=v/(v+r),C=r/(v+r);E=isNaN(E)?0:E,C=isNaN(C)?0:C;const z=l*E,R=l*C;return{previous:{x:d.x-z*(_.x-c.x),y:d.y-z*(_.y-c.y)},next:{x:d.x+R*(_.x-c.x),y:d.y+R*(_.y-c.y)}}}function mR(n,t,i){const l=n.length;let c,d,_,v,r,E=If(n,0);for(let C=0;C<l-1;++C)if(r=E,E=If(n,C+1),!(!r||!E)){if(Zp(t[C],0,fR)){i[C]=i[C+1]=0;continue}c=i[C]/t[C],d=i[C+1]/t[C],v=Math.pow(c,2)+Math.pow(d,2),!(v<=9)&&(_=3/Math.sqrt(v),i[C]=c*_*t[C],i[C+1]=d*_*t[C])}}function _R(n,t,i="x"){const l=cC(i),c=n.length;let d,_,v,r=If(n,0);for(let E=0;E<c;++E){if(_=v,v=r,r=If(n,E+1),!v)continue;const C=v[i],z=v[l];_&&(d=(C-_[i])/3,v[`cp1${i}`]=C-d,v[`cp1${l}`]=z-d*t[E]),r&&(d=(r[i]-C)/3,v[`cp2${i}`]=C+d,v[`cp2${l}`]=z+d*t[E])}}function gR(n,t="x"){const i=cC(t),l=n.length,c=Array(l).fill(0),d=Array(l);let _,v,r,E=If(n,0);for(_=0;_<l;++_)if(v=r,r=E,E=If(n,_+1),!!r){if(E){const C=E[t]-r[t];c[_]=C!==0?(E[i]-r[i])/C:0}d[_]=v?E?Vc(c[_-1])!==Vc(c[_])?0:(c[_-1]+c[_])/2:c[_-1]:c[_]}mR(n,c,d),_R(n,d,t)}function v_(n,t,i){return Math.max(Math.min(n,i),t)}function yR(n,t){let i,l,c,d,_,v=Lu(n[0],t);for(i=0,l=n.length;i<l;++i)_=d,d=v,v=i<l-1&&Lu(n[i+1],t),d&&(c=n[i],_&&(c.cp1x=v_(c.cp1x,t.left,t.right),c.cp1y=v_(c.cp1y,t.top,t.bottom)),v&&(c.cp2x=v_(c.cp2x,t.left,t.right),c.cp2y=v_(c.cp2y,t.top,t.bottom)))}function vR(n,t,i,l,c){let d,_,v,r;if(t.spanGaps&&(n=n.filter(E=>!E.skip)),t.cubicInterpolationMode==="monotone")gR(n,c);else{let E=l?n[n.length-1]:n[0];for(d=0,_=n.length;d<_;++d)v=n[d],r=pR(E,v,n[Math.min(d+1,_-(l?0:1))%_],t.tension),v.cp1x=r.previous.x,v.cp1y=r.previous.y,v.cp2x=r.next.x,v.cp2y=r.next.y,E=v}t.capBezierPoints&&yR(n,i)}function p0(){return typeof window<"u"&&typeof document<"u"}function m0(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function pg(n,t,i){let l;return typeof n=="string"?(l=parseInt(n,10),n.indexOf("%")!==-1&&(l=l/100*t.parentNode[i])):l=n,l}const Bg=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function xR(n,t){return Bg(n).getPropertyValue(t)}const bR=["top","right","bottom","left"];function bd(n,t,i){const l={};i=i?"-"+i:"";for(let c=0;c<4;c++){const d=bR[c];l[d]=parseFloat(n[t+"-"+d+i])||0}return l.width=l.left+l.right,l.height=l.top+l.bottom,l}const wR=(n,t,i)=>(n>0||t>0)&&(!i||!i.shadowRoot);function TR(n,t){const i=n.touches,l=i&&i.length?i[0]:n,{offsetX:c,offsetY:d}=l;let _=!1,v,r;if(wR(c,d,n.target))v=c,r=d;else{const E=t.getBoundingClientRect();v=l.clientX-E.left,r=l.clientY-E.top,_=!0}return{x:v,y:r,box:_}}function cd(n,t){if("native"in n)return n;const{canvas:i,currentDevicePixelRatio:l}=t,c=Bg(i),d=c.boxSizing==="border-box",_=bd(c,"padding"),v=bd(c,"border","width"),{x:r,y:E,box:C}=TR(n,i),z=_.left+(C&&v.left),R=_.top+(C&&v.top);let{width:j,height:G}=t;return d&&(j-=_.width+v.width,G-=_.height+v.height),{x:Math.round((r-z)/j*i.width/l),y:Math.round((E-R)/G*i.height/l)}}function ER(n,t,i){let l,c;if(t===void 0||i===void 0){const d=n&&m0(n);if(!d)t=n.clientWidth,i=n.clientHeight;else{const _=d.getBoundingClientRect(),v=Bg(d),r=bd(v,"border","width"),E=bd(v,"padding");t=_.width-E.width-r.width,i=_.height-E.height-r.height,l=pg(v.maxWidth,d,"clientWidth"),c=pg(v.maxHeight,d,"clientHeight")}}return{width:t,height:i,maxWidth:l||dg,maxHeight:c||dg}}const dh=n=>Math.round(n*10)/10;function SR(n,t,i,l){const c=Bg(n),d=bd(c,"margin"),_=pg(c.maxWidth,n,"clientWidth")||dg,v=pg(c.maxHeight,n,"clientHeight")||dg,r=ER(n,t,i);let{width:E,height:C}=r;if(c.boxSizing==="content-box"){const R=bd(c,"border","width"),j=bd(c,"padding");E-=j.width+R.width,C-=j.height+R.height}return E=Math.max(0,E-d.width),C=Math.max(0,l?E/l:C-d.height),E=dh(Math.min(E,_,r.maxWidth)),C=dh(Math.min(C,v,r.maxHeight)),E&&!C&&(C=dh(E/2)),(t!==void 0||i!==void 0)&&l&&r.height&&C>r.height&&(C=r.height,E=dh(Math.floor(C*l))),{width:E,height:C}}function wT(n,t,i){const l=t||1,c=dh(n.height*l),d=dh(n.width*l);n.height=dh(n.height),n.width=dh(n.width);const _=n.canvas;return _.style&&(i||!_.style.height&&!_.style.width)&&(_.style.height=`${n.height}px`,_.style.width=`${n.width}px`),n.currentDevicePixelRatio!==l||_.height!==c||_.width!==d?(n.currentDevicePixelRatio=l,_.height=c,_.width=d,n.ctx.setTransform(l,0,0,l,0,0),!0):!1}const MR=(function(){let n=!1;try{const t={get passive(){return n=!0,!1}};p0()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n})();function TT(n,t){const i=xR(n,t),l=i&&i.match(/^(\d+)(\.\d+)?px$/);return l?+l[1]:void 0}function ud(n,t,i,l){return{x:n.x+i*(t.x-n.x),y:n.y+i*(t.y-n.y)}}function CR(n,t,i,l){return{x:n.x+i*(t.x-n.x),y:l==="middle"?i<.5?n.y:t.y:l==="after"?i<1?n.y:t.y:i>0?t.y:n.y}}function AR(n,t,i,l){const c={x:n.cp2x,y:n.cp2y},d={x:t.cp1x,y:t.cp1y},_=ud(n,c,i),v=ud(c,d,i),r=ud(d,t,i),E=ud(_,v,i),C=ud(v,r,i);return ud(E,C,i)}const PR=function(n,t){return{x(i){return n+n+t-i},setWidth(i){t=i},textAlign(i){return i==="center"?i:i==="right"?"left":"right"},xPlus(i,l){return i-l},leftForLtr(i,l){return i-l}}},kR=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function wf(n,t,i){return n?PR(t,i):kR()}function uC(n,t){let i,l;(t==="ltr"||t==="rtl")&&(i=n.canvas.style,l=[i.getPropertyValue("direction"),i.getPropertyPriority("direction")],i.setProperty("direction",t,"important"),n.prevTextDirection=l)}function hC(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function dC(n){return n==="angle"?{between:dm,compare:I3,normalize:mo}:{between:ku,compare:(t,i)=>t-i,normalize:t=>t}}function ET({start:n,end:t,count:i,loop:l,style:c}){return{start:n%i,end:t%i,loop:l&&(t-n+1)%i===0,style:c}}function IR(n,t,i){const{property:l,start:c,end:d}=i,{between:_,normalize:v}=dC(l),r=t.length;let{start:E,end:C,loop:z}=n,R,j;if(z){for(E+=r,C+=r,R=0,j=r;R<j&&_(v(t[E%r][l]),c,d);++R)E--,C--;E%=r,C%=r}return C<E&&(C+=r),{start:E,end:C,loop:z,style:n.style}}function fC(n,t,i){if(!i)return[n];const{property:l,start:c,end:d}=i,_=t.length,{compare:v,between:r,normalize:E}=dC(l),{start:C,end:z,loop:R,style:j}=IR(n,t,i),G=[];let W=!1,Q=null,rt,ft,xt;const mt=()=>r(c,xt,rt)&&v(c,xt)!==0,bt=()=>v(d,rt)===0||r(d,xt,rt),Ot=()=>W||mt(),zt=()=>!W||bt();for(let Rt=C,Bt=C;Rt<=z;++Rt)ft=t[Rt%_],!ft.skip&&(rt=E(ft[l]),rt!==xt&&(W=r(rt,c,d),Q===null&&Ot()&&(Q=v(rt,c)===0?Rt:Bt),Q!==null&&zt()&&(G.push(ET({start:Q,end:Rt,loop:R,count:_,style:j})),Q=null),Bt=Rt,xt=rt));return Q!==null&&G.push(ET({start:Q,end:z,loop:R,count:_,style:j})),G}function pC(n,t){const i=[],l=n.segments;for(let c=0;c<l.length;c++){const d=fC(l[c],n.points,t);d.length&&i.push(...d)}return i}function LR(n,t,i,l){let c=0,d=t-1;if(i&&!l)for(;c<t&&!n[c].skip;)c++;for(;c<t&&n[c].skip;)c++;for(c%=t,i&&(d+=c);d>c&&n[d%t].skip;)d--;return d%=t,{start:c,end:d}}function DR(n,t,i,l){const c=n.length,d=[];let _=t,v=n[t],r;for(r=t+1;r<=i;++r){const E=n[r%c];E.skip||E.stop?v.skip||(l=!1,d.push({start:t%c,end:(r-1)%c,loop:l}),t=_=E.stop?r:null):(_=r,v.skip&&(t=r)),v=E}return _!==null&&d.push({start:t%c,end:_%c,loop:l}),d}function zR(n,t){const i=n.points,l=n.options.spanGaps,c=i.length;if(!c)return[];const d=!!n._loop,{start:_,end:v}=LR(i,c,d,l);if(l===!0)return ST(n,[{start:_,end:v,loop:d}],i,t);const r=v<_?v+c:v,E=!!n._fullLoop&&_===0&&v===c-1;return ST(n,DR(i,_,r,E),i,t)}function ST(n,t,i,l){return!l||!l.setContext||!i?t:OR(n,t,i,l)}function OR(n,t,i,l){const c=n._chart.getContext(),d=MT(n.options),{_datasetIndex:_,options:{spanGaps:v}}=n,r=i.length,E=[];let C=d,z=t[0].start,R=z;function j(G,W,Q,rt){const ft=v?-1:1;if(G!==W){for(G+=r;i[G%r].skip;)G-=ft;for(;i[W%r].skip;)W+=ft;G%r!==W%r&&(E.push({start:G%r,end:W%r,loop:Q,style:rt}),C=rt,z=W%r)}}for(const G of t){z=v?z:G.start;let W=i[z%r],Q;for(R=z+1;R<=G.end;R++){const rt=i[R%r];Q=MT(l.setContext(Sh(c,{type:"segment",p0:W,p1:rt,p0DataIndex:(R-1)%r,p1DataIndex:R%r,datasetIndex:_}))),RR(Q,C)&&j(z,R-1,G.loop,C),W=rt,C=Q}z<R-1&&j(z,R-1,G.loop,C)}return E}function MT(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function RR(n,t){if(!t)return!1;const i=[],l=function(c,d){return c0(d)?(i.includes(d)||i.push(d),i.indexOf(d)):d};return JSON.stringify(n,l)!==JSON.stringify(t,l)}function x_(n,t,i){return n.options.clip?n[i]:t[i]}function BR(n,t){const{xScale:i,yScale:l}=n;return i&&l?{left:x_(i,t,"left"),right:x_(i,t,"right"),top:x_(l,t,"top"),bottom:x_(l,t,"bottom")}:t}function mC(n,t){const i=t._clip;if(i.disabled)return!1;const l=BR(t,n.chartArea);return{left:i.left===!1?0:l.left-(i.left===!0?0:i.left),right:i.right===!1?n.width:l.right+(i.right===!0?0:i.right),top:i.top===!1?0:l.top-(i.top===!0?0:i.top),bottom:i.bottom===!1?n.height:l.bottom+(i.bottom===!0?0:i.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class FR{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,i,l,c){const d=i.listeners[c],_=i.duration;d.forEach(v=>v({chart:t,initial:i.initial,numSteps:_,currentStep:Math.min(l-i.start,_)}))}_refresh(){this._request||(this._running=!0,this._request=YM.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let i=0;this._charts.forEach((l,c)=>{if(!l.running||!l.items.length)return;const d=l.items;let _=d.length-1,v=!1,r;for(;_>=0;--_)r=d[_],r._active?(r._total>l.duration&&(l.duration=r._total),r.tick(t),v=!0):(d[_]=d[d.length-1],d.pop());v&&(c.draw(),this._notify(c,l,t,"progress")),d.length||(l.running=!1,this._notify(c,l,t,"complete"),l.initial=!1),i+=d.length}),this._lastDate=t,i===0&&(this._running=!1)}_getAnims(t){const i=this._charts;let l=i.get(t);return l||(l={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},i.set(t,l)),l}listen(t,i,l){this._getAnims(t).listeners[i].push(l)}add(t,i){!i||!i.length||this._getAnims(t).items.push(...i)}has(t){return this._getAnims(t).items.length>0}start(t){const i=this._charts.get(t);i&&(i.running=!0,i.start=Date.now(),i.duration=i.items.reduce((l,c)=>Math.max(l,c._duration),0),this._refresh())}running(t){if(!this._running)return!1;const i=this._charts.get(t);return!(!i||!i.running||!i.items.length)}stop(t){const i=this._charts.get(t);if(!i||!i.items.length)return;const l=i.items;let c=l.length-1;for(;c>=0;--c)l[c].cancel();i.items=[],this._notify(t,i,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var xu=new FR;const CT="transparent",NR={boolean(n,t,i){return i>.5?t:n},color(n,t,i){const l=gT(n||CT),c=l.valid&&gT(t||CT);return c&&c.valid?c.mix(l,i).hexString():t},number(n,t,i){return n+(t-n)*i}};class jR{constructor(t,i,l,c){const d=i[l];c=Ip([t.to,c,d,t.from]);const _=Ip([t.from,d,c]);this._active=!0,this._fn=t.fn||NR[t.type||typeof _],this._easing=Gp[t.easing]||Gp.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=i,this._prop=l,this._from=_,this._to=c,this._promises=void 0}active(){return this._active}update(t,i,l){if(this._active){this._notify(!1);const c=this._target[this._prop],d=l-this._start,_=this._duration-d;this._start=l,this._duration=Math.floor(Math.max(_,t.duration)),this._total+=d,this._loop=!!t.loop,this._to=Ip([t.to,i,c,t.from]),this._from=Ip([t.from,c,i])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const i=t-this._start,l=this._duration,c=this._prop,d=this._from,_=this._loop,v=this._to;let r;if(this._active=d!==v&&(_||i<l),!this._active){this._target[c]=v,this._notify(!0);return}if(i<0){this._target[c]=d;return}r=i/l%2,r=_&&r>1?2-r:r,r=this._easing(Math.min(1,Math.max(0,r))),this._target[c]=this._fn(d,v,r)}wait(){const t=this._promises||(this._promises=[]);return new Promise((i,l)=>{t.push({res:i,rej:l})})}_notify(t){const i=t?"res":"rej",l=this._promises||[];for(let c=0;c<l.length;c++)l[c][i]()}}class _C{constructor(t,i){this._chart=t,this._properties=new Map,this.configure(i)}configure(t){if(!ln(t))return;const i=Object.keys(vs.animation),l=this._properties;Object.getOwnPropertyNames(t).forEach(c=>{const d=t[c];if(!ln(d))return;const _={};for(const v of i)_[v]=d[v];(ys(d.properties)&&d.properties||[c]).forEach(v=>{(v===c||!l.has(v))&&l.set(v,_)})})}_animateOptions(t,i){const l=i.options,c=UR(t,l);if(!c)return[];const d=this._createAnimations(c,l);return l.$shared&&VR(t.options.$animations,l).then(()=>{t.options=l},()=>{}),d}_createAnimations(t,i){const l=this._properties,c=[],d=t.$animations||(t.$animations={}),_=Object.keys(i),v=Date.now();let r;for(r=_.length-1;r>=0;--r){const E=_[r];if(E.charAt(0)==="$")continue;if(E==="options"){c.push(...this._animateOptions(t,i));continue}const C=i[E];let z=d[E];const R=l.get(E);if(z)if(R&&z.active()){z.update(R,C,v);continue}else z.cancel();if(!R||!R.duration){t[E]=C;continue}d[E]=z=new jR(R,t,E,C),c.push(z)}return c}update(t,i){if(this._properties.size===0){Object.assign(t,i);return}const l=this._createAnimations(t,i);if(l.length)return xu.add(this._chart,l),!0}}function VR(n,t){const i=[],l=Object.keys(t);for(let c=0;c<l.length;c++){const d=n[l[c]];d&&d.active()&&i.push(d.wait())}return Promise.all(i)}function UR(n,t){if(!t)return;let i=n.options;if(!i){n.options=t;return}return i.$shared&&(n.options=i=Object.assign({},i,{$shared:!1,$animations:{}})),i}function AT(n,t){const i=n&&n.options||{},l=i.reverse,c=i.min===void 0?t:0,d=i.max===void 0?t:0;return{start:l?d:c,end:l?c:d}}function $R(n,t,i){if(i===!1)return!1;const l=AT(n,i),c=AT(t,i);return{top:c.end,right:l.end,bottom:c.start,left:l.start}}function WR(n){let t,i,l,c;return ln(n)?(t=n.top,i=n.right,l=n.bottom,c=n.left):t=i=l=c=n,{top:t,right:i,bottom:l,left:c,disabled:n===!1}}function gC(n,t){const i=[],l=n._getSortedDatasetMetas(t);let c,d;for(c=0,d=l.length;c<d;++c)i.push(l[c].index);return i}function PT(n,t,i,l={}){const c=n.keys,d=l.mode==="single";let _,v,r,E;if(t===null)return;let C=!1;for(_=0,v=c.length;_<v;++_){if(r=+c[_],r===i){if(C=!0,l.all)continue;break}E=n.values[r],js(E)&&(d||t===0||Vc(t)===Vc(E))&&(t+=E)}return!C&&!l.all?0:t}function ZR(n,t){const{iScale:i,vScale:l}=t,c=i.axis==="x"?"x":"y",d=l.axis==="x"?"x":"y",_=Object.keys(n),v=new Array(_.length);let r,E,C;for(r=0,E=_.length;r<E;++r)C=_[r],v[r]={[c]:C,[d]:n[C]};return v}function Ev(n,t){const i=n&&n.options.stacked;return i||i===void 0&&t.stack!==void 0}function GR(n,t,i){return`${n.id}.${t.id}.${i.stack||i.type}`}function HR(n){const{min:t,max:i,minDefined:l,maxDefined:c}=n.getUserBounds();return{min:l?t:Number.NEGATIVE_INFINITY,max:c?i:Number.POSITIVE_INFINITY}}function qR(n,t,i){const l=n[t]||(n[t]={});return l[i]||(l[i]={})}function kT(n,t,i,l){for(const c of t.getMatchingVisibleMetas(l).reverse()){const d=n[c.index];if(i&&d>0||!i&&d<0)return c.index}return null}function IT(n,t){const{chart:i,_cachedMeta:l}=n,c=i._stacks||(i._stacks={}),{iScale:d,vScale:_,index:v}=l,r=d.axis,E=_.axis,C=GR(d,_,l),z=t.length;let R;for(let j=0;j<z;++j){const G=t[j],{[r]:W,[E]:Q}=G,rt=G._stacks||(G._stacks={});R=rt[E]=qR(c,C,W),R[v]=Q,R._top=kT(R,_,!0,l.type),R._bottom=kT(R,_,!1,l.type);const ft=R._visualValues||(R._visualValues={});ft[v]=Q}}function Sv(n,t){const i=n.scales;return Object.keys(i).filter(l=>i[l].axis===t).shift()}function XR(n,t){return Sh(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function KR(n,t,i){return Sh(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:i,index:t,mode:"default",type:"data"})}function xp(n,t){const i=n.controller.index,l=n.vScale&&n.vScale.axis;if(l){t=t||n._parsed;for(const c of t){const d=c._stacks;if(!d||d[l]===void 0||d[l][i]===void 0)return;delete d[l][i],d[l]._visualValues!==void 0&&d[l]._visualValues[i]!==void 0&&delete d[l]._visualValues[i]}}}const Mv=n=>n==="reset"||n==="none",LT=(n,t)=>t?n:Object.assign({},n),YR=(n,t,i)=>n&&!t.hidden&&t._stacked&&{keys:gC(i,!0),values:null};class Mh{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,i){this.chart=t,this._ctx=t.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Ev(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&xp(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,i=this._cachedMeta,l=this.getDataset(),c=(z,R,j,G)=>z==="x"?R:z==="r"?G:j,d=i.xAxisID=Gi(l.xAxisID,Sv(t,"x")),_=i.yAxisID=Gi(l.yAxisID,Sv(t,"y")),v=i.rAxisID=Gi(l.rAxisID,Sv(t,"r")),r=i.indexAxis,E=i.iAxisID=c(r,d,_,v),C=i.vAxisID=c(r,_,d,v);i.xScale=this.getScaleForId(d),i.yScale=this.getScaleForId(_),i.rScale=this.getScaleForId(v),i.iScale=this.getScaleForId(E),i.vScale=this.getScaleForId(C)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const i=this._cachedMeta;return t===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&pT(this._data,this),t._stacked&&xp(t)}_dataCheck(){const t=this.getDataset(),i=t.data||(t.data=[]),l=this._data;if(ln(i)){const c=this._cachedMeta;this._data=ZR(i,c)}else if(l!==i){if(l){pT(l,this);const c=this._cachedMeta;xp(c),c._parsed=[]}i&&Object.isExtensible(i)&&O3(i,this),this._syncList=[],this._data=i}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const i=this._cachedMeta,l=this.getDataset();let c=!1;this._dataCheck();const d=i._stacked;i._stacked=Ev(i.vScale,i),i.stack!==l.stack&&(c=!0,xp(i),i.stack=l.stack),this._resyncElements(t),(c||d!==i._stacked)&&(IT(this,i._parsed),i._stacked=Ev(i.vScale,i))}configure(){const t=this.chart.config,i=t.datasetScopeKeys(this._type),l=t.getOptionScopes(this.getDataset(),i,!0);this.options=t.createResolver(l,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,i){const{_cachedMeta:l,_data:c}=this,{iScale:d,_stacked:_}=l,v=d.axis;let r=t===0&&i===c.length?!0:l._sorted,E=t>0&&l._parsed[t-1],C,z,R;if(this._parsing===!1)l._parsed=c,l._sorted=!0,R=c;else{ys(c[t])?R=this.parseArrayData(l,c,t,i):ln(c[t])?R=this.parseObjectData(l,c,t,i):R=this.parsePrimitiveData(l,c,t,i);const j=()=>z[v]===null||E&&z[v]<E[v];for(C=0;C<i;++C)l._parsed[C+t]=z=R[C],r&&(j()&&(r=!1),E=z);l._sorted=r}_&&IT(this,R)}parsePrimitiveData(t,i,l,c){const{iScale:d,vScale:_}=t,v=d.axis,r=_.axis,E=d.getLabels(),C=d===_,z=new Array(c);let R,j,G;for(R=0,j=c;R<j;++R)G=R+l,z[R]={[v]:C||d.parse(E[G],G),[r]:_.parse(i[G],G)};return z}parseArrayData(t,i,l,c){const{xScale:d,yScale:_}=t,v=new Array(c);let r,E,C,z;for(r=0,E=c;r<E;++r)C=r+l,z=i[C],v[r]={x:d.parse(z[0],C),y:_.parse(z[1],C)};return v}parseObjectData(t,i,l,c){const{xScale:d,yScale:_}=t,{xAxisKey:v="x",yAxisKey:r="y"}=this._parsing,E=new Array(c);let C,z,R,j;for(C=0,z=c;C<z;++C)R=C+l,j=i[R],E[C]={x:d.parse(wh(j,v),R),y:_.parse(wh(j,r),R)};return E}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,i,l){const c=this.chart,d=this._cachedMeta,_=i[t.axis],v={keys:gC(c,!0),values:i._stacks[t.axis]._visualValues};return PT(v,_,d.index,{mode:l})}updateRangeFromParsed(t,i,l,c){const d=l[i.axis];let _=d===null?NaN:d;const v=c&&l._stacks[i.axis];c&&v&&(c.values=v,_=PT(c,d,this._cachedMeta.index)),t.min=Math.min(t.min,_),t.max=Math.max(t.max,_)}getMinMax(t,i){const l=this._cachedMeta,c=l._parsed,d=l._sorted&&t===l.iScale,_=c.length,v=this._getOtherScale(t),r=YR(i,l,this.chart),E={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:C,max:z}=HR(v);let R,j;function G(){j=c[R];const W=j[v.axis];return!js(j[t.axis])||C>W||z<W}for(R=0;R<_&&!(!G()&&(this.updateRangeFromParsed(E,t,j,r),d));++R);if(d){for(R=_-1;R>=0;--R)if(!G()){this.updateRangeFromParsed(E,t,j,r);break}}return E}getAllParsedValues(t){const i=this._cachedMeta._parsed,l=[];let c,d,_;for(c=0,d=i.length;c<d;++c)_=i[c][t.axis],js(_)&&l.push(_);return l}getMaxOverflow(){return!1}getLabelAndValue(t){const i=this._cachedMeta,l=i.iScale,c=i.vScale,d=this.getParsed(t);return{label:l?""+l.getLabelForValue(d[l.axis]):"",value:c?""+c.getLabelForValue(d[c.axis]):""}}_update(t){const i=this._cachedMeta;this.update(t||"default"),i._clip=WR(Gi(this.options.clip,$R(i.xScale,i.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,i=this.chart,l=this._cachedMeta,c=l.data||[],d=i.chartArea,_=[],v=this._drawStart||0,r=this._drawCount||c.length-v,E=this.options.drawActiveElementsOnTop;let C;for(l.dataset&&l.dataset.draw(t,d,v,r),C=v;C<v+r;++C){const z=c[C];z.hidden||(z.active&&E?_.push(z):z.draw(t,d))}for(C=0;C<_.length;++C)_[C].draw(t,d)}getStyle(t,i){const l=i?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(l):this.resolveDataElementOptions(t||0,l)}getContext(t,i,l){const c=this.getDataset();let d;if(t>=0&&t<this._cachedMeta.data.length){const _=this._cachedMeta.data[t];d=_.$context||(_.$context=KR(this.getContext(),t,_)),d.parsed=this.getParsed(t),d.raw=c.data[t],d.index=d.dataIndex=t}else d=this.$context||(this.$context=XR(this.chart.getContext(),this.index)),d.dataset=c,d.index=d.datasetIndex=this.index;return d.active=!!i,d.mode=l,d}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,i){return this._resolveElementOptions(this.dataElementType.id,i,t)}_resolveElementOptions(t,i="default",l){const c=i==="active",d=this._cachedDataOpts,_=t+"-"+i,v=d[_],r=this.enableOptionSharing&&hm(l);if(v)return LT(v,r);const E=this.chart.config,C=E.datasetElementScopeKeys(this._type,t),z=c?[`${t}Hover`,"hover",t,""]:[t,""],R=E.getOptionScopes(this.getDataset(),C),j=Object.keys(vs.elements[t]),G=()=>this.getContext(l,c,i),W=E.resolveNamedOptions(R,j,G,z);return W.$shared&&(W.$shared=r,d[_]=Object.freeze(LT(W,r))),W}_resolveAnimations(t,i,l){const c=this.chart,d=this._cachedDataOpts,_=`animation-${i}`,v=d[_];if(v)return v;let r;if(c.options.animation!==!1){const C=this.chart.config,z=C.datasetAnimationScopeKeys(this._type,i),R=C.getOptionScopes(this.getDataset(),z);r=C.createResolver(R,this.getContext(t,l,i))}const E=new _C(c,r&&r.animations);return r&&r._cacheable&&(d[_]=Object.freeze(E)),E}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,i){return!i||Mv(t)||this.chart._animationsDisabled}_getSharedOptions(t,i){const l=this.resolveDataElementOptions(t,i),c=this._sharedOptions,d=this.getSharedOptions(l),_=this.includeOptions(i,d)||d!==c;return this.updateSharedOptions(d,i,l),{sharedOptions:d,includeOptions:_}}updateElement(t,i,l,c){Mv(c)?Object.assign(t,l):this._resolveAnimations(i,c).update(t,l)}updateSharedOptions(t,i,l){t&&!Mv(i)&&this._resolveAnimations(void 0,i).update(t,l)}_setStyle(t,i,l,c){t.active=c;const d=this.getStyle(i,c);this._resolveAnimations(i,l,c).update(t,{options:!c&&this.getSharedOptions(d)||d})}removeHoverStyle(t,i,l){this._setStyle(t,l,"active",!1)}setHoverStyle(t,i,l){this._setStyle(t,l,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const i=this._data,l=this._cachedMeta.data;for(const[v,r,E]of this._syncList)this[v](r,E);this._syncList=[];const c=l.length,d=i.length,_=Math.min(d,c);_&&this.parse(0,_),d>c?this._insertElements(c,d-c,t):d<c&&this._removeElements(d,c-d)}_insertElements(t,i,l=!0){const c=this._cachedMeta,d=c.data,_=t+i;let v;const r=E=>{for(E.length+=i,v=E.length-1;v>=_;v--)E[v]=E[v-i]};for(r(d),v=t;v<_;++v)d[v]=new this.dataElementType;this._parsing&&r(c._parsed),this.parse(t,i),l&&this.updateElements(d,t,i,"reset")}updateElements(t,i,l,c){}_removeElements(t,i){const l=this._cachedMeta;if(this._parsing){const c=l._parsed.splice(t,i);l._stacked&&xp(l,c)}l.data.splice(t,i)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[i,l,c]=t;this[i](l,c)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,i){i&&this._sync(["_removeElements",t,i]);const l=arguments.length-2;l&&this._sync(["_insertElements",t,l])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function JR(n,t){if(!n._cache.$bar){const i=n.getMatchingVisibleMetas(t);let l=[];for(let c=0,d=i.length;c<d;c++)l=l.concat(i[c].controller.getAllParsedValues(n));n._cache.$bar=KM(l.sort((c,d)=>c-d))}return n._cache.$bar}function QR(n){const t=n.iScale,i=JR(t,n.type);let l=t._length,c,d,_,v;const r=()=>{_===32767||_===-32768||(hm(v)&&(l=Math.min(l,Math.abs(_-v)||l)),v=_)};for(c=0,d=i.length;c<d;++c)_=t.getPixelForValue(i[c]),r();for(v=void 0,c=0,d=t.ticks.length;c<d;++c)_=t.getPixelForTick(c),r();return l}function tB(n,t,i,l){const c=i.barThickness;let d,_;return rn(c)?(d=t.min*i.categoryPercentage,_=i.barPercentage):(d=c*l,_=1),{chunk:d/l,ratio:_,start:t.pixels[n]-d/2}}function eB(n,t,i,l){const c=t.pixels,d=c[n];let _=n>0?c[n-1]:null,v=n<c.length-1?c[n+1]:null;const r=i.categoryPercentage;_===null&&(_=d-(v===null?t.end-t.start:v-d)),v===null&&(v=d+d-_);const E=d-(d-Math.min(_,v))/2*r;return{chunk:Math.abs(v-_)/2*r/l,ratio:i.barPercentage,start:E}}function iB(n,t,i,l){const c=i.parse(n[0],l),d=i.parse(n[1],l),_=Math.min(c,d),v=Math.max(c,d);let r=_,E=v;Math.abs(_)>Math.abs(v)&&(r=v,E=_),t[i.axis]=E,t._custom={barStart:r,barEnd:E,start:c,end:d,min:_,max:v}}function yC(n,t,i,l){return ys(n)?iB(n,t,i,l):t[i.axis]=i.parse(n,l),t}function DT(n,t,i,l){const c=n.iScale,d=n.vScale,_=c.getLabels(),v=c===d,r=[];let E,C,z,R;for(E=i,C=i+l;E<C;++E)R=t[E],z={},z[c.axis]=v||c.parse(_[E],E),r.push(yC(R,z,d,E));return r}function Cv(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function nB(n,t,i){return n!==0?Vc(n):(t.isHorizontal()?1:-1)*(t.min>=i?1:-1)}function sB(n){let t,i,l,c,d;return n.horizontal?(t=n.base>n.x,i="left",l="right"):(t=n.base<n.y,i="bottom",l="top"),t?(c="end",d="start"):(c="start",d="end"),{start:i,end:l,reverse:t,top:c,bottom:d}}function rB(n,t,i,l){let c=t.borderSkipped;const d={};if(!c){n.borderSkipped=d;return}if(c===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:_,end:v,reverse:r,top:E,bottom:C}=sB(n);c==="middle"&&i&&(n.enableBorderRadius=!0,(i._top||0)===l?c=E:(i._bottom||0)===l?c=C:(d[zT(C,_,v,r)]=!0,c=E)),d[zT(c,_,v,r)]=!0,n.borderSkipped=d}function zT(n,t,i,l){return l?(n=oB(n,t,i),n=OT(n,i,t)):n=OT(n,t,i),n}function oB(n,t,i){return n===t?i:n===i?t:n}function OT(n,t,i){return n==="start"?t:n==="end"?i:n}function aB(n,{inflateAmount:t},i){n.inflateAmount=t==="auto"?i===1?.33:0:t}class lB extends Mh{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,i,l,c){return DT(t,i,l,c)}parseArrayData(t,i,l,c){return DT(t,i,l,c)}parseObjectData(t,i,l,c){const{iScale:d,vScale:_}=t,{xAxisKey:v="x",yAxisKey:r="y"}=this._parsing,E=d.axis==="x"?v:r,C=_.axis==="x"?v:r,z=[];let R,j,G,W;for(R=l,j=l+c;R<j;++R)W=i[R],G={},G[d.axis]=d.parse(wh(W,E),R),z.push(yC(wh(W,C),G,_,R));return z}updateRangeFromParsed(t,i,l,c){super.updateRangeFromParsed(t,i,l,c);const d=l._custom;d&&i===this._cachedMeta.vScale&&(t.min=Math.min(t.min,d.min),t.max=Math.max(t.max,d.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const i=this._cachedMeta,{iScale:l,vScale:c}=i,d=this.getParsed(t),_=d._custom,v=Cv(_)?"["+_.start+", "+_.end+"]":""+c.getLabelForValue(d[c.axis]);return{label:""+l.getLabelForValue(d[l.axis]),value:v}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,t)}updateElements(t,i,l,c){const d=c==="reset",{index:_,_cachedMeta:{vScale:v}}=this,r=v.getBasePixel(),E=v.isHorizontal(),C=this._getRuler(),{sharedOptions:z,includeOptions:R}=this._getSharedOptions(i,c);for(let j=i;j<i+l;j++){const G=this.getParsed(j),W=d||rn(G[v.axis])?{base:r,head:r}:this._calculateBarValuePixels(j),Q=this._calculateBarIndexPixels(j,C),rt=(G._stacks||{})[v.axis],ft={horizontal:E,base:W.base,enableBorderRadius:!rt||Cv(G._custom)||_===rt._top||_===rt._bottom,x:E?W.head:Q.center,y:E?Q.center:W.head,height:E?Q.size:Math.abs(W.size),width:E?Math.abs(W.size):Q.size};R&&(ft.options=z||this.resolveDataElementOptions(j,t[j].active?"active":c));const xt=ft.options||t[j].options;rB(ft,xt,rt,_),aB(ft,xt,C.ratio),this.updateElement(t[j],j,ft,c)}}_getStacks(t,i){const{iScale:l}=this._cachedMeta,c=l.getMatchingVisibleMetas(this._type).filter(C=>C.controller.options.grouped),d=l.options.stacked,_=[],v=this._cachedMeta.controller.getParsed(i),r=v&&v[l.axis],E=C=>{const z=C._parsed.find(j=>j[l.axis]===r),R=z&&z[C.vScale.axis];if(rn(R)||isNaN(R))return!0};for(const C of c)if(!(i!==void 0&&E(C))&&((d===!1||_.indexOf(C.stack)===-1||d===void 0&&C.stack===void 0)&&_.push(C.stack),C.index===t))break;return _.length||_.push(void 0),_}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,i=this.chart.options.indexAxis;return Object.keys(t).filter(l=>t[l].axis===i).shift()}_getAxis(){const t={},i=this.getFirstScaleIdForIndexAxis();for(const l of this.chart.data.datasets)t[Gi(this.chart.options.indexAxis==="x"?l.xAxisID:l.yAxisID,i)]=!0;return Object.keys(t)}_getStackIndex(t,i,l){const c=this._getStacks(t,l),d=i!==void 0?c.indexOf(i):-1;return d===-1?c.length-1:d}_getRuler(){const t=this.options,i=this._cachedMeta,l=i.iScale,c=[];let d,_;for(d=0,_=i.data.length;d<_;++d)c.push(l.getPixelForValue(this.getParsed(d)[l.axis],d));const v=t.barThickness;return{min:v||QR(i),pixels:c,start:l._startPixel,end:l._endPixel,stackCount:this._getStackCount(),scale:l,grouped:t.grouped,ratio:v?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:i,_stacked:l,index:c},options:{base:d,minBarLength:_}}=this,v=d||0,r=this.getParsed(t),E=r._custom,C=Cv(E);let z=r[i.axis],R=0,j=l?this.applyStack(i,r,l):z,G,W;j!==z&&(R=j-z,j=z),C&&(z=E.barStart,j=E.barEnd-E.barStart,z!==0&&Vc(z)!==Vc(E.barEnd)&&(R=0),R+=z);const Q=!rn(d)&&!C?d:R;let rt=i.getPixelForValue(Q);if(this.chart.getDataVisibility(t)?G=i.getPixelForValue(R+j):G=rt,W=G-rt,Math.abs(W)<_){W=nB(W,i,v)*_,z===v&&(rt-=W/2);const ft=i.getPixelForDecimal(0),xt=i.getPixelForDecimal(1),mt=Math.min(ft,xt),bt=Math.max(ft,xt);rt=Math.max(Math.min(rt,bt),mt),G=rt+W,l&&!C&&(r._stacks[i.axis]._visualValues[c]=i.getValueForPixel(G)-i.getValueForPixel(rt))}if(rt===i.getPixelForValue(v)){const ft=Vc(W)*i.getLineWidthForValue(v)/2;rt+=ft,W-=ft}return{size:W,base:rt,head:G,center:G+W/2}}_calculateBarIndexPixels(t,i){const l=i.scale,c=this.options,d=c.skipNull,_=Gi(c.maxBarThickness,1/0);let v,r;const E=this._getAxisCount();if(i.grouped){const C=d?this._getStackCount(t):i.stackCount,z=c.barThickness==="flex"?eB(t,i,c,C*E):tB(t,i,c,C*E),R=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,j=this._getAxis().indexOf(Gi(R,this.getFirstScaleIdForIndexAxis())),G=this._getStackIndex(this.index,this._cachedMeta.stack,d?t:void 0)+j;v=z.start+z.chunk*G+z.chunk/2,r=Math.min(_,z.chunk*z.ratio)}else v=l.getPixelForValue(this.getParsed(t)[l.axis],t),r=Math.min(_,i.min*i.ratio);return{base:v-r/2,head:v+r/2,center:v,size:r}}draw(){const t=this._cachedMeta,i=t.vScale,l=t.data,c=l.length;let d=0;for(;d<c;++d)this.getParsed(d)[i.axis]!==null&&!l[d].hidden&&l[d].draw(this._ctx)}}class cB extends Mh{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,i,l,c){const d=super.parsePrimitiveData(t,i,l,c);for(let _=0;_<d.length;_++)d[_]._custom=this.resolveDataElementOptions(_+l).radius;return d}parseArrayData(t,i,l,c){const d=super.parseArrayData(t,i,l,c);for(let _=0;_<d.length;_++){const v=i[l+_];d[_]._custom=Gi(v[2],this.resolveDataElementOptions(_+l).radius)}return d}parseObjectData(t,i,l,c){const d=super.parseObjectData(t,i,l,c);for(let _=0;_<d.length;_++){const v=i[l+_];d[_]._custom=Gi(v&&v.r&&+v.r,this.resolveDataElementOptions(_+l).radius)}return d}getMaxOverflow(){const t=this._cachedMeta.data;let i=0;for(let l=t.length-1;l>=0;--l)i=Math.max(i,t[l].size(this.resolveDataElementOptions(l))/2);return i>0&&i}getLabelAndValue(t){const i=this._cachedMeta,l=this.chart.data.labels||[],{xScale:c,yScale:d}=i,_=this.getParsed(t),v=c.getLabelForValue(_.x),r=d.getLabelForValue(_.y),E=_._custom;return{label:l[t]||"",value:"("+v+", "+r+(E?", "+E:"")+")"}}update(t){const i=this._cachedMeta.data;this.updateElements(i,0,i.length,t)}updateElements(t,i,l,c){const d=c==="reset",{iScale:_,vScale:v}=this._cachedMeta,{sharedOptions:r,includeOptions:E}=this._getSharedOptions(i,c),C=_.axis,z=v.axis;for(let R=i;R<i+l;R++){const j=t[R],G=!d&&this.getParsed(R),W={},Q=W[C]=d?_.getPixelForDecimal(.5):_.getPixelForValue(G[C]),rt=W[z]=d?v.getBasePixel():v.getPixelForValue(G[z]);W.skip=isNaN(Q)||isNaN(rt),E&&(W.options=r||this.resolveDataElementOptions(R,j.active?"active":c),d&&(W.options.radius=0)),this.updateElement(j,R,W,c)}}resolveDataElementOptions(t,i){const l=this.getParsed(t);let c=super.resolveDataElementOptions(t,i);c.$shared&&(c=Object.assign({},c,{$shared:!1}));const d=c.radius;return i!=="active"&&(c.radius=0),c.radius+=Gi(l&&l._custom,d),c}}function uB(n,t,i){let l=1,c=1,d=0,_=0;if(t<ds){const v=n,r=v+t,E=Math.cos(v),C=Math.sin(v),z=Math.cos(r),R=Math.sin(r),j=(xt,mt,bt)=>dm(xt,v,r,!0)?1:Math.max(mt,mt*i,bt,bt*i),G=(xt,mt,bt)=>dm(xt,v,r,!0)?-1:Math.min(mt,mt*i,bt,bt*i),W=j(0,E,z),Q=j(Ks,C,R),rt=G(Sn,E,z),ft=G(Sn+Ks,C,R);l=(W-rt)/2,c=(Q-ft)/2,d=-(W+rt)/2,_=-(Q+ft)/2}return{ratioX:l,ratioY:c,offsetX:d,offsetY:_}}class _0 extends Mh{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const i=t.data,{labels:{pointStyle:l,textAlign:c,color:d,useBorderRadius:_,borderRadius:v}}=t.legend.options;return i.labels.length&&i.datasets.length?i.labels.map((r,E)=>{const z=t.getDatasetMeta(0).controller.getStyle(E);return{text:r,fillStyle:z.backgroundColor,fontColor:d,hidden:!t.getDataVisibility(E),lineDash:z.borderDash,lineDashOffset:z.borderDashOffset,lineJoin:z.borderJoinStyle,lineWidth:z.borderWidth,strokeStyle:z.borderColor,textAlign:c,pointStyle:l,borderRadius:_&&(v||z.borderRadius),index:E}}):[]}},onClick(t,i,l){l.chart.toggleDataVisibility(i.index),l.chart.update()}}}};constructor(t,i){super(t,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,i){const l=this.getDataset().data,c=this._cachedMeta;if(this._parsing===!1)c._parsed=l;else{let d=r=>+l[r];if(ln(l[t])){const{key:r="value"}=this._parsing;d=E=>+wh(l[E],r)}let _,v;for(_=t,v=t+i;_<v;++_)c._parsed[_]=d(_)}}_getRotation(){return Jl(this.options.rotation-90)}_getCircumference(){return Jl(this.options.circumference)}_getRotationExtents(){let t=ds,i=-ds;for(let l=0;l<this.chart.data.datasets.length;++l)if(this.chart.isDatasetVisible(l)&&this.chart.getDatasetMeta(l).type===this._type){const c=this.chart.getDatasetMeta(l).controller,d=c._getRotation(),_=c._getCircumference();t=Math.min(t,d),i=Math.max(i,d+_)}return{rotation:t,circumference:i-t}}update(t){const i=this.chart,{chartArea:l}=i,c=this._cachedMeta,d=c.data,_=this.getMaxBorderWidth()+this.getMaxOffset(d)+this.options.spacing,v=Math.max((Math.min(l.width,l.height)-_)/2,0),r=Math.min(x3(this.options.cutout,v),1),E=this._getRingWeight(this.index),{circumference:C,rotation:z}=this._getRotationExtents(),{ratioX:R,ratioY:j,offsetX:G,offsetY:W}=uB(z,C,r),Q=(l.width-_)/R,rt=(l.height-_)/j,ft=Math.max(Math.min(Q,rt)/2,0),xt=ZM(this.options.radius,ft),mt=Math.max(xt*r,0),bt=(xt-mt)/this._getVisibleDatasetWeightTotal();this.offsetX=G*xt,this.offsetY=W*xt,c.total=this.calculateTotal(),this.outerRadius=xt-bt*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-bt*E,0),this.updateElements(d,0,d.length,t)}_circumference(t,i){const l=this.options,c=this._cachedMeta,d=this._getCircumference();return i&&l.animation.animateRotate||!this.chart.getDataVisibility(t)||c._parsed[t]===null||c.data[t].hidden?0:this.calculateCircumference(c._parsed[t]*d/ds)}updateElements(t,i,l,c){const d=c==="reset",_=this.chart,v=_.chartArea,E=_.options.animation,C=(v.left+v.right)/2,z=(v.top+v.bottom)/2,R=d&&E.animateScale,j=R?0:this.innerRadius,G=R?0:this.outerRadius,{sharedOptions:W,includeOptions:Q}=this._getSharedOptions(i,c);let rt=this._getRotation(),ft;for(ft=0;ft<i;++ft)rt+=this._circumference(ft,d);for(ft=i;ft<i+l;++ft){const xt=this._circumference(ft,d),mt=t[ft],bt={x:C+this.offsetX,y:z+this.offsetY,startAngle:rt,endAngle:rt+xt,circumference:xt,outerRadius:G,innerRadius:j};Q&&(bt.options=W||this.resolveDataElementOptions(ft,mt.active?"active":c)),rt+=xt,this.updateElement(mt,ft,bt,c)}}calculateTotal(){const t=this._cachedMeta,i=t.data;let l=0,c;for(c=0;c<i.length;c++){const d=t._parsed[c];d!==null&&!isNaN(d)&&this.chart.getDataVisibility(c)&&!i[c].hidden&&(l+=Math.abs(d))}return l}calculateCircumference(t){const i=this._cachedMeta.total;return i>0&&!isNaN(t)?ds*(Math.abs(t)/i):0}getLabelAndValue(t){const i=this._cachedMeta,l=this.chart,c=l.data.labels||[],d=Tm(i._parsed[t],l.options.locale);return{label:c[t]||"",value:d}}getMaxBorderWidth(t){let i=0;const l=this.chart;let c,d,_,v,r;if(!t){for(c=0,d=l.data.datasets.length;c<d;++c)if(l.isDatasetVisible(c)){_=l.getDatasetMeta(c),t=_.data,v=_.controller;break}}if(!t)return 0;for(c=0,d=t.length;c<d;++c)r=v.resolveDataElementOptions(c),r.borderAlign!=="inner"&&(i=Math.max(i,r.borderWidth||0,r.hoverBorderWidth||0));return i}getMaxOffset(t){let i=0;for(let l=0,c=t.length;l<c;++l){const d=this.resolveDataElementOptions(l);i=Math.max(i,d.offset||0,d.hoverOffset||0)}return i}_getRingWeightOffset(t){let i=0;for(let l=0;l<t;++l)this.chart.isDatasetVisible(l)&&(i+=this._getRingWeight(l));return i}_getRingWeight(t){return Math.max(Gi(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class hB extends Mh{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const i=this._cachedMeta,{dataset:l,data:c=[],_dataset:d}=i,_=this.chart._animationsDisabled;let{start:v,count:r}=QM(i,c,_);this._drawStart=v,this._drawCount=r,tC(i)&&(v=0,r=c.length),l._chart=this.chart,l._datasetIndex=this.index,l._decimated=!!d._decimated,l.points=c;const E=this.resolveDatasetElementOptions(t);this.options.showLine||(E.borderWidth=0),E.segment=this.options.segment,this.updateElement(l,void 0,{animated:!_,options:E},t),this.updateElements(c,v,r,t)}updateElements(t,i,l,c){const d=c==="reset",{iScale:_,vScale:v,_stacked:r,_dataset:E}=this._cachedMeta,{sharedOptions:C,includeOptions:z}=this._getSharedOptions(i,c),R=_.axis,j=v.axis,{spanGaps:G,segment:W}=this.options,Q=Pf(G)?G:Number.POSITIVE_INFINITY,rt=this.chart._animationsDisabled||d||c==="none",ft=i+l,xt=t.length;let mt=i>0&&this.getParsed(i-1);for(let bt=0;bt<xt;++bt){const Ot=t[bt],zt=rt?Ot:{};if(bt<i||bt>=ft){zt.skip=!0;continue}const Rt=this.getParsed(bt),Bt=rn(Rt[j]),Nt=zt[R]=_.getPixelForValue(Rt[R],bt),ee=zt[j]=d||Bt?v.getBasePixel():v.getPixelForValue(r?this.applyStack(v,Rt,r):Rt[j],bt);zt.skip=isNaN(Nt)||isNaN(ee)||Bt,zt.stop=bt>0&&Math.abs(Rt[R]-mt[R])>Q,W&&(zt.parsed=Rt,zt.raw=E.data[bt]),z&&(zt.options=C||this.resolveDataElementOptions(bt,Ot.active?"active":c)),rt||this.updateElement(Ot,bt,zt,c),mt=Rt}}getMaxOverflow(){const t=this._cachedMeta,i=t.dataset,l=i.options&&i.options.borderWidth||0,c=t.data||[];if(!c.length)return l;const d=c[0].size(this.resolveDataElementOptions(0)),_=c[c.length-1].size(this.resolveDataElementOptions(c.length-1));return Math.max(l,d,_)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class vC extends Mh{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const i=t.data;if(i.labels.length&&i.datasets.length){const{labels:{pointStyle:l,color:c}}=t.legend.options;return i.labels.map((d,_)=>{const r=t.getDatasetMeta(0).controller.getStyle(_);return{text:d,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,fontColor:c,lineWidth:r.borderWidth,pointStyle:l,hidden:!t.getDataVisibility(_),index:_}})}return[]}},onClick(t,i,l){l.chart.toggleDataVisibility(i.index),l.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,i){super(t,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const i=this._cachedMeta,l=this.chart,c=l.data.labels||[],d=Tm(i._parsed[t].r,l.options.locale);return{label:c[t]||"",value:d}}parseObjectData(t,i,l,c){return lC.bind(this)(t,i,l,c)}update(t){const i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,t)}getMinMax(){const t=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((l,c)=>{const d=this.getParsed(c).r;!isNaN(d)&&this.chart.getDataVisibility(c)&&(d<i.min&&(i.min=d),d>i.max&&(i.max=d))}),i}_updateRadius(){const t=this.chart,i=t.chartArea,l=t.options,c=Math.min(i.right-i.left,i.bottom-i.top),d=Math.max(c/2,0),_=Math.max(l.cutoutPercentage?d/100*l.cutoutPercentage:1,0),v=(d-_)/t.getVisibleDatasetCount();this.outerRadius=d-v*this.index,this.innerRadius=this.outerRadius-v}updateElements(t,i,l,c){const d=c==="reset",_=this.chart,r=_.options.animation,E=this._cachedMeta.rScale,C=E.xCenter,z=E.yCenter,R=E.getIndexAngle(0)-.5*Sn;let j=R,G;const W=360/this.countVisibleElements();for(G=0;G<i;++G)j+=this._computeAngle(G,c,W);for(G=i;G<i+l;G++){const Q=t[G];let rt=j,ft=j+this._computeAngle(G,c,W),xt=_.getDataVisibility(G)?E.getDistanceFromCenterForValue(this.getParsed(G).r):0;j=ft,d&&(r.animateScale&&(xt=0),r.animateRotate&&(rt=ft=R));const mt={x:C,y:z,innerRadius:0,outerRadius:xt,startAngle:rt,endAngle:ft,options:this.resolveDataElementOptions(G,Q.active?"active":c)};this.updateElement(Q,G,mt,c)}}countVisibleElements(){const t=this._cachedMeta;let i=0;return t.data.forEach((l,c)=>{!isNaN(this.getParsed(c).r)&&this.chart.getDataVisibility(c)&&i++}),i}_computeAngle(t,i,l){return this.chart.getDataVisibility(t)?Jl(this.resolveDataElementOptions(t,i).angle||l):0}}class dB extends _0{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class fB extends Mh{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const i=this._cachedMeta.vScale,l=this.getParsed(t);return{label:i.getLabels()[t],value:""+i.getLabelForValue(l[i.axis])}}parseObjectData(t,i,l,c){return lC.bind(this)(t,i,l,c)}update(t){const i=this._cachedMeta,l=i.dataset,c=i.data||[],d=i.iScale.getLabels();if(l.points=c,t!=="resize"){const _=this.resolveDatasetElementOptions(t);this.options.showLine||(_.borderWidth=0);const v={_loop:!0,_fullLoop:d.length===c.length,options:_};this.updateElement(l,void 0,v,t)}this.updateElements(c,0,c.length,t)}updateElements(t,i,l,c){const d=this._cachedMeta.rScale,_=c==="reset";for(let v=i;v<i+l;v++){const r=t[v],E=this.resolveDataElementOptions(v,r.active?"active":c),C=d.getPointPositionForValue(v,this.getParsed(v).r),z=_?d.xCenter:C.x,R=_?d.yCenter:C.y,j={x:z,y:R,angle:C.angle,skip:isNaN(z)||isNaN(R),options:E};this.updateElement(r,v,j,c)}}}class pB extends Mh{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const i=this._cachedMeta,l=this.chart.data.labels||[],{xScale:c,yScale:d}=i,_=this.getParsed(t),v=c.getLabelForValue(_.x),r=d.getLabelForValue(_.y);return{label:l[t]||"",value:"("+v+", "+r+")"}}update(t){const i=this._cachedMeta,{data:l=[]}=i,c=this.chart._animationsDisabled;let{start:d,count:_}=QM(i,l,c);if(this._drawStart=d,this._drawCount=_,tC(i)&&(d=0,_=l.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:v,_dataset:r}=i;v._chart=this.chart,v._datasetIndex=this.index,v._decimated=!!r._decimated,v.points=l;const E=this.resolveDatasetElementOptions(t);E.segment=this.options.segment,this.updateElement(v,void 0,{animated:!c,options:E},t)}else this.datasetElementType&&(delete i.dataset,this.datasetElementType=!1);this.updateElements(l,d,_,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,i,l,c){const d=c==="reset",{iScale:_,vScale:v,_stacked:r,_dataset:E}=this._cachedMeta,C=this.resolveDataElementOptions(i,c),z=this.getSharedOptions(C),R=this.includeOptions(c,z),j=_.axis,G=v.axis,{spanGaps:W,segment:Q}=this.options,rt=Pf(W)?W:Number.POSITIVE_INFINITY,ft=this.chart._animationsDisabled||d||c==="none";let xt=i>0&&this.getParsed(i-1);for(let mt=i;mt<i+l;++mt){const bt=t[mt],Ot=this.getParsed(mt),zt=ft?bt:{},Rt=rn(Ot[G]),Bt=zt[j]=_.getPixelForValue(Ot[j],mt),Nt=zt[G]=d||Rt?v.getBasePixel():v.getPixelForValue(r?this.applyStack(v,Ot,r):Ot[G],mt);zt.skip=isNaN(Bt)||isNaN(Nt)||Rt,zt.stop=mt>0&&Math.abs(Ot[j]-xt[j])>rt,Q&&(zt.parsed=Ot,zt.raw=E.data[mt]),R&&(zt.options=z||this.resolveDataElementOptions(mt,bt.active?"active":c)),ft||this.updateElement(bt,mt,zt,c),xt=Ot}this.updateSharedOptions(z,c,C)}getMaxOverflow(){const t=this._cachedMeta,i=t.data||[];if(!this.options.showLine){let v=0;for(let r=i.length-1;r>=0;--r)v=Math.max(v,i[r].size(this.resolveDataElementOptions(r))/2);return v>0&&v}const l=t.dataset,c=l.options&&l.options.borderWidth||0;if(!i.length)return c;const d=i[0].size(this.resolveDataElementOptions(0)),_=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(c,d,_)/2}}var mB=Object.freeze({__proto__:null,BarController:lB,BubbleController:cB,DoughnutController:_0,LineController:hB,PieController:dB,PolarAreaController:vC,RadarController:fB,ScatterController:pB});function rd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class g0{static override(t){Object.assign(g0.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return rd()}parse(){return rd()}format(){return rd()}add(){return rd()}diff(){return rd()}startOf(){return rd()}endOf(){return rd()}}var _B={_date:g0};function gB(n,t,i,l){const{controller:c,data:d,_sorted:_}=n,v=c._cachedMeta.iScale,r=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(v&&t===v.axis&&t!=="r"&&_&&d.length){const E=v._reversePixels?D3:Iu;if(l){if(c._sharedOptions){const C=d[0],z=typeof C.getRange=="function"&&C.getRange(t);if(z){const R=E(d,t,i-z),j=E(d,t,i+z);return{lo:R.lo,hi:j.hi}}}}else{const C=E(d,t,i);if(r){const{vScale:z}=c._cachedMeta,{_parsed:R}=n,j=R.slice(0,C.lo+1).reverse().findIndex(W=>!rn(W[z.axis]));C.lo-=Math.max(0,j);const G=R.slice(C.hi).findIndex(W=>!rn(W[z.axis]));C.hi+=Math.max(0,G)}return C}}return{lo:0,hi:d.length-1}}function Fg(n,t,i,l,c){const d=n.getSortedVisibleDatasetMetas(),_=i[t];for(let v=0,r=d.length;v<r;++v){const{index:E,data:C}=d[v],{lo:z,hi:R}=gB(d[v],t,_,c);for(let j=z;j<=R;++j){const G=C[j];G.skip||l(G,E,j)}}}function yB(n){const t=n.indexOf("x")!==-1,i=n.indexOf("y")!==-1;return function(l,c){const d=t?Math.abs(l.x-c.x):0,_=i?Math.abs(l.y-c.y):0;return Math.sqrt(Math.pow(d,2)+Math.pow(_,2))}}function Av(n,t,i,l,c){const d=[];return!c&&!n.isPointInArea(t)||Fg(n,i,t,function(v,r,E){!c&&!Lu(v,n.chartArea,0)||v.inRange(t.x,t.y,l)&&d.push({element:v,datasetIndex:r,index:E})},!0),d}function vB(n,t,i,l){let c=[];function d(_,v,r){const{startAngle:E,endAngle:C}=_.getProps(["startAngle","endAngle"],l),{angle:z}=qM(_,{x:t.x,y:t.y});dm(z,E,C)&&c.push({element:_,datasetIndex:v,index:r})}return Fg(n,i,t,d),c}function xB(n,t,i,l,c,d){let _=[];const v=yB(i);let r=Number.POSITIVE_INFINITY;function E(C,z,R){const j=C.inRange(t.x,t.y,c);if(l&&!j)return;const G=C.getCenterPoint(c);if(!(!!d||n.isPointInArea(G))&&!j)return;const Q=v(t,G);Q<r?(_=[{element:C,datasetIndex:z,index:R}],r=Q):Q===r&&_.push({element:C,datasetIndex:z,index:R})}return Fg(n,i,t,E),_}function Pv(n,t,i,l,c,d){return!d&&!n.isPointInArea(t)?[]:i==="r"&&!l?vB(n,t,i,c):xB(n,t,i,l,c,d)}function RT(n,t,i,l,c){const d=[],_=i==="x"?"inXRange":"inYRange";let v=!1;return Fg(n,i,t,(r,E,C)=>{r[_]&&r[_](t[i],c)&&(d.push({element:r,datasetIndex:E,index:C}),v=v||r.inRange(t.x,t.y,c))}),l&&!v?[]:d}var bB={modes:{index(n,t,i,l){const c=cd(t,n),d=i.axis||"x",_=i.includeInvisible||!1,v=i.intersect?Av(n,c,d,l,_):Pv(n,c,d,!1,l,_),r=[];return v.length?(n.getSortedVisibleDatasetMetas().forEach(E=>{const C=v[0].index,z=E.data[C];z&&!z.skip&&r.push({element:z,datasetIndex:E.index,index:C})}),r):[]},dataset(n,t,i,l){const c=cd(t,n),d=i.axis||"xy",_=i.includeInvisible||!1;let v=i.intersect?Av(n,c,d,l,_):Pv(n,c,d,!1,l,_);if(v.length>0){const r=v[0].datasetIndex,E=n.getDatasetMeta(r).data;v=[];for(let C=0;C<E.length;++C)v.push({element:E[C],datasetIndex:r,index:C})}return v},point(n,t,i,l){const c=cd(t,n),d=i.axis||"xy",_=i.includeInvisible||!1;return Av(n,c,d,l,_)},nearest(n,t,i,l){const c=cd(t,n),d=i.axis||"xy",_=i.includeInvisible||!1;return Pv(n,c,d,i.intersect,l,_)},x(n,t,i,l){const c=cd(t,n);return RT(n,c,"x",i.intersect,l)},y(n,t,i,l){const c=cd(t,n);return RT(n,c,"y",i.intersect,l)}}};const xC=["left","top","right","bottom"];function bp(n,t){return n.filter(i=>i.pos===t)}function BT(n,t){return n.filter(i=>xC.indexOf(i.pos)===-1&&i.box.axis===t)}function wp(n,t){return n.sort((i,l)=>{const c=t?l:i,d=t?i:l;return c.weight===d.weight?c.index-d.index:c.weight-d.weight})}function wB(n){const t=[];let i,l,c,d,_,v;for(i=0,l=(n||[]).length;i<l;++i)c=n[i],{position:d,options:{stack:_,stackWeight:v=1}}=c,t.push({index:i,box:c,pos:d,horizontal:c.isHorizontal(),weight:c.weight,stack:_&&d+_,stackWeight:v});return t}function TB(n){const t={};for(const i of n){const{stack:l,pos:c,stackWeight:d}=i;if(!l||!xC.includes(c))continue;const _=t[l]||(t[l]={count:0,placed:0,weight:0,size:0});_.count++,_.weight+=d}return t}function EB(n,t){const i=TB(n),{vBoxMaxWidth:l,hBoxMaxHeight:c}=t;let d,_,v;for(d=0,_=n.length;d<_;++d){v=n[d];const{fullSize:r}=v.box,E=i[v.stack],C=E&&v.stackWeight/E.weight;v.horizontal?(v.width=C?C*l:r&&t.availableWidth,v.height=c):(v.width=l,v.height=C?C*c:r&&t.availableHeight)}return i}function SB(n){const t=wB(n),i=wp(t.filter(E=>E.box.fullSize),!0),l=wp(bp(t,"left"),!0),c=wp(bp(t,"right")),d=wp(bp(t,"top"),!0),_=wp(bp(t,"bottom")),v=BT(t,"x"),r=BT(t,"y");return{fullSize:i,leftAndTop:l.concat(d),rightAndBottom:c.concat(r).concat(_).concat(v),chartArea:bp(t,"chartArea"),vertical:l.concat(c).concat(r),horizontal:d.concat(_).concat(v)}}function FT(n,t,i,l){return Math.max(n[i],t[i])+Math.max(n[l],t[l])}function bC(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function MB(n,t,i,l){const{pos:c,box:d}=i,_=n.maxPadding;if(!ln(c)){i.size&&(n[c]-=i.size);const z=l[i.stack]||{size:0,count:1};z.size=Math.max(z.size,i.horizontal?d.height:d.width),i.size=z.size/z.count,n[c]+=i.size}d.getPadding&&bC(_,d.getPadding());const v=Math.max(0,t.outerWidth-FT(_,n,"left","right")),r=Math.max(0,t.outerHeight-FT(_,n,"top","bottom")),E=v!==n.w,C=r!==n.h;return n.w=v,n.h=r,i.horizontal?{same:E,other:C}:{same:C,other:E}}function CB(n){const t=n.maxPadding;function i(l){const c=Math.max(t[l]-n[l],0);return n[l]+=c,c}n.y+=i("top"),n.x+=i("left"),i("right"),i("bottom")}function AB(n,t){const i=t.maxPadding;function l(c){const d={left:0,top:0,right:0,bottom:0};return c.forEach(_=>{d[_]=Math.max(t[_],i[_])}),d}return l(n?["left","right"]:["top","bottom"])}function Lp(n,t,i,l){const c=[];let d,_,v,r,E,C;for(d=0,_=n.length,E=0;d<_;++d){v=n[d],r=v.box,r.update(v.width||t.w,v.height||t.h,AB(v.horizontal,t));const{same:z,other:R}=MB(t,i,v,l);E|=z&&c.length,C=C||R,r.fullSize||c.push(v)}return E&&Lp(c,t,i,l)||C}function b_(n,t,i,l,c){n.top=i,n.left=t,n.right=t+l,n.bottom=i+c,n.width=l,n.height=c}function NT(n,t,i,l){const c=i.padding;let{x:d,y:_}=t;for(const v of n){const r=v.box,E=l[v.stack]||{placed:0,weight:1},C=v.stackWeight/E.weight||1;if(v.horizontal){const z=t.w*C,R=E.size||r.height;hm(E.start)&&(_=E.start),r.fullSize?b_(r,c.left,_,i.outerWidth-c.right-c.left,R):b_(r,t.left+E.placed,_,z,R),E.start=_,E.placed+=z,_=r.bottom}else{const z=t.h*C,R=E.size||r.width;hm(E.start)&&(d=E.start),r.fullSize?b_(r,d,c.top,R,i.outerHeight-c.bottom-c.top):b_(r,d,t.top+E.placed,R,z),E.start=d,E.placed+=z,d=r.right}}t.x=d,t.y=_}var xo={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(i){t.draw(i)}}]},n.boxes.push(t)},removeBox(n,t){const i=n.boxes?n.boxes.indexOf(t):-1;i!==-1&&n.boxes.splice(i,1)},configure(n,t,i){t.fullSize=i.fullSize,t.position=i.position,t.weight=i.weight},update(n,t,i,l){if(!n)return;const c=To(n.options.layout.padding),d=Math.max(t-c.width,0),_=Math.max(i-c.height,0),v=SB(n.boxes),r=v.vertical,E=v.horizontal;jn(n.boxes,W=>{typeof W.beforeLayout=="function"&&W.beforeLayout()});const C=r.reduce((W,Q)=>Q.box.options&&Q.box.options.display===!1?W:W+1,0)||1,z=Object.freeze({outerWidth:t,outerHeight:i,padding:c,availableWidth:d,availableHeight:_,vBoxMaxWidth:d/2/C,hBoxMaxHeight:_/2}),R=Object.assign({},c);bC(R,To(l));const j=Object.assign({maxPadding:R,w:d,h:_,x:c.left,y:c.top},c),G=EB(r.concat(E),z);Lp(v.fullSize,j,z,G),Lp(r,j,z,G),Lp(E,j,z,G)&&Lp(r,j,z,G),CB(j),NT(v.leftAndTop,j,z,G),j.x+=j.w,j.y+=j.h,NT(v.rightAndBottom,j,z,G),n.chartArea={left:j.left,top:j.top,right:j.left+j.w,bottom:j.top+j.h,height:j.h,width:j.w},jn(v.chartArea,W=>{const Q=W.box;Object.assign(Q,n.chartArea),Q.update(j.w,j.h,{left:0,top:0,right:0,bottom:0})})}};class wC{acquireContext(t,i){}releaseContext(t){return!1}addEventListener(t,i,l){}removeEventListener(t,i,l){}getDevicePixelRatio(){return 1}getMaximumSize(t,i,l,c){return i=Math.max(0,i||t.width),l=l||t.height,{width:i,height:Math.max(0,c?Math.floor(i/c):l)}}isAttached(t){return!0}updateConfig(t){}}class PB extends wC{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const V_="$chartjs",kB={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},jT=n=>n===null||n==="";function IB(n,t){const i=n.style,l=n.getAttribute("height"),c=n.getAttribute("width");if(n[V_]={initial:{height:l,width:c,style:{display:i.display,height:i.height,width:i.width}}},i.display=i.display||"block",i.boxSizing=i.boxSizing||"border-box",jT(c)){const d=TT(n,"width");d!==void 0&&(n.width=d)}if(jT(l))if(n.style.height==="")n.height=n.width/(t||2);else{const d=TT(n,"height");d!==void 0&&(n.height=d)}return n}const TC=MR?{passive:!0}:!1;function LB(n,t,i){n&&n.addEventListener(t,i,TC)}function DB(n,t,i){n&&n.canvas&&n.canvas.removeEventListener(t,i,TC)}function zB(n,t){const i=kB[n.type]||n.type,{x:l,y:c}=cd(n,t);return{type:i,chart:t,native:n,x:l!==void 0?l:null,y:c!==void 0?c:null}}function mg(n,t){for(const i of n)if(i===t||i.contains(t))return!0}function OB(n,t,i){const l=n.canvas,c=new MutationObserver(d=>{let _=!1;for(const v of d)_=_||mg(v.addedNodes,l),_=_&&!mg(v.removedNodes,l);_&&i()});return c.observe(document,{childList:!0,subtree:!0}),c}function RB(n,t,i){const l=n.canvas,c=new MutationObserver(d=>{let _=!1;for(const v of d)_=_||mg(v.removedNodes,l),_=_&&!mg(v.addedNodes,l);_&&i()});return c.observe(document,{childList:!0,subtree:!0}),c}const pm=new Map;let VT=0;function EC(){const n=window.devicePixelRatio;n!==VT&&(VT=n,pm.forEach((t,i)=>{i.currentDevicePixelRatio!==n&&t()}))}function BB(n,t){pm.size||window.addEventListener("resize",EC),pm.set(n,t)}function FB(n){pm.delete(n),pm.size||window.removeEventListener("resize",EC)}function NB(n,t,i){const l=n.canvas,c=l&&m0(l);if(!c)return;const d=JM((v,r)=>{const E=c.clientWidth;i(v,r),E<c.clientWidth&&i()},window),_=new ResizeObserver(v=>{const r=v[0],E=r.contentRect.width,C=r.contentRect.height;E===0&&C===0||d(E,C)});return _.observe(c),BB(n,d),_}function kv(n,t,i){i&&i.disconnect(),t==="resize"&&FB(n)}function jB(n,t,i){const l=n.canvas,c=JM(d=>{n.ctx!==null&&i(zB(d,n))},n);return LB(l,t,c),c}class VB extends wC{acquireContext(t,i){const l=t&&t.getContext&&t.getContext("2d");return l&&l.canvas===t?(IB(t,i),l):null}releaseContext(t){const i=t.canvas;if(!i[V_])return!1;const l=i[V_].initial;["height","width"].forEach(d=>{const _=l[d];rn(_)?i.removeAttribute(d):i.setAttribute(d,_)});const c=l.style||{};return Object.keys(c).forEach(d=>{i.style[d]=c[d]}),i.width=i.width,delete i[V_],!0}addEventListener(t,i,l){this.removeEventListener(t,i);const c=t.$proxies||(t.$proxies={}),_={attach:OB,detach:RB,resize:NB}[i]||jB;c[i]=_(t,i,l)}removeEventListener(t,i){const l=t.$proxies||(t.$proxies={}),c=l[i];if(!c)return;({attach:kv,detach:kv,resize:kv}[i]||DB)(t,i,c),l[i]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,i,l,c){return SR(t,i,l,c)}isAttached(t){const i=t&&m0(t);return!!(i&&i.isConnected)}}function UB(n){return!p0()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?PB:VB}let Fu=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:i,y:l}=this.getProps(["x","y"],t);return{x:i,y:l}}hasValue(){return Pf(this.x)&&Pf(this.y)}getProps(t,i){const l=this.$animations;if(!i||!l)return this;const c={};return t.forEach(d=>{c[d]=l[d]&&l[d].active()?l[d]._to:this[d]}),c}};function $B(n,t){const i=n.options.ticks,l=WB(n),c=Math.min(i.maxTicksLimit||l,l),d=i.major.enabled?GB(t):[],_=d.length,v=d[0],r=d[_-1],E=[];if(_>c)return HB(t,E,d,_/c),E;const C=ZB(d,t,c);if(_>0){let z,R;const j=_>1?Math.round((r-v)/(_-1)):null;for(w_(t,E,C,rn(j)?0:v-j,v),z=0,R=_-1;z<R;z++)w_(t,E,C,d[z],d[z+1]);return w_(t,E,C,r,rn(j)?t.length:r+j),E}return w_(t,E,C),E}function WB(n){const t=n.options.offset,i=n._tickSize(),l=n._length/i+(t?0:1),c=n._maxLength/i;return Math.floor(Math.min(l,c))}function ZB(n,t,i){const l=qB(n),c=t.length/i;if(!l)return Math.max(c,1);const d=A3(l);for(let _=0,v=d.length-1;_<v;_++){const r=d[_];if(r>c)return r}return Math.max(c,1)}function GB(n){const t=[];let i,l;for(i=0,l=n.length;i<l;i++)n[i].major&&t.push(i);return t}function HB(n,t,i,l){let c=0,d=i[0],_;for(l=Math.ceil(l),_=0;_<n.length;_++)_===d&&(t.push(n[_]),c++,d=i[c*l])}function w_(n,t,i,l,c){const d=Gi(l,0),_=Math.min(Gi(c,n.length),n.length);let v=0,r,E,C;for(i=Math.ceil(i),c&&(r=c-l,i=r/Math.floor(r/i)),C=d;C<0;)v++,C=Math.round(d+v*i);for(E=Math.max(d,0);E<_;E++)E===C&&(t.push(n[E]),v++,C=Math.round(d+v*i))}function qB(n){const t=n.length;let i,l;if(t<2)return!1;for(l=n[0],i=1;i<t;++i)if(n[i]-n[i-1]!==l)return!1;return l}const XB=n=>n==="left"?"right":n==="right"?"left":n,UT=(n,t,i)=>t==="top"||t==="left"?n[t]+i:n[t]-i,$T=(n,t)=>Math.min(t||n,n);function WT(n,t){const i=[],l=n.length/t,c=n.length;let d=0;for(;d<c;d+=l)i.push(n[Math.floor(d)]);return i}function KB(n,t,i){const l=n.ticks.length,c=Math.min(t,l-1),d=n._startPixel,_=n._endPixel,v=1e-6;let r=n.getPixelForTick(c),E;if(!(i&&(l===1?E=Math.max(r-d,_-r):t===0?E=(n.getPixelForTick(1)-r)/2:E=(r-n.getPixelForTick(c-1))/2,r+=c<t?E:-E,r<d-v||r>_+v)))return r}function YB(n,t){jn(n,i=>{const l=i.gc,c=l.length/2;let d;if(c>t){for(d=0;d<c;++d)delete i.data[l[d]];l.splice(0,c)}})}function Tp(n){return n.drawTicks?n.tickLength:0}function ZT(n,t){if(!n.display)return 0;const i=Sr(n.font,t),l=To(n.padding);return(ys(n.text)?n.text.length:1)*i.lineHeight+l.height}function JB(n,t){return Sh(n,{scale:t,type:"scale"})}function QB(n,t,i){return Sh(n,{tick:i,index:t,type:"tick"})}function tF(n,t,i){let l=l0(n);return(i&&t!=="right"||!i&&t==="right")&&(l=XB(l)),l}function eF(n,t,i,l){const{top:c,left:d,bottom:_,right:v,chart:r}=n,{chartArea:E,scales:C}=r;let z=0,R,j,G;const W=_-c,Q=v-d;if(n.isHorizontal()){if(j=po(l,d,v),ln(i)){const rt=Object.keys(i)[0],ft=i[rt];G=C[rt].getPixelForValue(ft)+W-t}else i==="center"?G=(E.bottom+E.top)/2+W-t:G=UT(n,i,t);R=v-d}else{if(ln(i)){const rt=Object.keys(i)[0],ft=i[rt];j=C[rt].getPixelForValue(ft)-Q+t}else i==="center"?j=(E.left+E.right)/2-Q+t:j=UT(n,i,t);G=po(l,_,c),z=i==="left"?-Ks:Ks}return{titleX:j,titleY:G,maxWidth:R,rotation:z}}class Pd extends Fu{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,i){return t}getUserBounds(){let{_userMin:t,_userMax:i,_suggestedMin:l,_suggestedMax:c}=this;return t=Ia(t,Number.POSITIVE_INFINITY),i=Ia(i,Number.NEGATIVE_INFINITY),l=Ia(l,Number.POSITIVE_INFINITY),c=Ia(c,Number.NEGATIVE_INFINITY),{min:Ia(t,l),max:Ia(i,c),minDefined:js(t),maxDefined:js(i)}}getMinMax(t){let{min:i,max:l,minDefined:c,maxDefined:d}=this.getUserBounds(),_;if(c&&d)return{min:i,max:l};const v=this.getMatchingVisibleMetas();for(let r=0,E=v.length;r<E;++r)_=v[r].controller.getMinMax(this,t),c||(i=Math.min(i,_.min)),d||(l=Math.max(l,_.max));return i=d&&i>l?l:i,l=c&&i>l?i:l,{min:Ia(i,Ia(l,i)),max:Ia(l,Ia(i,l))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){as(this.options.beforeUpdate,[this])}update(t,i,l){const{beginAtZero:c,grace:d,ticks:_}=this.options,v=_.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=i,this._margins=l=Object.assign({left:0,right:0,top:0,bottom:0},l),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+l.left+l.right:this.height+l.top+l.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=nR(this,d,c),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const r=v<this.ticks.length;this._convertTicksToLabels(r?WT(this.ticks,v):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),_.display&&(_.autoSkip||_.source==="auto")&&(this.ticks=$B(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),r&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,i,l;this.isHorizontal()?(i=this.left,l=this.right):(i=this.top,l=this.bottom,t=!t),this._startPixel=i,this._endPixel=l,this._reversePixels=t,this._length=l-i,this._alignToPixels=this.options.alignToPixels}afterUpdate(){as(this.options.afterUpdate,[this])}beforeSetDimensions(){as(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){as(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),as(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){as(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const i=this.options.ticks;let l,c,d;for(l=0,c=t.length;l<c;l++)d=t[l],d.label=as(i.callback,[d.value,l,t],this)}afterTickToLabelConversion(){as(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){as(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,i=t.ticks,l=$T(this.ticks.length,t.ticks.maxTicksLimit),c=i.minRotation||0,d=i.maxRotation;let _=c,v,r,E;if(!this._isVisible()||!i.display||c>=d||l<=1||!this.isHorizontal()){this.labelRotation=c;return}const C=this._getLabelSizes(),z=C.widest.width,R=C.highest.height,j=Fr(this.chart.width-z,0,this.maxWidth);v=t.offset?this.maxWidth/l:j/(l-1),z+6>v&&(v=j/(l-(t.offset?.5:1)),r=this.maxHeight-Tp(t.grid)-i.padding-ZT(t.title,this.chart.options.font),E=Math.sqrt(z*z+R*R),_=o0(Math.min(Math.asin(Fr((C.highest.height+6)/v,-1,1)),Math.asin(Fr(r/E,-1,1))-Math.asin(Fr(R/E,-1,1)))),_=Math.max(c,Math.min(d,_))),this.labelRotation=_}afterCalculateLabelRotation(){as(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){as(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:i,options:{ticks:l,title:c,grid:d}}=this,_=this._isVisible(),v=this.isHorizontal();if(_){const r=ZT(c,i.options.font);if(v?(t.width=this.maxWidth,t.height=Tp(d)+r):(t.height=this.maxHeight,t.width=Tp(d)+r),l.display&&this.ticks.length){const{first:E,last:C,widest:z,highest:R}=this._getLabelSizes(),j=l.padding*2,G=Jl(this.labelRotation),W=Math.cos(G),Q=Math.sin(G);if(v){const rt=l.mirror?0:Q*z.width+W*R.height;t.height=Math.min(this.maxHeight,t.height+rt+j)}else{const rt=l.mirror?0:W*z.width+Q*R.height;t.width=Math.min(this.maxWidth,t.width+rt+j)}this._calculatePadding(E,C,Q,W)}}this._handleMargins(),v?(this.width=this._length=i.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=i.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,i,l,c){const{ticks:{align:d,padding:_},position:v}=this.options,r=this.labelRotation!==0,E=v!=="top"&&this.axis==="x";if(this.isHorizontal()){const C=this.getPixelForTick(0)-this.left,z=this.right-this.getPixelForTick(this.ticks.length-1);let R=0,j=0;r?E?(R=c*t.width,j=l*i.height):(R=l*t.height,j=c*i.width):d==="start"?j=i.width:d==="end"?R=t.width:d!=="inner"&&(R=t.width/2,j=i.width/2),this.paddingLeft=Math.max((R-C+_)*this.width/(this.width-C),0),this.paddingRight=Math.max((j-z+_)*this.width/(this.width-z),0)}else{let C=i.height/2,z=t.height/2;d==="start"?(C=0,z=t.height):d==="end"&&(C=i.height,z=0),this.paddingTop=C+_,this.paddingBottom=z+_}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){as(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:i}=this.options;return i==="top"||i==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let i,l;for(i=0,l=t.length;i<l;i++)rn(t[i].label)&&(t.splice(i,1),l--,i--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const i=this.options.ticks.sampleSize;let l=this.ticks;i<l.length&&(l=WT(l,i)),this._labelSizes=t=this._computeLabelSizes(l,l.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,i,l){const{ctx:c,_longestTextCache:d}=this,_=[],v=[],r=Math.floor(i/$T(i,l));let E=0,C=0,z,R,j,G,W,Q,rt,ft,xt,mt,bt;for(z=0;z<i;z+=r){if(G=t[z].label,W=this._resolveTickFontOptions(z),c.font=Q=W.string,rt=d[Q]=d[Q]||{data:{},gc:[]},ft=W.lineHeight,xt=mt=0,!rn(G)&&!ys(G))xt=fg(c,rt.data,rt.gc,xt,G),mt=ft;else if(ys(G))for(R=0,j=G.length;R<j;++R)bt=G[R],!rn(bt)&&!ys(bt)&&(xt=fg(c,rt.data,rt.gc,xt,bt),mt+=ft);_.push(xt),v.push(mt),E=Math.max(xt,E),C=Math.max(mt,C)}YB(d,i);const Ot=_.indexOf(E),zt=v.indexOf(C),Rt=Bt=>({width:_[Bt]||0,height:v[Bt]||0});return{first:Rt(0),last:Rt(i-1),widest:Rt(Ot),highest:Rt(zt),widths:_,heights:v}}getLabelForValue(t){return t}getPixelForValue(t,i){return NaN}getValueForPixel(t){}getPixelForTick(t){const i=this.ticks;return t<0||t>i.length-1?null:this.getPixelForValue(i[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const i=this._startPixel+t*this._length;return L3(this._alignToPixels?sd(this.chart,i,0):i)}getDecimalForPixel(t){const i=(t-this._startPixel)/this._length;return this._reversePixels?1-i:i}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:i}=this;return t<0&&i<0?i:t>0&&i>0?t:0}getContext(t){const i=this.ticks||[];if(t>=0&&t<i.length){const l=i[t];return l.$context||(l.$context=QB(this.getContext(),t,l))}return this.$context||(this.$context=JB(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,i=Jl(this.labelRotation),l=Math.abs(Math.cos(i)),c=Math.abs(Math.sin(i)),d=this._getLabelSizes(),_=t.autoSkipPadding||0,v=d?d.widest.width+_:0,r=d?d.highest.height+_:0;return this.isHorizontal()?r*l>v*c?v/l:r/c:r*c<v*l?r/l:v/c}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const i=this.axis,l=this.chart,c=this.options,{grid:d,position:_,border:v}=c,r=d.offset,E=this.isHorizontal(),z=this.ticks.length+(r?1:0),R=Tp(d),j=[],G=v.setContext(this.getContext()),W=G.display?G.width:0,Q=W/2,rt=function(de){return sd(l,de,W)};let ft,xt,mt,bt,Ot,zt,Rt,Bt,Nt,ee,Wt,ae;if(_==="top")ft=rt(this.bottom),zt=this.bottom-R,Bt=ft-Q,ee=rt(t.top)+Q,ae=t.bottom;else if(_==="bottom")ft=rt(this.top),ee=t.top,ae=rt(t.bottom)-Q,zt=ft+Q,Bt=this.top+R;else if(_==="left")ft=rt(this.right),Ot=this.right-R,Rt=ft-Q,Nt=rt(t.left)+Q,Wt=t.right;else if(_==="right")ft=rt(this.left),Nt=t.left,Wt=rt(t.right)-Q,Ot=ft+Q,Rt=this.left+R;else if(i==="x"){if(_==="center")ft=rt((t.top+t.bottom)/2+.5);else if(ln(_)){const de=Object.keys(_)[0],he=_[de];ft=rt(this.chart.scales[de].getPixelForValue(he))}ee=t.top,ae=t.bottom,zt=ft+Q,Bt=zt+R}else if(i==="y"){if(_==="center")ft=rt((t.left+t.right)/2);else if(ln(_)){const de=Object.keys(_)[0],he=_[de];ft=rt(this.chart.scales[de].getPixelForValue(he))}Ot=ft-Q,Rt=Ot-R,Nt=t.left,Wt=t.right}const ye=Gi(c.ticks.maxTicksLimit,z),He=Math.max(1,Math.ceil(z/ye));for(xt=0;xt<z;xt+=He){const de=this.getContext(xt),he=d.setContext(de),oe=v.setContext(de),Oe=he.lineWidth,Ue=he.color,$t=oe.dash||[],ce=oe.dashOffset,Ve=he.tickWidth,je=he.tickColor,Xe=he.tickBorderDash||[],ri=he.tickBorderDashOffset;mt=KB(this,xt,r),mt!==void 0&&(bt=sd(l,mt,Oe),E?Ot=Rt=Nt=Wt=bt:zt=Bt=ee=ae=bt,j.push({tx1:Ot,ty1:zt,tx2:Rt,ty2:Bt,x1:Nt,y1:ee,x2:Wt,y2:ae,width:Oe,color:Ue,borderDash:$t,borderDashOffset:ce,tickWidth:Ve,tickColor:je,tickBorderDash:Xe,tickBorderDashOffset:ri}))}return this._ticksLength=z,this._borderValue=ft,j}_computeLabelItems(t){const i=this.axis,l=this.options,{position:c,ticks:d}=l,_=this.isHorizontal(),v=this.ticks,{align:r,crossAlign:E,padding:C,mirror:z}=d,R=Tp(l.grid),j=R+C,G=z?-C:j,W=-Jl(this.labelRotation),Q=[];let rt,ft,xt,mt,bt,Ot,zt,Rt,Bt,Nt,ee,Wt,ae="middle";if(c==="top")Ot=this.bottom-G,zt=this._getXAxisLabelAlignment();else if(c==="bottom")Ot=this.top+G,zt=this._getXAxisLabelAlignment();else if(c==="left"){const He=this._getYAxisLabelAlignment(R);zt=He.textAlign,bt=He.x}else if(c==="right"){const He=this._getYAxisLabelAlignment(R);zt=He.textAlign,bt=He.x}else if(i==="x"){if(c==="center")Ot=(t.top+t.bottom)/2+j;else if(ln(c)){const He=Object.keys(c)[0],de=c[He];Ot=this.chart.scales[He].getPixelForValue(de)+j}zt=this._getXAxisLabelAlignment()}else if(i==="y"){if(c==="center")bt=(t.left+t.right)/2-j;else if(ln(c)){const He=Object.keys(c)[0],de=c[He];bt=this.chart.scales[He].getPixelForValue(de)}zt=this._getYAxisLabelAlignment(R).textAlign}i==="y"&&(r==="start"?ae="top":r==="end"&&(ae="bottom"));const ye=this._getLabelSizes();for(rt=0,ft=v.length;rt<ft;++rt){xt=v[rt],mt=xt.label;const He=d.setContext(this.getContext(rt));Rt=this.getPixelForTick(rt)+d.labelOffset,Bt=this._resolveTickFontOptions(rt),Nt=Bt.lineHeight,ee=ys(mt)?mt.length:1;const de=ee/2,he=He.color,oe=He.textStrokeColor,Oe=He.textStrokeWidth;let Ue=zt;_?(bt=Rt,zt==="inner"&&(rt===ft-1?Ue=this.options.reverse?"left":"right":rt===0?Ue=this.options.reverse?"right":"left":Ue="center"),c==="top"?E==="near"||W!==0?Wt=-ee*Nt+Nt/2:E==="center"?Wt=-ye.highest.height/2-de*Nt+Nt:Wt=-ye.highest.height+Nt/2:E==="near"||W!==0?Wt=Nt/2:E==="center"?Wt=ye.highest.height/2-de*Nt:Wt=ye.highest.height-ee*Nt,z&&(Wt*=-1),W!==0&&!He.showLabelBackdrop&&(bt+=Nt/2*Math.sin(W))):(Ot=Rt,Wt=(1-ee)*Nt/2);let $t;if(He.showLabelBackdrop){const ce=To(He.backdropPadding),Ve=ye.heights[rt],je=ye.widths[rt];let Xe=Wt-ce.top,ri=0-ce.left;switch(ae){case"middle":Xe-=Ve/2;break;case"bottom":Xe-=Ve;break}switch(zt){case"center":ri-=je/2;break;case"right":ri-=je;break;case"inner":rt===ft-1?ri-=je:rt>0&&(ri-=je/2);break}$t={left:ri,top:Xe,width:je+ce.width,height:Ve+ce.height,color:He.backdropColor}}Q.push({label:mt,font:Bt,textOffset:Wt,options:{rotation:W,color:he,strokeColor:oe,strokeWidth:Oe,textAlign:Ue,textBaseline:ae,translation:[bt,Ot],backdrop:$t}})}return Q}_getXAxisLabelAlignment(){const{position:t,ticks:i}=this.options;if(-Jl(this.labelRotation))return t==="top"?"left":"right";let c="center";return i.align==="start"?c="left":i.align==="end"?c="right":i.align==="inner"&&(c="inner"),c}_getYAxisLabelAlignment(t){const{position:i,ticks:{crossAlign:l,mirror:c,padding:d}}=this.options,_=this._getLabelSizes(),v=t+d,r=_.widest.width;let E,C;return i==="left"?c?(C=this.right+d,l==="near"?E="left":l==="center"?(E="center",C+=r/2):(E="right",C+=r)):(C=this.right-v,l==="near"?E="right":l==="center"?(E="center",C-=r/2):(E="left",C=this.left)):i==="right"?c?(C=this.left+d,l==="near"?E="right":l==="center"?(E="center",C-=r/2):(E="left",C-=r)):(C=this.left+v,l==="near"?E="left":l==="center"?(E="center",C+=r/2):(E="right",C=this.right)):E="right",{textAlign:E,x:C}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,i=this.options.position;if(i==="left"||i==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(i==="top"||i==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:i},left:l,top:c,width:d,height:_}=this;i&&(t.save(),t.fillStyle=i,t.fillRect(l,c,d,_),t.restore())}getLineWidthForValue(t){const i=this.options.grid;if(!this._isVisible()||!i.display)return 0;const c=this.ticks.findIndex(d=>d.value===t);return c>=0?i.setContext(this.getContext(c)).lineWidth:0}drawGrid(t){const i=this.options.grid,l=this.ctx,c=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let d,_;const v=(r,E,C)=>{!C.width||!C.color||(l.save(),l.lineWidth=C.width,l.strokeStyle=C.color,l.setLineDash(C.borderDash||[]),l.lineDashOffset=C.borderDashOffset,l.beginPath(),l.moveTo(r.x,r.y),l.lineTo(E.x,E.y),l.stroke(),l.restore())};if(i.display)for(d=0,_=c.length;d<_;++d){const r=c[d];i.drawOnChartArea&&v({x:r.x1,y:r.y1},{x:r.x2,y:r.y2},r),i.drawTicks&&v({x:r.tx1,y:r.ty1},{x:r.tx2,y:r.ty2},{color:r.tickColor,width:r.tickWidth,borderDash:r.tickBorderDash,borderDashOffset:r.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:i,options:{border:l,grid:c}}=this,d=l.setContext(this.getContext()),_=l.display?d.width:0;if(!_)return;const v=c.setContext(this.getContext(0)).lineWidth,r=this._borderValue;let E,C,z,R;this.isHorizontal()?(E=sd(t,this.left,_)-_/2,C=sd(t,this.right,v)+v/2,z=R=r):(z=sd(t,this.top,_)-_/2,R=sd(t,this.bottom,v)+v/2,E=C=r),i.save(),i.lineWidth=d.width,i.strokeStyle=d.color,i.beginPath(),i.moveTo(E,z),i.lineTo(C,R),i.stroke(),i.restore()}drawLabels(t){if(!this.options.ticks.display)return;const l=this.ctx,c=this._computeLabelArea();c&&Og(l,c);const d=this.getLabelItems(t);for(const _ of d){const v=_.options,r=_.font,E=_.label,C=_.textOffset;Ed(l,E,0,C,r,v)}c&&Rg(l)}drawTitle(){const{ctx:t,options:{position:i,title:l,reverse:c}}=this;if(!l.display)return;const d=Sr(l.font),_=To(l.padding),v=l.align;let r=d.lineHeight/2;i==="bottom"||i==="center"||ln(i)?(r+=_.bottom,ys(l.text)&&(r+=d.lineHeight*(l.text.length-1))):r+=_.top;const{titleX:E,titleY:C,maxWidth:z,rotation:R}=eF(this,r,i,v);Ed(t,l.text,0,0,d,{color:l.color,maxWidth:z,rotation:R,textAlign:tF(v,i,c),textBaseline:"middle",translation:[E,C]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,i=t.ticks&&t.ticks.z||0,l=Gi(t.grid&&t.grid.z,-1),c=Gi(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Pd.prototype.draw?[{z:i,draw:d=>{this.draw(d)}}]:[{z:l,draw:d=>{this.drawBackground(),this.drawGrid(d),this.drawTitle()}},{z:c,draw:()=>{this.drawBorder()}},{z:i,draw:d=>{this.drawLabels(d)}}]}getMatchingVisibleMetas(t){const i=this.chart.getSortedVisibleDatasetMetas(),l=this.axis+"AxisID",c=[];let d,_;for(d=0,_=i.length;d<_;++d){const v=i[d];v[l]===this.id&&(!t||v.type===t)&&c.push(v)}return c}_resolveTickFontOptions(t){const i=this.options.ticks.setContext(this.getContext(t));return Sr(i.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class T_{constructor(t,i,l){this.type=t,this.scope=i,this.override=l,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const i=Object.getPrototypeOf(t);let l;sF(i)&&(l=this.register(i));const c=this.items,d=t.id,_=this.scope+"."+d;if(!d)throw new Error("class does not have id: "+t);return d in c||(c[d]=t,iF(t,_,l),this.override&&vs.override(t.id,t.overrides)),_}get(t){return this.items[t]}unregister(t){const i=this.items,l=t.id,c=this.scope;l in i&&delete i[l],c&&l in vs[c]&&(delete vs[c][l],this.override&&delete Td[l])}}function iF(n,t,i){const l=um(Object.create(null),[i?vs.get(i):{},vs.get(t),n.defaults]);vs.set(t,l),n.defaultRoutes&&nF(t,n.defaultRoutes),n.descriptors&&vs.describe(t,n.descriptors)}function nF(n,t){Object.keys(t).forEach(i=>{const l=i.split("."),c=l.pop(),d=[n].concat(l).join("."),_=t[i].split("."),v=_.pop(),r=_.join(".");vs.route(d,c,r,v)})}function sF(n){return"id"in n&&"defaults"in n}class rF{constructor(){this.controllers=new T_(Mh,"datasets",!0),this.elements=new T_(Fu,"elements"),this.plugins=new T_(Object,"plugins"),this.scales=new T_(Pd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,i,l){[...i].forEach(c=>{const d=l||this._getRegistryForType(c);l||d.isForType(c)||d===this.plugins&&c.id?this._exec(t,d,c):jn(c,_=>{const v=l||this._getRegistryForType(_);this._exec(t,v,_)})})}_exec(t,i,l){const c=r0(t);as(l["before"+c],[],l),i[t](l),as(l["after"+c],[],l)}_getRegistryForType(t){for(let i=0;i<this._typedRegistries.length;i++){const l=this._typedRegistries[i];if(l.isForType(t))return l}return this.plugins}_get(t,i,l){const c=i.get(t);if(c===void 0)throw new Error('"'+t+'" is not a registered '+l+".");return c}}var Dc=new rF;class oF{constructor(){this._init=void 0}notify(t,i,l,c){if(i==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const d=c?this._descriptors(t).filter(c):this._descriptors(t),_=this._notify(d,t,i,l);return i==="afterDestroy"&&(this._notify(d,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),_}_notify(t,i,l,c){c=c||{};for(const d of t){const _=d.plugin,v=_[l],r=[i,c,d.options];if(as(v,r,_)===!1&&c.cancelable)return!1}return!0}invalidate(){rn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const i=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),i}_createDescriptors(t,i){const l=t&&t.config,c=Gi(l.options&&l.options.plugins,{}),d=aF(l);return c===!1&&!i?[]:cF(t,d,c,i)}_notifyStateChanges(t){const i=this._oldCache||[],l=this._cache,c=(d,_)=>d.filter(v=>!_.some(r=>v.plugin.id===r.plugin.id));this._notify(c(i,l),t,"stop"),this._notify(c(l,i),t,"start")}}function aF(n){const t={},i=[],l=Object.keys(Dc.plugins.items);for(let d=0;d<l.length;d++)i.push(Dc.getPlugin(l[d]));const c=n.plugins||[];for(let d=0;d<c.length;d++){const _=c[d];i.indexOf(_)===-1&&(i.push(_),t[_.id]=!0)}return{plugins:i,localIds:t}}function lF(n,t){return!t&&n===!1?null:n===!0?{}:n}function cF(n,{plugins:t,localIds:i},l,c){const d=[],_=n.getContext();for(const v of t){const r=v.id,E=lF(l[r],c);E!==null&&d.push({plugin:v,options:uF(n.config,{plugin:v,local:i[r]},E,_)})}return d}function uF(n,{plugin:t,local:i},l,c){const d=n.pluginScopeKeys(t),_=n.getOptionScopes(l,d);return i&&t.defaults&&_.push(t.defaults),n.createResolver(_,c,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function px(n,t){const i=vs.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||i.indexAxis||"x"}function hF(n,t){let i=n;return n==="_index_"?i=t:n==="_value_"&&(i=t==="x"?"y":"x"),i}function dF(n,t){return n===t?"_index_":"_value_"}function GT(n){if(n==="x"||n==="y"||n==="r")return n}function fF(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function mx(n,...t){if(GT(n))return n;for(const i of t){const l=i.axis||fF(i.position)||n.length>1&&GT(n[0].toLowerCase());if(l)return l}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function HT(n,t,i){if(i[t+"AxisID"]===n)return{axis:t}}function pF(n,t){if(t.data&&t.data.datasets){const i=t.data.datasets.filter(l=>l.xAxisID===n||l.yAxisID===n);if(i.length)return HT(n,"x",i[0])||HT(n,"y",i[0])}return{}}function mF(n,t){const i=Td[n.type]||{scales:{}},l=t.scales||{},c=px(n.type,t),d=Object.create(null);return Object.keys(l).forEach(_=>{const v=l[_];if(!ln(v))return console.error(`Invalid scale configuration for scale: ${_}`);if(v._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${_}`);const r=mx(_,v,pF(_,n),vs.scales[v.type]),E=dF(r,c),C=i.scales||{};d[_]=Wp(Object.create(null),[{axis:r},v,C[r],C[E]])}),n.data.datasets.forEach(_=>{const v=_.type||n.type,r=_.indexAxis||px(v,t),C=(Td[v]||{}).scales||{};Object.keys(C).forEach(z=>{const R=hF(z,r),j=_[R+"AxisID"]||R;d[j]=d[j]||Object.create(null),Wp(d[j],[{axis:R},l[j],C[z]])})}),Object.keys(d).forEach(_=>{const v=d[_];Wp(v,[vs.scales[v.type],vs.scale])}),d}function SC(n){const t=n.options||(n.options={});t.plugins=Gi(t.plugins,{}),t.scales=mF(n,t)}function MC(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function _F(n){return n=n||{},n.data=MC(n.data),SC(n),n}const qT=new Map,CC=new Set;function E_(n,t){let i=qT.get(n);return i||(i=t(),qT.set(n,i),CC.add(i)),i}const Ep=(n,t,i)=>{const l=wh(t,i);l!==void 0&&n.add(l)};class gF{constructor(t){this._config=_F(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=MC(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),SC(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return E_(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,i){return E_(`${t}.transition.${i}`,()=>[[`datasets.${t}.transitions.${i}`,`transitions.${i}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,i){return E_(`${t}-${i}`,()=>[[`datasets.${t}.elements.${i}`,`datasets.${t}`,`elements.${i}`,""]])}pluginScopeKeys(t){const i=t.id,l=this.type;return E_(`${l}-plugin-${i}`,()=>[[`plugins.${i}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,i){const l=this._scopeCache;let c=l.get(t);return(!c||i)&&(c=new Map,l.set(t,c)),c}getOptionScopes(t,i,l){const{options:c,type:d}=this,_=this._cachedScopes(t,l),v=_.get(i);if(v)return v;const r=new Set;i.forEach(C=>{t&&(r.add(t),C.forEach(z=>Ep(r,t,z))),C.forEach(z=>Ep(r,c,z)),C.forEach(z=>Ep(r,Td[d]||{},z)),C.forEach(z=>Ep(r,vs,z)),C.forEach(z=>Ep(r,dx,z))});const E=Array.from(r);return E.length===0&&E.push(Object.create(null)),CC.has(i)&&_.set(i,E),E}chartOptionScopes(){const{options:t,type:i}=this;return[t,Td[i]||{},vs.datasets[i]||{},{type:i},vs,dx]}resolveNamedOptions(t,i,l,c=[""]){const d={$shared:!0},{resolver:_,subPrefixes:v}=XT(this._resolverCache,t,c);let r=_;if(vF(_,i)){d.$shared=!1,l=Th(l)?l():l;const E=this.createResolver(t,l,v);r=kf(_,l,E)}for(const E of i)d[E]=r[E];return d}createResolver(t,i,l=[""],c){const{resolver:d}=XT(this._resolverCache,t,l);return ln(i)?kf(d,i,void 0,c):d}}function XT(n,t,i){let l=n.get(t);l||(l=new Map,n.set(t,l));const c=i.join();let d=l.get(c);return d||(d={resolver:h0(t,i),subPrefixes:i.filter(v=>!v.toLowerCase().includes("hover"))},l.set(c,d)),d}const yF=n=>ln(n)&&Object.getOwnPropertyNames(n).some(t=>Th(n[t]));function vF(n,t){const{isScriptable:i,isIndexable:l}=sC(n);for(const c of t){const d=i(c),_=l(c),v=(_||d)&&n[c];if(d&&(Th(v)||yF(v))||_&&ys(v))return!0}return!1}var xF="4.5.1";const bF=["top","bottom","left","right","chartArea"];function KT(n,t){return n==="top"||n==="bottom"||bF.indexOf(n)===-1&&t==="x"}function YT(n,t){return function(i,l){return i[n]===l[n]?i[t]-l[t]:i[n]-l[n]}}function JT(n){const t=n.chart,i=t.options.animation;t.notifyPlugins("afterRender"),as(i&&i.onComplete,[n],t)}function wF(n){const t=n.chart,i=t.options.animation;as(i&&i.onProgress,[n],t)}function AC(n){return p0()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const U_={},QT=n=>{const t=AC(n);return Object.values(U_).filter(i=>i.canvas===t).pop()};function TF(n,t,i){const l=Object.keys(n);for(const c of l){const d=+c;if(d>=t){const _=n[c];delete n[c],(i>0||d>t)&&(n[d+i]=_)}}}function EF(n,t,i,l){return!i||n.type==="mouseout"?null:l?t:n}class y0{static defaults=vs;static instances=U_;static overrides=Td;static registry=Dc;static version=xF;static getChart=QT;static register(...t){Dc.add(...t),tE()}static unregister(...t){Dc.remove(...t),tE()}constructor(t,i){const l=this.config=new gF(i),c=AC(t),d=QT(c);if(d)throw new Error("Canvas is already in use. Chart with ID '"+d.id+"' must be destroyed before the canvas with ID '"+d.canvas.id+"' can be reused.");const _=l.createResolver(l.chartOptionScopes(),this.getContext());this.platform=new(l.platform||UB(c)),this.platform.updateConfig(l);const v=this.platform.acquireContext(c,_.aspectRatio),r=v&&v.canvas,E=r&&r.height,C=r&&r.width;if(this.id=v3(),this.ctx=v,this.canvas=r,this.width=C,this.height=E,this._options=_,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new oF,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=R3(z=>this.update(z),_.resizeDelay||0),this._dataChanges=[],U_[this.id]=this,!v||!r){console.error("Failed to create chart: can't acquire context from the given item");return}xu.listen(this,"complete",JT),xu.listen(this,"progress",wF),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:i},width:l,height:c,_aspectRatio:d}=this;return rn(t)?i&&d?d:c?l/c:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Dc}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():wT(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return vT(this.canvas,this.ctx),this}stop(){return xu.stop(this),this}resize(t,i){xu.running(this)?this._resizeBeforeDraw={width:t,height:i}:this._resize(t,i)}_resize(t,i){const l=this.options,c=this.canvas,d=l.maintainAspectRatio&&this.aspectRatio,_=this.platform.getMaximumSize(c,t,i,d),v=l.devicePixelRatio||this.platform.getDevicePixelRatio(),r=this.width?"resize":"attach";this.width=_.width,this.height=_.height,this._aspectRatio=this.aspectRatio,wT(this,v,!0)&&(this.notifyPlugins("resize",{size:_}),as(l.onResize,[this,_],this),this.attached&&this._doResize(r)&&this.render())}ensureScalesHaveIDs(){const i=this.options.scales||{};jn(i,(l,c)=>{l.id=c})}buildOrUpdateScales(){const t=this.options,i=t.scales,l=this.scales,c=Object.keys(l).reduce((_,v)=>(_[v]=!1,_),{});let d=[];i&&(d=d.concat(Object.keys(i).map(_=>{const v=i[_],r=mx(_,v),E=r==="r",C=r==="x";return{options:v,dposition:E?"chartArea":C?"bottom":"left",dtype:E?"radialLinear":C?"category":"linear"}}))),jn(d,_=>{const v=_.options,r=v.id,E=mx(r,v),C=Gi(v.type,_.dtype);(v.position===void 0||KT(v.position,E)!==KT(_.dposition))&&(v.position=_.dposition),c[r]=!0;let z=null;if(r in l&&l[r].type===C)z=l[r];else{const R=Dc.getScale(C);z=new R({id:r,type:C,ctx:this.ctx,chart:this}),l[z.id]=z}z.init(v,t)}),jn(c,(_,v)=>{_||delete l[v]}),jn(l,_=>{xo.configure(this,_,_.options),xo.addBox(this,_)})}_updateMetasets(){const t=this._metasets,i=this.data.datasets.length,l=t.length;if(t.sort((c,d)=>c.index-d.index),l>i){for(let c=i;c<l;++c)this._destroyDatasetMeta(c);t.splice(i,l-i)}this._sortedMetasets=t.slice(0).sort(YT("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:i}}=this;t.length>i.length&&delete this._stacks,t.forEach((l,c)=>{i.filter(d=>d===l._dataset).length===0&&this._destroyDatasetMeta(c)})}buildOrUpdateControllers(){const t=[],i=this.data.datasets;let l,c;for(this._removeUnreferencedMetasets(),l=0,c=i.length;l<c;l++){const d=i[l];let _=this.getDatasetMeta(l);const v=d.type||this.config.type;if(_.type&&_.type!==v&&(this._destroyDatasetMeta(l),_=this.getDatasetMeta(l)),_.type=v,_.indexAxis=d.indexAxis||px(v,this.options),_.order=d.order||0,_.index=l,_.label=""+d.label,_.visible=this.isDatasetVisible(l),_.controller)_.controller.updateIndex(l),_.controller.linkScales();else{const r=Dc.getController(v),{datasetElementType:E,dataElementType:C}=vs.datasets[v];Object.assign(r,{dataElementType:Dc.getElement(C),datasetElementType:E&&Dc.getElement(E)}),_.controller=new r(this,l),t.push(_.controller)}}return this._updateMetasets(),t}_resetElements(){jn(this.data.datasets,(t,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const i=this.config;i.update();const l=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),c=this._animationsDisabled=!l.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const d=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let _=0;for(let E=0,C=this.data.datasets.length;E<C;E++){const{controller:z}=this.getDatasetMeta(E),R=!c&&d.indexOf(z)===-1;z.buildOrUpdateElements(R),_=Math.max(+z.getMaxOverflow(),_)}_=this._minPadding=l.layout.autoPadding?_:0,this._updateLayout(_),c||jn(d,E=>{E.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(YT("z","_idx"));const{_active:v,_lastEvent:r}=this;r?this._eventHandler(r,!0):v.length&&this._updateHoverStyles(v,v,!0),this.render()}_updateScales(){jn(this.scales,t=>{xo.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,i=new Set(Object.keys(this._listeners)),l=new Set(t.events);(!uT(i,l)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,i=this._getUniformDataChanges()||[];for(const{method:l,start:c,count:d}of i){const _=l==="_removeElements"?-d:d;TF(t,c,_)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const i=this.data.datasets.length,l=d=>new Set(t.filter(_=>_[0]===d).map((_,v)=>v+","+_.splice(1).join(","))),c=l(0);for(let d=1;d<i;d++)if(!uT(c,l(d)))return;return Array.from(c).map(d=>d.split(",")).map(d=>({method:d[1],start:+d[2],count:+d[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;xo.update(this,this.width,this.height,t);const i=this.chartArea,l=i.width<=0||i.height<=0;this._layers=[],jn(this.boxes,c=>{l&&c.position==="chartArea"||(c.configure&&c.configure(),this._layers.push(...c._layers()))},this),this._layers.forEach((c,d)=>{c._idx=d}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let i=0,l=this.data.datasets.length;i<l;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,l=this.data.datasets.length;i<l;++i)this._updateDataset(i,Th(t)?t({datasetIndex:i}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,i){const l=this.getDatasetMeta(t),c={meta:l,index:t,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",c)!==!1&&(l.controller._update(i),c.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",c))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(xu.has(this)?this.attached&&!xu.running(this)&&xu.start(this):(this.draw(),JT({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:l,height:c}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(l,c)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const i=this._layers;for(t=0;t<i.length&&i[t].z<=0;++t)i[t].draw(this.chartArea);for(this._drawDatasets();t<i.length;++t)i[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const i=this._sortedMetasets,l=[];let c,d;for(c=0,d=i.length;c<d;++c){const _=i[c];(!t||_.visible)&&l.push(_)}return l}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let i=t.length-1;i>=0;--i)this._drawDataset(t[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const i=this.ctx,l={meta:t,index:t.index,cancelable:!0},c=mC(this,t);this.notifyPlugins("beforeDatasetDraw",l)!==!1&&(c&&Og(i,c),t.controller.draw(),c&&Rg(i),l.cancelable=!1,this.notifyPlugins("afterDatasetDraw",l))}isPointInArea(t){return Lu(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,i,l,c){const d=bB.modes[i];return typeof d=="function"?d(this,t,l,c):[]}getDatasetMeta(t){const i=this.data.datasets[t],l=this._metasets;let c=l.filter(d=>d&&d._dataset===i).pop();return c||(c={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:t,_dataset:i,_parsed:[],_sorted:!1},l.push(c)),c}getContext(){return this.$context||(this.$context=Sh(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const i=this.data.datasets[t];if(!i)return!1;const l=this.getDatasetMeta(t);return typeof l.hidden=="boolean"?!l.hidden:!i.hidden}setDatasetVisibility(t,i){const l=this.getDatasetMeta(t);l.hidden=!i}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,i,l){const c=l?"show":"hide",d=this.getDatasetMeta(t),_=d.controller._resolveAnimations(void 0,c);hm(i)?(d.data[i].hidden=!l,this.update()):(this.setDatasetVisibility(t,l),_.update(d,{visible:l}),this.update(v=>v.datasetIndex===t?c:void 0))}hide(t,i){this._updateVisibility(t,i,!1)}show(t,i){this._updateVisibility(t,i,!0)}_destroyDatasetMeta(t){const i=this._metasets[t];i&&i.controller&&i.controller._destroy(),delete this._metasets[t]}_stop(){let t,i;for(this.stop(),xu.remove(this),t=0,i=this.data.datasets.length;t<i;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:i}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),vT(t,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete U_[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,i=this.platform,l=(d,_)=>{i.addEventListener(this,d,_),t[d]=_},c=(d,_,v)=>{d.offsetX=_,d.offsetY=v,this._eventHandler(d)};jn(this.options.events,d=>l(d,c))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,i=this.platform,l=(r,E)=>{i.addEventListener(this,r,E),t[r]=E},c=(r,E)=>{t[r]&&(i.removeEventListener(this,r,E),delete t[r])},d=(r,E)=>{this.canvas&&this.resize(r,E)};let _;const v=()=>{c("attach",v),this.attached=!0,this.resize(),l("resize",d),l("detach",_)};_=()=>{this.attached=!1,c("resize",d),this._stop(),this._resize(0,0),l("attach",v)},i.isAttached(this.canvas)?v():_()}unbindEvents(){jn(this._listeners,(t,i)=>{this.platform.removeEventListener(this,i,t)}),this._listeners={},jn(this._responsiveListeners,(t,i)=>{this.platform.removeEventListener(this,i,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,i,l){const c=l?"set":"remove";let d,_,v,r;for(i==="dataset"&&(d=this.getDatasetMeta(t[0].datasetIndex),d.controller["_"+c+"DatasetHoverStyle"]()),v=0,r=t.length;v<r;++v){_=t[v];const E=_&&this.getDatasetMeta(_.datasetIndex).controller;E&&E[c+"HoverStyle"](_.element,_.datasetIndex,_.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const i=this._active||[],l=t.map(({datasetIndex:d,index:_})=>{const v=this.getDatasetMeta(d);if(!v)throw new Error("No dataset found at index "+d);return{datasetIndex:d,element:v.data[_],index:_}});!ug(l,i)&&(this._active=l,this._lastEvent=null,this._updateHoverStyles(l,i))}notifyPlugins(t,i,l){return this._plugins.notify(this,t,i,l)}isPluginEnabled(t){return this._plugins._cache.filter(i=>i.plugin.id===t).length===1}_updateHoverStyles(t,i,l){const c=this.options.hover,d=(r,E)=>r.filter(C=>!E.some(z=>C.datasetIndex===z.datasetIndex&&C.index===z.index)),_=d(i,t),v=l?t:d(t,i);_.length&&this.updateHoverStyle(_,c.mode,!1),v.length&&c.mode&&this.updateHoverStyle(v,c.mode,!0)}_eventHandler(t,i){const l={event:t,replay:i,cancelable:!0,inChartArea:this.isPointInArea(t)},c=_=>(_.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",l,c)===!1)return;const d=this._handleEvent(t,i,l.inChartArea);return l.cancelable=!1,this.notifyPlugins("afterEvent",l,c),(d||l.changed)&&this.render(),this}_handleEvent(t,i,l){const{_active:c=[],options:d}=this,_=i,v=this._getActiveElements(t,c,l,_),r=S3(t),E=EF(t,this._lastEvent,l,r);l&&(this._lastEvent=null,as(d.onHover,[t,v,this],this),r&&as(d.onClick,[t,v,this],this));const C=!ug(v,c);return(C||i)&&(this._active=v,this._updateHoverStyles(v,c,i)),this._lastEvent=E,C}_getActiveElements(t,i,l,c){if(t.type==="mouseout")return[];if(!l)return i;const d=this.options.hover;return this.getElementsAtEventForMode(t,d.mode,d,c)}}function tE(){return jn(y0.instances,n=>n._plugins.invalidate())}function SF(n,t,i){const{startAngle:l,x:c,y:d,outerRadius:_,innerRadius:v,options:r}=t,{borderWidth:E,borderJoinStyle:C}=r,z=Math.min(E/_,mo(l-i));if(n.beginPath(),n.arc(c,d,_-E/2,l+z/2,i-z/2),v>0){const R=Math.min(E/v,mo(l-i));n.arc(c,d,v+E/2,i-R/2,l+R/2,!0)}else{const R=Math.min(E/2,_*mo(l-i));if(C==="round")n.arc(c,d,R,i-Sn/2,l+Sn/2,!0);else if(C==="bevel"){const j=2*R*R,G=-j*Math.cos(i+Sn/2)+c,W=-j*Math.sin(i+Sn/2)+d,Q=j*Math.cos(l+Sn/2)+c,rt=j*Math.sin(l+Sn/2)+d;n.lineTo(G,W),n.lineTo(Q,rt)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function MF(n,t,i){const{startAngle:l,pixelMargin:c,x:d,y:_,outerRadius:v,innerRadius:r}=t;let E=c/v;n.beginPath(),n.arc(d,_,v,l-E,i+E),r>c?(E=c/r,n.arc(d,_,r,i+E,l-E,!0)):n.arc(d,_,c,i+Ks,l-Ks),n.closePath(),n.clip()}function CF(n){return u0(n,["outerStart","outerEnd","innerStart","innerEnd"])}function AF(n,t,i,l){const c=CF(n.options.borderRadius),d=(i-t)/2,_=Math.min(d,l*t/2),v=r=>{const E=(i-Math.min(d,r))*l/2;return Fr(r,0,Math.min(d,E))};return{outerStart:v(c.outerStart),outerEnd:v(c.outerEnd),innerStart:Fr(c.innerStart,0,_),innerEnd:Fr(c.innerEnd,0,_)}}function lf(n,t,i,l){return{x:i+n*Math.cos(t),y:l+n*Math.sin(t)}}function _g(n,t,i,l,c,d){const{x:_,y:v,startAngle:r,pixelMargin:E,innerRadius:C}=t,z=Math.max(t.outerRadius+l+i-E,0),R=C>0?C+l+i+E:0;let j=0;const G=c-r;if(l){const He=C>0?C-l:0,de=z>0?z-l:0,he=(He+de)/2,oe=he!==0?G*he/(he+l):G;j=(G-oe)/2}const W=Math.max(.001,G*z-i/Sn)/z,Q=(G-W)/2,rt=r+Q+j,ft=c-Q-j,{outerStart:xt,outerEnd:mt,innerStart:bt,innerEnd:Ot}=AF(t,R,z,ft-rt),zt=z-xt,Rt=z-mt,Bt=rt+xt/zt,Nt=ft-mt/Rt,ee=R+bt,Wt=R+Ot,ae=rt+bt/ee,ye=ft-Ot/Wt;if(n.beginPath(),d){const He=(Bt+Nt)/2;if(n.arc(_,v,z,Bt,He),n.arc(_,v,z,He,Nt),mt>0){const Oe=lf(Rt,Nt,_,v);n.arc(Oe.x,Oe.y,mt,Nt,ft+Ks)}const de=lf(Wt,ft,_,v);if(n.lineTo(de.x,de.y),Ot>0){const Oe=lf(Wt,ye,_,v);n.arc(Oe.x,Oe.y,Ot,ft+Ks,ye+Math.PI)}const he=(ft-Ot/R+(rt+bt/R))/2;if(n.arc(_,v,R,ft-Ot/R,he,!0),n.arc(_,v,R,he,rt+bt/R,!0),bt>0){const Oe=lf(ee,ae,_,v);n.arc(Oe.x,Oe.y,bt,ae+Math.PI,rt-Ks)}const oe=lf(zt,rt,_,v);if(n.lineTo(oe.x,oe.y),xt>0){const Oe=lf(zt,Bt,_,v);n.arc(Oe.x,Oe.y,xt,rt-Ks,Bt)}}else{n.moveTo(_,v);const He=Math.cos(Bt)*z+_,de=Math.sin(Bt)*z+v;n.lineTo(He,de);const he=Math.cos(Nt)*z+_,oe=Math.sin(Nt)*z+v;n.lineTo(he,oe)}n.closePath()}function PF(n,t,i,l,c){const{fullCircles:d,startAngle:_,circumference:v}=t;let r=t.endAngle;if(d){_g(n,t,i,l,r,c);for(let E=0;E<d;++E)n.fill();isNaN(v)||(r=_+(v%ds||ds))}return _g(n,t,i,l,r,c),n.fill(),r}function kF(n,t,i,l,c){const{fullCircles:d,startAngle:_,circumference:v,options:r}=t,{borderWidth:E,borderJoinStyle:C,borderDash:z,borderDashOffset:R,borderRadius:j}=r,G=r.borderAlign==="inner";if(!E)return;n.setLineDash(z||[]),n.lineDashOffset=R,G?(n.lineWidth=E*2,n.lineJoin=C||"round"):(n.lineWidth=E,n.lineJoin=C||"bevel");let W=t.endAngle;if(d){_g(n,t,i,l,W,c);for(let Q=0;Q<d;++Q)n.stroke();isNaN(v)||(W=_+(v%ds||ds))}G&&MF(n,t,W),r.selfJoin&&W-_>=Sn&&j===0&&C!=="miter"&&SF(n,t,W),d||(_g(n,t,i,l,W,c),n.stroke())}class IF extends Fu{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,i,l){const c=this.getProps(["x","y"],l),{angle:d,distance:_}=qM(c,{x:t,y:i}),{startAngle:v,endAngle:r,innerRadius:E,outerRadius:C,circumference:z}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],l),R=(this.options.spacing+this.options.borderWidth)/2,j=Gi(z,r-v),G=dm(d,v,r)&&v!==r,W=j>=ds||G,Q=ku(_,E+R,C+R);return W&&Q}getCenterPoint(t){const{x:i,y:l,startAngle:c,endAngle:d,innerRadius:_,outerRadius:v}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:r,spacing:E}=this.options,C=(c+d)/2,z=(_+v+E+r)/2;return{x:i+Math.cos(C)*z,y:l+Math.sin(C)*z}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:i,circumference:l}=this,c=(i.offset||0)/4,d=(i.spacing||0)/2,_=i.circular;if(this.pixelMargin=i.borderAlign==="inner"?.33:0,this.fullCircles=l>ds?Math.floor(l/ds):0,l===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const v=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(v)*c,Math.sin(v)*c);const r=1-Math.sin(Math.min(Sn,l||0)),E=c*r;t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,PF(t,this,E,d,_),kF(t,this,E,d,_),t.restore()}}function PC(n,t,i=t){n.lineCap=Gi(i.borderCapStyle,t.borderCapStyle),n.setLineDash(Gi(i.borderDash,t.borderDash)),n.lineDashOffset=Gi(i.borderDashOffset,t.borderDashOffset),n.lineJoin=Gi(i.borderJoinStyle,t.borderJoinStyle),n.lineWidth=Gi(i.borderWidth,t.borderWidth),n.strokeStyle=Gi(i.borderColor,t.borderColor)}function LF(n,t,i){n.lineTo(i.x,i.y)}function DF(n){return n.stepped?q3:n.tension||n.cubicInterpolationMode==="monotone"?X3:LF}function kC(n,t,i={}){const l=n.length,{start:c=0,end:d=l-1}=i,{start:_,end:v}=t,r=Math.max(c,_),E=Math.min(d,v),C=c<_&&d<_||c>v&&d>v;return{count:l,start:r,loop:t.loop,ilen:E<r&&!C?l+E-r:E-r}}function zF(n,t,i,l){const{points:c,options:d}=t,{count:_,start:v,loop:r,ilen:E}=kC(c,i,l),C=DF(d);let{move:z=!0,reverse:R}=l||{},j,G,W;for(j=0;j<=E;++j)G=c[(v+(R?E-j:j))%_],!G.skip&&(z?(n.moveTo(G.x,G.y),z=!1):C(n,W,G,R,d.stepped),W=G);return r&&(G=c[(v+(R?E:0))%_],C(n,W,G,R,d.stepped)),!!r}function OF(n,t,i,l){const c=t.points,{count:d,start:_,ilen:v}=kC(c,i,l),{move:r=!0,reverse:E}=l||{};let C=0,z=0,R,j,G,W,Q,rt;const ft=mt=>(_+(E?v-mt:mt))%d,xt=()=>{W!==Q&&(n.lineTo(C,Q),n.lineTo(C,W),n.lineTo(C,rt))};for(r&&(j=c[ft(0)],n.moveTo(j.x,j.y)),R=0;R<=v;++R){if(j=c[ft(R)],j.skip)continue;const mt=j.x,bt=j.y,Ot=mt|0;Ot===G?(bt<W?W=bt:bt>Q&&(Q=bt),C=(z*C+mt)/++z):(xt(),n.lineTo(mt,bt),G=Ot,z=0,W=Q=bt),rt=bt}xt()}function _x(n){const t=n.options,i=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!i?OF:zF}function RF(n){return n.stepped?CR:n.tension||n.cubicInterpolationMode==="monotone"?AR:ud}function BF(n,t,i,l){let c=t._path;c||(c=t._path=new Path2D,t.path(c,i,l)&&c.closePath()),PC(n,t.options),n.stroke(c)}function FF(n,t,i,l){const{segments:c,options:d}=t,_=_x(t);for(const v of c)PC(n,d,v.style),n.beginPath(),_(n,t,v,{start:i,end:i+l-1})&&n.closePath(),n.stroke()}const NF=typeof Path2D=="function";function jF(n,t,i,l){NF&&!t.options.segment?BF(n,t,i,l):FF(n,t,i,l)}class Ng extends Fu{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,i){const l=this.options;if((l.tension||l.cubicInterpolationMode==="monotone")&&!l.stepped&&!this._pointsUpdated){const c=l.spanGaps?this._loop:this._fullLoop;vR(this._points,l,t,c,i),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=zR(this,this.options.segment))}first(){const t=this.segments,i=this.points;return t.length&&i[t[0].start]}last(){const t=this.segments,i=this.points,l=t.length;return l&&i[t[l-1].end]}interpolate(t,i){const l=this.options,c=t[i],d=this.points,_=pC(this,{property:i,start:c,end:c});if(!_.length)return;const v=[],r=RF(l);let E,C;for(E=0,C=_.length;E<C;++E){const{start:z,end:R}=_[E],j=d[z],G=d[R];if(j===G){v.push(j);continue}const W=Math.abs((c-j[i])/(G[i]-j[i])),Q=r(j,G,W,l.stepped);Q[i]=t[i],v.push(Q)}return v.length===1?v[0]:v}pathSegment(t,i,l){return _x(this)(t,this,i,l)}path(t,i,l){const c=this.segments,d=_x(this);let _=this._loop;i=i||0,l=l||this.points.length-i;for(const v of c)_&=d(t,this,v,{start:i,end:i+l-1});return!!_}draw(t,i,l,c){const d=this.options||{};(this.points||[]).length&&d.borderWidth&&(t.save(),jF(t,this,l,c),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function eE(n,t,i,l){const c=n.options,{[i]:d}=n.getProps([i],l);return Math.abs(t-d)<c.radius+c.hitRadius}class VF extends Fu{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,i,l){const c=this.options,{x:d,y:_}=this.getProps(["x","y"],l);return Math.pow(t-d,2)+Math.pow(i-_,2)<Math.pow(c.hitRadius+c.radius,2)}inXRange(t,i){return eE(this,t,"x",i)}inYRange(t,i){return eE(this,t,"y",i)}getCenterPoint(t){const{x:i,y:l}=this.getProps(["x","y"],t);return{x:i,y:l}}size(t){t=t||this.options||{};let i=t.radius||0;i=Math.max(i,i&&t.hoverRadius||0);const l=i&&t.borderWidth||0;return(i+l)*2}draw(t,i){const l=this.options;this.skip||l.radius<.1||!Lu(this,i,this.size(l)/2)||(t.strokeStyle=l.borderColor,t.lineWidth=l.borderWidth,t.fillStyle=l.backgroundColor,fx(t,l,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function IC(n,t){const{x:i,y:l,base:c,width:d,height:_}=n.getProps(["x","y","base","width","height"],t);let v,r,E,C,z;return n.horizontal?(z=_/2,v=Math.min(i,c),r=Math.max(i,c),E=l-z,C=l+z):(z=d/2,v=i-z,r=i+z,E=Math.min(l,c),C=Math.max(l,c)),{left:v,top:E,right:r,bottom:C}}function fh(n,t,i,l){return n?0:Fr(t,i,l)}function UF(n,t,i){const l=n.options.borderWidth,c=n.borderSkipped,d=nC(l);return{t:fh(c.top,d.top,0,i),r:fh(c.right,d.right,0,t),b:fh(c.bottom,d.bottom,0,i),l:fh(c.left,d.left,0,t)}}function $F(n,t,i){const{enableBorderRadius:l}=n.getProps(["enableBorderRadius"]),c=n.options.borderRadius,d=xd(c),_=Math.min(t,i),v=n.borderSkipped,r=l||ln(c);return{topLeft:fh(!r||v.top||v.left,d.topLeft,0,_),topRight:fh(!r||v.top||v.right,d.topRight,0,_),bottomLeft:fh(!r||v.bottom||v.left,d.bottomLeft,0,_),bottomRight:fh(!r||v.bottom||v.right,d.bottomRight,0,_)}}function WF(n){const t=IC(n),i=t.right-t.left,l=t.bottom-t.top,c=UF(n,i/2,l/2),d=$F(n,i/2,l/2);return{outer:{x:t.left,y:t.top,w:i,h:l,radius:d},inner:{x:t.left+c.l,y:t.top+c.t,w:i-c.l-c.r,h:l-c.t-c.b,radius:{topLeft:Math.max(0,d.topLeft-Math.max(c.t,c.l)),topRight:Math.max(0,d.topRight-Math.max(c.t,c.r)),bottomLeft:Math.max(0,d.bottomLeft-Math.max(c.b,c.l)),bottomRight:Math.max(0,d.bottomRight-Math.max(c.b,c.r))}}}}function Iv(n,t,i,l){const c=t===null,d=i===null,v=n&&!(c&&d)&&IC(n,l);return v&&(c||ku(t,v.left,v.right))&&(d||ku(i,v.top,v.bottom))}function ZF(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function GF(n,t){n.rect(t.x,t.y,t.w,t.h)}function Lv(n,t,i={}){const l=n.x!==i.x?-t:0,c=n.y!==i.y?-t:0,d=(n.x+n.w!==i.x+i.w?t:0)-l,_=(n.y+n.h!==i.y+i.h?t:0)-c;return{x:n.x+l,y:n.y+c,w:n.w+d,h:n.h+_,radius:n.radius}}class HF extends Fu{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:i,options:{borderColor:l,backgroundColor:c}}=this,{inner:d,outer:_}=WF(this),v=ZF(_.radius)?fm:GF;t.save(),(_.w!==d.w||_.h!==d.h)&&(t.beginPath(),v(t,Lv(_,i,d)),t.clip(),v(t,Lv(d,-i,_)),t.fillStyle=l,t.fill("evenodd")),t.beginPath(),v(t,Lv(d,i)),t.fillStyle=c,t.fill(),t.restore()}inRange(t,i,l){return Iv(this,t,i,l)}inXRange(t,i){return Iv(this,t,null,i)}inYRange(t,i){return Iv(this,null,t,i)}getCenterPoint(t){const{x:i,y:l,base:c,horizontal:d}=this.getProps(["x","y","base","horizontal"],t);return{x:d?(i+c)/2:i,y:d?l:(l+c)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}var qF=Object.freeze({__proto__:null,ArcElement:IF,BarElement:HF,LineElement:Ng,PointElement:VF});const gx=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],iE=gx.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function LC(n){return gx[n%gx.length]}function DC(n){return iE[n%iE.length]}function XF(n,t){return n.borderColor=LC(t),n.backgroundColor=DC(t),++t}function KF(n,t){return n.backgroundColor=n.data.map(()=>LC(t++)),t}function YF(n,t){return n.backgroundColor=n.data.map(()=>DC(t++)),t}function JF(n){let t=0;return(i,l)=>{const c=n.getDatasetMeta(l).controller;c instanceof _0?t=KF(i,t):c instanceof vC?t=YF(i,t):c&&(t=XF(i,t))}}function nE(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function QF(n){return n&&(n.borderColor||n.backgroundColor)}function t5(){return vs.borderColor!=="rgba(0,0,0,0.1)"||vs.backgroundColor!=="rgba(0,0,0,0.1)"}var e5={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,i){if(!i.enabled)return;const{data:{datasets:l},options:c}=n.config,{elements:d}=c,_=nE(l)||QF(c)||d&&nE(d)||t5();if(!i.forceOverride&&_)return;const v=JF(n);l.forEach(v)}};function i5(n,t,i,l,c){const d=c.samples||l;if(d>=i)return n.slice(t,t+i);const _=[],v=(i-2)/(d-2);let r=0;const E=t+i-1;let C=t,z,R,j,G,W;for(_[r++]=n[C],z=0;z<d-2;z++){let Q=0,rt=0,ft;const xt=Math.floor((z+1)*v)+1+t,mt=Math.min(Math.floor((z+2)*v)+1,i)+t,bt=mt-xt;for(ft=xt;ft<mt;ft++)Q+=n[ft].x,rt+=n[ft].y;Q/=bt,rt/=bt;const Ot=Math.floor(z*v)+1+t,zt=Math.min(Math.floor((z+1)*v)+1,i)+t,{x:Rt,y:Bt}=n[C];for(j=G=-1,ft=Ot;ft<zt;ft++)G=.5*Math.abs((Rt-Q)*(n[ft].y-Bt)-(Rt-n[ft].x)*(rt-Bt)),G>j&&(j=G,R=n[ft],W=ft);_[r++]=R,C=W}return _[r++]=n[E],_}function n5(n,t,i,l){let c=0,d=0,_,v,r,E,C,z,R,j,G,W;const Q=[],rt=t+i-1,ft=n[t].x,mt=n[rt].x-ft;for(_=t;_<t+i;++_){v=n[_],r=(v.x-ft)/mt*l,E=v.y;const bt=r|0;if(bt===C)E<G?(G=E,z=_):E>W&&(W=E,R=_),c=(d*c+v.x)/++d;else{const Ot=_-1;if(!rn(z)&&!rn(R)){const zt=Math.min(z,R),Rt=Math.max(z,R);zt!==j&&zt!==Ot&&Q.push({...n[zt],x:c}),Rt!==j&&Rt!==Ot&&Q.push({...n[Rt],x:c})}_>0&&Ot!==j&&Q.push(n[Ot]),Q.push(v),C=bt,d=0,G=W=E,z=R=j=_}}return Q}function zC(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function sE(n){n.data.datasets.forEach(t=>{zC(t)})}function s5(n,t){const i=t.length;let l=0,c;const{iScale:d}=n,{min:_,max:v,minDefined:r,maxDefined:E}=d.getUserBounds();return r&&(l=Fr(Iu(t,d.axis,_).lo,0,i-1)),E?c=Fr(Iu(t,d.axis,v).hi+1,l,i)-l:c=i-l,{start:l,count:c}}var r5={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,i)=>{if(!i.enabled){sE(n);return}const l=n.width;n.data.datasets.forEach((c,d)=>{const{_data:_,indexAxis:v}=c,r=n.getDatasetMeta(d),E=_||c.data;if(Ip([v,n.options.indexAxis])==="y"||!r.controller.supportsDecimation)return;const C=n.scales[r.xAxisID];if(C.type!=="linear"&&C.type!=="time"||n.options.parsing)return;let{start:z,count:R}=s5(r,E);const j=i.threshold||4*l;if(R<=j){zC(c);return}rn(_)&&(c._data=E,delete c.data,Object.defineProperty(c,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(W){this._data=W}}));let G;switch(i.algorithm){case"lttb":G=i5(E,z,R,l,i);break;case"min-max":G=n5(E,z,R,l);break;default:throw new Error(`Unsupported decimation algorithm '${i.algorithm}'`)}c._decimated=G})},destroy(n){sE(n)}};function o5(n,t,i){const l=n.segments,c=n.points,d=t.points,_=[];for(const v of l){let{start:r,end:E}=v;E=jg(r,E,c);const C=yx(i,c[r],c[E],v.loop);if(!t.segments){_.push({source:v,target:C,start:c[r],end:c[E]});continue}const z=pC(t,C);for(const R of z){const j=yx(i,d[R.start],d[R.end],R.loop),G=fC(v,c,j);for(const W of G)_.push({source:W,target:R,start:{[i]:rE(C,j,"start",Math.max)},end:{[i]:rE(C,j,"end",Math.min)}})}}return _}function yx(n,t,i,l){if(l)return;let c=t[n],d=i[n];return n==="angle"&&(c=mo(c),d=mo(d)),{property:n,start:c,end:d}}function a5(n,t){const{x:i=null,y:l=null}=n||{},c=t.points,d=[];return t.segments.forEach(({start:_,end:v})=>{v=jg(_,v,c);const r=c[_],E=c[v];l!==null?(d.push({x:r.x,y:l}),d.push({x:E.x,y:l})):i!==null&&(d.push({x:i,y:r.y}),d.push({x:i,y:E.y}))}),d}function jg(n,t,i){for(;t>n;t--){const l=i[t];if(!isNaN(l.x)&&!isNaN(l.y))break}return t}function rE(n,t,i,l){return n&&t?l(n[i],t[i]):n?n[i]:t?t[i]:0}function OC(n,t){let i=[],l=!1;return ys(n)?(l=!0,i=n):i=a5(n,t),i.length?new Ng({points:i,options:{tension:0},_loop:l,_fullLoop:l}):null}function oE(n){return n&&n.fill!==!1}function l5(n,t,i){let c=n[t].fill;const d=[t];let _;if(!i)return c;for(;c!==!1&&d.indexOf(c)===-1;){if(!js(c))return c;if(_=n[c],!_)return!1;if(_.visible)return c;d.push(c),c=_.fill}return!1}function c5(n,t,i){const l=f5(n);if(ln(l))return isNaN(l.value)?!1:l;let c=parseFloat(l);return js(c)&&Math.floor(c)===c?u5(l[0],t,c,i):["origin","start","end","stack","shape"].indexOf(l)>=0&&l}function u5(n,t,i,l){return(n==="-"||n==="+")&&(i=t+i),i===t||i<0||i>=l?!1:i}function h5(n,t){let i=null;return n==="start"?i=t.bottom:n==="end"?i=t.top:ln(n)?i=t.getPixelForValue(n.value):t.getBasePixel&&(i=t.getBasePixel()),i}function d5(n,t,i){let l;return n==="start"?l=i:n==="end"?l=t.options.reverse?t.min:t.max:ln(n)?l=n.value:l=t.getBaseValue(),l}function f5(n){const t=n.options,i=t.fill;let l=Gi(i&&i.target,i);return l===void 0&&(l=!!t.backgroundColor),l===!1||l===null?!1:l===!0?"origin":l}function p5(n){const{scale:t,index:i,line:l}=n,c=[],d=l.segments,_=l.points,v=m5(t,i);v.push(OC({x:null,y:t.bottom},l));for(let r=0;r<d.length;r++){const E=d[r];for(let C=E.start;C<=E.end;C++)_5(c,_[C],v)}return new Ng({points:c,options:{}})}function m5(n,t){const i=[],l=n.getMatchingVisibleMetas("line");for(let c=0;c<l.length;c++){const d=l[c];if(d.index===t)break;d.hidden||i.unshift(d.dataset)}return i}function _5(n,t,i){const l=[];for(let c=0;c<i.length;c++){const d=i[c],{first:_,last:v,point:r}=g5(d,t,"x");if(!(!r||_&&v)){if(_)l.unshift(r);else if(n.push(r),!v)break}}n.push(...l)}function g5(n,t,i){const l=n.interpolate(t,i);if(!l)return{};const c=l[i],d=n.segments,_=n.points;let v=!1,r=!1;for(let E=0;E<d.length;E++){const C=d[E],z=_[C.start][i],R=_[C.end][i];if(ku(c,z,R)){v=c===z,r=c===R;break}}return{first:v,last:r,point:l}}class RC{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,i,l){const{x:c,y:d,radius:_}=this;return i=i||{start:0,end:ds},t.arc(c,d,_,i.end,i.start,!0),!l.bounds}interpolate(t){const{x:i,y:l,radius:c}=this,d=t.angle;return{x:i+Math.cos(d)*c,y:l+Math.sin(d)*c,angle:d}}}function y5(n){const{chart:t,fill:i,line:l}=n;if(js(i))return v5(t,i);if(i==="stack")return p5(n);if(i==="shape")return!0;const c=x5(n);return c instanceof RC?c:OC(c,l)}function v5(n,t){const i=n.getDatasetMeta(t);return i&&n.isDatasetVisible(t)?i.dataset:null}function x5(n){return(n.scale||{}).getPointPositionForValue?w5(n):b5(n)}function b5(n){const{scale:t={},fill:i}=n,l=h5(i,t);if(js(l)){const c=t.isHorizontal();return{x:c?l:null,y:c?null:l}}return null}function w5(n){const{scale:t,fill:i}=n,l=t.options,c=t.getLabels().length,d=l.reverse?t.max:t.min,_=d5(i,t,d),v=[];if(l.grid.circular){const r=t.getPointPositionForValue(0,d);return new RC({x:r.x,y:r.y,radius:t.getDistanceFromCenterForValue(_)})}for(let r=0;r<c;++r)v.push(t.getPointPositionForValue(r,_));return v}function Dv(n,t,i){const l=y5(t),{chart:c,index:d,line:_,scale:v,axis:r}=t,E=_.options,C=E.fill,z=E.backgroundColor,{above:R=z,below:j=z}=C||{},G=c.getDatasetMeta(d),W=mC(c,G);l&&_.points.length&&(Og(n,i),T5(n,{line:_,target:l,above:R,below:j,area:i,scale:v,axis:r,clip:W}),Rg(n))}function T5(n,t){const{line:i,target:l,above:c,below:d,area:_,scale:v,clip:r}=t,E=i._loop?"angle":t.axis;n.save();let C=d;d!==c&&(E==="x"?(aE(n,l,_.top),zv(n,{line:i,target:l,color:c,scale:v,property:E,clip:r}),n.restore(),n.save(),aE(n,l,_.bottom)):E==="y"&&(lE(n,l,_.left),zv(n,{line:i,target:l,color:d,scale:v,property:E,clip:r}),n.restore(),n.save(),lE(n,l,_.right),C=c)),zv(n,{line:i,target:l,color:C,scale:v,property:E,clip:r}),n.restore()}function aE(n,t,i){const{segments:l,points:c}=t;let d=!0,_=!1;n.beginPath();for(const v of l){const{start:r,end:E}=v,C=c[r],z=c[jg(r,E,c)];d?(n.moveTo(C.x,C.y),d=!1):(n.lineTo(C.x,i),n.lineTo(C.x,C.y)),_=!!t.pathSegment(n,v,{move:_}),_?n.closePath():n.lineTo(z.x,i)}n.lineTo(t.first().x,i),n.closePath(),n.clip()}function lE(n,t,i){const{segments:l,points:c}=t;let d=!0,_=!1;n.beginPath();for(const v of l){const{start:r,end:E}=v,C=c[r],z=c[jg(r,E,c)];d?(n.moveTo(C.x,C.y),d=!1):(n.lineTo(i,C.y),n.lineTo(C.x,C.y)),_=!!t.pathSegment(n,v,{move:_}),_?n.closePath():n.lineTo(i,z.y)}n.lineTo(i,t.first().y),n.closePath(),n.clip()}function zv(n,t){const{line:i,target:l,property:c,color:d,scale:_,clip:v}=t,r=o5(i,l,c);for(const{source:E,target:C,start:z,end:R}of r){const{style:{backgroundColor:j=d}={}}=E,G=l!==!0;n.save(),n.fillStyle=j,E5(n,_,v,G&&yx(c,z,R)),n.beginPath();const W=!!i.pathSegment(n,E);let Q;if(G){W?n.closePath():cE(n,l,R,c);const rt=!!l.pathSegment(n,C,{move:W,reverse:!0});Q=W&&rt,Q||cE(n,l,z,c)}n.closePath(),n.fill(Q?"evenodd":"nonzero"),n.restore()}}function E5(n,t,i,l){const c=t.chart.chartArea,{property:d,start:_,end:v}=l||{};if(d==="x"||d==="y"){let r,E,C,z;d==="x"?(r=_,E=c.top,C=v,z=c.bottom):(r=c.left,E=_,C=c.right,z=v),n.beginPath(),i&&(r=Math.max(r,i.left),C=Math.min(C,i.right),E=Math.max(E,i.top),z=Math.min(z,i.bottom)),n.rect(r,E,C-r,z-E),n.clip()}}function cE(n,t,i,l){const c=t.interpolate(i,l);c&&n.lineTo(c.x,c.y)}var S5={id:"filler",afterDatasetsUpdate(n,t,i){const l=(n.data.datasets||[]).length,c=[];let d,_,v,r;for(_=0;_<l;++_)d=n.getDatasetMeta(_),v=d.dataset,r=null,v&&v.options&&v instanceof Ng&&(r={visible:n.isDatasetVisible(_),index:_,fill:c5(v,_,l),chart:n,axis:d.controller.options.indexAxis,scale:d.vScale,line:v}),d.$filler=r,c.push(r);for(_=0;_<l;++_)r=c[_],!(!r||r.fill===!1)&&(r.fill=l5(c,_,i.propagate))},beforeDraw(n,t,i){const l=i.drawTime==="beforeDraw",c=n.getSortedVisibleDatasetMetas(),d=n.chartArea;for(let _=c.length-1;_>=0;--_){const v=c[_].$filler;v&&(v.line.updateControlPoints(d,v.axis),l&&v.fill&&Dv(n.ctx,v,d))}},beforeDatasetsDraw(n,t,i){if(i.drawTime!=="beforeDatasetsDraw")return;const l=n.getSortedVisibleDatasetMetas();for(let c=l.length-1;c>=0;--c){const d=l[c].$filler;oE(d)&&Dv(n.ctx,d,n.chartArea)}},beforeDatasetDraw(n,t,i){const l=t.meta.$filler;!oE(l)||i.drawTime!=="beforeDatasetDraw"||Dv(n.ctx,l,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const uE=(n,t)=>{let{boxHeight:i=t,boxWidth:l=t}=n;return n.usePointStyle&&(i=Math.min(i,t),l=n.pointStyleWidth||Math.min(l,t)),{boxWidth:l,boxHeight:i,itemHeight:Math.max(t,i)}},M5=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class hE extends Fu{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,i,l){this.maxWidth=t,this.maxHeight=i,this._margins=l,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let i=as(t.generateLabels,[this.chart],this)||[];t.filter&&(i=i.filter(l=>t.filter(l,this.chart.data))),t.sort&&(i=i.sort((l,c)=>t.sort(l,c,this.chart.data))),this.options.reverse&&i.reverse(),this.legendItems=i}fit(){const{options:t,ctx:i}=this;if(!t.display){this.width=this.height=0;return}const l=t.labels,c=Sr(l.font),d=c.size,_=this._computeTitleHeight(),{boxWidth:v,itemHeight:r}=uE(l,d);let E,C;i.font=c.string,this.isHorizontal()?(E=this.maxWidth,C=this._fitRows(_,d,v,r)+10):(C=this.maxHeight,E=this._fitCols(_,c,v,r)+10),this.width=Math.min(E,t.maxWidth||this.maxWidth),this.height=Math.min(C,t.maxHeight||this.maxHeight)}_fitRows(t,i,l,c){const{ctx:d,maxWidth:_,options:{labels:{padding:v}}}=this,r=this.legendHitBoxes=[],E=this.lineWidths=[0],C=c+v;let z=t;d.textAlign="left",d.textBaseline="middle";let R=-1,j=-C;return this.legendItems.forEach((G,W)=>{const Q=l+i/2+d.measureText(G.text).width;(W===0||E[E.length-1]+Q+2*v>_)&&(z+=C,E[E.length-(W>0?0:1)]=0,j+=C,R++),r[W]={left:0,top:j,row:R,width:Q,height:c},E[E.length-1]+=Q+v}),z}_fitCols(t,i,l,c){const{ctx:d,maxHeight:_,options:{labels:{padding:v}}}=this,r=this.legendHitBoxes=[],E=this.columnSizes=[],C=_-t;let z=v,R=0,j=0,G=0,W=0;return this.legendItems.forEach((Q,rt)=>{const{itemWidth:ft,itemHeight:xt}=C5(l,i,d,Q,c);rt>0&&j+xt+2*v>C&&(z+=R+v,E.push({width:R,height:j}),G+=R+v,W++,R=j=0),r[rt]={left:G,top:j,col:W,width:ft,height:xt},R=Math.max(R,ft),j+=xt+v}),z+=R,E.push({width:R,height:j}),z}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:i,options:{align:l,labels:{padding:c},rtl:d}}=this,_=wf(d,this.left,this.width);if(this.isHorizontal()){let v=0,r=po(l,this.left+c,this.right-this.lineWidths[v]);for(const E of i)v!==E.row&&(v=E.row,r=po(l,this.left+c,this.right-this.lineWidths[v])),E.top+=this.top+t+c,E.left=_.leftForLtr(_.x(r),E.width),r+=E.width+c}else{let v=0,r=po(l,this.top+t+c,this.bottom-this.columnSizes[v].height);for(const E of i)E.col!==v&&(v=E.col,r=po(l,this.top+t+c,this.bottom-this.columnSizes[v].height)),E.top=r,E.left+=this.left+c,E.left=_.leftForLtr(_.x(E.left),E.width),r+=E.height+c}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Og(t,this),this._draw(),Rg(t)}}_draw(){const{options:t,columnSizes:i,lineWidths:l,ctx:c}=this,{align:d,labels:_}=t,v=vs.color,r=wf(t.rtl,this.left,this.width),E=Sr(_.font),{padding:C}=_,z=E.size,R=z/2;let j;this.drawTitle(),c.textAlign=r.textAlign("left"),c.textBaseline="middle",c.lineWidth=.5,c.font=E.string;const{boxWidth:G,boxHeight:W,itemHeight:Q}=uE(_,z),rt=function(Ot,zt,Rt){if(isNaN(G)||G<=0||isNaN(W)||W<0)return;c.save();const Bt=Gi(Rt.lineWidth,1);if(c.fillStyle=Gi(Rt.fillStyle,v),c.lineCap=Gi(Rt.lineCap,"butt"),c.lineDashOffset=Gi(Rt.lineDashOffset,0),c.lineJoin=Gi(Rt.lineJoin,"miter"),c.lineWidth=Bt,c.strokeStyle=Gi(Rt.strokeStyle,v),c.setLineDash(Gi(Rt.lineDash,[])),_.usePointStyle){const Nt={radius:W*Math.SQRT2/2,pointStyle:Rt.pointStyle,rotation:Rt.rotation,borderWidth:Bt},ee=r.xPlus(Ot,G/2),Wt=zt+R;iC(c,Nt,ee,Wt,_.pointStyleWidth&&G)}else{const Nt=zt+Math.max((z-W)/2,0),ee=r.leftForLtr(Ot,G),Wt=xd(Rt.borderRadius);c.beginPath(),Object.values(Wt).some(ae=>ae!==0)?fm(c,{x:ee,y:Nt,w:G,h:W,radius:Wt}):c.rect(ee,Nt,G,W),c.fill(),Bt!==0&&c.stroke()}c.restore()},ft=function(Ot,zt,Rt){Ed(c,Rt.text,Ot,zt+Q/2,E,{strikethrough:Rt.hidden,textAlign:r.textAlign(Rt.textAlign)})},xt=this.isHorizontal(),mt=this._computeTitleHeight();xt?j={x:po(d,this.left+C,this.right-l[0]),y:this.top+C+mt,line:0}:j={x:this.left+C,y:po(d,this.top+mt+C,this.bottom-i[0].height),line:0},uC(this.ctx,t.textDirection);const bt=Q+C;this.legendItems.forEach((Ot,zt)=>{c.strokeStyle=Ot.fontColor,c.fillStyle=Ot.fontColor;const Rt=c.measureText(Ot.text).width,Bt=r.textAlign(Ot.textAlign||(Ot.textAlign=_.textAlign)),Nt=G+R+Rt;let ee=j.x,Wt=j.y;r.setWidth(this.width),xt?zt>0&&ee+Nt+C>this.right&&(Wt=j.y+=bt,j.line++,ee=j.x=po(d,this.left+C,this.right-l[j.line])):zt>0&&Wt+bt>this.bottom&&(ee=j.x=ee+i[j.line].width+C,j.line++,Wt=j.y=po(d,this.top+mt+C,this.bottom-i[j.line].height));const ae=r.x(ee);if(rt(ae,Wt,Ot),ee=B3(Bt,ee+G+R,xt?ee+Nt:this.right,t.rtl),ft(r.x(ee),Wt,Ot),xt)j.x+=Nt+C;else if(typeof Ot.text!="string"){const ye=E.lineHeight;j.y+=BC(Ot,ye)+C}else j.y+=bt}),hC(this.ctx,t.textDirection)}drawTitle(){const t=this.options,i=t.title,l=Sr(i.font),c=To(i.padding);if(!i.display)return;const d=wf(t.rtl,this.left,this.width),_=this.ctx,v=i.position,r=l.size/2,E=c.top+r;let C,z=this.left,R=this.width;if(this.isHorizontal())R=Math.max(...this.lineWidths),C=this.top+E,z=po(t.align,z,this.right-R);else{const G=this.columnSizes.reduce((W,Q)=>Math.max(W,Q.height),0);C=E+po(t.align,this.top,this.bottom-G-t.labels.padding-this._computeTitleHeight())}const j=po(v,z,z+R);_.textAlign=d.textAlign(l0(v)),_.textBaseline="middle",_.strokeStyle=i.color,_.fillStyle=i.color,_.font=l.string,Ed(_,i.text,j,C,l)}_computeTitleHeight(){const t=this.options.title,i=Sr(t.font),l=To(t.padding);return t.display?i.lineHeight+l.height:0}_getLegendItemAt(t,i){let l,c,d;if(ku(t,this.left,this.right)&&ku(i,this.top,this.bottom)){for(d=this.legendHitBoxes,l=0;l<d.length;++l)if(c=d[l],ku(t,c.left,c.left+c.width)&&ku(i,c.top,c.top+c.height))return this.legendItems[l]}return null}handleEvent(t){const i=this.options;if(!k5(t.type,i))return;const l=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const c=this._hoveredItem,d=M5(c,l);c&&!d&&as(i.onLeave,[t,c,this],this),this._hoveredItem=l,l&&!d&&as(i.onHover,[t,l,this],this)}else l&&as(i.onClick,[t,l,this],this)}}function C5(n,t,i,l,c){const d=A5(l,n,t,i),_=P5(c,l,t.lineHeight);return{itemWidth:d,itemHeight:_}}function A5(n,t,i,l){let c=n.text;return c&&typeof c!="string"&&(c=c.reduce((d,_)=>d.length>_.length?d:_)),t+i.size/2+l.measureText(c).width}function P5(n,t,i){let l=n;return typeof t.text!="string"&&(l=BC(t,i)),l}function BC(n,t){const i=n.text?n.text.length:0;return t*i}function k5(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var I5={id:"legend",_element:hE,start(n,t,i){const l=n.legend=new hE({ctx:n.ctx,options:i,chart:n});xo.configure(n,l,i),xo.addBox(n,l)},stop(n){xo.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,i){const l=n.legend;xo.configure(n,l,i),l.options=i},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,i){const l=t.datasetIndex,c=i.chart;c.isDatasetVisible(l)?(c.hide(l),t.hidden=!0):(c.show(l),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:i,pointStyle:l,textAlign:c,color:d,useBorderRadius:_,borderRadius:v}}=n.legend.options;return n._getSortedDatasetMetas().map(r=>{const E=r.controller.getStyle(i?0:void 0),C=To(E.borderWidth);return{text:t[r.index].label,fillStyle:E.backgroundColor,fontColor:d,hidden:!r.visible,lineCap:E.borderCapStyle,lineDash:E.borderDash,lineDashOffset:E.borderDashOffset,lineJoin:E.borderJoinStyle,lineWidth:(C.width+C.height)/4,strokeStyle:E.borderColor,pointStyle:l||E.pointStyle,rotation:E.rotation,textAlign:c||E.textAlign,borderRadius:_&&(v||E.borderRadius),datasetIndex:r.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class v0 extends Fu{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,i){const l=this.options;if(this.left=0,this.top=0,!l.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=i;const c=ys(l.text)?l.text.length:1;this._padding=To(l.padding);const d=c*Sr(l.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=d:this.width=d}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:i,left:l,bottom:c,right:d,options:_}=this,v=_.align;let r=0,E,C,z;return this.isHorizontal()?(C=po(v,l,d),z=i+t,E=d-l):(_.position==="left"?(C=l+t,z=po(v,c,i),r=Sn*-.5):(C=d-t,z=po(v,i,c),r=Sn*.5),E=c-i),{titleX:C,titleY:z,maxWidth:E,rotation:r}}draw(){const t=this.ctx,i=this.options;if(!i.display)return;const l=Sr(i.font),d=l.lineHeight/2+this._padding.top,{titleX:_,titleY:v,maxWidth:r,rotation:E}=this._drawArgs(d);Ed(t,i.text,0,0,l,{color:i.color,maxWidth:r,rotation:E,textAlign:l0(i.align),textBaseline:"middle",translation:[_,v]})}}function L5(n,t){const i=new v0({ctx:n.ctx,options:t,chart:n});xo.configure(n,i,t),xo.addBox(n,i),n.titleBlock=i}var D5={id:"title",_element:v0,start(n,t,i){L5(n,i)},stop(n){const t=n.titleBlock;xo.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,i){const l=n.titleBlock;xo.configure(n,l,i),l.options=i},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const S_=new WeakMap;var z5={id:"subtitle",start(n,t,i){const l=new v0({ctx:n.ctx,options:i,chart:n});xo.configure(n,l,i),xo.addBox(n,l),S_.set(n,l)},stop(n){xo.removeBox(n,S_.get(n)),S_.delete(n)},beforeUpdate(n,t,i){const l=S_.get(n);xo.configure(n,l,i),l.options=i},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Dp={average(n){if(!n.length)return!1;let t,i,l=new Set,c=0,d=0;for(t=0,i=n.length;t<i;++t){const v=n[t].element;if(v&&v.hasValue()){const r=v.tooltipPosition();l.add(r.x),c+=r.y,++d}}return d===0||l.size===0?!1:{x:[...l].reduce((v,r)=>v+r)/l.size,y:c/d}},nearest(n,t){if(!n.length)return!1;let i=t.x,l=t.y,c=Number.POSITIVE_INFINITY,d,_,v;for(d=0,_=n.length;d<_;++d){const r=n[d].element;if(r&&r.hasValue()){const E=r.getCenterPoint(),C=hx(t,E);C<c&&(c=C,v=r)}}if(v){const r=v.tooltipPosition();i=r.x,l=r.y}return{x:i,y:l}}};function Ic(n,t){return t&&(ys(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function bu(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function O5(n,t){const{element:i,datasetIndex:l,index:c}=t,d=n.getDatasetMeta(l).controller,{label:_,value:v}=d.getLabelAndValue(c);return{chart:n,label:_,parsed:d.getParsed(c),raw:n.data.datasets[l].data[c],formattedValue:v,dataset:d.getDataset(),dataIndex:c,datasetIndex:l,element:i}}function dE(n,t){const i=n.chart.ctx,{body:l,footer:c,title:d}=n,{boxWidth:_,boxHeight:v}=t,r=Sr(t.bodyFont),E=Sr(t.titleFont),C=Sr(t.footerFont),z=d.length,R=c.length,j=l.length,G=To(t.padding);let W=G.height,Q=0,rt=l.reduce((mt,bt)=>mt+bt.before.length+bt.lines.length+bt.after.length,0);if(rt+=n.beforeBody.length+n.afterBody.length,z&&(W+=z*E.lineHeight+(z-1)*t.titleSpacing+t.titleMarginBottom),rt){const mt=t.displayColors?Math.max(v,r.lineHeight):r.lineHeight;W+=j*mt+(rt-j)*r.lineHeight+(rt-1)*t.bodySpacing}R&&(W+=t.footerMarginTop+R*C.lineHeight+(R-1)*t.footerSpacing);let ft=0;const xt=function(mt){Q=Math.max(Q,i.measureText(mt).width+ft)};return i.save(),i.font=E.string,jn(n.title,xt),i.font=r.string,jn(n.beforeBody.concat(n.afterBody),xt),ft=t.displayColors?_+2+t.boxPadding:0,jn(l,mt=>{jn(mt.before,xt),jn(mt.lines,xt),jn(mt.after,xt)}),ft=0,i.font=C.string,jn(n.footer,xt),i.restore(),Q+=G.width,{width:Q,height:W}}function R5(n,t){const{y:i,height:l}=t;return i<l/2?"top":i>n.height-l/2?"bottom":"center"}function B5(n,t,i,l){const{x:c,width:d}=l,_=i.caretSize+i.caretPadding;if(n==="left"&&c+d+_>t.width||n==="right"&&c-d-_<0)return!0}function F5(n,t,i,l){const{x:c,width:d}=i,{width:_,chartArea:{left:v,right:r}}=n;let E="center";return l==="center"?E=c<=(v+r)/2?"left":"right":c<=d/2?E="left":c>=_-d/2&&(E="right"),B5(E,n,t,i)&&(E="center"),E}function fE(n,t,i){const l=i.yAlign||t.yAlign||R5(n,i);return{xAlign:i.xAlign||t.xAlign||F5(n,t,i,l),yAlign:l}}function N5(n,t){let{x:i,width:l}=n;return t==="right"?i-=l:t==="center"&&(i-=l/2),i}function j5(n,t,i){let{y:l,height:c}=n;return t==="top"?l+=i:t==="bottom"?l-=c+i:l-=c/2,l}function pE(n,t,i,l){const{caretSize:c,caretPadding:d,cornerRadius:_}=n,{xAlign:v,yAlign:r}=i,E=c+d,{topLeft:C,topRight:z,bottomLeft:R,bottomRight:j}=xd(_);let G=N5(t,v);const W=j5(t,r,E);return r==="center"?v==="left"?G+=E:v==="right"&&(G-=E):v==="left"?G-=Math.max(C,R)+c:v==="right"&&(G+=Math.max(z,j)+c),{x:Fr(G,0,l.width-t.width),y:Fr(W,0,l.height-t.height)}}function M_(n,t,i){const l=To(i.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-l.right:n.x+l.left}function mE(n){return Ic([],bu(n))}function V5(n,t,i){return Sh(n,{tooltip:t,tooltipItems:i,type:"tooltip"})}function _E(n,t){const i=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return i?n.override(i):n}const FC={beforeTitle:vu,title(n){if(n.length>0){const t=n[0],i=t.chart.data.labels,l=i?i.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(l>0&&t.dataIndex<l)return i[t.dataIndex]}return""},afterTitle:vu,beforeBody:vu,beforeLabel:vu,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const i=n.formattedValue;return rn(i)||(t+=i),t},labelColor(n){const i=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:i.borderColor,backgroundColor:i.backgroundColor,borderWidth:i.borderWidth,borderDash:i.borderDash,borderDashOffset:i.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const i=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:i.pointStyle,rotation:i.rotation}},afterLabel:vu,afterBody:vu,beforeFooter:vu,footer:vu,afterFooter:vu};function aa(n,t,i,l){const c=n[t].call(i,l);return typeof c>"u"?FC[t].call(i,l):c}class gE extends Fu{static positioners=Dp;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const i=this.chart,l=this.options.setContext(this.getContext()),c=l.enabled&&i.options.animation&&l.animations,d=new _C(this.chart,c);return c._cacheable&&(this._cachedAnimations=Object.freeze(d)),d}getContext(){return this.$context||(this.$context=V5(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,i){const{callbacks:l}=i,c=aa(l,"beforeTitle",this,t),d=aa(l,"title",this,t),_=aa(l,"afterTitle",this,t);let v=[];return v=Ic(v,bu(c)),v=Ic(v,bu(d)),v=Ic(v,bu(_)),v}getBeforeBody(t,i){return mE(aa(i.callbacks,"beforeBody",this,t))}getBody(t,i){const{callbacks:l}=i,c=[];return jn(t,d=>{const _={before:[],lines:[],after:[]},v=_E(l,d);Ic(_.before,bu(aa(v,"beforeLabel",this,d))),Ic(_.lines,aa(v,"label",this,d)),Ic(_.after,bu(aa(v,"afterLabel",this,d))),c.push(_)}),c}getAfterBody(t,i){return mE(aa(i.callbacks,"afterBody",this,t))}getFooter(t,i){const{callbacks:l}=i,c=aa(l,"beforeFooter",this,t),d=aa(l,"footer",this,t),_=aa(l,"afterFooter",this,t);let v=[];return v=Ic(v,bu(c)),v=Ic(v,bu(d)),v=Ic(v,bu(_)),v}_createItems(t){const i=this._active,l=this.chart.data,c=[],d=[],_=[];let v=[],r,E;for(r=0,E=i.length;r<E;++r)v.push(O5(this.chart,i[r]));return t.filter&&(v=v.filter((C,z,R)=>t.filter(C,z,R,l))),t.itemSort&&(v=v.sort((C,z)=>t.itemSort(C,z,l))),jn(v,C=>{const z=_E(t.callbacks,C);c.push(aa(z,"labelColor",this,C)),d.push(aa(z,"labelPointStyle",this,C)),_.push(aa(z,"labelTextColor",this,C))}),this.labelColors=c,this.labelPointStyles=d,this.labelTextColors=_,this.dataPoints=v,v}update(t,i){const l=this.options.setContext(this.getContext()),c=this._active;let d,_=[];if(!c.length)this.opacity!==0&&(d={opacity:0});else{const v=Dp[l.position].call(this,c,this._eventPosition);_=this._createItems(l),this.title=this.getTitle(_,l),this.beforeBody=this.getBeforeBody(_,l),this.body=this.getBody(_,l),this.afterBody=this.getAfterBody(_,l),this.footer=this.getFooter(_,l);const r=this._size=dE(this,l),E=Object.assign({},v,r),C=fE(this.chart,l,E),z=pE(l,E,C,this.chart);this.xAlign=C.xAlign,this.yAlign=C.yAlign,d={opacity:1,x:z.x,y:z.y,width:r.width,height:r.height,caretX:v.x,caretY:v.y}}this._tooltipItems=_,this.$context=void 0,d&&this._resolveAnimations().update(this,d),t&&l.external&&l.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(t,i,l,c){const d=this.getCaretPosition(t,l,c);i.lineTo(d.x1,d.y1),i.lineTo(d.x2,d.y2),i.lineTo(d.x3,d.y3)}getCaretPosition(t,i,l){const{xAlign:c,yAlign:d}=this,{caretSize:_,cornerRadius:v}=l,{topLeft:r,topRight:E,bottomLeft:C,bottomRight:z}=xd(v),{x:R,y:j}=t,{width:G,height:W}=i;let Q,rt,ft,xt,mt,bt;return d==="center"?(mt=j+W/2,c==="left"?(Q=R,rt=Q-_,xt=mt+_,bt=mt-_):(Q=R+G,rt=Q+_,xt=mt-_,bt=mt+_),ft=Q):(c==="left"?rt=R+Math.max(r,C)+_:c==="right"?rt=R+G-Math.max(E,z)-_:rt=this.caretX,d==="top"?(xt=j,mt=xt-_,Q=rt-_,ft=rt+_):(xt=j+W,mt=xt+_,Q=rt+_,ft=rt-_),bt=xt),{x1:Q,x2:rt,x3:ft,y1:xt,y2:mt,y3:bt}}drawTitle(t,i,l){const c=this.title,d=c.length;let _,v,r;if(d){const E=wf(l.rtl,this.x,this.width);for(t.x=M_(this,l.titleAlign,l),i.textAlign=E.textAlign(l.titleAlign),i.textBaseline="middle",_=Sr(l.titleFont),v=l.titleSpacing,i.fillStyle=l.titleColor,i.font=_.string,r=0;r<d;++r)i.fillText(c[r],E.x(t.x),t.y+_.lineHeight/2),t.y+=_.lineHeight+v,r+1===d&&(t.y+=l.titleMarginBottom-v)}}_drawColorBox(t,i,l,c,d){const _=this.labelColors[l],v=this.labelPointStyles[l],{boxHeight:r,boxWidth:E}=d,C=Sr(d.bodyFont),z=M_(this,"left",d),R=c.x(z),j=r<C.lineHeight?(C.lineHeight-r)/2:0,G=i.y+j;if(d.usePointStyle){const W={radius:Math.min(E,r)/2,pointStyle:v.pointStyle,rotation:v.rotation,borderWidth:1},Q=c.leftForLtr(R,E)+E/2,rt=G+r/2;t.strokeStyle=d.multiKeyBackground,t.fillStyle=d.multiKeyBackground,fx(t,W,Q,rt),t.strokeStyle=_.borderColor,t.fillStyle=_.backgroundColor,fx(t,W,Q,rt)}else{t.lineWidth=ln(_.borderWidth)?Math.max(...Object.values(_.borderWidth)):_.borderWidth||1,t.strokeStyle=_.borderColor,t.setLineDash(_.borderDash||[]),t.lineDashOffset=_.borderDashOffset||0;const W=c.leftForLtr(R,E),Q=c.leftForLtr(c.xPlus(R,1),E-2),rt=xd(_.borderRadius);Object.values(rt).some(ft=>ft!==0)?(t.beginPath(),t.fillStyle=d.multiKeyBackground,fm(t,{x:W,y:G,w:E,h:r,radius:rt}),t.fill(),t.stroke(),t.fillStyle=_.backgroundColor,t.beginPath(),fm(t,{x:Q,y:G+1,w:E-2,h:r-2,radius:rt}),t.fill()):(t.fillStyle=d.multiKeyBackground,t.fillRect(W,G,E,r),t.strokeRect(W,G,E,r),t.fillStyle=_.backgroundColor,t.fillRect(Q,G+1,E-2,r-2))}t.fillStyle=this.labelTextColors[l]}drawBody(t,i,l){const{body:c}=this,{bodySpacing:d,bodyAlign:_,displayColors:v,boxHeight:r,boxWidth:E,boxPadding:C}=l,z=Sr(l.bodyFont);let R=z.lineHeight,j=0;const G=wf(l.rtl,this.x,this.width),W=function(Rt){i.fillText(Rt,G.x(t.x+j),t.y+R/2),t.y+=R+d},Q=G.textAlign(_);let rt,ft,xt,mt,bt,Ot,zt;for(i.textAlign=_,i.textBaseline="middle",i.font=z.string,t.x=M_(this,Q,l),i.fillStyle=l.bodyColor,jn(this.beforeBody,W),j=v&&Q!=="right"?_==="center"?E/2+C:E+2+C:0,mt=0,Ot=c.length;mt<Ot;++mt){for(rt=c[mt],ft=this.labelTextColors[mt],i.fillStyle=ft,jn(rt.before,W),xt=rt.lines,v&&xt.length&&(this._drawColorBox(i,t,mt,G,l),R=Math.max(z.lineHeight,r)),bt=0,zt=xt.length;bt<zt;++bt)W(xt[bt]),R=z.lineHeight;jn(rt.after,W)}j=0,R=z.lineHeight,jn(this.afterBody,W),t.y-=d}drawFooter(t,i,l){const c=this.footer,d=c.length;let _,v;if(d){const r=wf(l.rtl,this.x,this.width);for(t.x=M_(this,l.footerAlign,l),t.y+=l.footerMarginTop,i.textAlign=r.textAlign(l.footerAlign),i.textBaseline="middle",_=Sr(l.footerFont),i.fillStyle=l.footerColor,i.font=_.string,v=0;v<d;++v)i.fillText(c[v],r.x(t.x),t.y+_.lineHeight/2),t.y+=_.lineHeight+l.footerSpacing}}drawBackground(t,i,l,c){const{xAlign:d,yAlign:_}=this,{x:v,y:r}=t,{width:E,height:C}=l,{topLeft:z,topRight:R,bottomLeft:j,bottomRight:G}=xd(c.cornerRadius);i.fillStyle=c.backgroundColor,i.strokeStyle=c.borderColor,i.lineWidth=c.borderWidth,i.beginPath(),i.moveTo(v+z,r),_==="top"&&this.drawCaret(t,i,l,c),i.lineTo(v+E-R,r),i.quadraticCurveTo(v+E,r,v+E,r+R),_==="center"&&d==="right"&&this.drawCaret(t,i,l,c),i.lineTo(v+E,r+C-G),i.quadraticCurveTo(v+E,r+C,v+E-G,r+C),_==="bottom"&&this.drawCaret(t,i,l,c),i.lineTo(v+j,r+C),i.quadraticCurveTo(v,r+C,v,r+C-j),_==="center"&&d==="left"&&this.drawCaret(t,i,l,c),i.lineTo(v,r+z),i.quadraticCurveTo(v,r,v+z,r),i.closePath(),i.fill(),c.borderWidth>0&&i.stroke()}_updateAnimationTarget(t){const i=this.chart,l=this.$animations,c=l&&l.x,d=l&&l.y;if(c||d){const _=Dp[t.position].call(this,this._active,this._eventPosition);if(!_)return;const v=this._size=dE(this,t),r=Object.assign({},_,this._size),E=fE(i,t,r),C=pE(t,r,E,i);(c._to!==C.x||d._to!==C.y)&&(this.xAlign=E.xAlign,this.yAlign=E.yAlign,this.width=v.width,this.height=v.height,this.caretX=_.x,this.caretY=_.y,this._resolveAnimations().update(this,C))}}_willRender(){return!!this.opacity}draw(t){const i=this.options.setContext(this.getContext());let l=this.opacity;if(!l)return;this._updateAnimationTarget(i);const c={width:this.width,height:this.height},d={x:this.x,y:this.y};l=Math.abs(l)<.001?0:l;const _=To(i.padding),v=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&v&&(t.save(),t.globalAlpha=l,this.drawBackground(d,t,c,i),uC(t,i.textDirection),d.y+=_.top,this.drawTitle(d,t,i),this.drawBody(d,t,i),this.drawFooter(d,t,i),hC(t,i.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,i){const l=this._active,c=t.map(({datasetIndex:v,index:r})=>{const E=this.chart.getDatasetMeta(v);if(!E)throw new Error("Cannot find a dataset at index "+v);return{datasetIndex:v,element:E.data[r],index:r}}),d=!ug(l,c),_=this._positionChanged(c,i);(d||_)&&(this._active=c,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,i,l=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const c=this.options,d=this._active||[],_=this._getActiveElements(t,d,i,l),v=this._positionChanged(_,t),r=i||!ug(_,d)||v;return r&&(this._active=_,(c.enabled||c.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,i))),r}_getActiveElements(t,i,l,c){const d=this.options;if(t.type==="mouseout")return[];if(!c)return i.filter(v=>this.chart.data.datasets[v.datasetIndex]&&this.chart.getDatasetMeta(v.datasetIndex).controller.getParsed(v.index)!==void 0);const _=this.chart.getElementsAtEventForMode(t,d.mode,d,l);return d.reverse&&_.reverse(),_}_positionChanged(t,i){const{caretX:l,caretY:c,options:d}=this,_=Dp[d.position].call(this,t,i);return _!==!1&&(l!==_.x||c!==_.y)}}var U5={id:"tooltip",_element:gE,positioners:Dp,afterInit(n,t,i){i&&(n.tooltip=new gE({chart:n,options:i}))},beforeUpdate(n,t,i){n.tooltip&&n.tooltip.initialize(i)},reset(n,t,i){n.tooltip&&n.tooltip.initialize(i)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const i={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...i,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",i)}},afterEvent(n,t){if(n.tooltip){const i=t.replay;n.tooltip.handleEvent(t.event,i,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:FC},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},$5=Object.freeze({__proto__:null,Colors:e5,Decimation:r5,Filler:S5,Legend:I5,SubTitle:z5,Title:D5,Tooltip:U5});const W5=(n,t,i,l)=>(typeof t=="string"?(i=n.push(t)-1,l.unshift({index:i,label:t})):isNaN(t)&&(i=null),i);function Z5(n,t,i,l){const c=n.indexOf(t);if(c===-1)return W5(n,t,i,l);const d=n.lastIndexOf(t);return c!==d?i:c}const G5=(n,t)=>n===null?null:Fr(Math.round(n),0,t);function yE(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class H5 extends Pd{static id="category";static defaults={ticks:{callback:yE}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const i=this._addedLabels;if(i.length){const l=this.getLabels();for(const{index:c,label:d}of i)l[c]===d&&l.splice(c,1);this._addedLabels=[]}super.init(t)}parse(t,i){if(rn(t))return null;const l=this.getLabels();return i=isFinite(i)&&l[i]===t?i:Z5(l,t,Gi(i,t),this._addedLabels),G5(i,l.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:i}=this.getUserBounds();let{min:l,max:c}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(l=0),i||(c=this.getLabels().length-1)),this.min=l,this.max=c}buildTicks(){const t=this.min,i=this.max,l=this.options.offset,c=[];let d=this.getLabels();d=t===0&&i===d.length-1?d:d.slice(t,i+1),this._valueRange=Math.max(d.length-(l?0:1),1),this._startValue=this.min-(l?.5:0);for(let _=t;_<=i;_++)c.push({value:_});return c}getLabelForValue(t){return yE.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const i=this.ticks;return t<0||t>i.length-1?null:this.getPixelForValue(i[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function q5(n,t){const i=[],{bounds:c,step:d,min:_,max:v,precision:r,count:E,maxTicks:C,maxDigits:z,includeBounds:R}=n,j=d||1,G=C-1,{min:W,max:Q}=t,rt=!rn(_),ft=!rn(v),xt=!rn(E),mt=(Q-W)/(z+1);let bt=dT((Q-W)/G/j)*j,Ot,zt,Rt,Bt;if(bt<1e-14&&!rt&&!ft)return[{value:W},{value:Q}];Bt=Math.ceil(Q/bt)-Math.floor(W/bt),Bt>G&&(bt=dT(Bt*bt/G/j)*j),rn(r)||(Ot=Math.pow(10,r),bt=Math.ceil(bt*Ot)/Ot),c==="ticks"?(zt=Math.floor(W/bt)*bt,Rt=Math.ceil(Q/bt)*bt):(zt=W,Rt=Q),rt&&ft&&d&&k3((v-_)/d,bt/1e3)?(Bt=Math.round(Math.min((v-_)/bt,C)),bt=(v-_)/Bt,zt=_,Rt=v):xt?(zt=rt?_:zt,Rt=ft?v:Rt,Bt=E-1,bt=(Rt-zt)/Bt):(Bt=(Rt-zt)/bt,Zp(Bt,Math.round(Bt),bt/1e3)?Bt=Math.round(Bt):Bt=Math.ceil(Bt));const Nt=Math.max(fT(bt),fT(zt));Ot=Math.pow(10,rn(r)?Nt:r),zt=Math.round(zt*Ot)/Ot,Rt=Math.round(Rt*Ot)/Ot;let ee=0;for(rt&&(R&&zt!==_?(i.push({value:_}),zt<_&&ee++,Zp(Math.round((zt+ee*bt)*Ot)/Ot,_,vE(_,mt,n))&&ee++):zt<_&&ee++);ee<Bt;++ee){const Wt=Math.round((zt+ee*bt)*Ot)/Ot;if(ft&&Wt>v)break;i.push({value:Wt})}return ft&&R&&Rt!==v?i.length&&Zp(i[i.length-1].value,v,vE(v,mt,n))?i[i.length-1].value=v:i.push({value:v}):(!ft||Rt===v)&&i.push({value:Rt}),i}function vE(n,t,{horizontal:i,minRotation:l}){const c=Jl(l),d=(i?Math.sin(c):Math.cos(c))||.001,_=.75*t*(""+n).length;return Math.min(t/d,_)}class gg extends Pd{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,i){return rn(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:i,maxDefined:l}=this.getUserBounds();let{min:c,max:d}=this;const _=r=>c=i?c:r,v=r=>d=l?d:r;if(t){const r=Vc(c),E=Vc(d);r<0&&E<0?v(0):r>0&&E>0&&_(0)}if(c===d){let r=d===0?1:Math.abs(d*.05);v(d+r),t||_(c-r)}this.min=c,this.max=d}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:i,stepSize:l}=t,c;return l?(c=Math.ceil(this.max/l)-Math.floor(this.min/l)+1,c>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${l} would result generating up to ${c} ticks. Limiting to 1000.`),c=1e3)):(c=this.computeTickLimit(),i=i||11),i&&(c=Math.min(i,c)),c}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,i=t.ticks;let l=this.getTickLimit();l=Math.max(2,l);const c={maxTicks:l,bounds:t.bounds,min:t.min,max:t.max,precision:i.precision,step:i.stepSize,count:i.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:i.minRotation||0,includeBounds:i.includeBounds!==!1},d=this._range||this,_=q5(c,d);return t.bounds==="ticks"&&HM(_,this,"value"),t.reverse?(_.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),_}configure(){const t=this.ticks;let i=this.min,l=this.max;if(super.configure(),this.options.offset&&t.length){const c=(l-i)/Math.max(t.length-1,1)/2;i-=c,l+=c}this._startValue=i,this._endValue=l,this._valueRange=l-i}getLabelForValue(t){return Tm(t,this.chart.options.locale,this.options.ticks.format)}}class X5 extends gg{static id="linear";static defaults={ticks:{callback:zg.formatters.numeric}};determineDataLimits(){const{min:t,max:i}=this.getMinMax(!0);this.min=js(t)?t:0,this.max=js(i)?i:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),i=t?this.width:this.height,l=Jl(this.options.ticks.minRotation),c=(t?Math.sin(l):Math.cos(l))||.001,d=this._resolveTickFontOptions(0);return Math.ceil(i/Math.min(40,d.lineHeight/c))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const mm=n=>Math.floor(hh(n)),od=(n,t)=>Math.pow(10,mm(n)+t);function xE(n){return n/Math.pow(10,mm(n))===1}function bE(n,t,i){const l=Math.pow(10,i),c=Math.floor(n/l);return Math.ceil(t/l)-c}function K5(n,t){const i=t-n;let l=mm(i);for(;bE(n,t,l)>10;)l++;for(;bE(n,t,l)<10;)l--;return Math.min(l,mm(n))}function Y5(n,{min:t,max:i}){t=Ia(n.min,t);const l=[],c=mm(t);let d=K5(t,i),_=d<0?Math.pow(10,Math.abs(d)):1;const v=Math.pow(10,d),r=c>d?Math.pow(10,c):0,E=Math.round((t-r)*_)/_,C=Math.floor((t-r)/v/10)*v*10;let z=Math.floor((E-C)/Math.pow(10,d)),R=Ia(n.min,Math.round((r+C+z*Math.pow(10,d))*_)/_);for(;R<i;)l.push({value:R,major:xE(R),significand:z}),z>=10?z=z<15?15:20:z++,z>=20&&(d++,z=2,_=d>=0?1:_),R=Math.round((r+C+z*Math.pow(10,d))*_)/_;const j=Ia(n.max,R);return l.push({value:j,major:xE(j),significand:z}),l}class J5 extends Pd{static id="logarithmic";static defaults={ticks:{callback:zg.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,i){const l=gg.prototype.parse.apply(this,[t,i]);if(l===0){this._zero=!0;return}return js(l)&&l>0?l:null}determineDataLimits(){const{min:t,max:i}=this.getMinMax(!0);this.min=js(t)?Math.max(0,t):null,this.max=js(i)?Math.max(0,i):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!js(this._userMin)&&(this.min=t===od(this.min,0)?od(this.min,-1):od(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:i}=this.getUserBounds();let l=this.min,c=this.max;const d=v=>l=t?l:v,_=v=>c=i?c:v;l===c&&(l<=0?(d(1),_(10)):(d(od(l,-1)),_(od(c,1)))),l<=0&&d(od(c,-1)),c<=0&&_(od(l,1)),this.min=l,this.max=c}buildTicks(){const t=this.options,i={min:this._userMin,max:this._userMax},l=Y5(i,this);return t.bounds==="ticks"&&HM(l,this,"value"),t.reverse?(l.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),l}getLabelForValue(t){return t===void 0?"0":Tm(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=hh(t),this._valueRange=hh(this.max)-hh(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(hh(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const i=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+i*this._valueRange)}}function vx(n){const t=n.ticks;if(t.display&&n.display){const i=To(t.backdropPadding);return Gi(t.font&&t.font.size,vs.font.size)+i.height}return 0}function Q5(n,t,i){return i=ys(i)?i:[i],{w:H3(n,t.string,i),h:i.length*t.lineHeight}}function wE(n,t,i,l,c){return n===l||n===c?{start:t-i/2,end:t+i/2}:n<l||n>c?{start:t-i,end:t}:{start:t,end:t+i}}function t4(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},i=Object.assign({},t),l=[],c=[],d=n._pointLabels.length,_=n.options.pointLabels,v=_.centerPointLabels?Sn/d:0;for(let r=0;r<d;r++){const E=_.setContext(n.getPointLabelContext(r));c[r]=E.padding;const C=n.getPointPosition(r,n.drawingArea+c[r],v),z=Sr(E.font),R=Q5(n.ctx,z,n._pointLabels[r]);l[r]=R;const j=mo(n.getIndexAngle(r)+v),G=Math.round(o0(j)),W=wE(G,C.x,R.w,0,180),Q=wE(G,C.y,R.h,90,270);e4(i,t,j,W,Q)}n.setCenterPoint(t.l-i.l,i.r-t.r,t.t-i.t,i.b-t.b),n._pointLabelItems=s4(n,l,c)}function e4(n,t,i,l,c){const d=Math.abs(Math.sin(i)),_=Math.abs(Math.cos(i));let v=0,r=0;l.start<t.l?(v=(t.l-l.start)/d,n.l=Math.min(n.l,t.l-v)):l.end>t.r&&(v=(l.end-t.r)/d,n.r=Math.max(n.r,t.r+v)),c.start<t.t?(r=(t.t-c.start)/_,n.t=Math.min(n.t,t.t-r)):c.end>t.b&&(r=(c.end-t.b)/_,n.b=Math.max(n.b,t.b+r))}function i4(n,t,i){const l=n.drawingArea,{extra:c,additionalAngle:d,padding:_,size:v}=i,r=n.getPointPosition(t,l+c+_,d),E=Math.round(o0(mo(r.angle+Ks))),C=a4(r.y,v.h,E),z=r4(E),R=o4(r.x,v.w,z);return{visible:!0,x:r.x,y:C,textAlign:z,left:R,top:C,right:R+v.w,bottom:C+v.h}}function n4(n,t){if(!t)return!0;const{left:i,top:l,right:c,bottom:d}=n;return!(Lu({x:i,y:l},t)||Lu({x:i,y:d},t)||Lu({x:c,y:l},t)||Lu({x:c,y:d},t))}function s4(n,t,i){const l=[],c=n._pointLabels.length,d=n.options,{centerPointLabels:_,display:v}=d.pointLabels,r={extra:vx(d)/2,additionalAngle:_?Sn/c:0};let E;for(let C=0;C<c;C++){r.padding=i[C],r.size=t[C];const z=i4(n,C,r);l.push(z),v==="auto"&&(z.visible=n4(z,E),z.visible&&(E=z))}return l}function r4(n){return n===0||n===180?"center":n<180?"left":"right"}function o4(n,t,i){return i==="right"?n-=t:i==="center"&&(n-=t/2),n}function a4(n,t,i){return i===90||i===270?n-=t/2:(i>270||i<90)&&(n-=t),n}function l4(n,t,i){const{left:l,top:c,right:d,bottom:_}=i,{backdropColor:v}=t;if(!rn(v)){const r=xd(t.borderRadius),E=To(t.backdropPadding);n.fillStyle=v;const C=l-E.left,z=c-E.top,R=d-l+E.width,j=_-c+E.height;Object.values(r).some(G=>G!==0)?(n.beginPath(),fm(n,{x:C,y:z,w:R,h:j,radius:r}),n.fill()):n.fillRect(C,z,R,j)}}function c4(n,t){const{ctx:i,options:{pointLabels:l}}=n;for(let c=t-1;c>=0;c--){const d=n._pointLabelItems[c];if(!d.visible)continue;const _=l.setContext(n.getPointLabelContext(c));l4(i,_,d);const v=Sr(_.font),{x:r,y:E,textAlign:C}=d;Ed(i,n._pointLabels[c],r,E+v.lineHeight/2,v,{color:_.color,textAlign:C,textBaseline:"middle"})}}function NC(n,t,i,l){const{ctx:c}=n;if(i)c.arc(n.xCenter,n.yCenter,t,0,ds);else{let d=n.getPointPosition(0,t);c.moveTo(d.x,d.y);for(let _=1;_<l;_++)d=n.getPointPosition(_,t),c.lineTo(d.x,d.y)}}function u4(n,t,i,l,c){const d=n.ctx,_=t.circular,{color:v,lineWidth:r}=t;!_&&!l||!v||!r||i<0||(d.save(),d.strokeStyle=v,d.lineWidth=r,d.setLineDash(c.dash||[]),d.lineDashOffset=c.dashOffset,d.beginPath(),NC(n,i,_,l),d.closePath(),d.stroke(),d.restore())}function h4(n,t,i){return Sh(n,{label:i,index:t,type:"pointLabel"})}class d4 extends gg{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:zg.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=To(vx(this.options)/2),i=this.width=this.maxWidth-t.width,l=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+i/2+t.left),this.yCenter=Math.floor(this.top+l/2+t.top),this.drawingArea=Math.floor(Math.min(i,l)/2)}determineDataLimits(){const{min:t,max:i}=this.getMinMax(!1);this.min=js(t)&&!isNaN(t)?t:0,this.max=js(i)&&!isNaN(i)?i:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/vx(this.options))}generateTickLabels(t){gg.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((i,l)=>{const c=as(this.options.pointLabels.callback,[i,l],this);return c||c===0?c:""}).filter((i,l)=>this.chart.getDataVisibility(l))}fit(){const t=this.options;t.display&&t.pointLabels.display?t4(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,i,l,c){this.xCenter+=Math.floor((t-i)/2),this.yCenter+=Math.floor((l-c)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,i,l,c))}getIndexAngle(t){const i=ds/(this._pointLabels.length||1),l=this.options.startAngle||0;return mo(t*i+Jl(l))}getDistanceFromCenterForValue(t){if(rn(t))return NaN;const i=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*i:(t-this.min)*i}getValueForDistanceFromCenter(t){if(rn(t))return NaN;const i=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-i:this.min+i}getPointLabelContext(t){const i=this._pointLabels||[];if(t>=0&&t<i.length){const l=i[t];return h4(this.getContext(),t,l)}}getPointPosition(t,i,l=0){const c=this.getIndexAngle(t)-Ks+l;return{x:Math.cos(c)*i+this.xCenter,y:Math.sin(c)*i+this.yCenter,angle:c}}getPointPositionForValue(t,i){return this.getPointPosition(t,this.getDistanceFromCenterForValue(i))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:i,top:l,right:c,bottom:d}=this._pointLabelItems[t];return{left:i,top:l,right:c,bottom:d}}drawBackground(){const{backgroundColor:t,grid:{circular:i}}=this.options;if(t){const l=this.ctx;l.save(),l.beginPath(),NC(this,this.getDistanceFromCenterForValue(this._endValue),i,this._pointLabels.length),l.closePath(),l.fillStyle=t,l.fill(),l.restore()}}drawGrid(){const t=this.ctx,i=this.options,{angleLines:l,grid:c,border:d}=i,_=this._pointLabels.length;let v,r,E;if(i.pointLabels.display&&c4(this,_),c.display&&this.ticks.forEach((C,z)=>{if(z!==0||z===0&&this.min<0){r=this.getDistanceFromCenterForValue(C.value);const R=this.getContext(z),j=c.setContext(R),G=d.setContext(R);u4(this,j,r,_,G)}}),l.display){for(t.save(),v=_-1;v>=0;v--){const C=l.setContext(this.getPointLabelContext(v)),{color:z,lineWidth:R}=C;!R||!z||(t.lineWidth=R,t.strokeStyle=z,t.setLineDash(C.borderDash),t.lineDashOffset=C.borderDashOffset,r=this.getDistanceFromCenterForValue(i.reverse?this.min:this.max),E=this.getPointPosition(v,r),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(E.x,E.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,i=this.options,l=i.ticks;if(!l.display)return;const c=this.getIndexAngle(0);let d,_;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(c),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((v,r)=>{if(r===0&&this.min>=0&&!i.reverse)return;const E=l.setContext(this.getContext(r)),C=Sr(E.font);if(d=this.getDistanceFromCenterForValue(this.ticks[r].value),E.showLabelBackdrop){t.font=C.string,_=t.measureText(v.label).width,t.fillStyle=E.backdropColor;const z=To(E.backdropPadding);t.fillRect(-_/2-z.left,-d-C.size/2-z.top,_+z.width,C.size+z.height)}Ed(t,v.label,0,-d,C,{color:E.color,strokeColor:E.textStrokeColor,strokeWidth:E.textStrokeWidth})}),t.restore()}drawTitle(){}}const Vg={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},ca=Object.keys(Vg);function TE(n,t){return n-t}function EE(n,t){if(rn(t))return null;const i=n._adapter,{parser:l,round:c,isoWeekday:d}=n._parseOpts;let _=t;return typeof l=="function"&&(_=l(_)),js(_)||(_=typeof l=="string"?i.parse(_,l):i.parse(_)),_===null?null:(c&&(_=c==="week"&&(Pf(d)||d===!0)?i.startOf(_,"isoWeek",d):i.startOf(_,c)),+_)}function SE(n,t,i,l){const c=ca.length;for(let d=ca.indexOf(n);d<c-1;++d){const _=Vg[ca[d]],v=_.steps?_.steps:Number.MAX_SAFE_INTEGER;if(_.common&&Math.ceil((i-t)/(v*_.size))<=l)return ca[d]}return ca[c-1]}function f4(n,t,i,l,c){for(let d=ca.length-1;d>=ca.indexOf(i);d--){const _=ca[d];if(Vg[_].common&&n._adapter.diff(c,l,_)>=t-1)return _}return ca[i?ca.indexOf(i):0]}function p4(n){for(let t=ca.indexOf(n)+1,i=ca.length;t<i;++t)if(Vg[ca[t]].common)return ca[t]}function ME(n,t,i){if(!i)n[t]=!0;else if(i.length){const{lo:l,hi:c}=a0(i,t),d=i[l]>=t?i[l]:i[c];n[d]=!0}}function m4(n,t,i,l){const c=n._adapter,d=+c.startOf(t[0].value,l),_=t[t.length-1].value;let v,r;for(v=d;v<=_;v=+c.add(v,1,l))r=i[v],r>=0&&(t[r].major=!0);return t}function CE(n,t,i){const l=[],c={},d=t.length;let _,v;for(_=0;_<d;++_)v=t[_],c[v]=_,l.push({value:v,major:!1});return d===0||!i?l:m4(n,l,c,i)}class xx extends Pd{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,i={}){const l=t.time||(t.time={}),c=this._adapter=new _B._date(t.adapters.date);c.init(i),Wp(l.displayFormats,c.formats()),this._parseOpts={parser:l.parser,round:l.round,isoWeekday:l.isoWeekday},super.init(t),this._normalized=i.normalized}parse(t,i){return t===void 0?null:EE(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,i=this._adapter,l=t.time.unit||"day";let{min:c,max:d,minDefined:_,maxDefined:v}=this.getUserBounds();function r(E){!_&&!isNaN(E.min)&&(c=Math.min(c,E.min)),!v&&!isNaN(E.max)&&(d=Math.max(d,E.max))}(!_||!v)&&(r(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&r(this.getMinMax(!1))),c=js(c)&&!isNaN(c)?c:+i.startOf(Date.now(),l),d=js(d)&&!isNaN(d)?d:+i.endOf(Date.now(),l)+1,this.min=Math.min(c,d-1),this.max=Math.max(c+1,d)}_getLabelBounds(){const t=this.getLabelTimestamps();let i=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY;return t.length&&(i=t[0],l=t[t.length-1]),{min:i,max:l}}buildTicks(){const t=this.options,i=t.time,l=t.ticks,c=l.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&c.length&&(this.min=this._userMin||c[0],this.max=this._userMax||c[c.length-1]);const d=this.min,_=this.max,v=z3(c,d,_);return this._unit=i.unit||(l.autoSkip?SE(i.minUnit,this.min,this.max,this._getLabelCapacity(d)):f4(this,v.length,i.minUnit,this.min,this.max)),this._majorUnit=!l.major.enabled||this._unit==="year"?void 0:p4(this._unit),this.initOffsets(c),t.reverse&&v.reverse(),CE(this,v,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let i=0,l=0,c,d;this.options.offset&&t.length&&(c=this.getDecimalForValue(t[0]),t.length===1?i=1-c:i=(this.getDecimalForValue(t[1])-c)/2,d=this.getDecimalForValue(t[t.length-1]),t.length===1?l=d:l=(d-this.getDecimalForValue(t[t.length-2]))/2);const _=t.length<3?.5:.25;i=Fr(i,0,_),l=Fr(l,0,_),this._offsets={start:i,end:l,factor:1/(i+1+l)}}_generate(){const t=this._adapter,i=this.min,l=this.max,c=this.options,d=c.time,_=d.unit||SE(d.minUnit,i,l,this._getLabelCapacity(i)),v=Gi(c.ticks.stepSize,1),r=_==="week"?d.isoWeekday:!1,E=Pf(r)||r===!0,C={};let z=i,R,j;if(E&&(z=+t.startOf(z,"isoWeek",r)),z=+t.startOf(z,E?"day":_),t.diff(l,i,_)>1e5*v)throw new Error(i+" and "+l+" are too far apart with stepSize of "+v+" "+_);const G=c.ticks.source==="data"&&this.getDataTimestamps();for(R=z,j=0;R<l;R=+t.add(R,v,_),j++)ME(C,R,G);return(R===l||c.bounds==="ticks"||j===1)&&ME(C,R,G),Object.keys(C).sort(TE).map(W=>+W)}getLabelForValue(t){const i=this._adapter,l=this.options.time;return l.tooltipFormat?i.format(t,l.tooltipFormat):i.format(t,l.displayFormats.datetime)}format(t,i){const c=this.options.time.displayFormats,d=this._unit,_=i||c[d];return this._adapter.format(t,_)}_tickFormatFunction(t,i,l,c){const d=this.options,_=d.ticks.callback;if(_)return as(_,[t,i,l],this);const v=d.time.displayFormats,r=this._unit,E=this._majorUnit,C=r&&v[r],z=E&&v[E],R=l[i],j=E&&z&&R&&R.major;return this._adapter.format(t,c||(j?z:C))}generateTickLabels(t){let i,l,c;for(i=0,l=t.length;i<l;++i)c=t[i],c.label=this._tickFormatFunction(c.value,i,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const i=this._offsets,l=this.getDecimalForValue(t);return this.getPixelForDecimal((i.start+l)*i.factor)}getValueForPixel(t){const i=this._offsets,l=this.getDecimalForPixel(t)/i.factor-i.end;return this.min+l*(this.max-this.min)}_getLabelSize(t){const i=this.options.ticks,l=this.ctx.measureText(t).width,c=Jl(this.isHorizontal()?i.maxRotation:i.minRotation),d=Math.cos(c),_=Math.sin(c),v=this._resolveTickFontOptions(0).size;return{w:l*d+v*_,h:l*_+v*d}}_getLabelCapacity(t){const i=this.options.time,l=i.displayFormats,c=l[i.unit]||l.millisecond,d=this._tickFormatFunction(t,0,CE(this,[t],this._majorUnit),c),_=this._getLabelSize(d),v=Math.floor(this.isHorizontal()?this.width/_.w:this.height/_.h)-1;return v>0?v:1}getDataTimestamps(){let t=this._cache.data||[],i,l;if(t.length)return t;const c=this.getMatchingVisibleMetas();if(this._normalized&&c.length)return this._cache.data=c[0].controller.getAllParsedValues(this);for(i=0,l=c.length;i<l;++i)t=t.concat(c[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let i,l;if(t.length)return t;const c=this.getLabels();for(i=0,l=c.length;i<l;++i)t.push(EE(this,c[i]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return KM(t.sort(TE))}}function C_(n,t,i){let l=0,c=n.length-1,d,_,v,r;i?(t>=n[l].pos&&t<=n[c].pos&&({lo:l,hi:c}=Iu(n,"pos",t)),{pos:d,time:v}=n[l],{pos:_,time:r}=n[c]):(t>=n[l].time&&t<=n[c].time&&({lo:l,hi:c}=Iu(n,"time",t)),{time:d,pos:v}=n[l],{time:_,pos:r}=n[c]);const E=_-d;return E?v+(r-v)*(t-d)/E:v}class _4 extends xx{static id="timeseries";static defaults=xx.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),i=this._table=this.buildLookupTable(t);this._minPos=C_(i,this.min),this._tableRange=C_(i,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:i,max:l}=this,c=[],d=[];let _,v,r,E,C;for(_=0,v=t.length;_<v;++_)E=t[_],E>=i&&E<=l&&c.push(E);if(c.length<2)return[{time:i,pos:0},{time:l,pos:1}];for(_=0,v=c.length;_<v;++_)C=c[_+1],r=c[_-1],E=c[_],Math.round((C+r)/2)!==E&&d.push({time:E,pos:_/(v-1)});return d}_generate(){const t=this.min,i=this.max;let l=super.getDataTimestamps();return(!l.includes(t)||!l.length)&&l.splice(0,0,t),(!l.includes(i)||l.length===1)&&l.push(i),l.sort((c,d)=>c-d)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const i=this.getDataTimestamps(),l=this.getLabelTimestamps();return i.length&&l.length?t=this.normalize(i.concat(l)):t=i.length?i:l,t=this._cache.all=t,t}getDecimalForValue(t){return(C_(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const i=this._offsets,l=this.getDecimalForPixel(t)/i.factor-i.end;return C_(this._table,l*this._tableRange+this._minPos,!0)}}var g4=Object.freeze({__proto__:null,CategoryScale:H5,LinearScale:X5,LogarithmicScale:J5,RadialLinearScale:d4,TimeScale:xx,TimeSeriesScale:_4});const y4=[mB,qF,$5,g4];y0.register(...y4);const v4=[{max:3.2,fare:1.19},{max:4.2,fare:1.29},{max:5.2,fare:1.4},{max:6.2,fare:1.5},{max:7.2,fare:1.59},{max:8.2,fare:1.66},{max:9.2,fare:1.73},{max:10.2,fare:1.77},{max:11.2,fare:1.81},{max:12.2,fare:1.85},{max:13.2,fare:1.89},{max:14.2,fare:1.93},{max:15.2,fare:1.98},{max:16.2,fare:2.02},{max:17.2,fare:2.06},{max:18.2,fare:2.1},{max:19.2,fare:2.14},{max:20.2,fare:2.17},{max:21.2,fare:2.2},{max:22.2,fare:2.23},{max:23.2,fare:2.26},{max:24.2,fare:2.28},{max:25.2,fare:2.3},{max:26.2,fare:2.32},{max:27.2,fare:2.33},{max:28.2,fare:2.34},{max:29.2,fare:2.35},{max:30.2,fare:2.36},{max:31.2,fare:2.37},{max:32.2,fare:2.38},{max:33.2,fare:2.39},{max:34.2,fare:2.4},{max:35.2,fare:2.41},{max:36.2,fare:2.42},{max:37.2,fare:2.43},{max:38.2,fare:2.44},{max:39.2,fare:2.45},{max:40.2,fare:2.46},{max:1/0,fare:2.47}],x4=[{max:3.2,fare:.52},{max:4.2,fare:.57},{max:5.2,fare:.63},{max:6.2,fare:.68},{max:7.2,fare:.71},{max:1/0,fare:.74}],b4=[{max:3.2,fare:.69},{max:4.2,fare:.76},{max:5.2,fare:.84},{max:6.2,fare:.91},{max:7.2,fare:.97},{max:1/0,fare:1.03}],w4=[{max:3.2,fare:.78},{max:4.2,fare:.86},{max:5.2,fare:.95},{max:6.2,fare:1.03},{max:7.2,fare:1.1},{max:8.2,fare:1.16},{max:9.2,fare:1.22},{max:10.2,fare:1.25},{max:11.2,fare:1.28},{max:12.2,fare:1.31},{max:13.2,fare:1.34},{max:14.2,fare:1.37},{max:15.2,fare:1.4},{max:16.2,fare:1.43},{max:17.2,fare:1.46},{max:18.2,fare:1.49},{max:19.2,fare:1.52},{max:20.2,fare:1.55},{max:21.2,fare:1.58},{max:22.2,fare:1.61},{max:23.2,fare:1.64},{max:24.2,fare:1.66},{max:25.2,fare:1.67},{max:26.2,fare:1.68},{max:27.2,fare:1.69},{max:28.2,fare:1.7},{max:29.2,fare:1.71},{max:30.2,fare:1.72},{max:31.2,fare:1.73},{max:32.2,fare:1.74},{max:33.2,fare:1.75},{max:34.2,fare:1.76},{max:35.2,fare:1.77},{max:36.2,fare:1.78},{max:37.2,fare:1.79},{max:38.2,fare:1.8},{max:39.2,fare:1.81},{max:40.2,fare:1.82},{max:1/0,fare:1.83}],AE={train:{primary:21,secondary:26.5,polytechnic:26.5,university:48,ns:48,senior:58,disability:58,workfare:96,adult:128},bus:{primary:24,secondary:29,polytechnic:29,university:55.5,ns:55.5,senior:58,disability:58,workfare:96,adult:128},hybrid:{primary:39,secondary:49,polytechnic:49,university:81,ns:81,senior:58,disability:58,workfare:96,adult:128}};function T4(n){switch(n){case"primary":case"secondary":case"polytechnic":return x4;case"senior":case"disability":return b4;case"workfare":return w4;case"university":case"ns":case"adult":default:return v4}}function jC(n,t){const i=T4(t);for(const l of i)if(n<=l.max)return l.fare;return i[i.length-1].fare}function E4({distanceKm:n,type:t,dailyTrips:i,workingDays:l}){const c=jC(n,t),d=c*i*l,v=["train","bus","hybrid"].map(r=>{const E=AE[r][t]??AE[r].adult,C=d-E;return{mode:r,passPrice:E,savings:C,worth:C>0}});return{singleFare:c,monthlyTotal:d,breakdown:v}}function S4(){return{fareByType:jC,analyseMonthlyPass:E4}}const M4={class:"section-card"},C4={class:"col-md-4"},A4=["value"],P4={class:"col-md-4"},k4=["value"],I4={class:"col-md-4"},L4=["value"],D4={class:"col-12 d-flex flex-wrap align-items-center gap-2"},z4={class:"btn btn-primary",type:"submit"},O4={key:0,class:"text-warning small d-flex align-items-center gap-1"},R4={key:0,class:"mt-4 feature-result-animate"},B4={class:"row g-3"},F4={class:"col-lg-4"},N4={class:"fare-result-card h-100"},j4={class:"fare-result-amount"},V4={class:"fare-result-commuter"},U4={class:"list-unstyled mt-4 mb-0 small text-muted"},$4={class:"d-flex align-items-center gap-2 mb-2"},W4={class:"d-flex align-items-center gap-2 mb-2"},Z4={class:"d-flex align-items-center gap-2"},G4={class:"col-lg-8"},H4={class:"fare-route-card h-100"},q4={class:"d-flex justify-content-between align-items-center mb-3"},X4={class:"badge bg-light text-muted border"},K4={class:"d-flex justify-content-between align-items-center flex-wrap gap-2"},Y4={class:"d-flex align-items-center gap-2 mb-1"},J4={class:"badge rounded-pill bg-secondary-subtle text-secondary"},Q4={class:"fw-semibold"},tN={key:1,class:"mt-4"},eN={class:"row g-3 align-items-end"},iN={class:"col-md-4"},nN={class:"col-md-4"},sN={class:"col-md-4"},rN={class:"info-pill"},oN={class:"fw-semibold"},aN={key:0,class:"row g-3 mt-1"},lN={class:"col-lg-4"},cN={class:"card border-0 shadow-sm h-100"},uN={class:"card-body"},hN={key:0,class:"fw-semibold mb-2"},dN={class:"mb-1"},fN={class:"mb-0"},pN={class:"col-lg-8"},mN={class:"card border-0 shadow-sm h-100"},_N={class:"card-body"},gN={class:"chart-wrapper"},yN={class:"col-12"},vN={class:"table-responsive shadow-sm border rounded-3"},xN={class:"table align-middle mb-0"},bN={class:"text-center"},wN={key:0,class:"badge bg-success-subtle text-success-emphasis px-3"},TN={key:1,class:"badge bg-danger-subtle text-danger-emphasis px-3"},EN={key:2,class:"alert alert-danger mt-4"},SN={__name:"FareCalculator",setup(n){const{allStations:t,shortestPath:i,estimateDistanceKm:l,estimateTimeMinutes:c,summariseSegments:d}=e0(),{fareByType:_,analyseMonthlyPass:v}=S4(),r=[{value:"adult",label:"Adult"},{value:"primary",label:"Primary School Student"},{value:"secondary",label:"Secondary School Student"},{value:"polytechnic",label:"Polytechnic Student"},{value:"university",label:"University Student"},{value:"ns",label:"National Serviceman"},{value:"senior",label:"Senior Citizen"},{value:"disability",label:"Person with Disabilities"},{value:"workfare",label:"Workfare Concession"}],E={NSL:{name:"North South Line"},EWL:{name:"East West Line"},CGL:{name:"Changi Airport Branch"},DTL:{name:"Downtown Line"},CCL:{name:"Circle Line"},NEL:{name:"North East Line"},TEL:{name:"ThomsonEast Coast Line"},BPL:{name:"Bukit Panjang LRT"},SWPL:{name:"Sengkang West LRT"},SEPL:{name:"Sengkang East LRT"},PEPLRT:{name:"Punggol East LRT"},PWLRT:{name:"Punggol West LRT"}},C={train:"Train-only",bus:"Bus-only",hybrid:"Hybrid (Bus + Train)"},z=Yi("Jurong East"),R=Yi("City Hall"),j=Yi("adult"),G=Yi(null),W=Yi(null),Q=Yi(""),rt=Yi(!1),ft=Yi(2),xt=Yi(22),mt=Yi(null);let bt=null;const Ot=new Intl.NumberFormat("en-SG",{style:"currency",currency:"SGD",currencyDisplay:"narrowSymbol",minimumFractionDigits:2}),zt=Er(()=>r.find($t=>$t.value===j.value)?.label??"Adult"),Rt=Er(()=>Math.max(0,ft.value*xt.value*2)),Bt=Er(()=>W.value?W.value.breakdown.reduce(($t,ce)=>$t?ce.savings>$t.savings?ce:$t:ce,null):null);function Nt($t){return Ot.format($t)}function ee($t){const ce=Ot.format(Math.abs($t));return`${$t>=0?"+":""}${ce}`}function Wt($t){return E[$t]?.name??$t}function ae($t){return $t?`line-${$t.toLowerCase()}`:""}function ye($t){return C[$t]??$t}function He(){if(Q.value="",W.value=null,z.value===R.value){G.value=null,oe(),Q.value="Please choose two different stations.",rt.value=!1;return}const $t=i(z.value,R.value);if(!$t){G.value=null,oe(),Q.value="No valid MRT route found between these stations.",rt.value=!1;return}const ce=l($t.totalWeight),Ve=c($t.totalWeight),je=d($t)??[],Xe=je.reduce((Ii,Qe)=>Ii+Qe.stops,0),ri=Math.max(0,je.length-1),vi=_(ce,j.value);G.value={fare:vi,distanceKm:ce,minutes:Ve,segments:je,totalStops:Xe,transfers:ri},rt.value=!1,de()}function de(){if(!G.value){W.value=null,oe();return}W.value=v({distanceKm:G.value.distanceKm,type:j.value,dailyTrips:ft.value,workingDays:xt.value}),he(W.value)}function he($t){if(!$t||!mt.value){oe();return}const ce=$t.breakdown.map(je=>ye(je.mode)),Ve=$t.breakdown.map(je=>Number(je.savings.toFixed(2)));bt&&bt.destroy(),bt=new y0(mt.value,{type:"bar",data:{labels:ce,datasets:[{label:"Net savings vs monthly pass ($)",data:Ve,backgroundColor:Ve.map(je=>je>=0?"rgba(25,135,84,0.6)":"rgba(220,53,69,0.65)"),borderRadius:8,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label(je){const Xe=je.parsed?.y??0,ri=Ot.format(Math.abs(Xe));return`${Xe>=0?"+":""}${ri}`}}}},scales:{y:{ticks:{callback(je){return typeof je=="number"?Ot.format(je):je}},grid:{color:"rgba(0,0,0,0.05)"}},x:{grid:{display:!1}}}}})}function oe(){bt&&(bt.destroy(),bt=null)}function Oe(){z.value="Jurong East",R.value="City Hall",j.value="adult",G.value=null,W.value=null,Q.value="",ft.value=2,xt.value=22,rt.value=!1,oe()}function Ue(){[z.value,R.value]=[R.value,z.value]}return qr([z,R,j],()=>{G.value&&(rt.value=!0)}),qr(j,()=>{G.value&&He()}),KO([ft,xt],()=>{G.value&&de()},{debounce:300,maxWait:800}),Cd(()=>{oe()}),($t,ce)=>(Ye(),ii("section",M4,[ce[29]||(ce[29]=ht("h2",{class:"section-title mb-3"},"Fare Calculator",-1)),ce[30]||(ce[30]=ht("p",{class:"text-muted"}," Distance-based fares with the latest LTA tables. Estimate concession pricing, understand line changes, and see whether a monthly pass could save you more. ",-1)),ht("form",{class:"row g-3 align-items-end",onSubmit:md(He,["prevent"])},[ht("div",C4,[ce[5]||(ce[5]=ht("label",{class:"form-label",for:"fareStart"},"From",-1)),ar(ht("select",{id:"fareStart","onUpdate:modelValue":ce[0]||(ce[0]=Ve=>z.value=Ve),class:"form-select"},[(Ye(!0),ii(an,null,gs(es(t),Ve=>(Ye(),ii("option",{key:Ve,value:Ve},Ge(Ve),9,A4))),128))],512),[[jc,z.value]])]),ht("div",P4,[ce[6]||(ce[6]=ht("label",{class:"form-label",for:"fareEnd"},"To",-1)),ar(ht("select",{id:"fareEnd","onUpdate:modelValue":ce[1]||(ce[1]=Ve=>R.value=Ve),class:"form-select"},[(Ye(!0),ii(an,null,gs(es(t),Ve=>(Ye(),ii("option",{key:Ve,value:Ve},Ge(Ve),9,k4))),128))],512),[[jc,R.value]])]),ht("div",I4,[ce[7]||(ce[7]=ht("label",{class:"form-label",for:"commuterType"},"Commuter Type",-1)),ar(ht("select",{id:"commuterType","onUpdate:modelValue":ce[2]||(ce[2]=Ve=>j.value=Ve),class:"form-select"},[(Ye(),ii(an,null,gs(r,Ve=>ht("option",{key:Ve.value,value:Ve.value},Ge(Ve.label),9,L4)),64))],512),[[jc,j.value]])]),ht("div",D4,[ht("button",z4,[ce[8]||(ce[8]=ht("span",{class:"material-icons me-1"},"attach_money",-1)),sn(" "+Ge(G.value?"Recalculate":"Calculate fare"),1)]),ht("button",{class:"btn btn-outline-secondary",type:"button",onClick:Ue},[...ce[9]||(ce[9]=[ht("span",{class:"material-icons me-1"},"swap_horiz",-1),sn(" Swap stations ",-1)])]),ht("button",{class:"btn btn-outline-danger",type:"button",onClick:Oe},[...ce[10]||(ce[10]=[ht("span",{class:"material-icons me-1"},"restart_alt",-1),sn(" Reset ",-1)])]),rt.value?(Ye(),ii("span",O4,[...ce[11]||(ce[11]=[ht("span",{class:"material-icons fs-6 align-middle"},"info",-1),sn(" Inputs changed  calculate again to refresh. ",-1)])])):cr("",!0)])],32),G.value?(Ye(),ii("div",R4,[ht("div",B4,[ht("div",F4,[ht("div",N4,[ht("div",j4,Ge(Nt(G.value.fare)),1),ht("div",V4,Ge(zt.value),1),ht("ul",U4,[ht("li",$4,[ce[12]||(ce[12]=ht("span",{class:"material-icons text-primary"},"train",-1)),ht("span",null,Ge(z.value)+"  "+Ge(R.value),1)]),ht("li",W4,[ce[13]||(ce[13]=ht("span",{class:"material-icons text-primary"},"route",-1)),ht("span",null,Ge(G.value.distanceKm)+" km  "+Ge(G.value.totalStops)+" "+Ge(G.value.totalStops===1?"stop":"stops"),1)]),ht("li",Z4,[ce[14]||(ce[14]=ht("span",{class:"material-icons text-primary"},"schedule",-1)),ht("span",null,Ge(G.value.minutes)+" minutes  "+Ge(G.value.transfers)+" "+Ge(G.value.transfers===1?"transfer":"transfers"),1)])])])]),ht("div",G4,[ht("div",H4,[ht("div",q4,[ce[15]||(ce[15]=ht("h5",{class:"mb-0"},"Route overview",-1)),ht("span",X4,Ge(G.value.segments.length)+" "+Ge(G.value.segments.length===1?"segment":"segments"),1)]),ce[16]||(ce[16]=ht("p",{class:"text-muted small mb-3"}," We recommend the quickest MRT path. Look out for Transfer badges to change lines with minimal walking. ",-1)),(Ye(!0),ii(an,null,gs(G.value.segments,Ve=>(Ye(),ii("div",{key:`${Ve.line}-${Ve.from}-${Ve.to}`,class:"route-segment"},[ht("div",K4,[ht("div",null,[ht("div",Y4,[ht("span",{class:$c(["route-line-badge",ae(Ve.line)])},Ge(Wt(Ve.line)),3),ht("span",J4,Ge(Ve.stops===0?"Transfer":`${Ve.stops} ${Ve.stops===1?"stop":"stops"}`),1)]),ht("div",Q4,Ge(Ve.from)+"  "+Ge(Ve.to),1)])])]))),128))])])])])):cr("",!0),G.value?(Ye(),ii("div",tN,[ce[28]||(ce[28]=ht("div",{class:"d-flex flex-wrap align-items-center gap-2 mb-3"},[ht("h5",{class:"mb-0"},"Monthly Pass Companion"),ht("span",{class:"badge bg-info-subtle text-info-emphasis"},"Auto-updates with your inputs")],-1)),ht("div",eN,[ht("div",iN,[ce[17]||(ce[17]=ht("label",{class:"form-label",for:"dailyTrips"},"Daily round trips",-1)),ar(ht("input",{id:"dailyTrips","onUpdate:modelValue":ce[3]||(ce[3]=Ve=>ft.value=Ve),type:"number",class:"form-control",min:"1",max:"10"},null,512),[[zc,ft.value,void 0,{number:!0}]]),ce[18]||(ce[18]=ht("small",{class:"text-muted"},"Two rides count as one round trip.",-1))]),ht("div",nN,[ce[19]||(ce[19]=ht("label",{class:"form-label",for:"workingDays"},"Working days / month",-1)),ar(ht("input",{id:"workingDays","onUpdate:modelValue":ce[4]||(ce[4]=Ve=>xt.value=Ve),type:"number",class:"form-control",min:"1",max:"31"},null,512),[[zc,xt.value,void 0,{number:!0}]]),ce[20]||(ce[20]=ht("small",{class:"text-muted"},"Include study days if you commute then.",-1))]),ht("div",sN,[ht("div",rN,[ce[22]||(ce[22]=ht("span",{class:"material-icons"},"equalizer",-1)),ht("div",null,[ht("div",oN,Ge(Rt.value)+" rides / month",1),ce[21]||(ce[21]=ht("div",{class:"small text-muted"},"Used for the monthly pass comparison.",-1))])])])]),W.value?(Ye(),ii("div",aN,[ht("div",lN,[ht("div",cN,[ht("div",uN,[ce[25]||(ce[25]=ht("h6",{class:"text-uppercase text-muted mb-2"},"Recommendation",-1)),Bt.value?(Ye(),ii("p",hN,[Bt.value.worth?(Ye(),ii(an,{key:0},[sn(" The "+Ge(ye(Bt.value.mode))+" pass could save "+Ge(Nt(Bt.value.savings))+" this month. ",1)],64)):(Ye(),ii(an,{key:1},[sn(" Stick to pay-per-ride  the "+Ge(ye(Bt.value.mode))+" pass costs "+Ge(Nt(Math.abs(Bt.value.savings)))+" more. ",1)],64))])):cr("",!0),ht("p",dN,[ce[23]||(ce[23]=ht("strong",null,"Single trip fare:",-1)),sn(" "+Ge(Nt(W.value.singleFare)),1)]),ht("p",fN,[ce[24]||(ce[24]=ht("strong",null,"Estimated monthly spend:",-1)),sn(" "+Ge(Nt(W.value.monthlyTotal)),1)])])])]),ht("div",pN,[ht("div",mN,[ht("div",_N,[ce[26]||(ce[26]=ht("h6",{class:"text-uppercase text-muted mb-2"},"Savings vs monthly passes",-1)),ht("div",gN,[ht("canvas",{ref_key:"passChartRef",ref:mt},null,512)])])])]),ht("div",yN,[ht("div",vN,[ht("table",xN,[ce[27]||(ce[27]=ht("thead",{class:"table-light"},[ht("tr",{class:"text-center"},[ht("th",{scope:"col"},"Pass type"),ht("th",{scope:"col"},"Pass price"),ht("th",{scope:"col"},"Net savings"),ht("th",{scope:"col"},"Recommendation")])],-1)),ht("tbody",bN,[(Ye(!0),ii(an,null,gs(W.value.breakdown,Ve=>(Ye(),ii("tr",{key:Ve.mode},[ht("td",null,Ge(ye(Ve.mode)),1),ht("td",null,Ge(Nt(Ve.passPrice)),1),ht("td",{class:$c(Ve.worth?"text-success fw-semibold":"text-danger fw-semibold")},Ge(ee(Ve.savings)),3),ht("td",null,[Ve.worth?(Ye(),ii("span",wN,"Worth it")):(Ye(),ii("span",TN,"Skip it"))])]))),128))])])])])])):cr("",!0)])):cr("",!0),Q.value?(Ye(),ii("div",EN,Ge(Q.value),1)):cr("",!0)]))}};var $_={exports:{}},MN=$_.exports,PE;function CN(){return PE||(PE=1,(function(n,t){var i={};(function(l,c){n.exports=c()})(MN,(function(){var l,c,d;function _(r,E){if(!l)l=E;else if(!c)c=E;else{var C="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+c+")(sharedChunk); self.onerror = null;",z={};l(z),d=E(z),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([C],{type:"text/javascript"})))}}_(["exports"],(function(r){var E=typeof self<"u"?self:{},C="2.15.0";let z;const R={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(z==null){const s=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{z=i.API_URL_REGEX!=null?new RegExp(i.API_URL_REGEX):s}catch{z=s}}return z},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!R.API_URL)return null;try{const s=new URL(R.API_URL);return s.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":s.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},j={supported:!1,testSupport:function(s){!Q&&W&&(rt?ft(s):G=s)}};let G,W,Q=!1,rt=!1;function ft(s){const e=s.createTexture();s.bindTexture(s.TEXTURE_2D,e);try{if(s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,W),s.isContextLost())return;j.supported=!0}catch{}s.deleteTexture(e),Q=!0}E.document&&(W=E.document.createElement("img"),W.onload=function(){G&&ft(G),G=null,rt=!0},W.onerror=function(){Q=!0,G=null},W.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const xt="01";function mt(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var bt=Ot;function Ot(s,e,a,u){this.cx=3*s,this.bx=3*(a-s)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(u-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=s,this.p1y=e,this.p2x=a,this.p2y=u}Ot.prototype={sampleCurveX:function(s){return((this.ax*s+this.bx)*s+this.cx)*s},sampleCurveY:function(s){return((this.ay*s+this.by)*s+this.cy)*s},sampleCurveDerivativeX:function(s){return(3*this.ax*s+2*this.bx)*s+this.cx},solveCurveX:function(s,e){if(e===void 0&&(e=1e-6),s<0)return 0;if(s>1)return 1;for(var a=s,u=0;u<8;u++){var p=this.sampleCurveX(a)-s;if(Math.abs(p)<e)return a;var y=this.sampleCurveDerivativeX(a);if(Math.abs(y)<1e-6)break;a-=p/y}var b=0,T=1;for(a=s,u=0;u<20&&(p=this.sampleCurveX(a),!(Math.abs(p-s)<e));u++)s>p?b=a:T=a,a=.5*(T-b)+b;return a},solve:function(s,e){return this.sampleCurveY(this.solveCurveX(s,e))}};var zt=mt(bt),Rt=Bt;function Bt(s,e){this.x=s,this.y=e}Bt.prototype={clone:function(){return new Bt(this.x,this.y)},add:function(s){return this.clone()._add(s)},sub:function(s){return this.clone()._sub(s)},multByPoint:function(s){return this.clone()._multByPoint(s)},divByPoint:function(s){return this.clone()._divByPoint(s)},mult:function(s){return this.clone()._mult(s)},div:function(s){return this.clone()._div(s)},rotate:function(s){return this.clone()._rotate(s)},rotateAround:function(s,e){return this.clone()._rotateAround(s,e)},matMult:function(s){return this.clone()._matMult(s)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(s){return this.x===s.x&&this.y===s.y},dist:function(s){return Math.sqrt(this.distSqr(s))},distSqr:function(s){var e=s.x-this.x,a=s.y-this.y;return e*e+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(s){return Math.atan2(this.y-s.y,this.x-s.x)},angleWith:function(s){return this.angleWithSep(s.x,s.y)},angleWithSep:function(s,e){return Math.atan2(this.x*e-this.y*s,this.x*s+this.y*e)},_matMult:function(s){var e=s[2]*this.x+s[3]*this.y;return this.x=s[0]*this.x+s[1]*this.y,this.y=e,this},_add:function(s){return this.x+=s.x,this.y+=s.y,this},_sub:function(s){return this.x-=s.x,this.y-=s.y,this},_mult:function(s){return this.x*=s,this.y*=s,this},_div:function(s){return this.x/=s,this.y/=s,this},_multByPoint:function(s){return this.x*=s.x,this.y*=s.y,this},_divByPoint:function(s){return this.x/=s.x,this.y/=s.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var s=this.y;return this.y=this.x,this.x=-s,this},_rotate:function(s){var e=Math.cos(s),a=Math.sin(s),u=a*this.x+e*this.y;return this.x=e*this.x-a*this.y,this.y=u,this},_rotateAround:function(s,e){var a=Math.cos(s),u=Math.sin(s),p=e.y+u*(this.x-e.x)+a*(this.y-e.y);return this.x=e.x+a*(this.x-e.x)-u*(this.y-e.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Bt.convert=function(s){return s instanceof Bt?s:Array.isArray(s)?new Bt(s[0],s[1]):s};var Nt=mt(Rt);const ee=Math.PI/180,Wt=180/Math.PI;function ae(s){return s*ee}function ye(s){return s*Wt}const He=[[0,0],[1,0],[1,1],[0,1]];function de(s){if(s<=0)return 0;if(s>=1)return 1;const e=s*s,a=e*s;return 4*(s<.5?a:3*(s-e)+a-.75)}function he(s,e,a,u){const p=new zt(s,e,a,u);return function(y){return p.solve(y)}}const oe=he(.25,.1,.25,1);function Oe(s,e,a){return Math.min(a,Math.max(e,s))}function Ue(s,e,a){return(a=Oe((a-s)/(e-s),0,1))*a*(3-2*a)}function $t(s,e,a){const u=a-e,p=((s-e)%u+u)%u+e;return p===e?a:p}function ce(s,e,a){if(!s.length)return a(null,[]);let u=s.length;const p=new Array(s.length);let y=null;s.forEach(((b,T)=>{e(b,((M,P)=>{M&&(y=M),p[T]=P,--u==0&&a(y,p)}))}))}function Ve(s){const e=[];for(const a in s)e.push(s[a]);return e}function je(s,...e){for(const a of e)for(const u in a)s[u]=a[u];return s}let Xe=1;function ri(){return Xe++}function vi(){return(function s(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,s)})()}function Ii(s){return s<=1?1:Math.pow(2,Math.ceil(Math.log(s)/Math.LN2))}function Qe(s){return!!s&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(s)}function _n(s,e){s.forEach((a=>{e[a]&&(e[a]=e[a].bind(e))}))}function ls(s,e){return s.indexOf(e,s.length-e.length)!==-1}function Tt(s,e,a){const u={};for(const p in s)u[p]=e.call(this,s[p],p,s);return u}function Ft(s,e,a){const u={};for(const p in s)e.call(a||this,s[p],p,s)&&(u[p]=s[p]);return u}function Jt(s){return Array.isArray(s)?s.map(Jt):typeof s=="object"&&s?Tt(s,Jt):s}const Se={};function me(s){Se[s]||(typeof console<"u"&&console.warn(s),Se[s]=!0)}function we(s,e,a){return(a.y-s.y)*(e.x-s.x)>(e.y-s.y)*(a.x-s.x)}function Ke(s){let e=0;for(let a,u,p=0,y=s.length,b=y-1;p<y;b=p++)a=s[p],u=s[b],e+=(u.x-a.x)*(a.y+u.y);return e}function $e(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Ne(s){const e={};if(s.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((a,u,p,y)=>{const b=p||y;return e[u]=!b||b.toLowerCase(),""})),e["max-age"]){const a=parseInt(e["max-age"],10);isNaN(a)?delete e["max-age"]:e["max-age"]=a}return e}let Re=null;function fi(s){if(Re==null){const e=s.navigator?s.navigator.userAgent:null;Re=!!s.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Re}function ti(s){try{const e=E[s];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function ci(s,e){return[s[4*e],s[4*e+1],s[4*e+2],s[4*e+3]]}const _i="mapbox-tiles";let Ei=500,Ji=50,Ri,Fn;function Mn(){try{return E.caches}catch{}}function zn(){Mn()&&!Ri&&(Ri=E.caches.open(_i))}function Vn(s){const e=s.indexOf("?");if(e<0)return s;const a=(function(p){const y=p.indexOf("?");return y>0?p.slice(y+1).split("&"):[]})(s),u=a.filter((p=>{const y=p.split("=");return y[0]==="language"||y[0]==="worldview"}));return u.length?`${s.slice(0,e)}?${u.join("&")}`:s.slice(0,e)}let Us=1/0;const Mr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Mr);class Cn extends Error{constructor(e,a,u){a===401&&Kt(u)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=a,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const fs=$e()?()=>self.worker&&self.worker.referrer:()=>(E.location.protocol==="blob:"?E.parent:E).location.href,Ys=function(s,e){if(!(/^file:/.test(a=s.url)||/^file:/.test(fs())&&!/^\w+:/.test(a))){if(E.fetch&&E.Request&&E.AbortController&&E.Request.prototype.hasOwnProperty("signal"))return(function(u,p){const y=new E.AbortController,b=new E.Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:fs(),referrerPolicy:u.referrerPolicy,signal:y.signal});let T=!1,M=!1;const P=(O=b.url).indexOf("sku=")>0&&Kt(O);var O;u.type==="json"&&b.headers.set("Accept","application/json");const N=(Z,X,J)=>{if(M)return;if(Z&&Z.message!=="SecurityError"&&me(Z.toString()),X&&J)return $(X);const ct=Date.now();E.fetch(b).then((yt=>{if(yt.ok){const Ct=P?yt.clone():null;return $(yt,Ct,ct)}return p(new Cn(yt.statusText,yt.status,u.url))})).catch((yt=>{yt.name!=="AbortError"&&p(new Error(`${yt.message} ${u.url}`))}))},$=(Z,X,J)=>{(u.type==="arrayBuffer"?Z.arrayBuffer():u.type==="json"?Z.json():Z.text()).then((ct=>{M||(X&&J&&(function(yt,Ct,vt){if(zn(),!Ri)return;const St={status:Ct.status,statusText:Ct.statusText,headers:new E.Headers};Ct.headers.forEach(((ie,Qt)=>St.headers.set(Qt,ie)));const Dt=Ne(Ct.headers.get("Cache-Control")||"");if(Dt["no-store"])return;Dt["max-age"]&&St.headers.set("Expires",new Date(vt+1e3*Dt["max-age"]).toUTCString());const It=St.headers.get("Expires");It&&(new Date(It).getTime()-vt<42e4||(function(ie,Qt){if(Fn===void 0)try{new Response(new ReadableStream),Fn=!0}catch{Fn=!1}Fn?Qt(ie.body):ie.blob().then(Qt)})(Ct,(ie=>{const Qt=new E.Response(ie,St);zn(),Ri&&Ri.then((_e=>_e.put(Vn(yt.url),Qt))).catch((_e=>me(_e.message)))})))})(b,X,J),T=!0,p(null,ct,Z.headers.get("Cache-Control"),Z.headers.get("Expires")))})).catch((ct=>{M||p(new Error(ct.message))}))};return P?(function(Z,X){if(zn(),!Ri)return X(null);const J=Vn(Z.url);Ri.then((ct=>{ct.match(J).then((yt=>{const Ct=(function(vt){if(!vt)return!1;const St=new Date(vt.headers.get("Expires")||0),Dt=Ne(vt.headers.get("Cache-Control")||"");return St>Date.now()&&!Dt["no-cache"]})(yt);ct.delete(J),Ct&&ct.put(J,yt.clone()),X(null,yt,Ct)})).catch(X)})).catch(X)})(b,N):N(null,null),{cancel:()=>{M=!0,T||y.abort()}}})(s,e);if($e()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",s,e,void 0,!0)}var a;return(function(u,p){const y=new E.XMLHttpRequest;y.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(y.responseType="arraybuffer");for(const b in u.headers)y.setRequestHeader(b,u.headers[b]);return u.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=u.credentials==="include",y.onerror=()=>{p(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let b=y.response;if(u.type==="json")try{b=JSON.parse(y.response)}catch(T){return p(T)}p(null,b,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else p(new Cn(y.statusText,y.status,u.url))},y.send(u.body),{cancel:()=>y.abort()}})(s,e)},Eo=function(s,e){return Ys(je(s,{type:"arrayBuffer"}),e)};function ec(s){const e=E.document.createElement("a");return e.href=s,e.protocol===E.document.location.protocol&&e.host===E.document.location.host}const Et="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let et,nt;et=[],nt=0;const wt=function(s,e){if(j.supported&&(s.headers||(s.headers={}),s.headers.accept="image/webp,*/*"),nt>=R.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:s,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return et.push(y),y}nt++;let a=!1;const u=()=>{if(!a)for(a=!0,nt--;et.length&&nt<R.MAX_PARALLEL_IMAGE_REQUESTS;){const y=et.shift(),{requestParameters:b,callback:T,cancelled:M}=y;M||(y.cancel=wt(b,T).cancel)}},p=Eo(s,((y,b,T,M)=>{u(),y?e(y):b&&(E.createImageBitmap?(function(P,O){const N=new E.Blob([new Uint8Array(P)],{type:"image/png"});E.createImageBitmap(N).then(($=>{O(null,$)})).catch(($=>{O(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(b,((P,O)=>e(P,O,T,M))):(function(P,O){const N=new E.Image,$=E.URL;N.onload=()=>{O(null,N),$.revokeObjectURL(N.src),N.onload=null,E.requestAnimationFrame((()=>{N.src=Et}))},N.onerror=()=>O(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const Z=new E.Blob([new Uint8Array(P)],{type:"image/png"});N.src=P.byteLength?$.createObjectURL(Z):Et})(b,((P,O)=>e(P,O,T,M))))}));return{cancel:()=>{p.cancel(),u()}}},Lt="NO_ACCESS_TOKEN";function jt(s){return s.indexOf("mapbox:")===0}function Kt(s){return R.API_URL_REGEX.test(s)}function qt(s){return R.API_CDN_URL_REGEX.test(s)}function Vt(s){return R.API_STYLE_REGEX.test(s)&&!ne(s)}function ne(s){return R.API_SPRITE_REGEX.test(s)}const Ae=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Be(s){const e=s.match(Ae);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Pe(s){const e=s.params.length?`?${s.params.join("&")}`:"";return`${s.protocol}://${s.authority}${s.path}${e}`}const Si="mapbox.eventData";function yi(s){if(!s)return null;const e=s.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(E.atob(e[1]).split("").map((a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch{return null}}class Le{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const a=yi(R.ACCESS_TOKEN);let u="";return u=a&&a.u?E.btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,((p,y)=>String.fromCharCode(+("0x"+y))))):R.ACCESS_TOKEN||"",e?`${Si}.${e}:${u}`:`${Si}:${u}`}fetchEventData(){const e=ti("localStorage"),a=this.getStorageKey(),u=this.getStorageKey("uuid");if(e)try{const p=E.localStorage.getItem(a);p&&(this.eventData=JSON.parse(p));const y=E.localStorage.getItem(u);y&&(this.anonId=y)}catch{me("Unable to read from LocalStorage")}}saveEventData(){const e=ti("localStorage"),a=this.getStorageKey(),u=this.getStorageKey("uuid");if(e)try{E.localStorage.setItem(u,this.anonId),Object.keys(this.eventData).length>=1&&E.localStorage.setItem(a,JSON.stringify(this.eventData))}catch{me("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,a,u,p){if(!R.EVENTS_URL)return;const y=Be(R.EVENTS_URL);y.params.push(`access_token=${p||R.ACCESS_TOKEN||""}`);const b={event:this.type,created:new Date(e).toISOString()},T=a?je(b,a):b,M={url:Pe(y),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};this.pendingRequest=(function(P,O){return Ys(je(P,{method:"POST"}),O)})(M,(P=>{this.pendingRequest=null,u(P),this.saveEventData(),this.processRequests(p)}))}queueRequest(e,a){this.queue.push(e),this.processRequests(a)}}const Mi=new class extends Le{constructor(s){super("appUserTurnstile"),this._customAccessToken=s}postTurnstileEvent(s,e){R.EVENTS_URL&&R.ACCESS_TOKEN&&Array.isArray(s)&&s.some((a=>jt(a)||Kt(a)))&&this.queueRequest(Date.now(),e)}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=yi(R.ACCESS_TOKEN),a=e?e.u:R.ACCESS_TOKEN;let u=a!==this.eventData.tokenU;Qe(this.anonId)||(this.anonId=vi(),u=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const y=new Date(this.eventData.lastSuccess),b=new Date(p),T=(p-this.eventData.lastSuccess)/864e5;u=u||T>=1||T<-1||y.getDate()!==b.getDate()}else u=!0;u?this.postEvent(p,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:xt,"enabled.telemetry":!1,userId:this.anonId},(y=>{y||(this.eventData.lastSuccess=p,this.eventData.tokenU=a)}),s):this.processRequests()}},Bi=Mi.postTurnstileEvent.bind(Mi),tn=new class extends Le{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(s,e,a,u){this.skuToken=e,this.errorCb=u,R.EVENTS_URL&&(a||R.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(Lt)))}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:a}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Qe(this.anonId)||(this.anonId=vi()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:xt,skuToken:this.skuToken,userId:this.anonId},(u=>{u?this.errorCb(u):e&&(this.success[e]=!0)}),s))}},An=tn.postMapLoadEvent.bind(tn),ps=new class extends Le{constructor(){super("gljs.performance")}postPerformanceEvent(s,e){R.EVENTS_URL&&(s||R.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},s)}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:a}=this.queue.shift(),u=(function(p){const y=E.performance.getEntriesByType("resource"),b=E.performance.getEntriesByType("mark"),T=(function($){const Z={};if($){for(const X in $)if(X!=="other")for(const J of $[X]){const ct=`${X}ResolveRangeMin`,yt=`${X}ResolveRangeMax`,Ct=`${X}RequestCount`,vt=`${X}RequestCachedCount`;Z[ct]=Math.min(Z[ct]||1/0,J.startTime),Z[yt]=Math.max(Z[yt]||-1/0,J.responseEnd);const St=Dt=>{Z[Dt]===void 0&&(Z[Dt]=0),++Z[Dt]};J.transferSize!==void 0&&J.transferSize===0&&St(vt),St(Ct)}}return Z})((function($,Z){const X={};if($)for(const J of $){const ct=Z(J);X[ct]===void 0&&(X[ct]=[]),X[ct].push(J)}return X})(y,Js)),M=E.devicePixelRatio,P=E.navigator.connection||E.navigator.mozConnection||E.navigator.webkitConnection,O={counters:[],metadata:[],attributes:[]},N=($,Z,X)=>{X!=null&&$.push({name:Z,value:X.toString()})};for(const $ in T)N(O.counters,$,T[$]);if(p.interactionRange[0]!==1/0&&p.interactionRange[1]!==-1/0&&(N(O.counters,"interactionRangeMin",p.interactionRange[0]),N(O.counters,"interactionRangeMax",p.interactionRange[1])),b)for(const $ of Object.keys(ns)){const Z=ns[$],X=b.find((J=>J.name===Z));X&&N(O.counters,Z,X.startTime)}return N(O.counters,"visibilityHidden",p.visibilityHidden),N(O.attributes,"style",(function($){if($)for(const Z of $){const X=Z.name.split("?")[0];if(Vt(X)){const J=X.split("/").slice(-2);if(J.length===2)return`mapbox://styles/${J[0]}/${J[1]}`}}})(y)),N(O.attributes,"terrainEnabled",p.terrainEnabled?"true":"false"),N(O.attributes,"fogEnabled",p.fogEnabled?"true":"false"),N(O.attributes,"projection",p.projection),N(O.attributes,"zoom",p.zoom),N(O.metadata,"devicePixelRatio",M),N(O.metadata,"connectionEffectiveType",P?P.effectiveType:void 0),N(O.metadata,"navigatorUserAgent",E.navigator.userAgent),N(O.metadata,"screenWidth",E.screen.width),N(O.metadata,"screenHeight",E.screen.height),N(O.metadata,"windowWidth",E.innerWidth),N(O.metadata,"windowHeight",E.innerHeight),N(O.metadata,"mapWidth",p.width/M),N(O.metadata,"mapHeight",p.height/M),N(O.metadata,"webglRenderer",p.renderer),N(O.metadata,"webglVendor",p.vendor),N(O.metadata,"sdkVersion",C),N(O.metadata,"sdkIdentifier","mapbox-gl-js"),O})(a);for(const p of u.metadata);for(const p of u.counters);for(const p of u.attributes);this.postEvent(e,u,(()=>{}),s)}},Nn=ps.postPerformanceEvent.bind(ps),$s=new class extends Le{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(s,e,a,u){if(!R.API_URL||!R.SESSION_PATH)return;const p=Be(R.API_URL+R.SESSION_PATH);p.params.push(`sku=${e||""}`),p.params.push(`access_token=${u||R.ACCESS_TOKEN||""}`);const y={url:Pe(p),headers:{"Content-Type":"text/plain"}};this.pendingRequest=(function(b,T){return Ys(je(b,{method:"GET"}),T)})(y,(b=>{this.pendingRequest=null,a(b),this.saveEventData(),this.processRequests(u)}))}getSessionAPI(s,e,a,u){this.skuToken=e,this.errorCb=u,R.SESSION_PATH&&R.API_URL&&(a||R.ACCESS_TOKEN?this.queueRequest({id:s,timestamp:Date.now()},a):this.errorCb(new Error(Lt)))}processRequests(s){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:a}=this.queue.shift();e&&this.success[e]||this.getSession(a,this.skuToken,(u=>{u?this.errorCb(u):e&&(this.success[e]=!0)}),s)}},cs=$s.getSessionAPI.bind($s),is=new Set,ns={create:"create",load:"load",fullLoad:"fullLoad"},ur={mark(s){E.performance.mark(s)},measure(s,e,a){E.performance.measure(s,e,a)}};function Js(s){const e=s.name.split("?")[0];return qt(e)&&e.includes("mapbox-gl.js")?"javascript":qt(e)&&e.includes("mapbox-gl.css")?"css":(function(a){return R.API_FONTS_REGEX.test(a)})(e)?"fontRange":ne(e)?"sprite":Vt(e)?"style":(function(a){return R.API_TILEJSON_REGEX.test(a)})(e)?"tilejson":"other"}const Ti=E.performance;function ja(s){const e=s?s.url.toString():void 0;return Ti.getEntriesByName(e)}let hr,So,Mo,jr;const Vr={now:()=>Mo!==void 0?Mo:E.performance.now(),setNow(s){Mo=s},restoreNow(){Mo=void 0},frame(s){const e=E.requestAnimationFrame(s);return{cancel:()=>E.cancelAnimationFrame(e)}},getImageData(s,e=0){const{width:a,height:u}=s;jr||(jr=E.document.createElement("canvas"));const p=jr.getContext("2d",{willReadFrequently:!0});if(!p)throw new Error("failed to create canvas 2d context");return(a>jr.width||u>jr.height)&&(jr.width=a,jr.height=u),p.clearRect(-e,-e,a+2*e,u+2*e),p.drawImage(s,0,0,a,u),p.getImageData(-e,-e,a+2*e,u+2*e)},resolveURL:s=>(hr||(hr=E.document.createElement("a")),hr.href=s,hr.href),get devicePixelRatio(){return E.devicePixelRatio},get prefersReducedMotion(){return!!E.matchMedia&&(So==null&&(So=E.matchMedia("(prefers-reduced-motion: reduce)")),So.matches)}};function Vo(s,e,a){a[s]&&a[s].indexOf(e)!==-1||(a[s]=a[s]||[],a[s].push(e))}function Va(s,e,a){if(a&&a[s]){const u=a[s].indexOf(e);u!==-1&&a[s].splice(u,1)}}class dr{constructor(e,a={}){je(this,a),this.type=e}}class Cr extends dr{constructor(e,a={}){super("error",je({error:e},a))}}class ma{on(e,a){return this._listeners=this._listeners||{},Vo(e,a,this._listeners),this}off(e,a){return Va(e,a,this._listeners),Va(e,a,this._oneTimeListeners),this}once(e,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Vo(e,a,this._oneTimeListeners),this):new Promise((u=>this.once(e,u)))}fire(e,a){typeof e=="string"&&(e=new dr(e,a||{}));const u=e.type;if(this.listens(u)){e.target=this;const p=this._listeners&&this._listeners[u]?this._listeners[u].slice():[];for(const T of p)T.call(this,e);const y=this._oneTimeListeners&&this._oneTimeListeners[u]?this._oneTimeListeners[u].slice():[];for(const T of y)Va(u,T,this._oneTimeListeners),T.call(this,e);const b=this._eventedParent;b&&(je(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(e))}else e instanceof Cr&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,a){return this._eventedParent=e,this._eventedParentData=a,this}}var le=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Vi(s,...e){for(const a of e)for(const u in a)s[u]=a[u];return s}function Li(s){return s instanceof Number||s instanceof String||s instanceof Boolean?s.valueOf():s}function Un(s){if(Array.isArray(s))return s.map(Un);if(s instanceof Object&&!(s instanceof Number||s instanceof String||s instanceof Boolean)){const e={};for(const a in s)e[a]=Un(s[a]);return e}return Li(s)}class Uo extends Error{constructor(e,a){super(a),this.message=a,this.key=e}}var Is=Uo;class Ua{constructor(e,a=[]){this.parent=e,this.bindings={};for(const[u,p]of a)this.bindings[u]=p}concat(e){return new Ua(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Fi=Ua;const gn={kind:"null"},Fe={kind:"number"},mi={kind:"string"},hi={kind:"boolean"},On={kind:"color"},Ls={kind:"object"},xi={kind:"value"},Ui={kind:"collator"},xs={kind:"formatted"},Qs={kind:"resolvedImage"};function Zn(s,e){return{kind:"array",itemType:s,N:e}}function on(s){if(s.kind==="array"){const e=on(s.itemType);return typeof s.N=="number"?`array<${e}, ${s.N}>`:s.itemType.kind==="value"?"array":`array<${e}>`}return s.kind}const _a=[gn,Fe,mi,hi,On,xs,Ls,Zn(xi),Qs];function Ds(s,e){if(e.kind==="error")return null;if(s.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Ds(s.itemType,e.itemType))&&(typeof s.N!="number"||s.N===e.N))return null}else{if(s.kind===e.kind)return null;if(s.kind==="value"){for(const a of _a)if(!Ds(a,e))return null}}return`Expected ${on(s)} but found ${on(e)} instead.`}function Co(s,e){return e.some((a=>a.kind===s.kind))}function Ao(s,e){return e.some((a=>a==="null"?s===null:a==="array"?Array.isArray(s):a==="object"?s&&!Array.isArray(s)&&typeof s=="object":a===typeof s))}var fr,ic={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Ws(s){return(s=Math.round(s))<0?0:s>255?255:s}function Po(s){return Ws(s[s.length-1]==="%"?parseFloat(s)/100*255:parseInt(s))}function ga(s){return(e=s[s.length-1]==="%"?parseFloat(s)/100:parseFloat(s))<0?0:e>1?1:e;var e}function Yr(s,e,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?s+(e-s)*a*6:2*a<1?e:3*a<2?s+(e-s)*(2/3-a)*6:s}try{fr={}.parseCSSColor=function(s){var e,a=s.replace(/ /g,"").toLowerCase();if(a in ic)return ic[a].slice();if(a[0]==="#")return a.length===4?(e=parseInt(a.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:a.length===7&&(e=parseInt(a.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var u=a.indexOf("("),p=a.indexOf(")");if(u!==-1&&p+1===a.length){var y=a.substr(0,u),b=a.substr(u+1,p-(u+1)).split(","),T=1;switch(y){case"rgba":if(b.length!==4)return null;T=ga(b.pop());case"rgb":return b.length!==3?null:[Po(b[0]),Po(b[1]),Po(b[2]),T];case"hsla":if(b.length!==4)return null;T=ga(b.pop());case"hsl":if(b.length!==3)return null;var M=(parseFloat(b[0])%360+360)%360/360,P=ga(b[1]),O=ga(b[2]),N=O<=.5?O*(P+1):O+P-O*P,$=2*O-N;return[Ws(255*Yr($,N,M+1/3)),Ws(255*Yr($,N,M)),Ws(255*Yr($,N,M-1/3)),T];default:return null}}return null}}catch{}class pi{constructor(e,a,u,p=1){this.r=e,this.g=a,this.b=u,this.a=p}static parse(e){if(!e)return;if(e instanceof pi)return e;if(typeof e!="string")return;const a=fr(e);return a?new pi(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[e,a,u,p]=this.toArray();return`rgba(${Math.round(e)},${Math.round(a)},${Math.round(u)},${p})`}toArray(){const{r:e,g:a,b:u,a:p}=this;return p===0?[0,0,0,0]:[255*e/p,255*a/p,255*u/p,p]}toArray01(){const{r:e,g:a,b:u,a:p}=this;return p===0?[0,0,0,0]:[e/p,a/p,u/p,p]}toArray01PremultipliedAlpha(){const{r:e,g:a,b:u,a:p}=this;return[e,a,u,p]}}pi.black=new pi(0,0,0,1),pi.white=new pi(1,1,1,1),pi.transparent=new pi(0,0,0,0),pi.red=new pi(1,0,0,1),pi.blue=new pi(0,0,1,1);var Xi=pi;class cn{constructor(e,a,u){this.sensitivity=e?a?"variant":"case":a?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,a){return this.collator.compare(e,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class vl{constructor(e,a,u,p,y){this.text=e.normalize?e.normalize():e,this.image=a,this.scale=u,this.fontStack=p,this.textColor=y}}class bs{constructor(e){this.sections=e}static fromString(e){return new bs([new vl(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((e=>e.text.length!==0||e.image&&e.image.name.length!==0))}static factory(e){return e instanceof bs?e:bs.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map((e=>e.text)).join("")}serialize(){const e=["format"];for(const a of this.sections){if(a.image){e.push(["image",a.image.name]);continue}e.push(a.text);const u={};a.fontStack&&(u["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(u["font-scale"]=a.scale),a.textColor&&(u["text-color"]=["rgba"].concat(a.textColor.toArray())),e.push(u)}return e}}class us{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new us({name:e,available:!1}):null}serialize(){return["image",this.name]}}function nc(s,e,a,u){return typeof s=="number"&&s>=0&&s<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof a=="number"&&a>=0&&a<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[s,e,a,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[s,e,a,u]:[s,e,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ar(s){if(s===null||typeof s=="string"||typeof s=="boolean"||typeof s=="number"||s instanceof Xi||s instanceof cn||s instanceof bs||s instanceof us)return!0;if(Array.isArray(s)){for(const e of s)if(!Ar(e))return!1;return!0}if(typeof s=="object"){for(const e in s)if(!Ar(s[e]))return!1;return!0}return!1}function yn(s){if(s===null)return gn;if(typeof s=="string")return mi;if(typeof s=="boolean")return hi;if(typeof s=="number")return Fe;if(s instanceof Xi)return On;if(s instanceof cn)return Ui;if(s instanceof bs)return xs;if(s instanceof us)return Qs;if(Array.isArray(s)){const e=s.length;let a;for(const u of s){const p=yn(u);if(a){if(a===p)continue;a=xi;break}a=p}return Zn(a||xi,e)}return Ls}function Pr(s){const e=typeof s;return s===null?"":e==="string"||e==="number"||e==="boolean"?String(s):s instanceof Xi||s instanceof bs||s instanceof us?s.toString():JSON.stringify(s)}class Gn{constructor(e,a){this.type=e,this.value=a}static parse(e,a){if(e.length!==2)return a.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ar(e[1]))return a.error("invalid value");const u=e[1];let p=yn(u);const y=a.expectedType;return p.kind!=="array"||p.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(p=y),new Gn(p,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Xi?["rgba"].concat(this.value.toArray()):this.value instanceof bs?this.value.serialize():this.value}}var pr=Gn,Hn=class{constructor(s){this.name="ExpressionEvaluationError",this.message=s}toJSON(){return this.message}};const sc={string:mi,number:Fe,boolean:hi,object:Ls};class rc{constructor(e,a){this.type=e,this.args=a}static parse(e,a){if(e.length<2)return a.error("Expected at least one argument.");let u,p=1;const y=e[0];if(y==="array"){let T,M;if(e.length>2){const P=e[1];if(typeof P!="string"||!(P in sc)||P==="object")return a.error('The item type argument of "array" must be one of string, number, boolean',1);T=sc[P],p++}else T=xi;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return a.error('The length argument to "array" must be a positive integer literal',2);M=e[2],p++}u=Zn(T,M)}else u=sc[y];const b=[];for(;p<e.length;p++){const T=a.parse(e[p],p,xi);if(!T)return null;b.push(T)}return new rc(u,b)}evaluate(e){for(let a=0;a<this.args.length;a++){const u=this.args[a].evaluate(e);if(!Ds(this.type,yn(u)))return u;if(a===this.args.length-1)throw new Hn(`Expected value to be of type ${on(this.type)}, but found ${on(yn(u))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=this.type,a=[e.kind];if(e.kind==="array"){const u=e.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){a.push(u.kind);const p=e.N;(typeof p=="number"||this.args.length>1)&&a.push(p)}}return a.concat(this.args.map((u=>u.serialize())))}}var kr=rc;class Ir{constructor(e){this.type=xs,this.sections=e}static parse(e,a){if(e.length<2)return a.error("Expected at least one argument.");const u=e[1];if(!Array.isArray(u)&&typeof u=="object")return a.error("First argument must be an image or text section.");const p=[];let y=!1;for(let b=1;b<=e.length-1;++b){const T=e[b];if(y&&typeof T=="object"&&!Array.isArray(T)){y=!1;let M=null;if(T["font-scale"]&&(M=a.parse(T["font-scale"],1,Fe),!M))return null;let P=null;if(T["text-font"]&&(P=a.parse(T["text-font"],1,Zn(mi)),!P))return null;let O=null;if(T["text-color"]&&(O=a.parse(T["text-color"],1,On),!O))return null;const N=p[p.length-1];N.scale=M,N.font=P,N.textColor=O}else{const M=a.parse(e[b],1,xi);if(!M)return null;const P=M.type.kind;if(P!=="string"&&P!=="value"&&P!=="null"&&P!=="resolvedImage")return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,p.push({content:M,scale:null,font:null,textColor:null})}}return new Ir(p)}evaluate(e){return new bs(this.sections.map((a=>{const u=a.content.evaluate(e);return yn(u)===Qs?new vl("",u,null,null,null):new vl(Pr(u),null,a.scale?a.scale.evaluate(e):null,a.font?a.font.evaluate(e).join(","):null,a.textColor?a.textColor.evaluate(e):null)})))}eachChild(e){for(const a of this.sections)e(a.content),a.scale&&e(a.scale),a.font&&e(a.font),a.textColor&&e(a.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const a of this.sections){e.push(a.content.serialize());const u={};a.scale&&(u["font-scale"]=a.scale.serialize()),a.font&&(u["text-font"]=a.font.serialize()),a.textColor&&(u["text-color"]=a.textColor.serialize()),e.push(u)}return e}}class $a{constructor(e){this.type=Qs,this.input=e}static parse(e,a){if(e.length!==2)return a.error("Expected two arguments.");const u=a.parse(e[1],1,mi);return u?new $a(u):a.error("No image name provided.")}evaluate(e){const a=this.input.evaluate(e),u=us.fromString(a);return u&&e.availableImages&&(u.available=e.availableImages.indexOf(a)>-1),u}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Zc={"to-boolean":hi,"to-color":On,"to-number":Fe,"to-string":mi};class Wi{constructor(e,a){this.type=e,this.args=a}static parse(e,a){if(e.length<2)return a.error("Expected at least one argument.");const u=e[0];if((u==="to-boolean"||u==="to-string")&&e.length!==2)return a.error("Expected one argument.");const p=Zc[u],y=[];for(let b=1;b<e.length;b++){const T=a.parse(e[b],b,xi);if(!T)return null;y.push(T)}return new Wi(p,y)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let a,u;for(const p of this.args){if(a=p.evaluate(e),u=null,a instanceof Xi)return a;if(typeof a=="string"){const y=e.parseColor(a);if(y)return y}else if(Array.isArray(a)&&(u=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:nc(a[0],a[1],a[2],a[3]),!u))return new Xi(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Hn(u||`Could not parse color from value '${typeof a=="string"?a:String(JSON.stringify(a))}'`)}if(this.type.kind==="number"){let a=null;for(const u of this.args){if(a=u.evaluate(e),a===null)return 0;const p=Number(a);if(!isNaN(p))return p}throw new Hn(`Could not convert ${JSON.stringify(a)} to number.`)}return this.type.kind==="formatted"?bs.fromString(Pr(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?us.fromString(Pr(this.args[0].evaluate(e))):Pr(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new Ir([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new $a(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild((a=>{e.push(a.serialize())})),e}}var $o=Wi;const qn=["Unknown","Point","LineString","Polygon"];var Wo=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?qn[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const s=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:a,y:u}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*e-s[0])+this.featureDistanceData.bearing[1]*(u*e-s[1])}return 0}parseColor(s){let e=this._parseColorCache[s];return e||(e=this._parseColorCache[s]=Xi.parse(s)),e}};class mr{constructor(e,a,u,p){this.name=e,this.type=a,this._evaluate=u,this.args=p}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((e=>e.serialize())))}static parse(e,a){const u=e[0],p=mr.definitions[u];if(!p)return a.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(p)?p[0]:p.type,b=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,T=b.filter((([P])=>!Array.isArray(P)||P.length===e.length-1));let M=null;for(const[P,O]of T){M=new cc(a.registry,a.path,null,a.scope);const N=[];let $=!1;for(let Z=1;Z<e.length;Z++){const X=e[Z],J=Array.isArray(P)?P[Z-1]:P.type,ct=M.parse(X,1+N.length,J);if(!ct){$=!0;break}N.push(ct)}if(!$)if(Array.isArray(P)&&P.length!==N.length)M.error(`Expected ${P.length} arguments, but found ${N.length} instead.`);else{for(let Z=0;Z<N.length;Z++){const X=Array.isArray(P)?P[Z]:P.type,J=N[Z];M.concat(Z+1).checkSubtype(X,J.type)}if(M.errors.length===0)return new mr(u,y,O,N)}}if(T.length===1)a.errors.push(...M.errors);else{const P=(T.length?T:b).map((([N])=>{return $=N,Array.isArray($)?`(${$.map(on).join(", ")})`:`(${on($.type)}...)`;var $})).join(" | "),O=[];for(let N=1;N<e.length;N++){const $=a.parse(e[N],1+O.length);if(!$)return null;O.push(on($.type))}a.error(`Expected arguments of type ${P}, but found (${O.join(", ")}) instead.`)}return null}static register(e,a){mr.definitions=a;for(const u in a)e[u]=mr}}var ko=mr;class Zo{constructor(e,a,u){this.type=Ui,this.locale=u,this.caseSensitive=e,this.diacriticSensitive=a}static parse(e,a){if(e.length!==2)return a.error("Expected one argument.");const u=e[1];if(typeof u!="object"||Array.isArray(u))return a.error("Collator options argument must be an object.");const p=a.parse(u["case-sensitive"]!==void 0&&u["case-sensitive"],1,hi);if(!p)return null;const y=a.parse(u["diacritic-sensitive"]!==void 0&&u["diacritic-sensitive"],1,hi);if(!y)return null;let b=null;return u.locale&&(b=a.parse(u.locale,1,mi),!b)?null:new Zo(p,y,b)}evaluate(e){return new cn(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Jr=8192;function Wa(s,e){s[0]=Math.min(s[0],e[0]),s[1]=Math.min(s[1],e[1]),s[2]=Math.max(s[2],e[0]),s[3]=Math.max(s[3],e[1])}function ya(s,e){return!(s[0]<=e[0]||s[2]>=e[2]||s[1]<=e[1]||s[3]>=e[3])}function Za(s,e){const a=(180+s[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s[1]*Math.PI/360)))/360,p=Math.pow(2,e.z);return[Math.round(a*p*Jr),Math.round(u*p*Jr)]}function Ga(s,e,a){const u=s[0]-e[0],p=s[1]-e[1],y=s[0]-a[0],b=s[1]-a[1];return u*b-y*p==0&&u*y<=0&&p*b<=0}function xl(s,e){let a=!1;for(let b=0,T=e.length;b<T;b++){const M=e[b];for(let P=0,O=M.length;P<O-1;P++){if(Ga(s,M[P],M[P+1]))return!1;(p=M[P])[1]>(u=s)[1]!=(y=M[P+1])[1]>u[1]&&u[0]<(y[0]-p[0])*(u[1]-p[1])/(y[1]-p[1])+p[0]&&(a=!a)}}var u,p,y;return a}function Lr(s,e){for(let a=0;a<e.length;a++)if(xl(s,e[a]))return!0;return!1}function Gc(s,e,a,u){const p=u[0]-a[0],y=u[1]-a[1],b=(s[0]-a[0])*y-p*(s[1]-a[1]),T=(e[0]-a[0])*y-p*(e[1]-a[1]);return b>0&&T<0||b<0&&T>0}function Go(s,e,a){for(const P of a)for(let O=0;O<P.length-1;++O)if((T=[(b=P[O+1])[0]-(y=P[O])[0],b[1]-y[1]])[0]*(M=[(p=e)[0]-(u=s)[0],p[1]-u[1]])[1]-T[1]*M[0]!=0&&Gc(u,p,y,b)&&Gc(y,b,u,p))return!0;var u,p,y,b,T,M;return!1}function Ni(s,e){for(let a=0;a<s.length;++a)if(!xl(s[a],e))return!1;for(let a=0;a<s.length-1;++a)if(Go(s[a],s[a+1],e))return!1;return!0}function bl(s,e){for(let a=0;a<e.length;a++)if(Ni(s,e[a]))return!0;return!1}function oc(s,e,a){const u=[];for(let p=0;p<s.length;p++){const y=[];for(let b=0;b<s[p].length;b++){const T=Za(s[p][b],a);Wa(e,T),y.push(T)}u.push(y)}return u}function ac(s,e,a){const u=[];for(let p=0;p<s.length;p++){const y=oc(s[p],e,a);u.push(y)}return u}function wl(s,e,a,u){if(s[0]<a[0]||s[0]>a[2]){const p=.5*u;let y=s[0]-a[0]>p?-u:a[0]-s[0]>p?u:0;y===0&&(y=s[0]-a[2]>p?-u:a[2]-s[0]>p?u:0),s[0]+=y}Wa(e,s)}function lc(s,e,a,u){const p=Math.pow(2,u.z)*Jr,y=[u.x*Jr,u.y*Jr],b=[];if(!s)return b;for(const T of s)for(const M of T){const P=[M.x+y[0],M.y+y[1]];wl(P,e,a,p),b.push(P)}return b}function Tl(s,e,a,u){const p=Math.pow(2,u.z)*Jr,y=[u.x*Jr,u.y*Jr],b=[];if(!s)return b;for(const M of s){const P=[];for(const O of M){const N=[O.x+y[0],O.y+y[1]];Wa(e,N),P.push(N)}b.push(P)}if(e[2]-e[0]<=p/2){(T=e)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const M of b)for(const P of M)wl(P,e,a,p)}var T;return b}class Dr{constructor(e,a){this.type=hi,this.geojson=e,this.geometries=a}static parse(e,a){if(e.length!==2)return a.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ar(e[1])){const u=e[1];if(u.type==="FeatureCollection")for(let p=0;p<u.features.length;++p){const y=u.features[p].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new Dr(u,u.features[p].geometry)}else if(u.type==="Feature"){const p=u.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Dr(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Dr(u,u)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return(function(a,u){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(!b)return!1;if(u.type==="Polygon"){const T=oc(u.coordinates,y,b),M=lc(a.geometry(),p,y,b);if(!ya(p,y))return!1;for(const P of M)if(!xl(P,T))return!1}if(u.type==="MultiPolygon"){const T=ac(u.coordinates,y,b),M=lc(a.geometry(),p,y,b);if(!ya(p,y))return!1;for(const P of M)if(!Lr(P,T))return!1}return!0})(e,this.geometries);if(e.geometryType()==="LineString")return(function(a,u){const p=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],b=a.canonicalID();if(!b)return!1;if(u.type==="Polygon"){const T=oc(u.coordinates,y,b),M=Tl(a.geometry(),p,y,b);if(!ya(p,y))return!1;for(const P of M)if(!Ni(P,T))return!1}if(u.type==="MultiPolygon"){const T=ac(u.coordinates,y,b),M=Tl(a.geometry(),p,y,b);if(!ya(p,y))return!1;for(const P of M)if(!bl(P,T))return!1}return!0})(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ha=Dr;function Ho(s){if(s instanceof ko&&(s.name==="get"&&s.args.length===1||s.name==="feature-state"||s.name==="has"&&s.args.length===1||s.name==="properties"||s.name==="geometry-type"||s.name==="id"||/^filter-/.test(s.name))||s instanceof Ha)return!1;let e=!0;return s.eachChild((a=>{e&&!Ho(a)&&(e=!1)})),e}function Qr(s){if(s instanceof ko&&s.name==="feature-state")return!1;let e=!0;return s.eachChild((a=>{e&&!Qr(a)&&(e=!1)})),e}function qo(s,e){if(s instanceof ko&&e.indexOf(s.name)>=0)return!1;let a=!0;return s.eachChild((u=>{a&&!qo(u,e)&&(a=!1)})),a}class El{constructor(e,a){this.type=a.type,this.name=e,this.boundExpression=a}static parse(e,a){if(e.length!==2||typeof e[1]!="string")return a.error("'var' expression requires exactly one string literal argument.");const u=e[1];return a.scope.has(u)?new El(u,a.scope.get(u)):a.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Sl=El;class Ur{constructor(e,a=[],u,p=new Fi,y=[]){this.registry=e,this.path=a,this.key=a.map((b=>`[${b}]`)).join(""),this.scope=p,this.errors=y,this.expectedType=u}parse(e,a,u,p,y={}){return a?this.concat(a,u,p)._parse(e,y):this._parse(e,y)}_parse(e,a){function u(p,y,b){return b==="assert"?new kr(y,[p]):b==="coerce"?new $o(y,[p]):p}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=e[0];if(typeof p!="string")return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[p];if(y){let b=y.parse(e,this);if(!b)return null;if(this.expectedType){const T=this.expectedType,M=b.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||M.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||M.kind!=="value"&&M.kind!=="string"){if(this.checkSubtype(T,M))return null}else b=u(b,T,a.typeAnnotation||"coerce");else b=u(b,T,a.typeAnnotation||"assert")}if(!(b instanceof pr)&&b.type.kind!=="resolvedImage"&&Xo(b)){const T=new Wo;try{b=new pr(b.type,b.evaluate(T))}catch(M){return this.error(M.message),null}}return b}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,a,u){const p=typeof e=="number"?this.path.concat(e):this.path,y=u?this.scope.concat(u):this.scope;return new Ur(this.registry,p,a||null,y,this.errors)}error(e,...a){const u=`${this.key}${a.map((p=>`[${p}]`)).join("")}`;this.errors.push(new Is(u,e))}checkSubtype(e,a){const u=Ds(e,a);return u&&this.error(u),u}}var cc=Ur;function Xo(s){if(s instanceof Sl)return Xo(s.boundExpression);if(s instanceof ko&&s.name==="error"||s instanceof Zo||s instanceof Ha)return!1;const e=s instanceof $o||s instanceof kr;let a=!0;return s.eachChild((u=>{a=e?a&&Xo(u):a&&u instanceof pr})),!!a&&Ho(s)&&qo(s,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Zs(s,e){const a=s.length-1;let u,p,y=0,b=a,T=0;for(;y<=b;)if(T=Math.floor((y+b)/2),u=s[T],p=s[T+1],u<=e){if(T===a||e<p)return T;y=T+1}else{if(!(u>e))throw new Hn("Input is not a number.");b=T-1}return 0}class to{constructor(e,a,u){this.type=e,this.input=a,this.labels=[],this.outputs=[];for(const[p,y]of u)this.labels.push(p),this.outputs.push(y)}static parse(e,a){if(e.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return a.error("Expected an even number of arguments.");const u=a.parse(e[1],1,Fe);if(!u)return null;const p=[];let y=null;a.expectedType&&a.expectedType.kind!=="value"&&(y=a.expectedType);for(let b=1;b<e.length;b+=2){const T=b===1?-1/0:e[b],M=e[b+1],P=b,O=b+1;if(typeof T!="number")return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(p.length&&p[p.length-1][0]>=T)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',P);const N=a.parse(M,O,y);if(!N)return null;y=y||N.type,p.push([T,N])}return new to(y,u,p)}evaluate(e){const a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(e);const p=this.input.evaluate(e);if(p<=a[0])return u[0].evaluate(e);const y=a.length;return p>=a[y-1]?u[y-1].evaluate(e):u[Zs(a,p)].evaluate(e)}eachChild(e){e(this.input);for(const a of this.outputs)e(a)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){const e=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&e.push(this.labels[a]),e.push(this.outputs[a].serialize());return e}}var eo=to;function Hi(s,e,a){return s*(1-a)+e*a}var io=Object.freeze({__proto__:null,array:function(s,e,a){return s.map(((u,p)=>Hi(u,e[p],a)))},color:function(s,e,a){return new Xi(Hi(s.r,e.r,a),Hi(s.g,e.g,a),Hi(s.b,e.b,a),Hi(s.a,e.a,a))},number:Hi});const uc=.95047,Hc=1.08883,Nu=4/29,Ko=6/29,qc=3*Ko*Ko,$r=Ko*Ko*Ko,qa=Math.PI/180,Ch=180/Math.PI;function Xn(s){return s>$r?Math.pow(s,1/3):s/qc+Nu}function hc(s){return s>Ko?s*s*s:qc*(s-Nu)}function Io(s){return 255*(s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055)}function Ml(s){return(s/=255)<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4)}function Xa(s){const e=Ml(s.r),a=Ml(s.g),u=Ml(s.b),p=Xn((.4124564*e+.3575761*a+.1804375*u)/uc),y=Xn((.2126729*e+.7151522*a+.072175*u)/1);return{l:116*y-16,a:500*(p-y),b:200*(y-Xn((.0193339*e+.119192*a+.9503041*u)/Hc)),alpha:s.a}}function Xc(s){let e=(s.l+16)/116,a=isNaN(s.a)?e:e+s.a/500,u=isNaN(s.b)?e:e-s.b/200;return e=1*hc(e),a=uc*hc(a),u=Hc*hc(u),new Xi(Io(3.2404542*a-1.5371385*e-.4985314*u),Io(-.969266*a+1.8760108*e+.041556*u),Io(.0556434*a-.2040259*e+1.0572252*u),s.alpha)}function Cl(s,e,a){const u=e-s;return s+a*(u>180||u<-180?u-360*Math.round(u/360):u)}const Yo={forward:Xa,reverse:Xc,interpolate:function(s,e,a){return{l:Hi(s.l,e.l,a),a:Hi(s.a,e.a,a),b:Hi(s.b,e.b,a),alpha:Hi(s.alpha,e.alpha,a)}}},_r={forward:function(s){const{l:e,a,b:u}=Xa(s),p=Math.atan2(u,a)*Ch;return{h:p<0?p+360:p,c:Math.sqrt(a*a+u*u),l:e,alpha:s.a}},reverse:function(s){const e=s.h*qa,a=s.c;return Xc({l:s.l,a:Math.cos(e)*a,b:Math.sin(e)*a,alpha:s.alpha})},interpolate:function(s,e,a){return{h:Cl(s.h,e.h,a),c:Hi(s.c,e.c,a),l:Hi(s.l,e.l,a),alpha:Hi(s.alpha,e.alpha,a)}}};var Ka=Object.freeze({__proto__:null,hcl:_r,lab:Yo});class Ya{constructor(e,a,u,p,y){this.type=e,this.operator=a,this.interpolation=u,this.input=p,this.labels=[],this.outputs=[];for(const[b,T]of y)this.labels.push(b),this.outputs.push(T)}static interpolationFactor(e,a,u,p){let y=0;if(e.name==="exponential")y=Al(a,e.base,u,p);else if(e.name==="linear")y=Al(a,1,u,p);else if(e.name==="cubic-bezier"){const b=e.controlPoints;y=new zt(b[0],b[1],b[2],b[3]).solve(Al(a,1,u,p))}return y}static parse(e,a){let[u,p,y,...b]=e;if(!Array.isArray(p)||p.length===0)return a.error("Expected an interpolation type expression.",1);if(p[0]==="linear")p={name:"linear"};else if(p[0]==="exponential"){const P=p[1];if(typeof P!="number")return a.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:P}}else{if(p[0]!=="cubic-bezier")return a.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const P=p.slice(1);if(P.length!==4||P.some((O=>typeof O!="number"||O<0||O>1)))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:P}}}if(e.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(y=a.parse(y,2,Fe),!y)return null;const T=[];let M=null;u==="interpolate-hcl"||u==="interpolate-lab"?M=On:a.expectedType&&a.expectedType.kind!=="value"&&(M=a.expectedType);for(let P=0;P<b.length;P+=2){const O=b[P],N=b[P+1],$=P+3,Z=P+4;if(typeof O!="number")return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(T.length&&T[T.length-1][0]>=O)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const X=a.parse(N,Z,M);if(!X)return null;M=M||X.type,T.push([O,X])}return M.kind==="number"||M.kind==="color"||M.kind==="array"&&M.itemType.kind==="number"&&typeof M.N=="number"?new Ya(M,u,p,y,T):a.error(`Type ${on(M)} is not interpolatable.`)}evaluate(e){const a=this.labels,u=this.outputs;if(a.length===1)return u[0].evaluate(e);const p=this.input.evaluate(e);if(p<=a[0])return u[0].evaluate(e);const y=a.length;if(p>=a[y-1])return u[y-1].evaluate(e);const b=Zs(a,p),T=Ya.interpolationFactor(this.interpolation,p,a[b],a[b+1]),M=u[b].evaluate(e),P=u[b+1].evaluate(e);return this.operator==="interpolate"?io[this.type.kind.toLowerCase()](M,P,T):this.operator==="interpolate-hcl"?_r.reverse(_r.interpolate(_r.forward(M),_r.forward(P),T)):Yo.reverse(Yo.interpolate(Yo.forward(M),Yo.forward(P),T))}eachChild(e){e(this.input);for(const a of this.outputs)e(a)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,e,this.input.serialize()];for(let u=0;u<this.labels.length;u++)a.push(this.labels[u],this.outputs[u].serialize());return a}}function Al(s,e,a,u){const p=u-a,y=s-a;return p===0?0:e===1?y/p:(Math.pow(e,y)-1)/(Math.pow(e,p)-1)}var no=Ya;class gr{constructor(e,a){this.type=e,this.args=a}static parse(e,a){if(e.length<2)return a.error("Expectected at least one argument.");let u=null;const p=a.expectedType;p&&p.kind!=="value"&&(u=p);const y=[];for(const T of e.slice(1)){const M=a.parse(T,1+y.length,u,void 0,{typeAnnotation:"omit"});if(!M)return null;u=u||M.type,y.push(M)}const b=p&&y.some((T=>Ds(p,T.type)));return new gr(b?xi:u,y)}evaluate(e){let a,u=null,p=0;for(const y of this.args){if(p++,u=y.evaluate(e),u&&u instanceof us&&!u.available&&(a||(a=u),u=null,p===this.args.length))return a;if(u!==null)break}return u}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=["coalesce"];return this.eachChild((a=>{e.push(a.serialize())})),e}}var dc=gr;class so{constructor(e,a){this.type=a.type,this.bindings=[].concat(e),this.result=a}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const a of this.bindings)e(a[1]);e(this.result)}static parse(e,a){if(e.length<4)return a.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const u=[];for(let y=1;y<e.length-1;y+=2){const b=e[y];if(typeof b!="string")return a.error(`Expected string, but found ${typeof b} instead.`,y);if(/[^a-zA-Z0-9_]/.test(b))return a.error("Variable names must contain only alphanumeric characters or '_'.",y);const T=a.parse(e[y+1],y+1);if(!T)return null;u.push([b,T])}const p=a.parse(e[e.length-1],e.length-1,a.expectedType,u);return p?new so(u,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[a,u]of this.bindings)e.push(a,u.serialize());return e.push(this.result.serialize()),e}}var Pl=so;class zr{constructor(e,a,u){this.type=e,this.index=a,this.input=u}static parse(e,a){if(e.length!==3)return a.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=a.parse(e[1],1,Fe),p=a.parse(e[2],2,Zn(a.expectedType||xi));return u&&p?new zr(p.type.itemType,u,p):null}evaluate(e){const a=this.index.evaluate(e),u=this.input.evaluate(e);if(a<0)throw new Hn(`Array index out of bounds: ${a} < 0.`);if(a>=u.length)throw new Hn(`Array index out of bounds: ${a} > ${u.length-1}.`);if(a!==Math.floor(a))throw new Hn(`Array index must be an integer, but found ${a} instead.`);return u[a]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Ja=zr;class Gs{constructor(e,a){this.type=hi,this.needle=e,this.haystack=a}static parse(e,a){if(e.length!==3)return a.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const u=a.parse(e[1],1,xi),p=a.parse(e[2],2,xi);return u&&p?Co(u.type,[hi,mi,Fe,gn,xi])?new Gs(u,p):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${on(u.type)} instead`):null}evaluate(e){const a=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(u==null)return!1;if(!Ao(a,["boolean","string","number","null"]))throw new Hn(`Expected first argument to be of type boolean, string, number or null, but found ${on(yn(a))} instead.`);if(!Ao(u,["string","array"]))throw new Hn(`Expected second argument to be of type array or string, but found ${on(yn(u))} instead.`);return u.indexOf(a)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Qa=Gs;class Jo{constructor(e,a,u){this.type=Fe,this.needle=e,this.haystack=a,this.fromIndex=u}static parse(e,a){if(e.length<=2||e.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=a.parse(e[1],1,xi),p=a.parse(e[2],2,xi);if(!u||!p)return null;if(!Co(u.type,[hi,mi,Fe,gn,xi]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${on(u.type)} instead`);if(e.length===4){const y=a.parse(e[3],3,Fe);return y?new Jo(u,p,y):null}return new Jo(u,p)}evaluate(e){const a=this.needle.evaluate(e),u=this.haystack.evaluate(e);if(!Ao(a,["boolean","string","number","null"]))throw new Hn(`Expected first argument to be of type boolean, string, number or null, but found ${on(yn(a))} instead.`);if(!Ao(u,["string","array"]))throw new Hn(`Expected second argument to be of type array or string, but found ${on(yn(u))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(e);return u.indexOf(a,p)}return u.indexOf(a)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var kl=Jo;class va{constructor(e,a,u,p,y,b){this.inputType=e,this.type=a,this.input=u,this.cases=p,this.outputs=y,this.otherwise=b}static parse(e,a){if(e.length<5)return a.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return a.error("Expected an even number of arguments.");let u,p;a.expectedType&&a.expectedType.kind!=="value"&&(p=a.expectedType);const y={},b=[];for(let P=2;P<e.length-1;P+=2){let O=e[P];const N=e[P+1];Array.isArray(O)||(O=[O]);const $=a.concat(P);if(O.length===0)return $.error("Expected at least one branch label.");for(const X of O){if(typeof X!="number"&&typeof X!="string")return $.error("Branch labels must be numbers or strings.");if(typeof X=="number"&&Math.abs(X)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof X=="number"&&Math.floor(X)!==X)return $.error("Numeric branch labels must be integer values.");if(u){if($.checkSubtype(u,yn(X)))return null}else u=yn(X);if(y[String(X)]!==void 0)return $.error("Branch labels must be unique.");y[String(X)]=b.length}const Z=a.parse(N,P,p);if(!Z)return null;p=p||Z.type,b.push(Z)}const T=a.parse(e[1],1,xi);if(!T)return null;const M=a.parse(e[e.length-1],e.length-1,p);return M?T.type.kind!=="value"&&a.concat(1).checkSubtype(u,T.type)?null:new va(u,p,T,y,b,M):null}evaluate(e){const a=this.input.evaluate(e);return(yn(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),u=[],p={};for(const b of a){const T=p[this.cases[b]];T===void 0?(p[this.cases[b]]=u.length,u.push([this.cases[b],[b]])):u[T][1].push(b)}const y=b=>this.inputType.kind==="number"?Number(b):b;for(const[b,T]of u)e.push(T.length===1?y(T[0]):T.map(y)),e.push(this.outputs[b].serialize());return e.push(this.otherwise.serialize()),e}}var tl=va;class el{constructor(e,a,u){this.type=e,this.branches=a,this.otherwise=u}static parse(e,a){if(e.length<4)return a.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return a.error("Expected an odd number of arguments.");let u;a.expectedType&&a.expectedType.kind!=="value"&&(u=a.expectedType);const p=[];for(let b=1;b<e.length-1;b+=2){const T=a.parse(e[b],b,hi);if(!T)return null;const M=a.parse(e[b+1],b+1,u);if(!M)return null;p.push([T,M]),u=u||M.type}const y=a.parse(e[e.length-1],e.length-1,u);return y?new el(u,p,y):null}evaluate(e){for(const[a,u]of this.branches)if(a.evaluate(e))return u.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[a,u]of this.branches)e(a),e(u);e(this.otherwise)}outputDefined(){return this.branches.every((([e,a])=>a.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild((a=>{e.push(a.serialize())})),e}}var fc=el;class il{constructor(e,a,u,p){this.type=e,this.input=a,this.beginIndex=u,this.endIndex=p}static parse(e,a){if(e.length<=2||e.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const u=a.parse(e[1],1,xi),p=a.parse(e[2],2,Fe);if(!u||!p)return null;if(!Co(u.type,[Zn(xi),mi,xi]))return a.error(`Expected first argument to be of type array or string, but found ${on(u.type)} instead`);if(e.length===4){const y=a.parse(e[3],3,Fe);return y?new il(u.type,u,p,y):null}return new il(u.type,u,p)}evaluate(e){const a=this.input.evaluate(e),u=this.beginIndex.evaluate(e);if(!Ao(a,["string","array"]))throw new Hn(`Expected first argument to be of type array or string, but found ${on(yn(a))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(e);return a.slice(u,p)}return a.slice(u)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var ju=il;function xa(s,e){return s==="=="||s==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Kc(s,e,a,u){return u.compare(e,a)===0}function Qo(s,e,a){const u=s!=="=="&&s!=="!=";return class VC{constructor(y,b,T){this.type=hi,this.lhs=y,this.rhs=b,this.collator=T,this.hasUntypedArgument=y.type.kind==="value"||b.type.kind==="value"}static parse(y,b){if(y.length!==3&&y.length!==4)return b.error("Expected two or three arguments.");const T=y[0];let M=b.parse(y[1],1,xi);if(!M)return null;if(!xa(T,M.type))return b.concat(1).error(`"${T}" comparisons are not supported for type '${on(M.type)}'.`);let P=b.parse(y[2],2,xi);if(!P)return null;if(!xa(T,P.type))return b.concat(2).error(`"${T}" comparisons are not supported for type '${on(P.type)}'.`);if(M.type.kind!==P.type.kind&&M.type.kind!=="value"&&P.type.kind!=="value")return b.error(`Cannot compare types '${on(M.type)}' and '${on(P.type)}'.`);u&&(M.type.kind==="value"&&P.type.kind!=="value"?M=new kr(P.type,[M]):M.type.kind!=="value"&&P.type.kind==="value"&&(P=new kr(M.type,[P])));let O=null;if(y.length===4){if(M.type.kind!=="string"&&P.type.kind!=="string"&&M.type.kind!=="value"&&P.type.kind!=="value")return b.error("Cannot use collator to compare non-string types.");if(O=b.parse(y[3],3,Ui),!O)return null}return new VC(M,P,O)}evaluate(y){const b=this.lhs.evaluate(y),T=this.rhs.evaluate(y);if(u&&this.hasUntypedArgument){const M=yn(b),P=yn(T);if(M.kind!==P.kind||M.kind!=="string"&&M.kind!=="number")throw new Hn(`Expected arguments for "${s}" to be (string, string) or (number, number), but found (${M.kind}, ${P.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const M=yn(b),P=yn(T);if(M.kind!=="string"||P.kind!=="string")return e(y,b,T)}return this.collator?a(y,b,T,this.collator.evaluate(y)):e(y,b,T)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[s];return this.eachChild((b=>{y.push(b.serialize())})),y}}}const Yc=Qo("==",(function(s,e,a){return e===a}),Kc),Vu=Qo("!=",(function(s,e,a){return e!==a}),(function(s,e,a,u){return!Kc(0,e,a,u)})),Ah=Qo("<",(function(s,e,a){return e<a}),(function(s,e,a,u){return u.compare(e,a)<0})),zs=Qo(">",(function(s,e,a){return e>a}),(function(s,e,a,u){return u.compare(e,a)>0})),Or=Qo("<=",(function(s,e,a){return e<=a}),(function(s,e,a,u){return u.compare(e,a)<=0})),Jc=Qo(">=",(function(s,e,a){return e>=a}),(function(s,e,a,u){return u.compare(e,a)>=0}));class ba{constructor(e,a,u,p,y,b){this.type=mi,this.number=e,this.locale=a,this.currency=u,this.unit=p,this.minFractionDigits=y,this.maxFractionDigits=b}static parse(e,a){if(e.length!==3)return a.error("Expected two arguments.");const u=a.parse(e[1],1,Fe);if(!u)return null;const p=e[2];if(typeof p!="object"||Array.isArray(p))return a.error("NumberFormat options argument must be an object.");let y=null;if(p.locale&&(y=a.parse(p.locale,1,mi),!y))return null;let b=null;if(p.currency&&(b=a.parse(p.currency,1,mi),!b))return null;let T=null;if(p.unit&&(T=a.parse(p.unit,1,mi),!T))return null;let M=null;if(p["min-fraction-digits"]&&(M=a.parse(p["min-fraction-digits"],1,Fe),!M))return null;let P=null;return p["max-fraction-digits"]&&(P=a.parse(p["max-fraction-digits"],1,Fe),!P)?null:new ba(u,y,b,T,M,P)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class wa{constructor(e){this.type=Fe,this.input=e}static parse(e,a){if(e.length!==2)return a.error(`Expected 1 argument, but found ${e.length-1} instead.`);const u=a.parse(e[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?a.error(`Expected argument of type string or array, but found ${on(u.type)} instead.`):new wa(u):null}evaluate(e){const a=this.input.evaluate(e);if(typeof a=="string"||Array.isArray(a))return a.length;throw new Hn(`Expected value to be of type string or array, but found ${on(yn(a))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild((a=>{e.push(a.serialize())})),e}}const pc={"==":Yc,"!=":Vu,">":zs,"<":Ah,">=":Jc,"<=":Or,array:kr,at:Ja,boolean:kr,case:fc,coalesce:dc,collator:Zo,format:Ir,image:$a,in:Qa,"index-of":kl,interpolate:no,"interpolate-hcl":no,"interpolate-lab":no,length:wa,let:Pl,literal:pr,match:tl,number:kr,"number-format":ba,object:kr,slice:ju,step:eo,string:kr,"to-boolean":$o,"to-color":$o,"to-number":$o,"to-string":$o,var:Sl,within:Ha};function Qc(s,[e,a,u,p]){e=e.evaluate(s),a=a.evaluate(s),u=u.evaluate(s);const y=p?p.evaluate(s):1,b=nc(e,a,u,y);if(b)throw new Hn(b);return new Xi(e/255*y,a/255*y,u/255*y,y)}function tr(s,e){return s in e}function mc(s,e){const a=e[s];return a===void 0?null:a}function ws(s){return{type:s}}ko.register(pc,{error:[{kind:"error"},[mi],(s,[e])=>{throw new Hn(e.evaluate(s))}],typeof:[mi,[xi],(s,[e])=>on(yn(e.evaluate(s)))],"to-rgba":[Zn(Fe,4),[On],(s,[e])=>e.evaluate(s).toArray()],rgb:[On,[Fe,Fe,Fe],Qc],rgba:[On,[Fe,Fe,Fe,Fe],Qc],has:{type:hi,overloads:[[[mi],(s,[e])=>tr(e.evaluate(s),s.properties())],[[mi,Ls],(s,[e,a])=>tr(e.evaluate(s),a.evaluate(s))]]},get:{type:xi,overloads:[[[mi],(s,[e])=>mc(e.evaluate(s),s.properties())],[[mi,Ls],(s,[e,a])=>mc(e.evaluate(s),a.evaluate(s))]]},"feature-state":[xi,[mi],(s,[e])=>mc(e.evaluate(s),s.featureState||{})],properties:[Ls,[],s=>s.properties()],"geometry-type":[mi,[],s=>s.geometryType()],id:[xi,[],s=>s.id()],zoom:[Fe,[],s=>s.globals.zoom],pitch:[Fe,[],s=>s.globals.pitch||0],"distance-from-center":[Fe,[],s=>s.distanceFromCenter()],"heatmap-density":[Fe,[],s=>s.globals.heatmapDensity||0],"line-progress":[Fe,[],s=>s.globals.lineProgress||0],"sky-radial-progress":[Fe,[],s=>s.globals.skyRadialProgress||0],accumulated:[xi,[],s=>s.globals.accumulated===void 0?null:s.globals.accumulated],"+":[Fe,ws(Fe),(s,e)=>{let a=0;for(const u of e)a+=u.evaluate(s);return a}],"*":[Fe,ws(Fe),(s,e)=>{let a=1;for(const u of e)a*=u.evaluate(s);return a}],"-":{type:Fe,overloads:[[[Fe,Fe],(s,[e,a])=>e.evaluate(s)-a.evaluate(s)],[[Fe],(s,[e])=>-e.evaluate(s)]]},"/":[Fe,[Fe,Fe],(s,[e,a])=>e.evaluate(s)/a.evaluate(s)],"%":[Fe,[Fe,Fe],(s,[e,a])=>e.evaluate(s)%a.evaluate(s)],ln2:[Fe,[],()=>Math.LN2],pi:[Fe,[],()=>Math.PI],e:[Fe,[],()=>Math.E],"^":[Fe,[Fe,Fe],(s,[e,a])=>Math.pow(e.evaluate(s),a.evaluate(s))],sqrt:[Fe,[Fe],(s,[e])=>Math.sqrt(e.evaluate(s))],log10:[Fe,[Fe],(s,[e])=>Math.log(e.evaluate(s))/Math.LN10],ln:[Fe,[Fe],(s,[e])=>Math.log(e.evaluate(s))],log2:[Fe,[Fe],(s,[e])=>Math.log(e.evaluate(s))/Math.LN2],sin:[Fe,[Fe],(s,[e])=>Math.sin(e.evaluate(s))],cos:[Fe,[Fe],(s,[e])=>Math.cos(e.evaluate(s))],tan:[Fe,[Fe],(s,[e])=>Math.tan(e.evaluate(s))],asin:[Fe,[Fe],(s,[e])=>Math.asin(e.evaluate(s))],acos:[Fe,[Fe],(s,[e])=>Math.acos(e.evaluate(s))],atan:[Fe,[Fe],(s,[e])=>Math.atan(e.evaluate(s))],min:[Fe,ws(Fe),(s,e)=>Math.min(...e.map((a=>a.evaluate(s))))],max:[Fe,ws(Fe),(s,e)=>Math.max(...e.map((a=>a.evaluate(s))))],abs:[Fe,[Fe],(s,[e])=>Math.abs(e.evaluate(s))],round:[Fe,[Fe],(s,[e])=>{const a=e.evaluate(s);return a<0?-Math.round(-a):Math.round(a)}],floor:[Fe,[Fe],(s,[e])=>Math.floor(e.evaluate(s))],ceil:[Fe,[Fe],(s,[e])=>Math.ceil(e.evaluate(s))],"filter-==":[hi,[mi,xi],(s,[e,a])=>s.properties()[e.value]===a.value],"filter-id-==":[hi,[xi],(s,[e])=>s.id()===e.value],"filter-type-==":[hi,[mi],(s,[e])=>s.geometryType()===e.value],"filter-<":[hi,[mi,xi],(s,[e,a])=>{const u=s.properties()[e.value],p=a.value;return typeof u==typeof p&&u<p}],"filter-id-<":[hi,[xi],(s,[e])=>{const a=s.id(),u=e.value;return typeof a==typeof u&&a<u}],"filter->":[hi,[mi,xi],(s,[e,a])=>{const u=s.properties()[e.value],p=a.value;return typeof u==typeof p&&u>p}],"filter-id->":[hi,[xi],(s,[e])=>{const a=s.id(),u=e.value;return typeof a==typeof u&&a>u}],"filter-<=":[hi,[mi,xi],(s,[e,a])=>{const u=s.properties()[e.value],p=a.value;return typeof u==typeof p&&u<=p}],"filter-id-<=":[hi,[xi],(s,[e])=>{const a=s.id(),u=e.value;return typeof a==typeof u&&a<=u}],"filter->=":[hi,[mi,xi],(s,[e,a])=>{const u=s.properties()[e.value],p=a.value;return typeof u==typeof p&&u>=p}],"filter-id->=":[hi,[xi],(s,[e])=>{const a=s.id(),u=e.value;return typeof a==typeof u&&a>=u}],"filter-has":[hi,[xi],(s,[e])=>e.value in s.properties()],"filter-has-id":[hi,[],s=>s.id()!==null&&s.id()!==void 0],"filter-type-in":[hi,[Zn(mi)],(s,[e])=>e.value.indexOf(s.geometryType())>=0],"filter-id-in":[hi,[Zn(xi)],(s,[e])=>e.value.indexOf(s.id())>=0],"filter-in-small":[hi,[mi,Zn(xi)],(s,[e,a])=>a.value.indexOf(s.properties()[e.value])>=0],"filter-in-large":[hi,[mi,Zn(xi)],(s,[e,a])=>(function(u,p,y,b){for(;y<=b;){const T=y+b>>1;if(p[T]===u)return!0;p[T]>u?b=T-1:y=T+1}return!1})(s.properties()[e.value],a.value,0,a.value.length-1)],all:{type:hi,overloads:[[[hi,hi],(s,[e,a])=>e.evaluate(s)&&a.evaluate(s)],[ws(hi),(s,e)=>{for(const a of e)if(!a.evaluate(s))return!1;return!0}]]},any:{type:hi,overloads:[[[hi,hi],(s,[e,a])=>e.evaluate(s)||a.evaluate(s)],[ws(hi),(s,e)=>{for(const a of e)if(a.evaluate(s))return!0;return!1}]]},"!":[hi,[hi],(s,[e])=>!e.evaluate(s)],"is-supported-script":[hi,[mi],(s,[e])=>{const a=s.globals&&s.globals.isSupportedScript;return!a||a(e.evaluate(s))}],upcase:[mi,[mi],(s,[e])=>e.evaluate(s).toUpperCase()],downcase:[mi,[mi],(s,[e])=>e.evaluate(s).toLowerCase()],concat:[mi,ws(xi),(s,e)=>e.map((a=>Pr(a.evaluate(s)))).join("")],"resolved-locale":[mi,[Ui],(s,[e])=>e.evaluate(s).resolvedLocale()]});var nl=pc;function _c(s){return{result:"success",value:s}}function ta(s){return{result:"error",value:s}}function er(s){return s["property-type"]==="data-driven"}function Il(s){return!!s.expression&&s.expression.parameters.indexOf("zoom")>-1}function Ll(s){return!!s.expression&&s.expression.interpolated}function Zi(s){return s instanceof Number?"number":s instanceof String?"string":s instanceof Boolean?"boolean":Array.isArray(s)?"array":s===null?"null":typeof s}function Dl(s){return typeof s=="object"&&s!==null&&!Array.isArray(s)}function yr(s){return s}function Lo(s,e){const a=e.type==="color",u=s.stops&&typeof s.stops[0][0]=="object",p=u||!(u||s.property!==void 0),y=s.type||(Ll(e)?"exponential":"interval");if(a&&((s=Vi({},s)).stops&&(s.stops=s.stops.map((P=>[P[0],Xi.parse(P[1])]))),s.default=Xi.parse(s.default?s.default:e.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!Ka[s.colorSpace])throw new Error(`Unknown color space: ${s.colorSpace}`);let b,T,M;if(y==="exponential")b=ro;else if(y==="interval")b=gc;else if(y==="categorical"){b=tu,T=Object.create(null);for(const P of s.stops)T[P[0]]=P[1];M=typeof s.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);b=eu}if(u){const P={},O=[];for(let Z=0;Z<s.stops.length;Z++){const X=s.stops[Z],J=X[0].zoom;P[J]===void 0&&(P[J]={zoom:J,type:s.type,property:s.property,default:s.default,stops:[]},O.push(J)),P[J].stops.push([X[0].value,X[1]])}const N=[];for(const Z of O)N.push([P[Z].zoom,Lo(P[Z],e)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:no.interpolationFactor.bind(void 0,$),zoomStops:N.map((Z=>Z[0])),evaluate:({zoom:Z},X)=>ro({stops:N,base:s.base},e,Z).evaluate(Z,X)}}if(p){const P=y==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:P,interpolationFactor:no.interpolationFactor.bind(void 0,P),zoomStops:s.stops.map((O=>O[0])),evaluate:({zoom:O})=>b(s,e,O,T,M)}}return{kind:"source",evaluate(P,O){const N=O&&O.properties?O.properties[s.property]:void 0;return N===void 0?Ta(s.default,e.default):b(s,e,N,T,M)}}}function Ta(s,e,a){return s!==void 0?s:e!==void 0?e:a!==void 0?a:void 0}function tu(s,e,a,u,p){return Ta(typeof a===p?u[a]:void 0,s.default,e.default)}function gc(s,e,a){if(Zi(a)!=="number")return Ta(s.default,e.default);const u=s.stops.length;if(u===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[u-1][0])return s.stops[u-1][1];const p=Zs(s.stops.map((y=>y[0])),a);return s.stops[p][1]}function ro(s,e,a){const u=s.base!==void 0?s.base:1;if(Zi(a)!=="number")return Ta(s.default,e.default);const p=s.stops.length;if(p===1||a<=s.stops[0][0])return s.stops[0][1];if(a>=s.stops[p-1][0])return s.stops[p-1][1];const y=Zs(s.stops.map((O=>O[0])),a),b=(function(O,N,$,Z){const X=Z-$,J=O-$;return X===0?0:N===1?J/X:(Math.pow(N,J)-1)/(Math.pow(N,X)-1)})(a,u,s.stops[y][0],s.stops[y+1][0]),T=s.stops[y][1],M=s.stops[y+1][1];let P=io[e.type]||yr;if(s.colorSpace&&s.colorSpace!=="rgb"){const O=Ka[s.colorSpace];P=(N,$)=>O.reverse(O.interpolate(O.forward(N),O.forward($),b))}return typeof T.evaluate=="function"?{evaluate(...O){const N=T.evaluate.apply(void 0,O),$=M.evaluate.apply(void 0,O);if(N!==void 0&&$!==void 0)return P(N,$,b)}}:P(T,M,b)}function eu(s,e,a){return e.type==="color"?a=Xi.parse(a):e.type==="formatted"?a=bs.fromString(a.toString()):e.type==="resolvedImage"?a=us.fromString(a.toString()):Zi(a)===e.type||e.type==="enum"&&e.values[a]||(a=void 0),Ta(a,s.default,e.default)}class zl{constructor(e,a){this.expression=e,this._warningHistory={},this._evaluator=new Wo,this._defaultValue=a?(function(u){return u.type==="color"&&(Dl(u.default)||Array.isArray(u.default))?new Xi(0,0,0,0):u.type==="color"?Xi.parse(u.default)||null:u.default===void 0?null:u.default})(a):null,this._enumValues=a&&a.type==="enum"?a.values:null}evaluateWithoutErrorHandling(e,a,u,p,y,b,T,M){return this._evaluator.globals=e,this._evaluator.feature=a,this._evaluator.featureState=u,this._evaluator.canonical=p||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=M||null,this.expression.evaluate(this._evaluator)}evaluate(e,a,u,p,y,b,T,M){this._evaluator.globals=e,this._evaluator.feature=a||null,this._evaluator.featureState=u||null,this._evaluator.canonical=p||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=b||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=M||null;try{const P=this.expression.evaluate(this._evaluator);if(P==null||typeof P=="number"&&P!=P)return this._defaultValue;if(this._enumValues&&!(P in this._enumValues))throw new Hn(`Expected value to be one of ${Object.keys(this._enumValues).map((O=>JSON.stringify(O))).join(", ")}, but found ${JSON.stringify(P)} instead.`);return P}catch(P){return this._warningHistory[P.message]||(this._warningHistory[P.message]=!0,typeof console<"u"&&console.warn(P.message)),this._defaultValue}}}function Ea(s){return Array.isArray(s)&&s.length>0&&typeof s[0]=="string"&&s[0]in nl}function Sa(s,e){const a=new cc(nl,[],e?(function(p){const y={color:On,string:mi,number:Fe,enum:mi,boolean:hi,formatted:xs,resolvedImage:Qs};return p.type==="array"?Zn(y[p.value]||xi,p.length):y[p.type]})(e):void 0),u=a.parse(s,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return u?_c(new zl(u,e)):ta(a.errors)}class Ol{constructor(e,a){this.kind=e,this._styleExpression=a,this.isStateDependent=e!=="constant"&&!Qr(a.expression)}evaluateWithoutErrorHandling(e,a,u,p,y,b){return this._styleExpression.evaluateWithoutErrorHandling(e,a,u,p,y,b)}evaluate(e,a,u,p,y,b){return this._styleExpression.evaluate(e,a,u,p,y,b)}}class Do{constructor(e,a,u,p){this.kind=e,this.zoomStops=u,this._styleExpression=a,this.isStateDependent=e!=="camera"&&!Qr(a.expression),this.interpolationType=p}evaluateWithoutErrorHandling(e,a,u,p,y,b){return this._styleExpression.evaluateWithoutErrorHandling(e,a,u,p,y,b)}evaluate(e,a,u,p,y,b){return this._styleExpression.evaluate(e,a,u,p,y,b)}interpolationFactor(e,a,u){return this.interpolationType?no.interpolationFactor(this.interpolationType,e,a,u):0}}function sl(s,e){if((s=Sa(s,e)).result==="error")return s;const a=s.value.expression,u=Ho(a);if(!u&&!er(e))return ta([new Is("","data expressions not supported")]);const p=qo(a,["zoom","pitch","distance-from-center"]);if(!p&&!Il(e))return ta([new Is("","zoom expressions not supported")]);const y=f(a);return y||p?y instanceof Is?ta([y]):y instanceof no&&!Ll(e)?ta([new Is("",'"interpolate" expressions cannot be used with this property')]):_c(y?new Do(u?"camera":"composite",s.value,y.labels,y instanceof no?y.interpolation:void 0):new Ol(u?"constant":"source",s.value)):ta([new Is("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Rl{constructor(e,a){this._parameters=e,this._specification=a,Vi(this,Lo(this._parameters,this._specification))}static deserialize(e){return new Rl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function f(s){let e=null;if(s instanceof Pl)e=f(s.result);else if(s instanceof dc){for(const a of s.args)if(e=f(a),e)break}else(s instanceof eo||s instanceof no)&&s.input instanceof ko&&s.input.name==="zoom"&&(e=s);return e instanceof Is||s.eachChild((a=>{const u=f(a);u instanceof Is?e=u:!e&&u?e=new Is("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&u&&e!==u&&(e=new Is("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),e}class x{constructor(e,a,u,p){this.message=(e?`${e}: `:"")+u,p&&(this.identifier=p),a!=null&&a.__line__&&(this.line=a.__line__)}}function A(s){const e=s.key,a=s.value,u=s.valueSpec||{},p=s.objectElementValidators||{},y=s.style,b=s.styleSpec;let T=[];const M=Zi(a);if(M!=="object")return[new x(e,a,`object expected, ${M} found`)];for(const P in a){const O=P.split(".")[0];let N;p[O]?N=p[O]:u[O]?N=Rs:p["*"]?N=p["*"]:u["*"]&&(N=Rs),N?T=T.concat(N({key:(e&&`${e}.`)+P,value:a[P],valueSpec:u[O]||u["*"],style:y,styleSpec:b,object:a,objectKey:P},a)):T.push(new x(e,a[P],`unknown property "${P}"`))}for(const P in u)p[P]||u[P].required&&u[P].default===void 0&&a[P]===void 0&&T.push(new x(e,a,`missing required property "${P}"`));return T}function F(s){const e=s.value,a=s.valueSpec,u=s.style,p=s.styleSpec,y=s.key,b=s.arrayElementValidator||Rs;if(Zi(e)!=="array")return[new x(y,e,`array expected, ${Zi(e)} found`)];if(a.length&&e.length!==a.length)return[new x(y,e,`array length ${a.length} expected, length ${e.length} found`)];if(a["min-length"]&&e.length<a["min-length"])return[new x(y,e,`array length at least ${a["min-length"]} expected, length ${e.length} found`)];let T={type:a.value,values:a.values,minimum:a.minimum,maximum:a.maximum,function:void 0};p.$version<7&&(T.function=a.function),Zi(a.value)==="object"&&(T=a.value);let M=[];for(let P=0;P<e.length;P++)M=M.concat(b({array:e,arrayIndex:P,value:e[P],valueSpec:T,style:u,styleSpec:p,key:`${y}[${P}]`}));return M}function q(s){const e=s.key,a=s.value,u=s.valueSpec;let p=Zi(a);if(p==="number"&&a!=a&&(p="NaN"),p!=="number")return[new x(e,a,`number expected, ${p} found`)];if("minimum"in u){let y=u.minimum;if(Zi(u.minimum)==="array"&&(y=u.minimum[s.arrayIndex]),a<y)return[new x(e,a,`${a} is less than the minimum value ${y}`)]}if("maximum"in u){let y=u.maximum;if(Zi(u.maximum)==="array"&&(y=u.maximum[s.arrayIndex]),a>y)return[new x(e,a,`${a} is greater than the maximum value ${y}`)]}return[]}function ot(s){const e=s.valueSpec,a=Li(s.value.type);let u,p,y,b={};const T=a!=="categorical"&&s.value.property===void 0,M=!T,P=Zi(s.value.stops)==="array"&&Zi(s.value.stops[0])==="array"&&Zi(s.value.stops[0][0])==="object",O=A({key:s.key,value:s.value,valueSpec:s.styleSpec.function,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{stops:function(Z){if(a==="identity")return[new x(Z.key,Z.value,'identity function may not have a "stops" property')];let X=[];const J=Z.value;return X=X.concat(F({key:Z.key,value:J,valueSpec:Z.valueSpec,style:Z.style,styleSpec:Z.styleSpec,arrayElementValidator:N})),Zi(J)==="array"&&J.length===0&&X.push(new x(Z.key,J,"array must have at least one stop")),X},default:function(Z){return Rs({key:Z.key,value:Z.value,valueSpec:e,style:Z.style,styleSpec:Z.styleSpec})}}});return a==="identity"&&T&&O.push(new x(s.key,s.value,'missing required property "property"')),a==="identity"||s.value.stops||O.push(new x(s.key,s.value,'missing required property "stops"')),a==="exponential"&&s.valueSpec.expression&&!Ll(s.valueSpec)&&O.push(new x(s.key,s.value,"exponential functions not supported")),s.styleSpec.$version>=8&&(M&&!er(s.valueSpec)?O.push(new x(s.key,s.value,"property functions not supported")):T&&!Il(s.valueSpec)&&O.push(new x(s.key,s.value,"zoom functions not supported"))),a!=="categorical"&&!P||s.value.property!==void 0||O.push(new x(s.key,s.value,'"property" property is required')),O;function N(Z){let X=[];const J=Z.value,ct=Z.key;if(Zi(J)!=="array")return[new x(ct,J,`array expected, ${Zi(J)} found`)];if(J.length!==2)return[new x(ct,J,`array length 2 expected, length ${J.length} found`)];if(P){if(Zi(J[0])!=="object")return[new x(ct,J,`object expected, ${Zi(J[0])} found`)];if(J[0].zoom===void 0)return[new x(ct,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new x(ct,J,"object stop key must have value")];const yt=Li(J[0].zoom);if(typeof yt!="number")return[new x(ct,J[0].zoom,"stop zoom values must be numbers")];if(y&&y>yt)return[new x(ct,J[0].zoom,"stop zoom values must appear in ascending order")];yt!==y&&(y=yt,p=void 0,b={}),X=X.concat(A({key:`${ct}[0]`,value:J[0],valueSpec:{zoom:{}},style:Z.style,styleSpec:Z.styleSpec,objectElementValidators:{zoom:q,value:$}}))}else X=X.concat($({key:`${ct}[0]`,value:J[0],style:Z.style,styleSpec:Z.styleSpec},J));return Ea(Un(J[1]))?X.concat([new x(`${ct}[1]`,J[1],"expressions are not allowed in function stops.")]):X.concat(Rs({key:`${ct}[1]`,value:J[1],valueSpec:e,style:Z.style,styleSpec:Z.styleSpec}))}function $(Z,X){const J=Zi(Z.value),ct=Li(Z.value),yt=Z.value!==null?Z.value:X;if(u){if(J!==u)return[new x(Z.key,yt,`${J} stop domain type must match previous stop domain type ${u}`)]}else u=J;if(J!=="number"&&J!=="string"&&J!=="boolean"&&typeof ct!="number"&&typeof ct!="string"&&typeof ct!="boolean")return[new x(Z.key,yt,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&a!=="categorical"){let Ct=`number expected, ${J} found`;return er(e)&&a===void 0&&(Ct+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new x(Z.key,yt,Ct)]}return a!=="categorical"||J!=="number"||typeof ct=="number"&&isFinite(ct)&&Math.floor(ct)===ct?a!=="categorical"&&J==="number"&&typeof ct=="number"&&typeof p=="number"&&p!==void 0&&ct<p?[new x(Z.key,yt,"stop domain values must appear in ascending order")]:(p=ct,a==="categorical"&&ct in b?[new x(Z.key,yt,"stop domain values must be unique")]:(b[ct]=!0,[])):[new x(Z.key,yt,`integer expected, found ${String(ct)}`)]}}function Pt(s){const e=(s.expressionContext==="property"?sl:Sa)(Un(s.value),s.valueSpec);if(e.result==="error")return e.value.map((u=>new x(`${s.key}${u.key}`,s.value,u.message)));const a=e.value.expression||e.value._styleExpression.expression;if(s.expressionContext==="property"&&s.propertyKey==="text-font"&&!a.outputDefined())return[new x(s.key,s.value,`Invalid data expression for "${s.propertyKey}". Output values must be contained as literals within the expression.`)];if(s.expressionContext==="property"&&s.propertyType==="layout"&&!Qr(a))return[new x(s.key,s.value,'"feature-state" data expressions are not supported with layout properties.')];if(s.expressionContext==="filter")return Yt(a,s);if(s.expressionContext&&s.expressionContext.indexOf("cluster")===0){if(!qo(a,["zoom","feature-state"]))return[new x(s.key,s.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(s.expressionContext==="cluster-initial"&&!Ho(a))return[new x(s.key,s.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yt(s,e){const a=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const p of e.valueSpec.expression.parameters)a.delete(p);if(a.size===0)return[];const u=[];return s instanceof ko&&a.has(s.name)?[new x(e.key,e.value,`["${s.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(s.eachChild((p=>{u.push(...Yt(p,e))})),u)}function ue(s){const e=s.key,a=s.value,u=s.valueSpec,p=[];return Array.isArray(u.values)?u.values.indexOf(Li(a))===-1&&p.push(new x(e,a,`expected one of [${u.values.join(", ")}], ${JSON.stringify(a)} found`)):Object.keys(u.values).indexOf(Li(a))===-1&&p.push(new x(e,a,`expected one of [${Object.keys(u.values).join(", ")}], ${JSON.stringify(a)} found`)),p}function Ie(s){if(s===!0||s===!1)return!0;if(!Array.isArray(s)||s.length===0)return!1;switch(s[0]){case"has":return s.length>=2&&s[1]!=="$id"&&s[1]!=="$type";case"in":return s.length>=3&&(typeof s[1]!="string"||Array.isArray(s[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return s.length!==3||Array.isArray(s[1])||Array.isArray(s[2]);case"any":case"all":for(const e of s.slice(1))if(!Ie(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function ni(s,e="fill"){if(s==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ie(s)||(s=Os(s));const a=s;let u=!0;try{u=(function(P){if(!$n(P))return P;let O=Un(P);return Di(O),O=wi(O),O})(a)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(a,null,2)}
        `)}const p=le[`filter_${e}`],y=Sa(u,p);let b=null;if(y.result==="error")throw new Error(y.value.map((P=>`${P.key}: ${P.message}`)).join(", "));b=(P,O,N)=>y.value.evaluate(P,O,{},N);let T=null,M=null;if(u!==a){const P=Sa(a,p);if(P.result==="error")throw new Error(P.value.map((O=>`${O.key}: ${O.message}`)).join(", "));T=(O,N,$,Z,X)=>P.value.evaluate(O,N,{},$,void 0,void 0,Z,X),M=!Ho(P.value.expression)}return{filter:b,dynamicFilter:T||void 0,needGeometry:Hs(u),needFeature:!!M}}function wi(s){if(!Array.isArray(s))return s;const e=(function(a){if(ss.has(a[0])){for(let u=1;u<a.length;u++)if($n(a[u]))return!0}return a})(s);return e===!0?e:e.map((a=>wi(a)))}function Di(s){let e=!1;const a=[];if(s[0]==="case"){for(let u=1;u<s.length-1;u+=2)e=e||$n(s[u]),a.push(s[u+1]);a.push(s[s.length-1])}else if(s[0]==="match"){e=e||$n(s[1]);for(let u=2;u<s.length-1;u+=2)a.push(s[u+1]);a.push(s[s.length-1])}else if(s[0]==="step"){e=e||$n(s[1]);for(let u=1;u<s.length-1;u+=2)a.push(s[u+1])}e&&(s.length=0,s.push("any",...a));for(let u=1;u<s.length;u++)Di(s[u])}function $n(s){if(!Array.isArray(s))return!1;if((e=s[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let a=1;a<s.length;a++)if($n(s[a]))return!0;return!1}const ss=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function vr(s,e){return s<e?-1:s>e?1:0}function Hs(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(let e=1;e<s.length;e++)if(Hs(s[e]))return!0;return!1}function Os(s){if(!s)return!0;const e=s[0];return s.length<=1?e!=="any":e==="=="?Bl(s[1],s[2],"=="):e==="!="?Fl(Bl(s[1],s[2],"==")):e==="<"||e===">"||e==="<="||e===">="?Bl(s[1],s[2],e):e==="any"?(a=s.slice(1),["any"].concat(a.map(Os))):e==="all"?["all"].concat(s.slice(1).map(Os)):e==="none"?["all"].concat(s.slice(1).map(Os).map(Fl)):e==="in"?yc(s[1],s.slice(2)):e==="!in"?Fl(yc(s[1],s.slice(2))):e==="has"?iu(s[1]):e==="!has"?Fl(iu(s[1])):e!=="within"||s;var a}function Bl(s,e,a){switch(s){case"$type":return[`filter-type-${a}`,e];case"$id":return[`filter-id-${a}`,e];default:return[`filter-${a}`,s,e]}}function yc(s,e){if(e.length===0)return!1;switch(s){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some((a=>typeof a!=typeof e[0]))?["filter-in-large",s,["literal",e.sort(vr)]]:["filter-in-small",s,["literal",e]]}}function iu(s){switch(s){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",s]}}function Fl(s){return["!",s]}function Nl(s){return Ie(Un(s.value))?Pt(Vi({},s,{expressionContext:"filter",valueSpec:s.styleSpec[`filter_${s.layerType||"fill"}`]})):oo(s)}function oo(s){const e=s.value,a=s.key;if(Zi(e)!=="array")return[new x(a,e,`array expected, ${Zi(e)} found`)];const u=s.styleSpec;let p,y=[];if(e.length<1)return[new x(a,e,"filter array must have at least 1 element")];switch(y=y.concat(ue({key:`${a}[0]`,value:e[0],valueSpec:u.filter_operator,style:s.style,styleSpec:s.styleSpec})),Li(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&Li(e[1])==="$type"&&y.push(new x(a,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&y.push(new x(a,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(p=Zi(e[1]),p!=="string"&&y.push(new x(`${a}[1]`,e[1],`string expected, ${p} found`)));for(let b=2;b<e.length;b++)p=Zi(e[b]),Li(e[1])==="$type"?y=y.concat(ue({key:`${a}[${b}]`,value:e[b],valueSpec:u.geometry_type,style:s.style,styleSpec:s.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&y.push(new x(`${a}[${b}]`,e[b],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let b=1;b<e.length;b++)y=y.concat(oo({key:`${a}[${b}]`,value:e[b],style:s.style,styleSpec:s.styleSpec}));break;case"has":case"!has":p=Zi(e[1]),e.length!==2?y.push(new x(a,e,`filter array for "${e[0]}" operator must have 2 elements`)):p!=="string"&&y.push(new x(`${a}[1]`,e[1],`string expected, ${p} found`));break;case"within":p=Zi(e[1]),e.length!==2?y.push(new x(a,e,`filter array for "${e[0]}" operator must have 2 elements`)):p!=="object"&&y.push(new x(`${a}[1]`,e[1],`object expected, ${p} found`))}return y}function pn(s,e){const a=s.key,u=s.style,p=s.styleSpec,y=s.value,b=s.objectKey,T=p[`${e}_${s.layerType}`];if(!T)return[];const M=b.match(/^(.*)-transition$/);if(e==="paint"&&M&&T[M[1]]&&T[M[1]].transition)return Rs({key:a,value:y,valueSpec:p.transition,style:u,styleSpec:p});const P=s.valueSpec||T[b];if(!P)return[new x(a,y,`unknown property "${b}"`)];let O;if(Zi(y)==="string"&&er(P)&&!P.tokens&&(O=/^{([^}]+)}$/.exec(y))){const $=`\`{ "type": "identity", "property": ${O?JSON.stringify(O[1]):'"_"'} }\``;return[new x(a,y,`"${b}" does not support interpolation syntax
Use an identity property function instead: ${$}.`)]}const N=[];return s.layerType==="symbol"&&(b==="text-field"&&u&&!u.glyphs&&N.push(new x(a,y,'use of "text-field" requires a style "glyphs" property')),b==="text-font"&&Dl(Un(y))&&Li(y.type)==="identity"&&N.push(new x(a,y,'"text-font" does not support identity functions'))),N.concat(Rs({key:s.key,value:y,valueSpec:P,style:u,styleSpec:p,expressionContext:"property",propertyType:e,propertyKey:b}))}function jl(s){return pn(s,"paint")}function nu(s){return pn(s,"layout")}function Uu(s){let e=[];const a=s.value,u=s.key,p=s.style,y=s.styleSpec;a.type||a.ref||e.push(new x(u,a,'either "type" or "ref" is required'));let b=Li(a.type);const T=Li(a.ref);if(a.id){const M=Li(a.id);for(let P=0;P<s.arrayIndex;P++){const O=p.layers[P];Li(O.id)===M&&e.push(new x(u,a.id,`duplicate layer id "${a.id}", previously used at line ${O.id.__line__}`))}}if("ref"in a){let M;["type","source","source-layer","filter","layout"].forEach((P=>{P in a&&e.push(new x(u,a[P],`"${P}" is prohibited for ref layers`))})),p.layers.forEach((P=>{Li(P.id)===T&&(M=P)})),M?M.ref?e.push(new x(u,a.ref,"ref cannot reference another ref layer")):b=Li(M.type):typeof T=="string"&&e.push(new x(u,a.ref,`ref layer "${T}" not found`))}else if(b!=="background"&&b!=="sky")if(a.source){const M=p.sources&&p.sources[a.source],P=M&&Li(M.type);M?P==="vector"&&b==="raster"?e.push(new x(u,a.source,`layer "${a.id}" requires a raster source`)):P==="raster"&&b!=="raster"?e.push(new x(u,a.source,`layer "${a.id}" requires a vector source`)):P!=="vector"||a["source-layer"]?P==="raster-dem"&&b!=="hillshade"?e.push(new x(u,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):b!=="line"||!a.paint||!a.paint["line-gradient"]&&!a.paint["line-trim-offset"]||P==="geojson"&&M.lineMetrics||e.push(new x(u,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new x(u,a,`layer "${a.id}" must specify a "source-layer"`)):e.push(new x(u,a.source,`source "${a.source}" not found`))}else e.push(new x(u,a,'missing required property "source"'));return e=e.concat(A({key:u,value:a,valueSpec:y.layer,style:s.style,styleSpec:s.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Rs({key:`${u}.type`,value:a.type,valueSpec:y.layer.type,style:s.style,styleSpec:s.styleSpec,object:a,objectKey:"type"}),filter:M=>Nl(Vi({layerType:b},M)),layout:M=>A({layer:a,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":P=>nu(Vi({layerType:b},P))}}),paint:M=>A({layer:a,key:M.key,value:M.value,valueSpec:{},style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":P=>jl(Vi({layerType:b},P))}})}})),e}function ea(s){const e=s.value,a=s.key,u=Zi(e);return u!=="string"?[new x(a,e,`string expected, ${u} found`)]:[]}const vc={promoteId:function({key:s,value:e}){if(Zi(e)==="string")return ea({key:s,value:e});{const a=[];for(const u in e)a.push(...ea({key:`${s}.${u}`,value:e[u]}));return a}}};function su(s){const e=s.value,a=s.key,u=s.styleSpec,p=s.style;if(!e.type)return[new x(a,e,'"type" is required')];const y=Li(e.type);let b;switch(y){case"vector":case"raster":case"raster-dem":return b=A({key:a,value:e,valueSpec:u[`source_${y.replace("-","_")}`],style:s.style,styleSpec:u,objectElementValidators:vc}),b;case"geojson":if(b=A({key:a,value:e,valueSpec:u.source_geojson,style:p,styleSpec:u,objectElementValidators:vc}),e.cluster)for(const T in e.clusterProperties){const[M,P]=e.clusterProperties[T],O=typeof M=="string"?[M,["accumulated"],["get",T]]:M;b.push(...Pt({key:`${a}.${T}.map`,value:P,expressionContext:"cluster-map"})),b.push(...Pt({key:`${a}.${T}.reduce`,value:O,expressionContext:"cluster-reduce"}))}return b;case"video":return A({key:a,value:e,valueSpec:u.source_video,style:p,styleSpec:u});case"image":return A({key:a,value:e,valueSpec:u.source_image,style:p,styleSpec:u});case"canvas":return[new x(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ue({key:`${a}.type`,value:e.type,valueSpec:{values:Ph(u)}})}}function Ph(s){return s.source.reduce(((e,a)=>{const u=s[a];return u.type.type==="enum"&&(e=e.concat(Object.keys(u.type.values))),e}),[])}function kd(s){const e=s.value,a=s.styleSpec,u=a.light,p=s.style;let y=[];const b=Zi(e);if(e===void 0)return y;if(b!=="object")return y=y.concat([new x("light",e,`object expected, ${b} found`)]),y;for(const T in e){const M=T.match(/^(.*)-transition$/);y=y.concat(M&&u[M[1]]&&u[M[1]].transition?Rs({key:T,value:e[T],valueSpec:a.transition,style:p,styleSpec:a}):u[T]?Rs({key:T,value:e[T],valueSpec:u[T],style:p,styleSpec:a}):[new x(T,e[T],`unknown property "${T}"`)])}return y}function $u(s){const e=s.value,a=s.key,u=s.style,p=s.styleSpec,y=p.terrain;let b=[];const T=Zi(e);if(e===void 0)return b;if(T!=="object")return b=b.concat([new x("terrain",e,`object expected, ${T} found`)]),b;for(const M in e){const P=M.match(/^(.*)-transition$/);b=b.concat(P&&y[P[1]]&&y[P[1]].transition?Rs({key:M,value:e[M],valueSpec:p.transition,style:u,styleSpec:p}):y[M]?Rs({key:M,value:e[M],valueSpec:y[M],style:u,styleSpec:p}):[new x(M,e[M],`unknown property "${M}"`)])}if(e.source){const M=u.sources&&u.sources[e.source],P=M&&Li(M.type);M?P!=="raster-dem"&&b.push(new x(a,e.source,`terrain cannot be used with a source of type ${String(P)}, it only be used with a "raster-dem" source type`)):b.push(new x(a,e.source,`source "${e.source}" not found`))}else b.push(new x(a,e,'terrain is missing required property "source"'));return b}function Id(s){const e=s.value,a=s.style,u=s.styleSpec,p=u.fog;let y=[];const b=Zi(e);if(e===void 0)return y;if(b!=="object")return y=y.concat([new x("fog",e,`object expected, ${b} found`)]),y;for(const T in e){const M=T.match(/^(.*)-transition$/);y=y.concat(M&&p[M[1]]&&p[M[1]].transition?Rs({key:T,value:e[T],valueSpec:u.transition,style:a,styleSpec:u}):p[T]?Rs({key:T,value:e[T],valueSpec:p[T],style:a,styleSpec:u}):[new x(T,e[T],`unknown property "${T}"`)])}return y}const kh={"*":()=>[],array:F,boolean:function(s){const e=s.value,a=s.key,u=Zi(e);return u!=="boolean"?[new x(a,e,`boolean expected, ${u} found`)]:[]},number:q,color:function(s){const e=s.key,a=s.value,u=Zi(a);return u!=="string"?[new x(e,a,`color expected, ${u} found`)]:fr(a)===null?[new x(e,a,`color expected, "${a}" found`)]:[]},enum:ue,filter:Nl,function:ot,layer:Uu,object:A,source:su,light:kd,terrain:$u,fog:Id,string:ea,formatted:function(s){return ea(s).length===0?[]:Pt(s)},resolvedImage:function(s){return ea(s).length===0?[]:Pt(s)},projection:function(s){const e=s.value,a=s.styleSpec,u=a.projection,p=s.style;let y=[];const b=Zi(e);if(b==="object")for(const T in e)y=y.concat(Rs({key:T,value:e[T],valueSpec:u[T],style:p,styleSpec:a}));else b!=="string"&&(y=y.concat([new x("projection",e,`object or string expected, ${b} found`)]));return y}};function Rs(s){const e=s.value,a=s.valueSpec,u=s.styleSpec;return a.expression&&Dl(Li(e))?ot(s):a.expression&&Ea(Un(e))?Pt(s):a.type&&kh[a.type]?kh[a.type](s):A(Vi({},s,{valueSpec:a.type?u[a.type]:a}))}function Ld(s){const e=s.value,a=s.key,u=ea(s);return u.length||(e.indexOf("{fontstack}")===-1&&u.push(new x(a,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&u.push(new x(a,e,'"glyphs" url must include a "{range}" token'))),u}function rl(s,e=le){return Wr(Rs({key:"",value:s,valueSpec:e.$root,styleSpec:e,style:s,objectElementValidators:{glyphs:Ld,"*":()=>[]}}))}const Dd=s=>Wr(jl(s)),Ih=s=>Wr(nu(s));function Wr(s){return s.slice().sort(((e,a)=>e.line&&a.line?e.line-a.line:0))}function Wu(s,e){let a=!1;if(e&&e.length)for(const u of e)s.fire(new Cr(new Error(u.message))),a=!0;return a}var zd=ia,Zr=3;function ia(s,e,a){var u=this.cells=[];if(s instanceof ArrayBuffer){this.arrayBuffer=s;var p=new Int32Array(this.arrayBuffer);s=p[0],this.d=(e=p[1])+2*(a=p[2]);for(var y=0;y<this.d*this.d;y++){var b=p[Zr+y],T=p[Zr+y+1];u.push(b===T?null:p.subarray(b,T))}var M=p[Zr+u.length+1];this.keys=p.subarray(p[Zr+u.length],M),this.bboxes=p.subarray(M),this.insert=this._insertReadonly}else{this.d=e+2*a;for(var P=0;P<this.d*this.d;P++)u.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=s,this.padding=a,this.scale=e/s,this.uid=0;var O=a/e*s;this.min=-O,this.max=s+O}ia.prototype.insert=function(s,e,a,u,p){this._forEachCell(e,a,u,p,this._insertCell,this.uid++),this.keys.push(s),this.bboxes.push(e),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(p)},ia.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ia.prototype._insertCell=function(s,e,a,u,p,y){this.cells[p].push(y)},ia.prototype.query=function(s,e,a,u,p){var y=this.min,b=this.max;if(s<=y&&e<=y&&b<=a&&b<=u&&!p)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(s,e,a,u,this._queryCell,T,{},p),T},ia.prototype._queryCell=function(s,e,a,u,p,y,b,T){var M=this.cells[p];if(M!==null)for(var P=this.keys,O=this.bboxes,N=0;N<M.length;N++){var $=M[N];if(b[$]===void 0){var Z=4*$;(T?T(O[Z+0],O[Z+1],O[Z+2],O[Z+3]):s<=O[Z+2]&&e<=O[Z+3]&&a>=O[Z+0]&&u>=O[Z+1])?(b[$]=!0,y.push(P[$])):b[$]=!1}}},ia.prototype._forEachCell=function(s,e,a,u,p,y,b,T){for(var M=this._convertToCellCoord(s),P=this._convertToCellCoord(e),O=this._convertToCellCoord(a),N=this._convertToCellCoord(u),$=M;$<=O;$++)for(var Z=P;Z<=N;Z++){var X=this.d*Z+$;if((!T||T(this._convertFromCellCoord($),this._convertFromCellCoord(Z),this._convertFromCellCoord($+1),this._convertFromCellCoord(Z+1)))&&p.call(this,s,e,a,u,X,y,b,T))return}},ia.prototype._convertFromCellCoord=function(s){return(s-this.padding)/this.scale},ia.prototype._convertToCellCoord=function(s){return Math.max(0,Math.min(this.d-1,Math.floor(s*this.scale)+this.padding))},ia.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var s=this.cells,e=Zr+this.cells.length+1+1,a=0,u=0;u<this.cells.length;u++)a+=this.cells[u].length;var p=new Int32Array(e+a+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var y=e,b=0;b<s.length;b++){var T=s[b];p[Zr+b]=y,p.set(T,y),y+=T.length}return p[Zr+s.length]=y,p.set(this.keys,y),p[Zr+s.length+1]=y+=this.keys.length,p.set(this.bboxes,y),y+=this.bboxes.length,p.buffer};var Gr=mt(zd);const zo={};function Je(s,e,a={}){Object.defineProperty(s,"_classRegistryKey",{value:e,writeable:!1}),zo[e]={klass:s,omit:a.omit||[]}}Je(Object,"Object"),Gr.serialize=function(s,e){const a=s.toArrayBuffer();return e&&e.push(a),{buffer:a}},Gr.deserialize=function(s){return new Gr(s.buffer)},Object.defineProperty(Gr,"name",{value:"Grid"}),Je(Gr,"Grid"),Je(Xi,"Color"),Je(Error,"Error"),Je(Cn,"AJAXError"),Je(us,"ResolvedImage"),Je(Rl,"StylePropertyFunction"),Je(zl,"StyleExpression",{omit:["_evaluator"]}),Je(Do,"ZoomDependentExpression"),Je(Ol,"ZoomConstantExpression"),Je(ko,"CompoundExpression",{omit:["_evaluate"]});for(const s in nl)zo[nl[s]._classRegistryKey]||Je(nl[s],`Expression${s}`);function Lh(s){return s&&typeof ArrayBuffer<"u"&&(s instanceof ArrayBuffer||s.constructor&&s.constructor.name==="ArrayBuffer")}function Dh(s){return E.ImageBitmap&&s instanceof E.ImageBitmap}function xc(s,e){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp)return s;if(Lh(s)||Dh(s))return e&&e.push(s),s;if(ArrayBuffer.isView(s)){const a=s;return e&&e.push(a.buffer),a}if(s instanceof E.ImageData)return e&&e.push(s.data.buffer),s;if(Array.isArray(s)){const a=[];for(const u of s)a.push(xc(u,e));return a}if(typeof s=="object"){const a=s.constructor,u=a._classRegistryKey;if(!u)throw new Error(`can't serialize object of unregistered class ${u}`);const p=a.serialize?a.serialize(s,e):{};if(!a.serialize){for(const y in s)s.hasOwnProperty(y)&&(zo[u].omit.indexOf(y)>=0||(p[y]=xc(s[y],e)));s instanceof Error&&(p.message=s.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(p.$name=u),p}throw new Error("can't serialize object of type "+typeof s)}function Vl(s){if(s==null||typeof s=="boolean"||typeof s=="number"||typeof s=="string"||s instanceof Boolean||s instanceof Number||s instanceof String||s instanceof Date||s instanceof RegExp||Lh(s)||Dh(s)||ArrayBuffer.isView(s)||s instanceof E.ImageData)return s;if(Array.isArray(s))return s.map(Vl);if(typeof s=="object"){const e=s.$name||"Object",{klass:a}=zo[e];if(!a)throw new Error(`can't deserialize unregistered class ${e}`);if(a.deserialize)return a.deserialize(s);const u=Object.create(a.prototype);for(const p of Object.keys(s))p!=="$name"&&(u[p]=Vl(s[p]));return u}throw new Error("can't deserialize object of type "+typeof s)}const Ze={"Latin-1 Supplement":s=>s>=128&&s<=255,Arabic:s=>s>=1536&&s<=1791,"Arabic Supplement":s=>s>=1872&&s<=1919,"Arabic Extended-A":s=>s>=2208&&s<=2303,"Hangul Jamo":s=>s>=4352&&s<=4607,"Unified Canadian Aboriginal Syllabics":s=>s>=5120&&s<=5759,Khmer:s=>s>=6016&&s<=6143,"Unified Canadian Aboriginal Syllabics Extended":s=>s>=6320&&s<=6399,"General Punctuation":s=>s>=8192&&s<=8303,"Letterlike Symbols":s=>s>=8448&&s<=8527,"Number Forms":s=>s>=8528&&s<=8591,"Miscellaneous Technical":s=>s>=8960&&s<=9215,"Control Pictures":s=>s>=9216&&s<=9279,"Optical Character Recognition":s=>s>=9280&&s<=9311,"Enclosed Alphanumerics":s=>s>=9312&&s<=9471,"Geometric Shapes":s=>s>=9632&&s<=9727,"Miscellaneous Symbols":s=>s>=9728&&s<=9983,"Miscellaneous Symbols and Arrows":s=>s>=11008&&s<=11263,"CJK Radicals Supplement":s=>s>=11904&&s<=12031,"Kangxi Radicals":s=>s>=12032&&s<=12255,"Ideographic Description Characters":s=>s>=12272&&s<=12287,"CJK Symbols and Punctuation":s=>s>=12288&&s<=12351,Hiragana:s=>s>=12352&&s<=12447,Katakana:s=>s>=12448&&s<=12543,Bopomofo:s=>s>=12544&&s<=12591,"Hangul Compatibility Jamo":s=>s>=12592&&s<=12687,Kanbun:s=>s>=12688&&s<=12703,"Bopomofo Extended":s=>s>=12704&&s<=12735,"CJK Strokes":s=>s>=12736&&s<=12783,"Katakana Phonetic Extensions":s=>s>=12784&&s<=12799,"Enclosed CJK Letters and Months":s=>s>=12800&&s<=13055,"CJK Compatibility":s=>s>=13056&&s<=13311,"CJK Unified Ideographs Extension A":s=>s>=13312&&s<=19903,"Yijing Hexagram Symbols":s=>s>=19904&&s<=19967,"CJK Unified Ideographs":s=>s>=19968&&s<=40959,"Yi Syllables":s=>s>=40960&&s<=42127,"Yi Radicals":s=>s>=42128&&s<=42191,"Hangul Jamo Extended-A":s=>s>=43360&&s<=43391,"Hangul Syllables":s=>s>=44032&&s<=55215,"Hangul Jamo Extended-B":s=>s>=55216&&s<=55295,"Private Use Area":s=>s>=57344&&s<=63743,"CJK Compatibility Ideographs":s=>s>=63744&&s<=64255,"Arabic Presentation Forms-A":s=>s>=64336&&s<=65023,"Vertical Forms":s=>s>=65040&&s<=65055,"CJK Compatibility Forms":s=>s>=65072&&s<=65103,"Small Form Variants":s=>s>=65104&&s<=65135,"Arabic Presentation Forms-B":s=>s>=65136&&s<=65279,"Halfwidth and Fullwidth Forms":s=>s>=65280&&s<=65519};function zh(s){for(const e of s)if(bc(e.charCodeAt(0)))return!0;return!1}function Lf(s){for(const e of s)if(!Oh(e.charCodeAt(0)))return!1;return!0}function Oh(s){return!(Ze.Arabic(s)||Ze["Arabic Supplement"](s)||Ze["Arabic Extended-A"](s)||Ze["Arabic Presentation Forms-A"](s)||Ze["Arabic Presentation Forms-B"](s))}function bc(s){return!(s!==746&&s!==747&&(s<4352||!(Ze["Bopomofo Extended"](s)||Ze.Bopomofo(s)||Ze["CJK Compatibility Forms"](s)&&!(s>=65097&&s<=65103)||Ze["CJK Compatibility Ideographs"](s)||Ze["CJK Compatibility"](s)||Ze["CJK Radicals Supplement"](s)||Ze["CJK Strokes"](s)||!(!Ze["CJK Symbols and Punctuation"](s)||s>=12296&&s<=12305||s>=12308&&s<=12319||s===12336)||Ze["CJK Unified Ideographs Extension A"](s)||Ze["CJK Unified Ideographs"](s)||Ze["Enclosed CJK Letters and Months"](s)||Ze["Hangul Compatibility Jamo"](s)||Ze["Hangul Jamo Extended-A"](s)||Ze["Hangul Jamo Extended-B"](s)||Ze["Hangul Jamo"](s)||Ze["Hangul Syllables"](s)||Ze.Hiragana(s)||Ze["Ideographic Description Characters"](s)||Ze.Kanbun(s)||Ze["Kangxi Radicals"](s)||Ze["Katakana Phonetic Extensions"](s)||Ze.Katakana(s)&&s!==12540||!(!Ze["Halfwidth and Fullwidth Forms"](s)||s===65288||s===65289||s===65293||s>=65306&&s<=65310||s===65339||s===65341||s===65343||s>=65371&&s<=65503||s===65507||s>=65512&&s<=65519)||!(!Ze["Small Form Variants"](s)||s>=65112&&s<=65118||s>=65123&&s<=65126)||Ze["Unified Canadian Aboriginal Syllabics"](s)||Ze["Unified Canadian Aboriginal Syllabics Extended"](s)||Ze["Vertical Forms"](s)||Ze["Yijing Hexagram Symbols"](s)||Ze["Yi Syllables"](s)||Ze["Yi Radicals"](s))))}function ru(s){return!(bc(s)||(function(e){return!!(Ze["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Ze["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Ze["Letterlike Symbols"](e)||Ze["Number Forms"](e)||Ze["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ze["Control Pictures"](e)&&e!==9251||Ze["Optical Character Recognition"](e)||Ze["Enclosed Alphanumerics"](e)||Ze["Geometric Shapes"](e)||Ze["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ze["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ze["CJK Symbols and Punctuation"](e)||Ze.Katakana(e)||Ze["Private Use Area"](e)||Ze["CJK Compatibility Forms"](e)||Ze["Small Form Variants"](e)||Ze["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)})(s))}function Od(s){return s>=1424&&s<=2303||Ze["Arabic Presentation Forms-A"](s)||Ze["Arabic Presentation Forms-B"](s)}function Df(s,e){return!(!e&&Od(s)||s>=2304&&s<=3583||s>=3840&&s<=4255||Ze.Khmer(s))}function ou(s){for(const e of s)if(Od(e.charCodeAt(0)))return!0;return!1}const it="deferred",D="loading",H="loaded";let pt=null,m="unavailable",o=null;const h=function(s){s&&typeof s=="string"&&s.indexOf("NetworkError")>-1&&(m="error"),pt&&pt(s)};function g(){w.fire(new dr("pluginStateChange",{pluginStatus:m,pluginURL:o}))}const w=new ma,S=function(){return m},k=function(){if(m!==it||!o)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");m=D,g(),o&&Eo({url:o},(s=>{s?h(s):(m=H,g())}))},I={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>m===H||I.applyArabicShaping!=null,isLoading:()=>m===D,setState(s){m=s.pluginStatus,o=s.pluginURL},isParsed:()=>I.applyArabicShaping!=null&&I.processBidirectionalText!=null&&I.processStyledBidirectionalText!=null,getPluginURL:()=>o};class B{constructor(e,a){this.zoom=e,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return(function(a,u){for(const p of a)if(!Df(p.charCodeAt(0),u))return!1;return!0})(e,I.isLoaded())}}class V{constructor(e,a){this.property=e,this.value=a,this.expression=(function(u,p){if(Dl(u))return new Rl(u,p);if(Ea(u)){const y=sl(u,p);if(y.result==="error")throw new Error(y.value.map((b=>`${b.key}: ${b.message}`)).join(", "));return y.value}{let y=u;return typeof u=="string"&&p.type==="color"&&(y=Xi.parse(u)),{kind:"constant",evaluate:()=>y}}})(a===void 0?e.specification.default:a,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,a,u){return this.property.possiblyEvaluate(this,e,a,u)}}class U{constructor(e){this.property=e,this.value=new V(e,void 0)}transitioned(e,a){return new tt(this.property,this.value,a,je({},e.transition,this.transition),e.now)}untransitioned(){return new tt(this.property,this.value,null,{},0)}}class K{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Jt(this._values[e].value.value)}setValue(e,a){this._values.hasOwnProperty(e)||(this._values[e]=new U(this._values[e].property)),this._values[e].value=new V(this._values[e].property,a===null?void 0:Jt(a))}getTransition(e){return Jt(this._values[e].transition)}setTransition(e,a){this._values.hasOwnProperty(e)||(this._values[e]=new U(this._values[e].property)),this._values[e].transition=Jt(a)||void 0}serialize(){const e={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(e[a]=u);const p=this.getTransition(a);p!==void 0&&(e[`${a}-transition`]=p)}return e}transitioned(e,a){const u=new at(this._properties);for(const p of Object.keys(this._values))u._values[p]=this._values[p].transitioned(e,a._values[p]);return u}untransitioned(){const e=new at(this._properties);for(const a of Object.keys(this._values))e._values[a]=this._values[a].untransitioned();return e}}class tt{constructor(e,a,u,p,y){const b=p.delay||0,T=p.duration||0;y=y||0,this.property=e,this.value=a,this.begin=y+b,this.end=this.begin+T,e.specification.transition&&(p.delay||p.duration)&&(this.prior=u)}possiblyEvaluate(e,a,u){const p=e.now||0,y=this.value.possiblyEvaluate(e,a,u),b=this.prior;if(b){if(p>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(p<this.begin)return b.possiblyEvaluate(e,a,u);{const T=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(b.possiblyEvaluate(e,a,u),y,de(T))}}return y}}class at{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,a,u){const p=new dt(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(e,a,u);return p}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ut{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return Jt(this._values[e].value)}setValue(e,a){this._values[e]=new V(this._values[e].property,a===null?void 0:Jt(a))}serialize(){const e={};for(const a of Object.keys(this._values)){const u=this.getValue(a);u!==void 0&&(e[a]=u)}return e}possiblyEvaluate(e,a,u){const p=new dt(this._properties);for(const y of Object.keys(this._values))p._values[y]=this._values[y].possiblyEvaluate(e,a,u);return p}}class lt{constructor(e,a,u){this.property=e,this.value=a,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,a,u,p){return this.property.evaluate(this.value,this.parameters,e,a,u,p)}}class dt{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Y{constructor(e){this.specification=e}possiblyEvaluate(e,a){return e.expression.evaluate(a)}interpolate(e,a,u){const p=io[this.specification.type];return p?p(e,a,u):e}}class st{constructor(e,a){this.specification=e,this.overrides=a}possiblyEvaluate(e,a,u,p){return new lt(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(a,null,{},u,p)}:e.expression,a)}interpolate(e,a,u){if(e.value.kind!=="constant"||a.value.kind!=="constant")return e;if(e.value.value===void 0||a.value.value===void 0)return new lt(this,{kind:"constant",value:void 0},e.parameters);const p=io[this.specification.type];return p?new lt(this,{kind:"constant",value:p(e.value.value,a.value.value,u)},e.parameters):e}evaluate(e,a,u,p,y,b){return e.kind==="constant"?e.value:e.evaluate(a,u,p,y,b)}}class _t{constructor(e){this.specification=e}possiblyEvaluate(e,a,u,p){return!!e.expression.evaluate(a,null,{},u,p)}interpolate(){return!1}}class gt{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new B(0,{});for(const u in e){const p=e[u];p.specification.overridable&&this.overridableProperties.push(u);const y=this.defaultPropertyValues[u]=new V(p,void 0),b=this.defaultTransitionablePropertyValues[u]=new U(p);this.defaultTransitioningPropertyValues[u]=b.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=y.possiblyEvaluate(a)}}}function Mt(s,e){return 256*(s=Oe(Math.floor(s),0,255))+Oe(Math.floor(e),0,255)}Je(st,"DataDrivenProperty"),Je(Y,"DataConstantProperty"),Je(_t,"ColorRampProperty");const At={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class kt{constructor(e,a){this._structArray=e,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Zt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,a){return e._trim(),a&&(e.isTransferred=!0,a.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const a=Object.create(this.prototype);return a.arrayBuffer=e.arrayBuffer,a.length=e.length,a.capacity=e.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ut(s,e=1){let a=0,u=0;return{members:s.map((p=>{const y=At[p.type].BYTES_PER_ELEMENT,b=a=Xt(a,Math.max(e,y)),T=p.components||1;return u=Math.max(u,y),a+=y*T,{name:p.name,type:p.type,components:T,offset:b}})),size:Xt(a,Math.max(u,e)),alignment:e}}function Xt(s,e){return Math.ceil(s/e)*e}class Te extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,a)}emplace(e,a,u){const p=2*e;return this.int16[p+0]=a,this.int16[p+1]=u,e}}Te.prototype.bytesPerElement=4,Je(Te,"StructArrayLayout2i4");class Gt extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,a,u)}emplace(e,a,u,p){const y=3*e;return this.int16[y+0]=a,this.int16[y+1]=u,this.int16[y+2]=p,e}}Gt.prototype.bytesPerElement=6,Je(Gt,"StructArrayLayout3i6");class fe extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,a,u,p)}emplace(e,a,u,p,y){const b=4*e;return this.int16[b+0]=a,this.int16[b+1]=u,this.int16[b+2]=p,this.int16[b+3]=y,e}}fe.prototype.bytesPerElement=8,Je(fe,"StructArrayLayout4i8");class te extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,a,u,p,y,b,T)}emplace(e,a,u,p,y,b,T,M){const P=6*e,O=12*e,N=3*e;return this.int16[P+0]=a,this.int16[P+1]=u,this.uint8[O+4]=p,this.uint8[O+5]=y,this.uint8[O+6]=b,this.uint8[O+7]=T,this.float32[N+2]=M,e}}te.prototype.bytesPerElement=12,Je(te,"StructArrayLayout2i4ub1f12");class Ee extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,a,u,p)}emplace(e,a,u,p,y){const b=4*e;return this.float32[b+0]=a,this.float32[b+1]=u,this.float32[b+2]=p,this.float32[b+3]=y,e}}Ee.prototype.bytesPerElement=16,Je(Ee,"StructArrayLayout4f16");class Ht extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,a,u,p,y)}emplace(e,a,u,p,y,b){const T=6*e,M=3*e;return this.uint16[T+0]=a,this.uint16[T+1]=u,this.uint16[T+2]=p,this.uint16[T+3]=y,this.float32[M+2]=b,e}}Ht.prototype.bytesPerElement=12,Je(Ht,"StructArrayLayout4ui1f12");class se extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,a,u,p)}emplace(e,a,u,p,y){const b=4*e;return this.uint16[b+0]=a,this.uint16[b+1]=u,this.uint16[b+2]=p,this.uint16[b+3]=y,e}}se.prototype.bytesPerElement=8,Je(se,"StructArrayLayout4ui8");class be extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y,b){const T=this.length;return this.resize(T+1),this.emplace(T,e,a,u,p,y,b)}emplace(e,a,u,p,y,b,T){const M=6*e;return this.int16[M+0]=a,this.int16[M+1]=u,this.int16[M+2]=p,this.int16[M+3]=y,this.int16[M+4]=b,this.int16[M+5]=T,e}}be.prototype.bytesPerElement=12,Je(be,"StructArrayLayout6i12");class ge extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y,b,T,M,P,O,N,$){const Z=this.length;return this.resize(Z+1),this.emplace(Z,e,a,u,p,y,b,T,M,P,O,N,$)}emplace(e,a,u,p,y,b,T,M,P,O,N,$,Z){const X=12*e;return this.int16[X+0]=a,this.int16[X+1]=u,this.int16[X+2]=p,this.int16[X+3]=y,this.uint16[X+4]=b,this.uint16[X+5]=T,this.uint16[X+6]=M,this.uint16[X+7]=P,this.int16[X+8]=O,this.int16[X+9]=N,this.int16[X+10]=$,this.int16[X+11]=Z,e}}ge.prototype.bytesPerElement=24,Je(ge,"StructArrayLayout4i4ui4i24");class Me extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y,b){const T=this.length;return this.resize(T+1),this.emplace(T,e,a,u,p,y,b)}emplace(e,a,u,p,y,b,T){const M=10*e,P=5*e;return this.int16[M+0]=a,this.int16[M+1]=u,this.int16[M+2]=p,this.float32[P+2]=y,this.float32[P+3]=b,this.float32[P+4]=T,e}}Me.prototype.bytesPerElement=20,Je(Me,"StructArrayLayout3i3f20");class ai extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const a=this.length;return this.resize(a+1),this.emplace(a,e)}emplace(e,a){return this.uint32[1*e+0]=a,e}}ai.prototype.bytesPerElement=4,Je(ai,"StructArrayLayout1ul4");class bi extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y,b,T,M,P,O,N,$,Z){const X=this.length;return this.resize(X+1),this.emplace(X,e,a,u,p,y,b,T,M,P,O,N,$,Z)}emplace(e,a,u,p,y,b,T,M,P,O,N,$,Z,X){const J=20*e,ct=10*e;return this.int16[J+0]=a,this.int16[J+1]=u,this.int16[J+2]=p,this.int16[J+3]=y,this.int16[J+4]=b,this.float32[ct+3]=T,this.float32[ct+4]=M,this.float32[ct+5]=P,this.float32[ct+6]=O,this.int16[J+14]=N,this.uint32[ct+8]=$,this.uint16[J+18]=Z,this.uint16[J+19]=X,e}}bi.prototype.bytesPerElement=40,Je(bi,"StructArrayLayout5i4f1i1ul2ui40");class ei extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y,b,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,a,u,p,y,b,T)}emplace(e,a,u,p,y,b,T,M){const P=8*e;return this.int16[P+0]=a,this.int16[P+1]=u,this.int16[P+2]=p,this.int16[P+4]=y,this.int16[P+5]=b,this.int16[P+6]=T,this.int16[P+7]=M,e}}ei.prototype.bytesPerElement=16,Je(ei,"StructArrayLayout3i2i2i16");class li extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,a,u,p,y)}emplace(e,a,u,p,y,b){const T=4*e,M=8*e;return this.float32[T+0]=a,this.float32[T+1]=u,this.float32[T+2]=p,this.int16[M+6]=y,this.int16[M+7]=b,e}}li.prototype.bytesPerElement=16,Je(li,"StructArrayLayout2f1f2i16");class $i extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,a,u,p)}emplace(e,a,u,p,y){const b=12*e,T=3*e;return this.uint8[b+0]=a,this.uint8[b+1]=u,this.float32[T+1]=p,this.float32[T+2]=y,e}}$i.prototype.bytesPerElement=12,Je($i,"StructArrayLayout2ub2f12");class ji extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,a,u)}emplace(e,a,u,p){const y=3*e;return this.float32[y+0]=a,this.float32[y+1]=u,this.float32[y+2]=p,e}}ji.prototype.bytesPerElement=12,Je(ji,"StructArrayLayout3f12");class oi extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,u){const p=this.length;return this.resize(p+1),this.emplace(p,e,a,u)}emplace(e,a,u,p){const y=3*e;return this.uint16[y+0]=a,this.uint16[y+1]=u,this.uint16[y+2]=p,e}}oi.prototype.bytesPerElement=6,Je(oi,"StructArrayLayout3ui6");class en extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y,b,T,M,P,O,N,$,Z,X,J,ct,yt,Ct,vt,St,Dt){const It=this.length;return this.resize(It+1),this.emplace(It,e,a,u,p,y,b,T,M,P,O,N,$,Z,X,J,ct,yt,Ct,vt,St,Dt)}emplace(e,a,u,p,y,b,T,M,P,O,N,$,Z,X,J,ct,yt,Ct,vt,St,Dt,It){const ie=30*e,Qt=15*e,_e=60*e;return this.int16[ie+0]=a,this.int16[ie+1]=u,this.int16[ie+2]=p,this.float32[Qt+2]=y,this.float32[Qt+3]=b,this.uint16[ie+8]=T,this.uint16[ie+9]=M,this.uint32[Qt+5]=P,this.uint32[Qt+6]=O,this.uint32[Qt+7]=N,this.uint16[ie+16]=$,this.uint16[ie+17]=Z,this.uint16[ie+18]=X,this.float32[Qt+10]=J,this.float32[Qt+11]=ct,this.uint8[_e+48]=yt,this.uint8[_e+49]=Ct,this.uint8[_e+50]=vt,this.uint32[Qt+13]=St,this.int16[ie+28]=Dt,this.uint8[_e+58]=It,e}}en.prototype.bytesPerElement=60,Je(en,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class un extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y,b,T,M,P,O,N,$,Z,X,J,ct,yt,Ct,vt,St,Dt,It,ie,Qt,_e,ke,re,ve,xe,Ce){const De=this.length;return this.resize(De+1),this.emplace(De,e,a,u,p,y,b,T,M,P,O,N,$,Z,X,J,ct,yt,Ct,vt,St,Dt,It,ie,Qt,_e,ke,re,ve,xe,Ce)}emplace(e,a,u,p,y,b,T,M,P,O,N,$,Z,X,J,ct,yt,Ct,vt,St,Dt,It,ie,Qt,_e,ke,re,ve,xe,Ce,De){const pe=38*e,We=19*e;return this.int16[pe+0]=a,this.int16[pe+1]=u,this.int16[pe+2]=p,this.float32[We+2]=y,this.float32[We+3]=b,this.int16[pe+8]=T,this.int16[pe+9]=M,this.int16[pe+10]=P,this.int16[pe+11]=O,this.int16[pe+12]=N,this.int16[pe+13]=$,this.uint16[pe+14]=Z,this.uint16[pe+15]=X,this.uint16[pe+16]=J,this.uint16[pe+17]=ct,this.uint16[pe+18]=yt,this.uint16[pe+19]=Ct,this.uint16[pe+20]=vt,this.uint16[pe+21]=St,this.uint16[pe+22]=Dt,this.uint16[pe+23]=It,this.uint16[pe+24]=ie,this.uint16[pe+25]=Qt,this.uint16[pe+26]=_e,this.uint16[pe+27]=ke,this.uint16[pe+28]=re,this.uint32[We+15]=ve,this.float32[We+16]=xe,this.float32[We+17]=Ce,this.float32[We+18]=De,e}}un.prototype.bytesPerElement=76,Je(un,"StructArrayLayout3i2f6i15ui1ul3f76");class mn extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const a=this.length;return this.resize(a+1),this.emplace(a,e)}emplace(e,a){return this.float32[1*e+0]=a,e}}mn.prototype.bytesPerElement=4,Je(mn,"StructArrayLayout1f4");class hn extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a,u,p,y){const b=this.length;return this.resize(b+1),this.emplace(b,e,a,u,p,y)}emplace(e,a,u,p,y,b){const T=5*e;return this.float32[T+0]=a,this.float32[T+1]=u,this.float32[T+2]=p,this.float32[T+3]=y,this.float32[T+4]=b,e}}hn.prototype.bytesPerElement=20,Je(hn,"StructArrayLayout5f20");class qs extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a,u,p){const y=this.length;return this.resize(y+1),this.emplace(y,e,a,u,p)}emplace(e,a,u,p,y){const b=6*e;return this.uint32[3*e+0]=a,this.uint16[b+2]=u,this.uint16[b+3]=p,this.uint16[b+4]=y,e}}qs.prototype.bytesPerElement=12,Je(qs,"StructArrayLayout1ul3ui12");class Bs extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,a)}emplace(e,a,u){const p=2*e;return this.uint16[p+0]=a,this.uint16[p+1]=u,e}}Bs.prototype.bytesPerElement=4,Je(Bs,"StructArrayLayout2ui4");class ao extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const a=this.length;return this.resize(a+1),this.emplace(a,e)}emplace(e,a){return this.uint16[1*e+0]=a,e}}ao.prototype.bytesPerElement=2,Je(ao,"StructArrayLayout1ui2");class ir extends Zt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,a)}emplace(e,a,u){const p=2*e;return this.float32[p+0]=a,this.float32[p+1]=u,e}}ir.prototype.bytesPerElement=8,Je(ir,"StructArrayLayout2f8");class vn extends kt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}vn.prototype.size=40;class dn extends bi{get(e){return new vn(this,e)}}Je(dn,"CollisionBoxArray");class Ki extends kt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Ki.prototype.size=60;class Kn extends en{get(e){return new Ki(this,e)}}Je(Kn,"PlacedSymbolArray");class nr extends kt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}nr.prototype.size=76;class xn extends un{get(e){return new nr(this,e)}}Je(xn,"SymbolInstanceArray");class xr extends mn{getoffsetX(e){return this.float32[1*e+0]}}Je(xr,"GlyphOffsetArray");class au extends Te{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Je(au,"SymbolLineVertexArray");class Ul extends kt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ul.prototype.size=12;class lu extends qs{get(e){return new Ul(this,e)}}Je(lu,"FeatureIndexArray");class Oo extends Bs{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Je(Oo,"FillExtrusionCentroidArray");const Ma=Ut([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),cu=Ut([{name:"a_dash",components:4,type:"Uint16"}]);var Rd={exports:{}},Rh={exports:{}};Rh.exports=function(s,e){var a,u,p,y,b,T,M,P;for(u=s.length-(a=3&s.length),p=e,b=3432918353,T=461845907,P=0;P<u;)M=255&s.charCodeAt(P)|(255&s.charCodeAt(++P))<<8|(255&s.charCodeAt(++P))<<16|(255&s.charCodeAt(++P))<<24,++P,p=27492+(65535&(y=5*(65535&(p=(p^=M=(65535&(M=(M=(65535&M)*b+(((M>>>16)*b&65535)<<16)&4294967295)<<15|M>>>17))*T+(((M>>>16)*T&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(M=0,a){case 3:M^=(255&s.charCodeAt(P+2))<<16;case 2:M^=(255&s.charCodeAt(P+1))<<8;case 1:p^=M=(65535&(M=(M=(65535&(M^=255&s.charCodeAt(P)))*b+(((M>>>16)*b&65535)<<16)&4294967295)<<15|M>>>17))*T+(((M>>>16)*T&65535)<<16)&4294967295}return p^=s.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0};var zf=Rh.exports,x0={exports:{}};x0.exports=function(s,e){for(var a,u=s.length,p=e^u,y=0;u>=4;)a=1540483477*(65535&(a=255&s.charCodeAt(y)|(255&s.charCodeAt(++y))<<8|(255&s.charCodeAt(++y))<<16|(255&s.charCodeAt(++y))<<24))+((1540483477*(a>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),u-=4,++y;switch(u){case 3:p^=(255&s.charCodeAt(y+2))<<16;case 2:p^=(255&s.charCodeAt(y+1))<<8;case 1:p=1540483477*(65535&(p^=255&s.charCodeAt(y)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0};var b0=zf,UC=x0.exports;Rd.exports=b0,Rd.exports.murmur3=b0,Rd.exports.murmur2=UC;var Ug=mt(Rd.exports);class Em{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,a,u,p){this.ids.push(w0(e)),this.positions.push(a,u,p)}getPositions(e){const a=w0(e);let u=0,p=this.ids.length-1;for(;u<p;){const b=u+p>>1;this.ids[b]>=a?p=b:u=b+1}const y=[];for(;this.ids[u]===a;)y.push({index:this.positions[3*u],start:this.positions[3*u+1],end:this.positions[3*u+2]}),u++;return y}static serialize(e,a){const u=new Float64Array(e.ids),p=new Uint32Array(e.positions);return $g(u,p,0,u.length-1),a&&a.push(u.buffer,p.buffer),{ids:u,positions:p}}static deserialize(e){const a=new Em;return a.ids=e.ids,a.positions=e.positions,a.indexed=!0,a}}function w0(s){const e=+s;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Ug(String(s))}function $g(s,e,a,u){for(;a<u;){const p=s[a+u>>1];let y=a-1,b=u+1;for(;;){do y++;while(s[y]<p);do b--;while(s[b]>p);if(y>=b)break;Sm(s,y,b),Sm(e,3*y,3*b),Sm(e,3*y+1,3*b+1),Sm(e,3*y+2,3*b+2)}b-a<u-b?($g(s,e,a,b),a=b+1):($g(s,e,b+1,u),u=b)}}function Sm(s,e,a){const u=s[e];s[e]=s[a],s[a]=u}Je(Em,"FeaturePositionMap");class uu{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,a),this.initialized=!0),!!this.location}}class Mm extends uu{constructor(e){super(e),this.current=0}set(e,a,u){this.fetchUniformLocation(e,a)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class T0 extends uu{constructor(e){super(e),this.current=[0,0,0,0]}set(e,a,u){this.fetchUniformLocation(e,a)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class E0 extends uu{constructor(e){super(e),this.current=Xi.transparent}set(e,a,u){this.fetchUniformLocation(e,a)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const $C=new Float32Array(16),WC=new Float32Array(9),ZC=new Float32Array(4);function Wg(s){return[Mt(255*s.r,255*s.g),Mt(255*s.b,255*s.a)]}class Of{constructor(e,a,u){this.value=e,this.uniformNames=a.map((p=>`u_${p}`)),this.type=u}setUniform(e,a,u,p,y){a.set(e,y,p.constantOr(this.value))}getBinding(e,a){return this.type==="color"?new E0(e):new Mm(e)}}class Bd{constructor(e,a){this.uniformNames=a.map((u=>`u_${u}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,a,u,p,y){const b=y==="u_pattern"||y==="u_dash"?this.pattern:y==="u_pixel_ratio"?this.pixelRatio:null;b&&a.set(e,y,b)}getBinding(e,a){return a==="u_pattern"||a==="u_dash"?new T0(e):new Mm(e)}}class hu{constructor(e,a,u,p){this.expression=e,this.type=u,this.maxValue=0,this.paintVertexAttributes=a.map((y=>({name:`a_${y}`,type:"Float32",components:u==="color"?2:1,offset:0}))),this.paintVertexArray=new p}populatePaintArray(e,a,u,p,y,b){const T=this.paintVertexArray.length,M=this.expression.evaluate(new B(0),a,{},y,p,b);this.paintVertexArray.resize(e),this._setPaintValue(T,e,M)}updatePaintArray(e,a,u,p,y){const b=this.expression.evaluate({zoom:0},u,p,void 0,y);this._setPaintValue(e,a,b)}_setPaintValue(e,a,u){if(this.type==="color"){const p=Wg(u);for(let y=e;y<a;y++)this.paintVertexArray.emplace(y,p[0],p[1])}else{for(let p=e;p<a;p++)this.paintVertexArray.emplace(p,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class $l{constructor(e,a,u,p,y,b){this.expression=e,this.uniformNames=a.map((T=>`u_${T}_t`)),this.type=u,this.useIntegerZoom=p,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=a.map((T=>({name:`a_${T}`,type:"Float32",components:u==="color"?4:2,offset:0}))),this.paintVertexArray=new b}populatePaintArray(e,a,u,p,y,b){const T=this.expression.evaluate(new B(this.zoom),a,{},y,p,b),M=this.expression.evaluate(new B(this.zoom+1),a,{},y,p,b),P=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(P,e,T,M)}updatePaintArray(e,a,u,p,y){const b=this.expression.evaluate({zoom:this.zoom},u,p,void 0,y),T=this.expression.evaluate({zoom:this.zoom+1},u,p,void 0,y);this._setPaintValue(e,a,b,T)}_setPaintValue(e,a,u,p){if(this.type==="color"){const y=Wg(u),b=Wg(p);for(let T=e;T<a;T++)this.paintVertexArray.emplace(T,y[0],y[1],b[0],b[1])}else{for(let y=e;y<a;y++)this.paintVertexArray.emplace(y,u,p);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(p))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,a,u,p,y){const b=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,T=Oe(this.expression.interpolationFactor(b,this.zoom,this.zoom+1),0,1);a.set(e,y,T)}getBinding(e,a){return new Mm(e)}}class Zu{constructor(e,a,u,p,y){this.expression=e,this.layerId=y,this.paintVertexAttributes=(u==="array"?cu:Ma).members;for(let b=0;b<a.length;++b);this.paintVertexArray=new p}populatePaintArray(e,a,u){const p=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(p,e,a.patterns&&a.patterns[this.layerId],u)}updatePaintArray(e,a,u,p,y,b){this._setPaintValues(e,a,u.patterns&&u.patterns[this.layerId],b)}_setPaintValues(e,a,u,p){if(!p||!u)return;const y=p[u];if(!y)return;const{tl:b,br:T,pixelRatio:M}=y;for(let P=e;P<a;P++)this.paintVertexArray.emplace(P,b[0],b[1],T[0],T[1],M)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gu{constructor(e,a,u=(()=>!0)){this.binders={},this._buffers=[];const p=[];for(const y in e.paint._values){if(!u(y))continue;const b=e.paint.get(y);if(!(b instanceof lt&&er(b.property.specification)))continue;const T=HC(y,e.type),M=b.value,P=b.property.specification.type,O=!!b.property.useIntegerZoom,N=y==="line-dasharray"||y.endsWith("pattern"),$=y==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(M.kind!=="constant"||$)if(M.kind==="source"||$||N){const Z=S0(y,P,"source");this.binders[y]=N?new Zu(M,T,P,Z,e.id):new hu(M,T,P,Z),p.push(`/a_${y}`)}else{const Z=S0(y,P,"composite");this.binders[y]=new $l(M,T,P,O,a,Z),p.push(`/z_${y}`)}else this.binders[y]=N?new Bd(M.value,T):new Of(M.value,T,P),p.push(`/u_${y}`)}this.cacheKey=p.sort().join("")}getMaxValue(e){const a=this.binders[e];return a instanceof hu||a instanceof $l?a.maxValue:0}populatePaintArrays(e,a,u,p,y,b){for(const T in this.binders){const M=this.binders[T];(M instanceof hu||M instanceof $l||M instanceof Zu)&&M.populatePaintArray(e,a,u,p,y,b)}}setConstantPatternPositions(e){for(const a in this.binders){const u=this.binders[a];u instanceof Bd&&u.setConstantPatternPositions(e)}}updatePaintArrays(e,a,u,p,y,b){let T=!1;for(const M in e){const P=a.getPositions(M);for(const O of P){const N=u.feature(O.index);for(const $ in this.binders){const Z=this.binders[$];if((Z instanceof hu||Z instanceof $l||Z instanceof Zu)&&Z.expression.isStateDependent===!0){const X=p.paint.get($);Z.expression=X.value,Z.updatePaintArray(O.start,O.end,N,e[M],y,b),T=!0}}}}return T}defines(){const e=[];for(const a in this.binders){const u=this.binders[a];(u instanceof Of||u instanceof Bd)&&e.push(...u.uniformNames.map((p=>`#define HAS_UNIFORM_${p}`)))}return e}getBinderAttributes(){const e=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof hu||u instanceof $l||u instanceof Zu)for(let p=0;p<u.paintVertexAttributes.length;p++)e.push(u.paintVertexAttributes[p].name)}return e}getBinderUniforms(){const e=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof Of||u instanceof Bd||u instanceof $l)for(const p of u.uniformNames)e.push(p)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const a=[];for(const u in this.binders){const p=this.binders[u];if(p instanceof Of||p instanceof Bd||p instanceof $l)for(const y of p.uniformNames)a.push({name:y,property:u,binding:p.getBinding(e,y)})}return a}setUniforms(e,a,u,p,y){for(const{name:b,property:T,binding:M}of u)this.binders[T].setUniform(e,M,y,p.get(T),b)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const a=this.binders[e];(a instanceof hu||a instanceof $l||a instanceof Zu)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const a in this.binders){const u=this.binders[a];(u instanceof hu||u instanceof $l||u instanceof Zu)&&u.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const a=this.binders[e];(a instanceof hu||a instanceof $l||a instanceof Zu)&&a.destroy()}}}class Bh{constructor(e,a,u=(()=>!0)){this.programConfigurations={};for(const p of e)this.programConfigurations[p.id]=new Gu(p,a,u);this.needsUpload=!1,this._featureMap=new Em,this._bufferOffset=0}populatePaintArrays(e,a,u,p,y,b,T){for(const M in this.programConfigurations)this.programConfigurations[M].populatePaintArrays(e,a,p,y,b,T);a.id!==void 0&&this._featureMap.add(a.id,u,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,a,u,p,y){for(const b of u)this.needsUpload=this.programConfigurations[b.id].updatePaintArrays(e,this._featureMap,a,b,p,y)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const GC={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function HC(s,e){return GC[s]||[s.replace(`${e}-`,"").replace(/-/g,"_")]}const qC={"line-pattern":{source:Ht,composite:Ht},"fill-pattern":{source:Ht,composite:Ht},"fill-extrusion-pattern":{source:Ht,composite:Ht},"line-dasharray":{source:se,composite:se}},XC={color:{source:ir,composite:Ee},number:{source:mn,composite:ir}};function S0(s,e,a){const u=qC[s];return u&&u[a]||XC[e][a]}Je(Of,"ConstantBinder"),Je(Bd,"PatternConstantBinder"),Je(hu,"SourceExpressionBinder"),Je(Zu,"PatternCompositeBinder"),Je($l,"CompositeExpressionBinder"),Je(Gu,"ProgramConfiguration",{omit:["_buffers"]}),Je(Bh,"ProgramConfigurationSet");const M0="-transition";class Wl extends ma{constructor(e,a){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),a.layout&&(this._unevaluatedLayout=new ut(a.layout)),a.paint)){this._transitionablePaint=new K(a.paint);for(const u in e.paint)this.setPaintProperty(u,e.paint[u],{validate:!1});for(const u in e.layout)this.setLayoutProperty(u,e.layout[u],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new dt(a.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,a,u={}){a!=null&&this._validate(Ih,`layers.${this.id}.layout.${e}`,e,a,u)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,a):this.visibility=a)}getPaintProperty(e){return ls(e,M0)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,a,u={}){if(a!=null&&this._validate(Dd,`layers.${this.id}.paint.${e}`,e,a,u))return!1;if(ls(e,M0))return this._transitionablePaint.setTransition(e.slice(0,-11),a||void 0),!1;{const p=this._transitionablePaint._values[e],y=p.value.isDataDriven(),b=p.value;this._transitionablePaint.setValue(e,a),this._handleSpecialPaintPropertyUpdate(e);const T=this._transitionablePaint._values[e].value,M=T.isDataDriven(),P=ls(e,"pattern")||e==="line-dasharray";return M||y||P||this._handleOverridablePaintPropertyUpdate(e,b,T)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,a,u){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,a)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ft(e,((a,u)=>!(a===void 0||u==="layout"&&!Object.keys(a).length||u==="paint"&&!Object.keys(a).length)))}_validate(e,a,u,p,y={}){return(!y||y.validate!==!1)&&Wu(this,e.call(rl,{key:a,layerType:this.type,objectKey:u,value:p,styleSpec:le,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const a=this.paint.get(e);if(a instanceof lt&&er(a.property.specification)&&(a.value.kind==="source"||a.value.kind==="composite")&&a.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ni(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const KC=Ut([{name:"a_pos",components:2,type:"Int16"}],4),YC=Ut([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Ts{constructor(e=[]){this.segments=e}prepareSegment(e,a,u,p){let y=this.segments[this.segments.length-1];return e>Ts.MAX_VERTEX_ARRAY_LENGTH&&me(`Max vertices per segment is ${Ts.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!y||y.vertexLength+e>Ts.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==p)&&(y={vertexOffset:a.length,primitiveOffset:u.length,vertexLength:0,primitiveLength:0},p!==void 0&&(y.sortKey=p),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const e of this.segments)for(const a in e.vaos)e.vaos[a].destroy()}static simpleSegment(e,a,u,p){return new Ts([{vertexOffset:e,primitiveOffset:a,vertexLength:u,primitiveLength:p,vaos:{},sortKey:0}])}}Ts.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Je(Ts,"SegmentVector");var di=8192;class Hu{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof bn?new bn(e.lng,e.lat):bn.convert(e),this}setSouthWest(e){return this._sw=e instanceof bn?new bn(e.lng,e.lat):bn.convert(e),this}extend(e){const a=this._sw,u=this._ne;let p,y;if(e instanceof bn)p=e,y=e;else{if(!(e instanceof Hu))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Hu.convert(e)):this.extend(bn.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(bn.convert(e)):this;if(p=e._sw,y=e._ne,!p||!y)return this}return a||u?(a.lng=Math.min(p.lng,a.lng),a.lat=Math.min(p.lat,a.lat),u.lng=Math.max(y.lng,u.lng),u.lat=Math.max(y.lat,u.lat)):(this._sw=new bn(p.lng,p.lat),this._ne=new bn(y.lng,y.lat)),this}getCenter(){return new bn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new bn(this.getWest(),this.getNorth())}getSouthEast(){return new bn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:a,lat:u}=bn.convert(e);let p=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&p}static convert(e){return!e||e instanceof Hu?e:new Hu(e)}}var Cm=1e-6,na=typeof Float32Array<"u"?Float32Array:Array;function C0(){var s=new na(9);return na!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[5]=0,s[6]=0,s[7]=0),s[0]=1,s[4]=1,s[8]=1,s}function A0(s,e,a){var u=e[0],p=e[1],y=e[2],b=e[3],T=e[4],M=e[5],P=e[6],O=e[7],N=e[8],$=a[0],Z=a[1],X=a[2],J=a[3],ct=a[4],yt=a[5],Ct=a[6],vt=a[7],St=a[8];return s[0]=$*u+Z*b+X*P,s[1]=$*p+Z*T+X*O,s[2]=$*y+Z*M+X*N,s[3]=J*u+ct*b+yt*P,s[4]=J*p+ct*T+yt*O,s[5]=J*y+ct*M+yt*N,s[6]=Ct*u+vt*b+St*P,s[7]=Ct*p+vt*T+St*O,s[8]=Ct*y+vt*M+St*N,s}function Zl(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function Zg(s,e){var a=e[0],u=e[1],p=e[2],y=e[3],b=e[4],T=e[5],M=e[6],P=e[7],O=e[8],N=e[9],$=e[10],Z=e[11],X=e[12],J=e[13],ct=e[14],yt=e[15],Ct=a*T-u*b,vt=a*M-p*b,St=a*P-y*b,Dt=u*M-p*T,It=u*P-y*T,ie=p*P-y*M,Qt=O*J-N*X,_e=O*ct-$*X,ke=O*yt-Z*X,re=N*ct-$*J,ve=N*yt-Z*J,xe=$*yt-Z*ct,Ce=Ct*xe-vt*ve+St*re+Dt*ke-It*_e+ie*Qt;return Ce?(s[0]=(T*xe-M*ve+P*re)*(Ce=1/Ce),s[1]=(p*ve-u*xe-y*re)*Ce,s[2]=(J*ie-ct*It+yt*Dt)*Ce,s[3]=($*It-N*ie-Z*Dt)*Ce,s[4]=(M*ke-b*xe-P*_e)*Ce,s[5]=(a*xe-p*ke+y*_e)*Ce,s[6]=(ct*St-X*ie-yt*vt)*Ce,s[7]=(O*ie-$*St+Z*vt)*Ce,s[8]=(b*ve-T*ke+P*Qt)*Ce,s[9]=(u*ke-a*ve-y*Qt)*Ce,s[10]=(X*It-J*St+yt*Ct)*Ce,s[11]=(N*St-O*It-Z*Ct)*Ce,s[12]=(T*_e-b*re-M*Qt)*Ce,s[13]=(a*re-u*_e+p*Qt)*Ce,s[14]=(J*vt-X*Dt-ct*Ct)*Ce,s[15]=(O*Dt-N*vt+$*Ct)*Ce,s):null}function Fh(s,e,a){var u=e[0],p=e[1],y=e[2],b=e[3],T=e[4],M=e[5],P=e[6],O=e[7],N=e[8],$=e[9],Z=e[10],X=e[11],J=e[12],ct=e[13],yt=e[14],Ct=e[15],vt=a[0],St=a[1],Dt=a[2],It=a[3];return s[0]=vt*u+St*T+Dt*N+It*J,s[1]=vt*p+St*M+Dt*$+It*ct,s[2]=vt*y+St*P+Dt*Z+It*yt,s[3]=vt*b+St*O+Dt*X+It*Ct,s[4]=(vt=a[4])*u+(St=a[5])*T+(Dt=a[6])*N+(It=a[7])*J,s[5]=vt*p+St*M+Dt*$+It*ct,s[6]=vt*y+St*P+Dt*Z+It*yt,s[7]=vt*b+St*O+Dt*X+It*Ct,s[8]=(vt=a[8])*u+(St=a[9])*T+(Dt=a[10])*N+(It=a[11])*J,s[9]=vt*p+St*M+Dt*$+It*ct,s[10]=vt*y+St*P+Dt*Z+It*yt,s[11]=vt*b+St*O+Dt*X+It*Ct,s[12]=(vt=a[12])*u+(St=a[13])*T+(Dt=a[14])*N+(It=a[15])*J,s[13]=vt*p+St*M+Dt*$+It*ct,s[14]=vt*y+St*P+Dt*Z+It*yt,s[15]=vt*b+St*O+Dt*X+It*Ct,s}function Rf(s,e,a){var u,p,y,b,T,M,P,O,N,$,Z,X,J=a[0],ct=a[1],yt=a[2];return e===s?(s[12]=e[0]*J+e[4]*ct+e[8]*yt+e[12],s[13]=e[1]*J+e[5]*ct+e[9]*yt+e[13],s[14]=e[2]*J+e[6]*ct+e[10]*yt+e[14],s[15]=e[3]*J+e[7]*ct+e[11]*yt+e[15]):(p=e[1],y=e[2],b=e[3],T=e[4],M=e[5],P=e[6],O=e[7],N=e[8],$=e[9],Z=e[10],X=e[11],s[0]=u=e[0],s[1]=p,s[2]=y,s[3]=b,s[4]=T,s[5]=M,s[6]=P,s[7]=O,s[8]=N,s[9]=$,s[10]=Z,s[11]=X,s[12]=u*J+T*ct+N*yt+e[12],s[13]=p*J+M*ct+$*yt+e[13],s[14]=y*J+P*ct+Z*yt+e[14],s[15]=b*J+O*ct+X*yt+e[15]),s}function Nh(s,e,a){var u=a[0],p=a[1],y=a[2];return s[0]=e[0]*u,s[1]=e[1]*u,s[2]=e[2]*u,s[3]=e[3]*u,s[4]=e[4]*p,s[5]=e[5]*p,s[6]=e[6]*p,s[7]=e[7]*p,s[8]=e[8]*y,s[9]=e[9]*y,s[10]=e[10]*y,s[11]=e[11]*y,s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15],s}function Gg(s,e,a){var u=Math.sin(a),p=Math.cos(a),y=e[4],b=e[5],T=e[6],M=e[7],P=e[8],O=e[9],N=e[10],$=e[11];return e!==s&&(s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=e[3],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15]),s[4]=y*p+P*u,s[5]=b*p+O*u,s[6]=T*p+N*u,s[7]=M*p+$*u,s[8]=P*p-y*u,s[9]=O*p-b*u,s[10]=N*p-T*u,s[11]=$*p-M*u,s}function Am(s,e,a){var u=Math.sin(a),p=Math.cos(a),y=e[0],b=e[1],T=e[2],M=e[3],P=e[8],O=e[9],N=e[10],$=e[11];return e!==s&&(s[4]=e[4],s[5]=e[5],s[6]=e[6],s[7]=e[7],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15]),s[0]=y*p-P*u,s[1]=b*p-O*u,s[2]=T*p-N*u,s[3]=M*p-$*u,s[8]=y*u+P*p,s[9]=b*u+O*p,s[10]=T*u+N*p,s[11]=M*u+$*p,s}function P0(s,e){return s[0]=e[0],s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=e[1],s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=e[2],s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s}function k0(s,e,a){var u,p,y,b=a[0],T=a[1],M=a[2],P=Math.hypot(b,T,M);return P<Cm?null:(b*=P=1/P,T*=P,M*=P,u=Math.sin(e),p=Math.cos(e),s[0]=b*b*(y=1-p)+p,s[1]=T*b*y+M*u,s[2]=M*b*y-T*u,s[3]=0,s[4]=b*T*y-M*u,s[5]=T*T*y+p,s[6]=M*T*y+b*u,s[7]=0,s[8]=b*M*y+T*u,s[9]=T*M*y-b*u,s[10]=M*M*y+p,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s)}Math.hypot||(Math.hypot=function(){for(var s=0,e=arguments.length;e--;)s+=arguments[e]*arguments[e];return Math.sqrt(s)});var JC=Fh;function Hg(){var s=new na(3);return na!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s}function I0(s){var e=new na(3);return e[0]=s[0],e[1]=s[1],e[2]=s[2],e}function Bf(s){return Math.hypot(s[0],s[1],s[2])}function Fd(s,e,a){var u=new na(3);return u[0]=s,u[1]=e,u[2]=a,u}function du(s,e,a){return s[0]=e[0]+a[0],s[1]=e[1]+a[1],s[2]=e[2]+a[2],s}function qg(s,e,a){return s[0]=e[0]-a[0],s[1]=e[1]-a[1],s[2]=e[2]-a[2],s}function L0(s,e,a){return s[0]=e[0]*a[0],s[1]=e[1]*a[1],s[2]=e[2]*a[2],s}function Ff(s,e,a){return s[0]=Math.min(e[0],a[0]),s[1]=Math.min(e[1],a[1]),s[2]=Math.min(e[2],a[2]),s}function Nf(s,e,a){return s[0]=Math.max(e[0],a[0]),s[1]=Math.max(e[1],a[1]),s[2]=Math.max(e[2],a[2]),s}function Ca(s,e,a){return s[0]=e[0]*a,s[1]=e[1]*a,s[2]=e[2]*a,s}function jf(s,e,a,u){return s[0]=e[0]+a[0]*u,s[1]=e[1]+a[1]*u,s[2]=e[2]+a[2]*u,s}function lo(s,e){var a=e[0],u=e[1],p=e[2],y=a*a+u*u+p*p;return y>0&&(y=1/Math.sqrt(y)),s[0]=e[0]*y,s[1]=e[1]*y,s[2]=e[2]*y,s}function ol(s,e){return s[0]*e[0]+s[1]*e[1]+s[2]*e[2]}function Xg(s,e,a){var u=e[0],p=e[1],y=e[2],b=a[0],T=a[1],M=a[2];return s[0]=p*M-y*T,s[1]=y*b-u*M,s[2]=u*T-p*b,s}function ms(s,e,a){var u=e[0],p=e[1],y=e[2],b=a[3]*u+a[7]*p+a[11]*y+a[15];return s[0]=(a[0]*u+a[4]*p+a[8]*y+a[12])/(b=b||1),s[1]=(a[1]*u+a[5]*p+a[9]*y+a[13])/b,s[2]=(a[2]*u+a[6]*p+a[10]*y+a[14])/b,s}function D0(s,e,a){var u=a[0],p=a[1],y=a[2],b=e[0],T=e[1],M=e[2],P=p*M-y*T,O=y*b-u*M,N=u*T-p*b,$=p*N-y*O,Z=y*P-u*N,X=u*O-p*P,J=2*a[3];return O*=J,N*=J,Z*=2,X*=2,s[0]=b+(P*=J)+($*=2),s[1]=T+O+Z,s[2]=M+N+X,s}var Vf,Gl=qg,QC=L0,tA=Bf;function z0(s,e,a){return s[0]=e[0]*a,s[1]=e[1]*a,s[2]=e[2]*a,s[3]=e[3]*a,s}function O0(s,e){var a=e[0],u=e[1],p=e[2],y=e[3],b=a*a+u*u+p*p+y*y;return b>0&&(b=1/Math.sqrt(b)),s[0]=a*b,s[1]=u*b,s[2]=p*b,s[3]=y*b,s}function jh(s,e,a){var u=e[0],p=e[1],y=e[2],b=e[3];return s[0]=a[0]*u+a[4]*p+a[8]*y+a[12]*b,s[1]=a[1]*u+a[5]*p+a[9]*y+a[13]*b,s[2]=a[2]*u+a[6]*p+a[10]*y+a[14]*b,s[3]=a[3]*u+a[7]*p+a[11]*y+a[15]*b,s}function R0(){var s=new na(4);return na!=Float32Array&&(s[0]=0,s[1]=0,s[2]=0),s[3]=1,s}function B0(s){return s[0]=0,s[1]=0,s[2]=0,s[3]=1,s}function F0(s,e,a){a*=.5;var u=e[0],p=e[1],y=e[2],b=e[3],T=Math.sin(a),M=Math.cos(a);return s[0]=u*M+b*T,s[1]=p*M+y*T,s[2]=y*M-p*T,s[3]=b*M-u*T,s}function N0(s,e,a){a*=.5;var u=e[0],p=e[1],y=e[2],b=e[3],T=Math.sin(a),M=Math.cos(a);return s[0]=u*M-y*T,s[1]=p*M+b*T,s[2]=y*M+u*T,s[3]=b*M-p*T,s}Hg(),Vf=new na(4),na!=Float32Array&&(Vf[0]=0,Vf[1]=0,Vf[2]=0,Vf[3]=0);var eA=O0;Hg(),Fd(1,0,0),Fd(0,1,0),R0(),R0(),C0();const iA=Ut([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:j0}=iA,V0=Ut([{name:"a_pos_3",components:3,type:"Int16"}]);var Uf=Ut([{name:"a_pos",type:"Int16",components:2}]);class Kg{constructor(e,a){this.pos=e,this.dir=a}intersectsPlane(e,a,u){const p=ol(a,this.dir);if(Math.abs(p)<1e-6)return!1;const y=((e[0]-this.pos[0])*a[0]+(e[1]-this.pos[1])*a[1]+(e[2]-this.pos[2])*a[2])/p;return u[0]=this.pos[0]+this.dir[0]*y,u[1]=this.pos[1]+this.dir[1]*y,u[2]=this.pos[2]+this.dir[2]*y,!0}closestPointOnSphere(e,a,u){if((function(Z,X){var J=Z[0],ct=Z[1],yt=Z[2],Ct=X[0],vt=X[1],St=X[2];return Math.abs(J-Ct)<=Cm*Math.max(1,Math.abs(J),Math.abs(Ct))&&Math.abs(ct-vt)<=Cm*Math.max(1,Math.abs(ct),Math.abs(vt))&&Math.abs(yt-St)<=Cm*Math.max(1,Math.abs(yt),Math.abs(St))})(this.pos,e)||a===0)return u[0]=u[1]=u[2]=0,!1;const[p,y,b]=this.dir,T=this.pos[0]-e[0],M=this.pos[1]-e[1],P=this.pos[2]-e[2],O=p*p+y*y+b*b,N=2*(T*p+M*y+P*b),$=N*N-4*O*(T*T+M*M+P*P-a*a);if($<0){const Z=Math.max(-N/2,0),X=T+p*Z,J=M+y*Z,ct=P+b*Z,yt=Math.hypot(X,J,ct);return u[0]=X*a/yt,u[1]=J*a/yt,u[2]=ct*a/yt,!1}{const Z=(-N-Math.sqrt($))/(2*O);if(Z<0){const X=Math.hypot(T,M,P);return u[0]=T*a/X,u[1]=M*a/X,u[2]=P*a/X,!1}return u[0]=T+p*Z,u[1]=M+y*Z,u[2]=P+b*Z,!0}}}class Yg{constructor(e,a,u,p,y){this.TL=e,this.TR=a,this.BR=u,this.BL=p,this.horizon=y}static fromInvProjectionMatrix(e,a,u){const p=[-1,1,1],y=[1,1,1],b=[1,-1,1],T=[-1,-1,1],M=ms(p,p,e),P=ms(y,y,e),O=ms(b,b,e),N=ms(T,T,e);return new Yg(M,P,O,N,a/u)}}class Jg{constructor(e,a){this.points=e,this.planes=a}static fromInvProjectionMatrix(e,a,u,p){const y=Math.pow(2,u),b=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((M=>{const P=jh([],M,e),O=1/P[3]/a*y;return(function(N,$,Z){return N[0]=$[0]*Z[0],N[1]=$[1]*Z[1],N[2]=$[2]*Z[2],N[3]=$[3]*Z[3],N})(P,P,[O,O,p?1/P[3]:O,O])})),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((M=>{const P=lo([],Xg([],Gl([],b[M[0]],b[M[1]]),Gl([],b[M[2]],b[M[1]]))),O=-ol(P,b[M[1]]);return P.concat(O)}));return new Jg(b,T)}}class co{static fromPoints(e){const a=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const p of e)Ff(a,a,p),Nf(u,u,p);return new co(a,u)}static applyTransform(e,a){const u=e.getCorners();for(let p=0;p<u.length;++p)ms(u[p],u[p],a);return co.fromPoints(u)}constructor(e,a){this.min=e,this.max=a,this.center=Ca([],du([],this.min,this.max),.5)}quadrant(e){const a=[e%2==0,e<2],u=I0(this.min),p=I0(this.max);for(let y=0;y<a.length;y++)u[y]=a[y]?this.min[y]:this.center[y],p[y]=a[y]?this.center[y]:this.max[y];return p[2]=this.max[2],new co(u,p)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,a=this.max;return[[e[0],e[1],e[2]],[a[0],e[1],e[2]],[a[0],a[1],e[2]],[e[0],a[1],e[2]],[e[0],e[1],a[2]],[a[0],e[1],a[2]],[a[0],a[1],a[2]],[e[0],a[1],a[2]]]}intersects(e){const a=this.getCorners();let u=!0;for(let p=0;p<e.planes.length;p++){const y=e.planes[p];let b=0;for(let T=0;T<a.length;T++)b+=ol(y,a[T])+y[3]>=0;if(b===0)return 0;b!==a.length&&(u=!1)}if(u)return 2;for(let p=0;p<3;p++){let y=Number.MAX_VALUE,b=-Number.MAX_VALUE;for(let T=0;T<e.points.length;T++){const M=e.points[T][p]-this.min[p];y=Math.min(y,M),b=Math.max(b,M)}if(b<0||y>this.max[p]-this.min[p])return 0}return 1}}const Qg=5,U0=6,wc=di/Math.PI/2,nA=16383,Vh=64,$f=[Vh,32,16],al=-wc,ll=wc,sA=[new co([al,al,al],[ll,ll,ll]),new co([al,al,al],[0,0,ll]),new co([0,al,al],[ll,0,ll]),new co([al,0,al],[0,ll,ll]),new co([0,0,al],[ll,ll,ll])];function Pm(s){return s*wc/Gf}function $0(s,e,a,u=!0){const p=Ca([],s._camera.position,s.worldSize),y=[e,a,1,1];jh(y,y,s.pixelMatrixInverse),z0(y,y,1/y[3]);const b=lo([],Gl([],y,p)),T=s.globeMatrix,M=[T[12],T[13],T[14]],P=Gl([],M,p),O=Bf(P),N=lo([],P),$=s.worldSize/(2*Math.PI),Z=ol(N,b),X=Math.asin($/O);if(X<Math.acos(Z)){if(!u)return null;const ke=[],re=[];Ca(ke,b,O/Z),lo(re,Gl(re,ke,P)),lo(b,du(b,P,Ca(b,re,Math.tan(X)*O)))}const J=[];new Kg(p,b).closestPointOnSphere(M,$,J);const ct=lo([],ci(T,0)),yt=lo([],ci(T,1)),Ct=lo([],ci(T,2)),vt=ol(ct,J),St=ol(yt,J),Dt=ol(Ct,J),It=ye(Math.asin(-St/$));let ie=ye(Math.atan2(vt,Dt));ie=s.center.lng+(function(ke,re){const ve=(re-ke+180)%360-180;return ve<-180?ve+360:ve})(s.center.lng,ie);const Qt=Ec(ie),_e=Oe(Sc(It),0,1);return new Ud(Qt,_e)}class rA{constructor(e,a,u){this.a=Gl([],e,u),this.b=Gl([],a,u),this.center=u;const p=lo([],this.a),y=lo([],this.b);this.angle=Math.acos(ol(p,y))}}function ty(s,e){if(s.angle===0)return null;let a;return a=s.a[e]===0?1/s.angle*.5*Math.PI:1/s.angle*Math.atan(s.b[e]/s.a[e]/Math.sin(s.angle)-1/Math.tan(s.angle)),a<0||a>1?null:(function(u,p,y,b){const T=Math.sin(y);return u*(Math.sin((1-b)*y)/T)+p*(Math.sin(b*y)/T)})(s.a[e],s.b[e],s.angle,Oe(a,0,1))+s.center[e]}function Tc(s){if(s.z<=1)return sA[s.z+2*s.y+s.x];const e=ey(km(s));return co.fromPoints(e)}function Uh(s,e,a){return Ca(s,s,1-a),jf(s,s,e,a)}function W0(s,e){const a=Vd(e.zoom);if(a===0)return Tc(s);const u=km(s),p=ey(u),y=Ec(u.getWest())*e.worldSize,b=Ec(u.getEast())*e.worldSize,T=Sc(u.getNorth())*e.worldSize,M=Sc(u.getSouth())*e.worldSize,P=[y,T,0],O=[b,T,0],N=[y,M,0],$=[b,M,0],Z=Zg([],e.globeMatrix);return ms(P,P,Z),ms(O,O,Z),ms(N,N,Z),ms($,$,Z),p[0]=Uh(p[0],N,a),p[1]=Uh(p[1],$,a),p[2]=Uh(p[2],O,a),p[3]=Uh(p[3],P,a),co.fromPoints(p)}function Z0(s,e,a){for(const u of s)ms(u,u,e),Ca(u,u,a)}function oA(s,e,a){const u=e/s.worldSize,p=s.globeMatrix;if(a.z<=1){const Qt=Tc(a).getCorners();return Z0(Qt,p,u),co.fromPoints(Qt)}const y=km(a),b=ey(y);Z0(b,p,u);const T=Number.MAX_VALUE,M=[-T,-T,-T],P=[T,T,T];if(y.contains(s.center)){for(const ke of b)Ff(P,P,ke),Nf(M,M,ke);M[2]=0;const Qt=s.point,_e=[Qt.x*u,Qt.y*u,0];return Ff(P,P,_e),Nf(M,M,_e),new co(P,M)}const O=[p[12]*u,p[13]*u,p[14]*u],N=y.getCenter(),$=Oe(s.center.lat,-Br,Br),Z=Oe(N.lat,-Br,Br),X=Ec(s.center.lng),J=Sc($);let ct=X-Ec(N.lng);const yt=J-Sc(Z);ct>.5?ct-=1:ct<-.5&&(ct+=1);let Ct=0;Math.abs(ct)>Math.abs(yt)?Ct=ct>=0?1:3:(Ct=yt>=0?0:2,jf(O,O,[p[4]*u,p[5]*u,p[6]*u],-Math.sin(ae(yt>=0?y.getSouth():y.getNorth()))*wc));const vt=b[Ct],St=b[(Ct+1)%4],Dt=new rA(vt,St,O),It=[ty(Dt,0)||vt[0],ty(Dt,1)||vt[1],ty(Dt,2)||vt[2]],ie=Vd(s.zoom);if(ie>0){const Qt=(function({x:ke,y:re,z:ve},xe,Ce,De,pe){const We=1/(1<<ve);let si=ke*We,qe=si+We,Ci=re*We,ze=Ci+We,ui=0;const Ai=(si+qe)/2-De;return Ai>.5?ui=-1:Ai<-.5&&(ui=1),si=((si+ui)*xe-(De*=xe))*Ce+De,qe=((qe+ui)*xe-De)*Ce+De,Ci=(Ci*xe-(pe*=xe))*Ce+pe,ze=(ze*xe-pe)*Ce+pe,[[si,ze,0],[qe,ze,0],[qe,Ci,0],[si,Ci,0]]})(a,e,s._pixelsPerMercatorPixel,X,J);for(let ke=0;ke<b.length;ke++)Uh(b[ke],Qt[ke],ie);const _e=du([],Qt[Ct],Qt[(Ct+1)%4]);Ca(_e,_e,.5),Uh(It,_e,ie)}for(const Qt of b)Ff(P,P,Qt),Nf(M,M,Qt);return P[2]=Math.min(vt[2],St[2]),Ff(P,P,It),Nf(M,M,It),new co(P,M)}function km({x:s,y:e,z:a}){const u=1/(1<<a),p=new bn(Aa(s*u),Rr((e+1)*u)),y=new bn(Aa((s+1)*u),Rr(e*u));return new Hu(p,y)}function ey(s){const e=ae(s.getNorth()),a=ae(s.getSouth()),u=Math.cos(e),p=Math.cos(a),y=Math.sin(e),b=Math.sin(a),T=s.getWest(),M=s.getEast();return[Nd(p,b,T),Nd(p,b,M),Nd(u,y,M),Nd(u,y,T)]}function Nd(s,e,a,u=wc){return a=ae(a),[s*Math.sin(a)*u,-e*u,s*Math.cos(a)*u]}function jd(s,e,a){return Nd(Math.cos(ae(s)),Math.sin(ae(s)),e,a)}function Wf(s,e,a,u){const p=1<<a.z,y=(s/di+a.x)/p;return jd(Rr((e/di+a.y)/p),Aa(y),u)}function Im({min:s,max:e}){return nA/Math.max(e[0]-s[0],e[1]-s[1],e[2]-s[2])}const G0=new Float64Array(16);function Zf(s){const e=Im(s),a=P0(G0,[e,e,e]);return Rf(a,a,((u=[])[0]=-(p=s.min)[0],u[1]=-p[1],u[2]=-p[2],u));var u,p}function iy(s){const e=(u=s.min,(a=G0)[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=u[0],a[13]=u[1],a[14]=u[2],a[15]=1,a);var a,u;const p=1/Im(s);return Nh(e,e,[p,p,p])}function H0(s,e,a,u,p){const y=(function(M){const P=di/(2*Math.PI);return M/(2*Math.PI)/P})(a),b=[s,e,-a/(2*Math.PI)],T=Zl(new Float64Array(16));return Rf(T,T,b),Nh(T,T,[y,y,y]),Gg(T,T,ae(-p)),Am(T,T,ae(-u)),T}function Vd(s){return Ue(Qg,U0,s)}function q0(s,e){const a=jd(e.lat,e.lng),u=(function(X){const J=jd(X._center.lat,X._center.lng);let ct=Xg([],Fd(0,1,0),J);const yt=k0([],-X.angle,J);ct=ms(ct,ct,yt),k0(yt,-X._pitch,ct);const Ct=lo([],J);return Ca(Ct,Ct,Pm(X.cameraToCenterDistance/X.pixelsPerMeter)),ms(Ct,Ct,yt),du([],J,Ct)})(s);return b=(p=qg([],u,a))[0],T=p[1],M=p[2],P=(y=a)[0],O=y[1],N=y[2],Z=($=Math.sqrt(b*b+T*T+M*M)*Math.sqrt(P*P+O*O+N*N))&&ol(p,y)/$,Math.acos(Math.min(Math.max(Z,-1),1));var p,y,b,T,M,P,O,N,$,Z}function ny(s,e){return q0(s,e)>Math.PI/2*1.01}const X0=ae(85),aA=Math.cos(X0),lA=Math.sin(X0),Gf=63710088e-1,K0=2*Math.PI*Gf;class qu{constructor(e,a){if(isNaN(e)||isNaN(a))throw new Error(`Invalid LngLat object: (${e}, ${a})`);if(this.lng=+e,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new qu($t(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const a=Math.PI/180,u=this.lat*a,p=e.lat*a,y=Math.sin(u)*Math.sin(p)+Math.cos(u)*Math.cos(p)*Math.cos((e.lng-this.lng)*a);return Gf*Math.acos(Math.min(y,1))}toBounds(e=0){const a=360*e/40075017,u=a/Math.cos(Math.PI/180*this.lat);return new Hu(new qu(this.lng-u,this.lat-a),new qu(this.lng+u,this.lat+a))}toEcef(e){const a=Pm(e);return jd(this.lat,this.lng,wc+a)}static convert(e){if(e instanceof qu)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new qu(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new qu(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var bn=qu;function sy(s){return K0*Math.cos(s*Math.PI/180)}function Ec(s){return(180+s)/360}function Sc(s){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+s*Math.PI/360)))/360}function Hl(s,e){return s/sy(e)}function Aa(s){return 360*s-180}function Rr(s){return 360/Math.PI*Math.atan(Math.exp((180-360*s)*Math.PI/180))-90}function Y0(s,e){return s*sy(Rr(e))}const Br=85.051129;function J0(s){return 1/Math.cos(s*Math.PI/180)}class Ud{constructor(e,a,u=0){this.x=+e,this.y=+a,this.z=+u}static fromLngLat(e,a=0){const u=bn.convert(e);return new Ud(Ec(u.lng),Sc(u.lat),Hl(a,u.lat))}toLngLat(){return new bn(Aa(this.x),Rr(this.y))}toAltitude(){return Y0(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/K0*J0(Rr(this.y))}}function ry(s,e,a,u,p,y,b,T,M){const P=(e+u)/2,O=(a+p)/2,N=new Nt(P,O);T(N),(function($,Z,X,J,ct,yt){const Ct=X-ct,vt=J-yt;return Math.abs((J-Z)*Ct-(X-$)*vt)/Math.hypot(Ct,vt)})(N.x,N.y,y.x,y.y,b.x,b.y)>=M?(ry(s,e,a,P,O,y,N,T,M),ry(s,P,O,u,p,N,b,T,M)):s.push(b)}function Q0(s,e,a){let u=s[0],p=u.x,y=u.y;e(u);const b=[u];for(let T=1;T<s.length;T++){const M=s[T],{x:P,y:O}=M;e(M),ry(b,p,y,P,O,u,M,e,a),p=P,y=O,u=M}return b}function oy(s,e,a,u){if(u(e,a)){const p=e.add(a)._mult(.5);oy(s,e,p,u),oy(s,p,a,u)}else s.push(a)}function cA(s,e){let a=s[0];const u=[a];for(let p=1;p<s.length;p++){const y=s[p];oy(u,a,y,e),a=y}return u}const ay=Math.pow(2,14)-1,tb=-ay-1;function uA(s,e){const a=Math.round(s.x*e),u=Math.round(s.y*e);return s.x=Oe(a,tb,ay),s.y=Oe(u,tb,ay),(a<s.x||a>s.x+1||u<s.y||u>s.y+1)&&me("Geometry exceeds allowed extent, reduce your vector tile buffer size"),s}function fu(s,e,a){const u=s.loadGeometry(),p=s.extent,y=di/p;if(e&&a&&a.projection.isReprojectedInTileSpace){const b=1<<e.z,{scale:T,x:M,y:P,projection:O}=a,N=$=>{const Z=Aa((e.x+$.x/p)/b),X=Rr((e.y+$.y/p)/b),J=O.project(Z,X);$.x=(J.x*T-M)*p,$.y=(J.y*T-P)*p};for(let $=0;$<u.length;$++)if(s.type!==1)u[$]=Q0(u[$],N,1);else{const Z=[];for(const X of u[$])X.x<0||X.x>=p||X.y<0||X.y>=p||(N(X),Z.push(X));u[$]=Z}}for(const b of u)for(const T of b)uA(T,y);return u}function $h(s,e){return{type:s.type,id:s.id,properties:s.properties,geometry:e?fu(s):[]}}function Lm(s,e,a,u,p){s.emplaceBack(2*e+(u+1)/2,2*a+(p+1)/2)}function Dm(s,e,a){s.emplaceBack(e.x,e.y,e.z,a[0]*16384,a[1]*16384,a[2]*16384)}class ly{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Te,this.indexArray=new oi,this.segments=new Ts,this.programConfigurations=new Bh(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(e,a,u,p){const y=this.layers[0],b=[];let T=null;y.type==="circle"&&(T=y.layout.get("circle-sort-key"));for(const{feature:P,id:O,index:N,sourceLayerIndex:$}of e){const Z=this.layers[0]._featureFilter.needGeometry,X=$h(P,Z);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),X,u))continue;const J=T?T.evaluate(X,{},u):void 0,ct={id:O,properties:P.properties,type:P.type,sourceLayerIndex:$,index:N,geometry:Z?X.geometry:fu(P,u,p),patterns:{},sortKey:J};b.push(ct)}T&&b.sort(((P,O)=>P.sortKey-O.sortKey));let M=null;p.projection.name==="globe"&&(this.globeExtVertexArray=new be,M=p.projection);for(const P of b){const{geometry:O,index:N,sourceLayerIndex:$}=P,Z=e[N].feature;this.addFeature(P,O,N,a.availableImages,u,M),a.featureIndex.insert(Z,O,N,$,this.index)}}update(e,a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,a,this.stateDependentLayers,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,KC.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,YC.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,a,u,p,y,b){for(const T of a)for(const M of T){const P=M.x,O=M.y;if(P<0||P>=di||O<0||O>=di)continue;if(b){const Z=b.projectTilePoint(P,O,y),X=b.upVector(y,P,O),J=this.globeExtVertexArray;Dm(J,Z,X),Dm(J,Z,X),Dm(J,Z,X),Dm(J,Z,X)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),$=N.vertexLength;Lm(this.layoutVertexArray,P,O,-1,-1),Lm(this.layoutVertexArray,P,O,1,-1),Lm(this.layoutVertexArray,P,O,1,1),Lm(this.layoutVertexArray,P,O,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,{},p,y)}}function eb(s,e){for(let a=0;a<s.length;a++)if(Wh(e,s[a]))return!0;for(let a=0;a<e.length;a++)if(Wh(s,e[a]))return!0;return!!cy(s,e)}function hA(s,e,a){return!!Wh(s,e)||!!uy(e,s,a)}function ib(s,e){if(s.length===1)return sb(e,s[0]);for(let a=0;a<e.length;a++){const u=e[a];for(let p=0;p<u.length;p++)if(Wh(s,u[p]))return!0}for(let a=0;a<s.length;a++)if(sb(e,s[a]))return!0;for(let a=0;a<e.length;a++)if(cy(s,e[a]))return!0;return!1}function dA(s,e,a){if(s.length>1){if(cy(s,e))return!0;for(let u=0;u<e.length;u++)if(uy(e[u],s,a))return!0}for(let u=0;u<s.length;u++)if(uy(s[u],e,a))return!0;return!1}function cy(s,e){if(s.length===0||e.length===0)return!1;for(let a=0;a<s.length-1;a++){const u=s[a],p=s[a+1];for(let y=0;y<e.length-1;y++)if(fA(u,p,e[y],e[y+1]))return!0}return!1}function fA(s,e,a,u){return we(s,a,u)!==we(e,a,u)&&we(s,e,a)!==we(s,e,u)}function uy(s,e,a){const u=a*a;if(e.length===1)return s.distSqr(e[0])<u;for(let p=1;p<e.length;p++)if(nb(s,e[p-1],e[p])<u)return!0;return!1}function nb(s,e,a){const u=e.distSqr(a);if(u===0)return s.distSqr(e);const p=((s.x-e.x)*(a.x-e.x)+(s.y-e.y)*(a.y-e.y))/u;return s.distSqr(p<0?e:p>1?a:a.sub(e)._mult(p)._add(e))}function sb(s,e){let a,u,p,y=!1;for(let b=0;b<s.length;b++){a=s[b];for(let T=0,M=a.length-1;T<a.length;M=T++)u=a[T],p=a[M],u.y>e.y!=p.y>e.y&&e.x<(p.x-u.x)*(e.y-u.y)/(p.y-u.y)+u.x&&(y=!y)}return y}function Wh(s,e){let a=!1;for(let u=0,p=s.length-1;u<s.length;p=u++){const y=s[u],b=s[p];y.y>e.y!=b.y>e.y&&e.x<(b.x-y.x)*(e.y-y.y)/(b.y-y.y)+y.x&&(a=!a)}return a}function rb(s,e,a,u,p){for(const b of s)if(e<=b.x&&a<=b.y&&u>=b.x&&p>=b.y)return!0;const y=[new Nt(e,a),new Nt(e,p),new Nt(u,p),new Nt(u,a)];if(s.length>2){for(const b of y)if(Wh(s,b))return!0}for(let b=0;b<s.length-1;b++)if(pA(s[b],s[b+1],y))return!0;return!1}function pA(s,e,a){const u=a[0],p=a[2];if(s.x<u.x&&e.x<u.x||s.x>p.x&&e.x>p.x||s.y<u.y&&e.y<u.y||s.y>p.y&&e.y>p.y)return!1;const y=we(s,e,a[0]);return y!==we(s,e,a[1])||y!==we(s,e,a[2])||y!==we(s,e,a[3])}function $d(s,e,a){const u=e.paint.get(s).value;return u.kind==="constant"?u.value:a.programConfigurations.get(e.id).getMaxValue(s)}function zm(s){return Math.sqrt(s[0]*s[0]+s[1]*s[1])}function ob(s,e,a,u,p){if(!e[0]&&!e[1])return s;const y=Nt.convert(e)._mult(p);a==="viewport"&&y._rotate(-u);const b=[];for(let T=0;T<s.length;T++)b.push(s[T].sub(y));return b}function ab(s,e,a,u){const p=Nt.convert(s)._mult(u);return e==="viewport"&&p._rotate(-a),p}Je(ly,"CircleBucket",{omit:["layers"]});const mA=new gt({"circle-sort-key":new st(le.layout_circle["circle-sort-key"])});var _A={paint:new gt({"circle-radius":new st(le.paint_circle["circle-radius"]),"circle-color":new st(le.paint_circle["circle-color"]),"circle-blur":new st(le.paint_circle["circle-blur"]),"circle-opacity":new st(le.paint_circle["circle-opacity"]),"circle-translate":new Y(le.paint_circle["circle-translate"]),"circle-translate-anchor":new Y(le.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Y(le.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Y(le.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new st(le.paint_circle["circle-stroke-width"]),"circle-stroke-color":new st(le.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new st(le.paint_circle["circle-stroke-opacity"])}),layout:mA};function lb(s,e,a,u,p,y,b,T,M){if(y&&s.queryGeometry.isAboveHorizon)return!1;y&&(M*=s.pixelToTileUnitsFactor);const P=s.tileID.canonical,O=a.projection.upVectorScale(P,a.center.lat,a.worldSize).metersToTile;for(const N of e)for(const $ of N){const Z=$.add(T),X=p&&a.elevation?a.elevation.exaggeration()*p.getElevationAt(Z.x,Z.y,!0):0,J=a.projection.projectTilePoint(Z.x,Z.y,P);if(X>0){const vt=a.projection.upVector(P,Z.x,Z.y);J.x+=vt[0]*O*X,J.y+=vt[1]*O*X,J.z+=vt[2]*O*X}const ct=y?Z:gA(J.x,J.y,J.z,u),yt=y?s.tilespaceRays.map((vt=>vA(vt,X))):s.queryGeometry.screenGeometry,Ct=jh([],[J.x,J.y,J.z,1],u);if(!b&&y?M*=Ct[3]/a.cameraToCenterDistance:b&&!y&&(M*=a.cameraToCenterDistance/Ct[3]),y){const vt=Rr(($.y/di+P.y)/(1<<P.z));M/=a.projection.pixelsPerMeter(vt,1)/Hl(1,vt)}if(hA(yt,ct,M))return!0}return!1}function gA(s,e,a,u){const p=jh([],[s,e,a,1],u);return new Nt(p[0]/p[3],p[1]/p[3])}const cb=Fd(0,0,0),yA=Fd(0,0,1);function vA(s,e){const a=Hg();return cb[2]=e,s.intersectsPlane(cb,yA,a),new Nt(a[0],a[1])}class ub extends ly{}function hb(s,{width:e,height:a},u,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==e*a*u)throw new RangeError("mismatched image size")}else p=new Uint8Array(e*a*u);return s.width=e,s.height=a,s.data=p,s}function db(s,e,a){const{width:u,height:p}=e;u===s.width&&p===s.height||(hy(s,e,{x:0,y:0},{x:0,y:0},{width:Math.min(s.width,u),height:Math.min(s.height,p)},a),s.width=u,s.height=p,s.data=e.data)}function hy(s,e,a,u,p,y){if(p.width===0||p.height===0)return e;if(p.width>s.width||p.height>s.height||a.x>s.width-p.width||a.y>s.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>e.width||p.height>e.height||u.x>e.width-p.width||u.y>e.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const b=s.data,T=e.data;for(let M=0;M<p.height;M++){const P=((a.y+M)*s.width+a.x)*y,O=((u.y+M)*e.width+u.x)*y;for(let N=0;N<p.width*y;N++)T[O+N]=b[P+N]}return e}Je(ub,"HeatmapBucket",{omit:["layers"]});class pu{constructor(e,a){hb(this,e,1,a)}resize(e){db(this,new pu(e),1)}clone(){return new pu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,a,u,p,y){hy(e,a,u,p,y,1)}}class sa{constructor(e,a){hb(this,e,4,a)}resize(e){db(this,new sa(e),4)}replace(e,a){a?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new sa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,a,u,p,y){hy(e,a,u,p,y,4)}}Je(pu,"AlphaImage"),Je(sa,"RGBAImage");var xA={paint:new gt({"heatmap-radius":new st(le.paint_heatmap["heatmap-radius"]),"heatmap-weight":new st(le.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Y(le.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _t(le.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Y(le.paint_heatmap["heatmap-opacity"])})};function dy(s){const e={},a=s.resolution||256,u=s.clips?s.clips.length:1,p=s.image||new sa({width:a,height:u}),y=(b,T,M)=>{e[s.evaluationKey]=M;const P=s.expression.evaluate(e);p.data[b+T+0]=Math.floor(255*P.r/P.a),p.data[b+T+1]=Math.floor(255*P.g/P.a),p.data[b+T+2]=Math.floor(255*P.b/P.a),p.data[b+T+3]=Math.floor(255*P.a)};if(s.clips)for(let b=0,T=0;b<u;++b,T+=4*a)for(let M=0,P=0;M<a;M++,P+=4){const O=M/(a-1),{start:N,end:$}=s.clips[b];y(T,P,N*(1-O)+$*O)}else for(let b=0,T=0;b<a;b++,T+=4)y(0,T,b/(a-1));return p}var bA={paint:new gt({"hillshade-illumination-direction":new Y(le.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Y(le.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Y(le.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Y(le.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Y(le.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Y(le.paint_hillshade["hillshade-accent-color"])})};const wA=Ut([{name:"a_pos",components:2,type:"Int16"}],4),{members:TA}=wA;var fy={exports:{}};function Om(s,e,a){a=a||2;var u,p,y,b,T,M,P,O=e&&e.length,N=O?e[0]*a:s.length,$=fb(s,0,N,a,!0),Z=[];if(!$||$.next===$.prev)return Z;if(O&&($=(function(J,ct,yt,Ct){var vt,St,Dt,It=[];for(vt=0,St=ct.length;vt<St;vt++)(Dt=fb(J,ct[vt]*Ct,vt<St-1?ct[vt+1]*Ct:J.length,Ct,!1))===Dt.next&&(Dt.steiner=!0),It.push(IA(Dt));for(It.sort(AA),vt=0;vt<It.length;vt++)yt=PA(It[vt],yt);return yt})(s,e,$,a)),s.length>80*a){u=y=s[0],p=b=s[1];for(var X=a;X<N;X+=a)(T=s[X])<u&&(u=T),(M=s[X+1])<p&&(p=M),T>y&&(y=T),M>b&&(b=M);P=(P=Math.max(y-u,b-p))!==0?32767/P:0}return Hf($,Z,a,u,p,P,0),Z}function fb(s,e,a,u,p){var y,b;if(p===_y(s,e,a,u)>0)for(y=e;y<a;y+=u)b=_b(y,s[y],s[y+1],b);else for(y=a-u;y>=e;y-=u)b=_b(y,s[y],s[y+1],b);return b&&Rm(b,b.next)&&(Xf(b),b=b.next),b}function Zh(s,e){if(!s)return s;e||(e=s);var a,u=s;do if(a=!1,u.steiner||!Rm(u,u.next)&&Es(u.prev,u,u.next)!==0)u=u.next;else{if(Xf(u),(u=e=u.prev)===u.next)break;a=!0}while(a||u!==e);return e}function Hf(s,e,a,u,p,y,b){if(s){!b&&y&&(function(O,N,$,Z){var X=O;do X.z===0&&(X.z=py(X.x,X.y,N,$,Z)),X.prevZ=X.prev,X.nextZ=X.next,X=X.next;while(X!==O);X.prevZ.nextZ=null,X.prevZ=null,(function(J){var ct,yt,Ct,vt,St,Dt,It,ie,Qt=1;do{for(yt=J,J=null,St=null,Dt=0;yt;){for(Dt++,Ct=yt,It=0,ct=0;ct<Qt&&(It++,Ct=Ct.nextZ);ct++);for(ie=Qt;It>0||ie>0&&Ct;)It!==0&&(ie===0||!Ct||yt.z<=Ct.z)?(vt=yt,yt=yt.nextZ,It--):(vt=Ct,Ct=Ct.nextZ,ie--),St?St.nextZ=vt:J=vt,vt.prevZ=St,St=vt;yt=Ct}St.nextZ=null,Qt*=2}while(Dt>1)})(X)})(s,u,p,y);for(var T,M,P=s;s.prev!==s.next;)if(T=s.prev,M=s.next,y?SA(s,u,p,y):EA(s))e.push(T.i/a|0),e.push(s.i/a|0),e.push(M.i/a|0),Xf(s),s=M.next,P=M.next;else if((s=M)===P){b?b===1?Hf(s=MA(Zh(s),e,a),e,a,u,p,y,2):b===2&&CA(s,e,a,u,p,y):Hf(Zh(s),e,a,u,p,y,1);break}}}function EA(s){var e=s.prev,a=s,u=s.next;if(Es(e,a,u)>=0)return!1;for(var p=e.x,y=a.x,b=u.x,T=e.y,M=a.y,P=u.y,O=p<y?p<b?p:b:y<b?y:b,N=T<M?T<P?T:P:M<P?M:P,$=p>y?p>b?p:b:y>b?y:b,Z=T>M?T>P?T:P:M>P?M:P,X=u.next;X!==e;){if(X.x>=O&&X.x<=$&&X.y>=N&&X.y<=Z&&Wd(p,T,y,M,b,P,X.x,X.y)&&Es(X.prev,X,X.next)>=0)return!1;X=X.next}return!0}function SA(s,e,a,u){var p=s.prev,y=s,b=s.next;if(Es(p,y,b)>=0)return!1;for(var T=p.x,M=y.x,P=b.x,O=p.y,N=y.y,$=b.y,Z=T<M?T<P?T:P:M<P?M:P,X=O<N?O<$?O:$:N<$?N:$,J=T>M?T>P?T:P:M>P?M:P,ct=O>N?O>$?O:$:N>$?N:$,yt=py(Z,X,e,a,u),Ct=py(J,ct,e,a,u),vt=s.prevZ,St=s.nextZ;vt&&vt.z>=yt&&St&&St.z<=Ct;){if(vt.x>=Z&&vt.x<=J&&vt.y>=X&&vt.y<=ct&&vt!==p&&vt!==b&&Wd(T,O,M,N,P,$,vt.x,vt.y)&&Es(vt.prev,vt,vt.next)>=0||(vt=vt.prevZ,St.x>=Z&&St.x<=J&&St.y>=X&&St.y<=ct&&St!==p&&St!==b&&Wd(T,O,M,N,P,$,St.x,St.y)&&Es(St.prev,St,St.next)>=0))return!1;St=St.nextZ}for(;vt&&vt.z>=yt;){if(vt.x>=Z&&vt.x<=J&&vt.y>=X&&vt.y<=ct&&vt!==p&&vt!==b&&Wd(T,O,M,N,P,$,vt.x,vt.y)&&Es(vt.prev,vt,vt.next)>=0)return!1;vt=vt.prevZ}for(;St&&St.z<=Ct;){if(St.x>=Z&&St.x<=J&&St.y>=X&&St.y<=ct&&St!==p&&St!==b&&Wd(T,O,M,N,P,$,St.x,St.y)&&Es(St.prev,St,St.next)>=0)return!1;St=St.nextZ}return!0}function MA(s,e,a){var u=s;do{var p=u.prev,y=u.next.next;!Rm(p,y)&&pb(p,u,u.next,y)&&qf(p,y)&&qf(y,p)&&(e.push(p.i/a|0),e.push(u.i/a|0),e.push(y.i/a|0),Xf(u),Xf(u.next),u=s=y),u=u.next}while(u!==s);return Zh(u)}function CA(s,e,a,u,p,y){var b=s;do{for(var T=b.next.next;T!==b.prev;){if(b.i!==T.i&&LA(b,T)){var M=mb(b,T);return b=Zh(b,b.next),M=Zh(M,M.next),Hf(b,e,a,u,p,y,0),void Hf(M,e,a,u,p,y,0)}T=T.next}b=b.next}while(b!==s)}function AA(s,e){return s.x-e.x}function PA(s,e){var a=(function(p,y){var b,T=y,M=p.x,P=p.y,O=-1/0;do{if(P<=T.y&&P>=T.next.y&&T.next.y!==T.y){var N=T.x+(P-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(N<=M&&N>O&&(O=N,b=T.x<T.next.x?T:T.next,N===M))return b}T=T.next}while(T!==y);if(!b)return null;var $,Z=b,X=b.x,J=b.y,ct=1/0;T=b;do M>=T.x&&T.x>=X&&M!==T.x&&Wd(P<J?M:O,P,X,J,P<J?O:M,P,T.x,T.y)&&($=Math.abs(P-T.y)/(M-T.x),qf(T,p)&&($<ct||$===ct&&(T.x>b.x||T.x===b.x&&kA(b,T)))&&(b=T,ct=$)),T=T.next;while(T!==Z);return b})(s,e);if(!a)return e;var u=mb(a,s);return Zh(u,u.next),Zh(a,a.next)}function kA(s,e){return Es(s.prev,s,e.prev)<0&&Es(e.next,s,s.next)<0}function py(s,e,a,u,p){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=(s-a)*p|0)|s<<8))|s<<4))|s<<2))|s<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-u)*p|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function IA(s){var e=s,a=s;do(e.x<a.x||e.x===a.x&&e.y<a.y)&&(a=e),e=e.next;while(e!==s);return a}function Wd(s,e,a,u,p,y,b,T){return(p-b)*(e-T)>=(s-b)*(y-T)&&(s-b)*(u-T)>=(a-b)*(e-T)&&(a-b)*(y-T)>=(p-b)*(u-T)}function LA(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!(function(a,u){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==u.i&&p.next.i!==u.i&&pb(p,p.next,a,u))return!0;p=p.next}while(p!==a);return!1})(s,e)&&(qf(s,e)&&qf(e,s)&&(function(a,u){var p=a,y=!1,b=(a.x+u.x)/2,T=(a.y+u.y)/2;do p.y>T!=p.next.y>T&&p.next.y!==p.y&&b<(p.next.x-p.x)*(T-p.y)/(p.next.y-p.y)+p.x&&(y=!y),p=p.next;while(p!==a);return y})(s,e)&&(Es(s.prev,s,e.prev)||Es(s,e.prev,e))||Rm(s,e)&&Es(s.prev,s,s.next)>0&&Es(e.prev,e,e.next)>0)}function Es(s,e,a){return(e.y-s.y)*(a.x-e.x)-(e.x-s.x)*(a.y-e.y)}function Rm(s,e){return s.x===e.x&&s.y===e.y}function pb(s,e,a,u){var p=Fm(Es(s,e,a)),y=Fm(Es(s,e,u)),b=Fm(Es(a,u,s)),T=Fm(Es(a,u,e));return p!==y&&b!==T||!(p!==0||!Bm(s,a,e))||!(y!==0||!Bm(s,u,e))||!(b!==0||!Bm(a,s,u))||!(T!==0||!Bm(a,e,u))}function Bm(s,e,a){return e.x<=Math.max(s.x,a.x)&&e.x>=Math.min(s.x,a.x)&&e.y<=Math.max(s.y,a.y)&&e.y>=Math.min(s.y,a.y)}function Fm(s){return s>0?1:s<0?-1:0}function qf(s,e){return Es(s.prev,s,s.next)<0?Es(s,e,s.next)>=0&&Es(s,s.prev,e)>=0:Es(s,e,s.prev)<0||Es(s,s.next,e)<0}function mb(s,e){var a=new my(s.i,s.x,s.y),u=new my(e.i,e.x,e.y),p=s.next,y=e.prev;return s.next=e,e.prev=s,a.next=p,p.prev=a,u.next=a,a.prev=u,y.next=u,u.prev=y,u}function _b(s,e,a,u){var p=new my(s,e,a);return u?(p.next=u.next,p.prev=u,u.next.prev=p,u.next=p):(p.prev=p,p.next=p),p}function Xf(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function my(s,e,a){this.i=s,this.x=e,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _y(s,e,a,u){for(var p=0,y=e,b=a-u;y<a;y+=u)p+=(s[b]-s[y])*(s[y+1]+s[b+1]),b=y;return p}fy.exports=Om,fy.exports.default=Om,Om.deviation=function(s,e,a,u){var p=e&&e.length,y=Math.abs(_y(s,0,p?e[0]*a:s.length,a));if(p)for(var b=0,T=e.length;b<T;b++)y-=Math.abs(_y(s,e[b]*a,b<T-1?e[b+1]*a:s.length,a));var M=0;for(b=0;b<u.length;b+=3){var P=u[b]*a,O=u[b+1]*a,N=u[b+2]*a;M+=Math.abs((s[P]-s[N])*(s[O+1]-s[P+1])-(s[P]-s[O])*(s[N+1]-s[P+1]))}return y===0&&M===0?0:Math.abs((M-y)/y)},Om.flatten=function(s){for(var e=s[0][0].length,a={vertices:[],holes:[],dimensions:e},u=0,p=0;p<s.length;p++){for(var y=0;y<s[p].length;y++)for(var b=0;b<e;b++)a.vertices.push(s[p][y][b]);p>0&&a.holes.push(u+=s[p-1].length)}return a};var gy=mt(fy.exports);function DA(s,e,a,u,p){gb(s,e,a,u||s.length-1,p||zA)}function gb(s,e,a,u,p){for(;u>a;){if(u-a>600){var y=u-a+1,b=e-a+1,T=Math.log(y),M=.5*Math.exp(2*T/3),P=.5*Math.sqrt(T*M*(y-M)/y)*(b-y/2<0?-1:1);gb(s,e,Math.max(a,Math.floor(e-b*M/y+P)),Math.min(u,Math.floor(e+(y-b)*M/y+P)),p)}var O=s[e],N=a,$=u;for(Kf(s,a,e),p(s[u],O)>0&&Kf(s,a,u);N<$;){for(Kf(s,N,$),N++,$--;p(s[N],O)<0;)N++;for(;p(s[$],O)>0;)$--}p(s[a],O)===0?Kf(s,a,$):Kf(s,++$,u),$<=e&&(a=$+1),e<=$&&(u=$-1)}}function Kf(s,e,a){var u=s[e];s[e]=s[a],s[a]=u}function zA(s,e){return s<e?-1:s>e?1:0}function yy(s,e){const a=s.length;if(a<=1)return[s];const u=[];let p,y;for(let b=0;b<a;b++){const T=Ke(s[b]);T!==0&&(s[b].area=Math.abs(T),y===void 0&&(y=T<0),y===T<0?(p&&u.push(p),p=[s[b]]):p.push(s[b]))}if(p&&u.push(p),e>1)for(let b=0;b<u.length;b++)u[b].length<=e||(DA(u[b],e,1,u[b].length-1,OA),u[b]=u[b].slice(0,e));return u}function OA(s,e){return e.area-s.area}function vy(s,e,a){const u=a.patternDependencies;let p=!1;for(const y of e){const b=y.paint.get(`${s}-pattern`);b.isConstant()||(p=!0);const T=b.constantOr(null);T&&(p=!0,u[T]=!0)}return p}function xy(s,e,a,u,p){const y=p.patternDependencies;for(const b of e){const T=b.paint.get(`${s}-pattern`).value;if(T.kind!=="constant"){let M=T.evaluate({zoom:u},a,{},p.availableImages);M=M&&M.name?M.name:M,y[M]=!0,a.patterns[b.id]=M}}return a}class Nm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Te,this.indexArray=new oi,this.indexArray2=new Bs,this.programConfigurations=new Bh(e.layers,e.zoom),this.segments=new Ts,this.segments2=new Ts,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id)),this.projection=e.projection}populate(e,a,u,p){this.hasPattern=vy("fill",this.layers,a);const y=this.layers[0].layout.get("fill-sort-key"),b=[];for(const{feature:T,id:M,index:P,sourceLayerIndex:O}of e){const N=this.layers[0]._featureFilter.needGeometry,$=$h(T,N);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),$,u))continue;const Z=y?y.evaluate($,{},u,a.availableImages):void 0,X={id:M,properties:T.properties,type:T.type,sourceLayerIndex:O,index:P,geometry:N?$.geometry:fu(T,u,p),patterns:{},sortKey:Z};b.push(X)}y&&b.sort(((T,M)=>T.sortKey-M.sortKey));for(const T of b){const{geometry:M,index:P,sourceLayerIndex:O}=T;if(this.hasPattern){const N=xy("fill",this.layers,T,this.zoom,a);this.patternFeatures.push(N)}else this.addFeature(T,M,P,u,{},a.availableImages);a.featureIndex.insert(e[P].feature,M,P,O,this.index)}}update(e,a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,a,this.stateDependentLayers,u,p)}addFeatures(e,a,u,p,y){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,a,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,TA),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,a,u,p,y,b=[]){for(const T of yy(a,500)){let M=0;for(const X of T)M+=X.length;const P=this.segments.prepareSegment(M,this.layoutVertexArray,this.indexArray),O=P.vertexLength,N=[],$=[];for(const X of T){if(X.length===0)continue;X!==T[0]&&$.push(N.length/2);const J=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),ct=J.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(ct+X.length-1,ct),N.push(X[0].x),N.push(X[0].y);for(let yt=1;yt<X.length;yt++)this.layoutVertexArray.emplaceBack(X[yt].x,X[yt].y),this.indexArray2.emplaceBack(ct+yt-1,ct+yt),N.push(X[yt].x),N.push(X[yt].y);J.vertexLength+=X.length,J.primitiveLength+=X.length}const Z=gy(N,$);for(let X=0;X<Z.length;X+=3)this.indexArray.emplaceBack(O+Z[X],O+Z[X+1],O+Z[X+2]);P.vertexLength+=M,P.primitiveLength+=Z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,y,b,p)}}Je(Nm,"FillBucket",{omit:["layers","patternFeatures"]});const RA=new gt({"fill-sort-key":new st(le.layout_fill["fill-sort-key"])});var BA={paint:new gt({"fill-antialias":new Y(le.paint_fill["fill-antialias"]),"fill-opacity":new st(le.paint_fill["fill-opacity"]),"fill-color":new st(le.paint_fill["fill-color"]),"fill-outline-color":new st(le.paint_fill["fill-outline-color"]),"fill-translate":new Y(le.paint_fill["fill-translate"]),"fill-translate-anchor":new Y(le.paint_fill["fill-translate-anchor"]),"fill-pattern":new st(le.paint_fill["fill-pattern"])}),layout:RA};const FA=Ut([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),NA=Ut([{name:"a_centroid_pos",components:2,type:"Uint16"}]),jA=Ut([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:VA}=FA;var jm={},UA=Rt,yb=Zd;function Zd(s,e,a,u,p){this.properties={},this.extent=a,this.type=0,this._pbf=s,this._geometry=-1,this._keys=u,this._values=p,s.readFields($A,this,e)}function $A(s,e,a){s==1?e.id=a.readVarint():s==2?(function(u,p){for(var y=u.readVarint()+u.pos;u.pos<y;){var b=p._keys[u.readVarint()],T=p._values[u.readVarint()];p.properties[b]=T}})(a,e):s==3?e.type=a.readVarint():s==4&&(e._geometry=a.pos)}function WA(s){for(var e,a,u=0,p=0,y=s.length,b=y-1;p<y;b=p++)u+=((a=s[b]).x-(e=s[p]).x)*(e.y+a.y);return u}Zd.types=["Unknown","Point","LineString","Polygon"],Zd.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var e,a=s.readVarint()+s.pos,u=1,p=0,y=0,b=0,T=[];s.pos<a;){if(p<=0){var M=s.readVarint();u=7&M,p=M>>3}if(p--,u===1||u===2)y+=s.readSVarint(),b+=s.readSVarint(),u===1&&(e&&T.push(e),e=[]),e.push(new UA(y,b));else{if(u!==7)throw new Error("unknown command "+u);e&&e.push(e[0].clone())}}return e&&T.push(e),T},Zd.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var e=s.readVarint()+s.pos,a=1,u=0,p=0,y=0,b=1/0,T=-1/0,M=1/0,P=-1/0;s.pos<e;){if(u<=0){var O=s.readVarint();a=7&O,u=O>>3}if(u--,a===1||a===2)(p+=s.readSVarint())<b&&(b=p),p>T&&(T=p),(y+=s.readSVarint())<M&&(M=y),y>P&&(P=y);else if(a!==7)throw new Error("unknown command "+a)}return[b,M,T,P]},Zd.prototype.toGeoJSON=function(s,e,a){var u,p,y=this.extent*Math.pow(2,a),b=this.extent*s,T=this.extent*e,M=this.loadGeometry(),P=Zd.types[this.type];function O(Z){for(var X=0;X<Z.length;X++){var J=Z[X];Z[X]=[360*(J.x+b)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(J.y+T)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(u=0;u<M.length;u++)N[u]=M[u][0];O(M=N);break;case 2:for(u=0;u<M.length;u++)O(M[u]);break;case 3:for(M=(function(Z){var X=Z.length;if(X<=1)return[Z];for(var J,ct,yt=[],Ct=0;Ct<X;Ct++){var vt=WA(Z[Ct]);vt!==0&&(ct===void 0&&(ct=vt<0),ct===vt<0?(J&&yt.push(J),J=[Z[Ct]]):J.push(Z[Ct]))}return J&&yt.push(J),yt})(M),u=0;u<M.length;u++)for(p=0;p<M[u].length;p++)O(M[u][p])}M.length===1?M=M[0]:P="Multi"+P;var $={type:"Feature",geometry:{type:P,coordinates:M},properties:this.properties};return"id"in this&&($.id=this.id),$};var ZA=yb,vb=xb;function xb(s,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=s,this._keys=[],this._values=[],this._features=[],s.readFields(GA,this,e),this.length=this._features.length}function GA(s,e,a){s===15?e.version=a.readVarint():s===1?e.name=a.readString():s===5?e.extent=a.readVarint():s===2?e._features.push(a.pos):s===3?e._keys.push(a.readString()):s===4&&e._values.push((function(u){for(var p=null,y=u.readVarint()+u.pos;u.pos<y;){var b=u.readVarint()>>3;p=b===1?u.readString():b===2?u.readFloat():b===3?u.readDouble():b===4?u.readVarint64():b===5?u.readVarint():b===6?u.readSVarint():b===7?u.readBoolean():null}return p})(a))}xb.prototype.feature=function(s){if(s<0||s>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[s];var e=this._pbf.readVarint()+this._pbf.pos;return new ZA(this._pbf,e,this.extent,this._keys,this._values)};var HA=vb;function qA(s,e,a){if(s===3){var u=new HA(a,a.readVarint()+a.pos);u.length&&(e[u.name]=u)}}var by=jm.VectorTile=function(s,e){this.layers=s.readFields(qA,{},e)},Vm=jm.VectorTileFeature=yb;function Um(s,e,a,u){const p=[],y=u===0?(b,T,M,P,O,N)=>{b.push(new Nt(N,M+(N-T)/(P-T)*(O-M)))}:(b,T,M,P,O,N)=>{b.push(new Nt(T+(N-M)/(O-M)*(P-T),N))};for(const b of s){const T=[];for(const M of b){if(M.length<=2)continue;const P=[];for(let $=0;$<M.length-1;$++){const Z=M[$].x,X=M[$].y,J=M[$+1].x,ct=M[$+1].y,yt=u===0?Z:X,Ct=u===0?J:ct;yt<e?Ct>e&&y(P,Z,X,J,ct,e):yt>a?Ct<a&&y(P,Z,X,J,ct,a):P.push(M[$]),Ct<e&&yt>=e&&y(P,Z,X,J,ct,e),Ct>a&&yt<=a&&y(P,Z,X,J,ct,a)}let O=M[M.length-1];const N=u===0?O.x:O.y;N>=e&&N<=a&&P.push(O),P.length&&(O=P[P.length-1],P[0].x===O.x&&P[0].y===O.y||P.push(P[0]),T.push(P))}T.length&&p.push(T)}return p}jm.VectorTileLayer=vb;const XA=Vm.types,KA=Math.pow(2,13);function Yf(s,e,a,u,p,y,b,T){s.emplaceBack((e<<1)+b,(a<<1)+y,(Math.floor(u*KA)<<1)+p,Math.round(T))}function Jf(s,e,a){s.emplaceBack(e.x,e.y,e.z,a[0]*16384,a[1]*16384,a[2]*16384)}class bb{constructor(){this.acc=new Nt(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Nt(e.x,e.y),this.max=new Nt(e.x,e.y))}append(e,a){this.currentPolyCount.edges++,this.acc._add(e);const u=this.min,p=this.max;e.x<u.x?u.x=e.x:e.x>p.x&&(p.x=e.x),e.y<u.y?u.y=e.y:e.y>p.y&&(p.y=e.y),((e.x===0||e.x===di)&&e.x===a.x)!=((e.y===0||e.y===di)&&e.y===a.y)&&this.processBorderOverlap(e,a),a.x<0!=e.x<0&&this.addBorderIntersection(0,Hi(a.y,e.y,(0-a.x)/(e.x-a.x))),a.x>di!=e.x>di&&this.addBorderIntersection(1,Hi(a.y,e.y,(di-a.x)/(e.x-a.x))),a.y<0!=e.y<0&&this.addBorderIntersection(2,Hi(a.x,e.x,(0-a.y)/(e.y-a.y))),a.y>di!=e.y>di&&this.addBorderIntersection(3,Hi(a.x,e.x,(di-a.y)/(e.y-a.y)))}addBorderIntersection(e,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[e];a<u[0]&&(u[0]=a),a>u[1]&&(u[1]=a)}processBorderOverlap(e,a){if(e.x===a.x){if(e.y===a.y)return;const u=e.x===0?0:1;this.addBorderIntersection(u,a.y),this.addBorderIntersection(u,e.y)}else{const u=e.y===0?2:3;this.addBorderIntersection(u,a.x),this.addBorderIntersection(u,e.x)}}centroid(){const e=this.polyCount.reduce(((a,u)=>a+u.edges),0);return e!==0?this.acc.div(e)._round():new Nt(0,0)}span(){return new Nt(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((e,a)=>e+ +(a[0]!==Number.MAX_VALUE)),0)}}class Qf{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new fe,this.centroidVertexArray=new Oo,this.indexArray=new oi,this.programConfigurations=new Bh(e.layers,e.zoom),this.segments=new Ts,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id)),this.enableTerrain=e.enableTerrain}populate(e,a,u,p){this.features=[],this.hasPattern=vy("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=(function(y){const b=Math.exp(Math.PI*(1-y.y/(1<<y.z)*2));return 80150034*b/(b*b+1)/di/(1<<y.z)})(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:y,id:b,index:T,sourceLayerIndex:M}of e){const P=this.layers[0]._featureFilter.needGeometry,O=$h(y,P);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),O,u))continue;const N={id:b,sourceLayerIndex:M,index:T,geometry:P?O.geometry:fu(y,u,p),properties:y.properties,type:y.type,patterns:{}},$=this.layoutVertexArray.length;this.hasPattern?this.features.push(xy("fill-extrusion",this.layers,N,this.zoom,a)):this.addFeature(N,N.geometry,T,u,{},a.availableImages,p),a.featureIndex.insert(y,N.geometry,T,M,this.index,$)}this.sortBorders()}addFeatures(e,a,u,p,y){for(const b of this.features){const{geometry:T}=b;this.addFeature(b,T,b.index,a,u,p,y)}this.sortBorders()}update(e,a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,a,this.stateDependentLayers,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,VA),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,jA.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,NA.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,a,u,p,y,b,T){const M=[new Nt(0,0),new Nt(di,di)],P=T.projection,O=P.name==="globe",N=this.enableTerrain&&!O?new bb:null,$=XA[e.type]==="Polygon";O&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new be);const Z=yy(a,500);for(let yt=Z.length-1;yt>=0;yt--){const Ct=Z[yt];(Ct.length===0||(X=Ct[0]).every((vt=>vt.x<=0))||X.every((vt=>vt.x>=di))||X.every((vt=>vt.y<=0))||X.every((vt=>vt.y>=di)))&&Z.splice(yt,1)}var X;let J;if(O)J=Ab(Z,M,p);else{J=[];for(const yt of Z)J.push({polygon:yt,bounds:M})}const ct=$?this.edgeRadius:0;for(const{polygon:yt,bounds:Ct}of J){let vt=0,St=0;for(const It of yt)$&&!It[0].equals(It[It.length-1])&&It.push(It[0]),St+=$?It.length-1:It.length;const Dt=this.segments.prepareSegment(($?5:4)*St,this.layoutVertexArray,this.indexArray);if($){const It=[],ie=[];vt=Dt.vertexLength;for(const _e of yt){let ke,re;_e.length&&_e!==yt[0]&&ie.push(It.length/2),ke=_e[1].sub(_e[0])._perp()._unit();for(let ve=1;ve<_e.length;ve++){const xe=_e[ve],Ce=_e[ve===_e.length-1?1:ve+1];let{x:De,y:pe}=xe;if(ct){re=Ce.sub(xe)._perp()._unit();const We=ke.add(re)._unit(),si=ct*Math.min(4,1/(ke.x*We.x+ke.y*We.y));De+=si*We.x,pe+=si*We.y,ke=re}Yf(this.layoutVertexArray,De,pe,0,0,1,1,0),Dt.vertexLength++,It.push(xe.x,xe.y),O&&Jf(this.layoutVertexExtArray,P.projectTilePoint(De,pe,p),P.upVector(p,De,pe))}}const Qt=gy(It,ie);for(let _e=0;_e<Qt.length;_e+=3)this.indexArray.emplaceBack(vt+Qt[_e],vt+Qt[_e+2],vt+Qt[_e+1]),Dt.primitiveLength++}for(const It of yt){N&&It.length&&N.startRing(It[0]);let ie,Qt,_e,ke=It.length>4&&Sb(It[It.length-2],It[0],It[1]),re=ct?YA(It[It.length-2],It[0],It[1],ct):0;Qt=It[1].sub(It[0])._perp()._unit();let ve=!0;for(let xe=1,Ce=0;xe<It.length;xe++){let De=It[xe-1],pe=It[xe];const We=It[xe===It.length-1?1:xe+1];if(N&&$&&N.currentPolyCount.top++,Eb(pe,De,Ct)){ct&&(Qt=We.sub(pe)._perp()._unit(),ve=!ve);continue}N&&N.append(pe,De);const si=pe.sub(De)._perp(),qe=si.x/(Math.abs(si.x)+Math.abs(si.y)),Ci=si.y>0?1:0,ze=De.dist(pe);if(Ce+ze>32768&&(Ce=0),ct){_e=We.sub(pe)._perp()._unit();let Pi=Tb(De,pe,We,wb(Qt,_e),ct);isNaN(Pi)&&(Pi=0);const gi=pe.sub(De)._unit();De=De.add(gi.mult(re))._round(),pe=pe.add(gi.mult(-Pi))._round(),re=Pi,Qt=_e}const ui=Dt.vertexLength,Ai=It.length>4&&Sb(De,pe,We);let Qi=Mb(Ce,ke,ve);if(Yf(this.layoutVertexArray,De.x,De.y,qe,Ci,0,0,Qi),Yf(this.layoutVertexArray,De.x,De.y,qe,Ci,0,1,Qi),Ce+=ze,Qi=Mb(Ce,Ai,!ve),ke=Ai,Yf(this.layoutVertexArray,pe.x,pe.y,qe,Ci,0,0,Qi),Yf(this.layoutVertexArray,pe.x,pe.y,qe,Ci,0,1,Qi),Dt.vertexLength+=4,this.indexArray.emplaceBack(ui+0,ui+1,ui+2),this.indexArray.emplaceBack(ui+1,ui+3,ui+2),Dt.primitiveLength+=2,ct){const Pi=vt+(xe===1?It.length-2:xe-2),gi=xe===1?vt:Pi+1;if(this.indexArray.emplaceBack(ui+1,Pi,ui+3),this.indexArray.emplaceBack(Pi,gi,ui+3),Dt.primitiveLength+=2,ie===void 0&&(ie=ui),!Eb(We,It[xe],Ct)){const Rn=xe===It.length-1?ie:Dt.vertexLength;this.indexArray.emplaceBack(ui+2,ui+3,Rn),this.indexArray.emplaceBack(ui+3,Rn+1,Rn),this.indexArray.emplaceBack(ui+3,gi,Rn+1),Dt.primitiveLength+=3}ve=!ve}if(O){const Pi=this.layoutVertexExtArray,gi=P.projectTilePoint(De.x,De.y,p),Rn=P.projectTilePoint(pe.x,pe.y,p),zi=P.upVector(p,De.x,De.y),Oi=P.upVector(p,pe.x,pe.y);Jf(Pi,gi,zi),Jf(Pi,gi,zi),Jf(Pi,Rn,Oi),Jf(Pi,Rn,Oi)}}$&&(vt+=It.length-1)}}if(N&&N.polyCount.length>0){if(N.borders){N.vertexArrayOffset=this.centroidVertexArray.length;const yt=N.borders,Ct=this.featuresOnBorder.push(N)-1;for(let vt=0;vt<4;vt++)yt[vt][0]!==Number.MAX_VALUE&&this.borders[vt].push(Ct)}this.encodeCentroid(N.borders?void 0:N.centroid(),N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,y,b,p)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort(((a,u)=>this.featuresOnBorder[a].borders[e][0]-this.featuresOnBorder[u].borders[e][0]))}encodeCentroid(e,a,u=!0){let p,y;if(e)if(e.y!==0){const T=a.span()._mult(this.tileToMeter);p=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(T.x/10)),y=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(T.y/10))}else p=Math.ceil(7*(e.x+450)),y=0;else p=0,y=+u;let b=u?this.centroidVertexArray.length:a.vertexArrayOffset;for(const T of a.polyCount){u&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*T.edges+T.top);for(let M=0;M<T.top;M++)this.centroidVertexArray.emplace(b++,p,y);for(let M=0;M<2*T.edges;M++)this.centroidVertexArray.emplace(b++,0,y),this.centroidVertexArray.emplace(b++,p,y)}}}function wb(s,e){const a=s.add(e)._unit();return s.x*a.x+s.y*a.y}function YA(s,e,a,u){const p=e.sub(s)._perp()._unit(),y=a.sub(e)._perp()._unit();return Tb(s,e,a,wb(p,y),u)}function Tb(s,e,a,u,p){const y=Math.sqrt(1-u*u);return Math.min(s.dist(e)/3,e.dist(a)/3,p*y/u)}function Eb(s,e,a){return s.x<a[0].x&&e.x<a[0].x||s.x>a[1].x&&e.x>a[1].x||s.y<a[0].y&&e.y<a[0].y||s.y>a[1].y&&e.y>a[1].y}function Sb(s,e,a){if(s.x<0||s.x>=di||e.x<0||e.x>=di||a.x<0||a.x>=di)return!1;const u=a.sub(e),p=u.perp(),y=s.sub(e);return(u.x*y.x+u.y*y.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(y.x*y.x+y.y*y.y))>-.866&&p.x*y.x+p.y*y.y<0}function Mb(s,e,a){const u=e?2|s:-3&s;return a?1|u:-2&u}function Cb(){const s=Math.PI/32,e=Math.tan(s),a=Gf;return a*Math.sqrt(1+2*e*e)-a}function Ab(s,e,a){const u=1<<a.z,p=Aa(a.x/u),y=Aa((a.x+1)/u),b=Rr(a.y/u),T=Rr((a.y+1)/u);return(function(M,P,O,N,$=0,Z){const X=[];if(!M.length||!O||!N)return X;const J=(It,ie)=>{for(const Qt of It)X.push({polygon:Qt,bounds:ie})},ct=Math.ceil(Math.log2(O)),yt=Math.ceil(Math.log2(N)),Ct=ct-yt,vt=[];for(let It=0;It<Math.abs(Ct);It++)vt.push(Ct>0?0:1);for(let It=0;It<Math.min(ct,yt);It++)vt.push(0),vt.push(1);let St=M;if(St=Um(St,P[0].y-$,P[1].y+$,1),St=Um(St,P[0].x-$,P[1].x+$,0),!St.length)return X;const Dt=[];for(vt.length?Dt.push({polygons:St,bounds:P,depth:0}):J(St,P);Dt.length;){const It=Dt.pop(),ie=It.depth,Qt=vt[ie],_e=It.bounds[0],ke=It.bounds[1],re=Qt===0?_e.x:_e.y,ve=Qt===0?ke.x:ke.y,xe=Z?Z(Qt,re,ve):.5*(re+ve),Ce=Um(It.polygons,re-$,xe+$,Qt),De=Um(It.polygons,xe-$,ve+$,Qt);if(Ce.length){const pe=[_e,new Nt(Qt===0?xe:ke.x,Qt===1?xe:ke.y)];vt.length>ie+1?Dt.push({polygons:Ce,bounds:pe,depth:ie+1}):J(Ce,pe)}if(De.length){const pe=[new Nt(Qt===0?xe:_e.x,Qt===1?xe:_e.y),ke];vt.length>ie+1?Dt.push({polygons:De,bounds:pe,depth:ie+1}):J(De,pe)}}return X})(s,e,Math.ceil((y-p)/11.25),Math.ceil((b-T)/11.25),1,((M,P,O)=>{if(M===0)return .5*(P+O);{const N=Rr((a.y+P/di)/u);return(Sc(.5*(Rr((a.y+O/di)/u)+N))*u-a.y)*di}}))}Je(Qf,"FillExtrusionBucket",{omit:["layers","features"]}),Je(bb,"PartMetadata");const JA=new gt({"fill-extrusion-edge-radius":new Y(le["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var QA={paint:new gt({"fill-extrusion-opacity":new Y(le["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new st(le["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Y(le["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Y(le["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new st(le["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new st(le["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new st(le["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Y(le["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Y(le["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Y(le["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Y(le["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:JA};function Pb(s,e,a){var u=2*Math.PI*6378137/256/Math.pow(2,a);return[s*u-2*Math.PI*6378137/2,e*u-2*Math.PI*6378137/2]}class $m{constructor(e,a,u){this.z=e,this.x=a,this.y=u,this.key=tp(0,e,e,a,u)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,a){const u=(function(y,b,T){var M=Pb(256*y,256*(b=Math.pow(2,T)-b-1),T),P=Pb(256*(y+1),256*(b+1),T);return M[0]+","+M[1]+","+P[0]+","+P[1]})(this.x,this.y,this.z),p=(function(y,b,T){let M,P="";for(let O=y;O>0;O--)M=1<<O-1,P+=(b&M?1:0)+(T&M?2:0);return P})(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",p).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class kb{constructor(e,a){this.wrap=e,this.canonical=a,this.key=tp(e,a.z,a.z,a.x,a.y)}}class uo{constructor(e,a,u,p,y){this.overscaledZ=e,this.wrap=a,this.canonical=new $m(u,+p,+y),this.key=a===0&&e===u?this.canonical.key:tp(a,e,u,p,y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const a=this.canonical.z-e;return e>this.canonical.z?new uo(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new uo(e,this.wrap,e,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(e,a=!0){if(this.overscaledZ===e&&a)return this.key;if(e>this.canonical.z)return tp(this.wrap*+a,e,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-e;return tp(this.wrap*+a,e,e,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const a=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>a&&e.canonical.y===this.canonical.y>>a}children(e){if(this.overscaledZ>=e)return[new uo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,u=2*this.canonical.x,p=2*this.canonical.y;return[new uo(a,this.wrap,a,u,p),new uo(a,this.wrap,a,u+1,p),new uo(a,this.wrap,a,u,p+1),new uo(a,this.wrap,a,u+1,p+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new uo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new uo(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new kb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function tp(s,e,a,u,p){const y=1<<Math.min(a,22);let b=y*(p%y)+u%y;return s&&a<22&&(b+=y*y*((s<0?-2*s-1:2*s)%(1<<2*(22-a)))),16*(32*b+a)+(e-a)}Je($m,"CanonicalTileID"),Je(uo,"OverscaledTileID",{omit:["projMatrix"]});class Gd extends Nt{constructor(e,a,u){super(e,a),this.z=u}}function ep(s,e){return s.x*e.x+s.y*e.y}function Ib(s,e){if(s.length===1){let a=0;const u=e[a++];let p;for(;!p||u.equals(p);)if(p=e[a++],!p)return 1/0;for(;a<e.length;a++){const y=e[a],b=s[0],T=p.sub(u),M=y.sub(u),P=b.sub(u),O=ep(T,T),N=ep(T,M),$=ep(M,M),Z=ep(P,T),X=ep(P,M),J=O*$-N*N,ct=($*Z-N*X)/J,yt=(O*X-N*Z)/J,Ct=u.z*(1-ct-yt)+p.z*ct+y.z*yt;if(isFinite(Ct))return Ct}return 1/0}{let a=1/0;for(const u of e)a=Math.min(a,u.z);return a}}function Lb(s,e,a,u,p,y,b,T){const M=b*p.getElevationAt(s,e,!0,!0),P=y[0]!==0,O=P?y[1]===0?b*(y[0]/7-450):b*(function(N,$,Z){const X=Math.floor($[0]/8),J=Math.floor($[1]/8),ct=10*($[0]-8*X),yt=10*($[1]-8*J),Ct=N.getElevationAt(X,J,!0,!0),vt=N.getMeterToDEM(Z),St=Math.floor(.5*(ct*vt-1)),Dt=Math.floor(.5*(yt*vt-1)),It=N.tileCoordToPixel(X,J),ie=2*St+1,Qt=2*Dt+1,_e=(function(De,pe,We,si,qe){return[De.getElevationAtPixel(pe,We,!0),De.getElevationAtPixel(pe+qe,We,!0),De.getElevationAtPixel(pe,We+qe,!0),De.getElevationAtPixel(pe+si,We+qe,!0)]})(N,It.x-St,It.y-Dt,ie,Qt),ke=Math.abs(_e[0]-_e[1]),re=Math.abs(_e[2]-_e[3]),ve=Math.abs(_e[0]-_e[2])+Math.abs(_e[1]-_e[3]),xe=Math.min(.25,.5*vt*(ke+re)/ie),Ce=Math.min(.25,.5*vt*ve/Qt);return Ct+Math.max(xe*ct,Ce*yt)})(p,y,T):M;return{base:M+(a===0)?-1:a,top:P?Math.max(O+u,M+a+2):M+u}}const tP=Ut([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:eP}=tP,iP=Ut([{name:"a_packed",components:4,type:"Float32"}]),{members:nP}=iP,sP=Vm.types,rP=Math.cos(Math.PI/180*37.5);class Wm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((a=>a.id)),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((a=>{this.gradients[a.id]={}})),this.layoutVertexArray=new te,this.layoutVertexArray2=new Ee,this.indexArray=new oi,this.programConfigurations=new Bh(e.layers,e.zoom),this.segments=new Ts,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((a=>a.isStateDependent())).map((a=>a.id))}populate(e,a,u,p){this.hasPattern=vy("line",this.layers,a);const y=this.layers[0].layout.get("line-sort-key"),b=[];for(const{feature:O,id:N,index:$,sourceLayerIndex:Z}of e){const X=this.layers[0]._featureFilter.needGeometry,J=$h(O,X);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),J,u))continue;const ct=y?y.evaluate(J,{},u):void 0,yt={id:N,properties:O.properties,type:O.type,sourceLayerIndex:Z,index:$,geometry:X?J.geometry:fu(O,u,p),patterns:{},sortKey:ct};b.push(yt)}y&&b.sort(((O,N)=>O.sortKey-N.sortKey));const{lineAtlas:T,featureIndex:M}=a,P=this.addConstantDashes(T);for(const O of b){const{geometry:N,index:$,sourceLayerIndex:Z}=O;if(P&&this.addFeatureDashes(O,T),this.hasPattern){const X=xy("line",this.layers,O,this.zoom,a);this.patternFeatures.push(X)}else this.addFeature(O,N,$,u,T.positions,a.availableImages);M.insert(e[$].feature,N,$,Z,this.index)}}addConstantDashes(e){let a=!1;for(const u of this.layers){const p=u.paint.get("line-dasharray").value,y=u.layout.get("line-cap").value;if(p.kind!=="constant"||y.kind!=="constant")a=!0;else{const b=y.value,T=p.value;if(!T)continue;e.addDash(T,b)}}return a}addFeatureDashes(e,a){const u=this.zoom;for(const p of this.layers){const y=p.paint.get("line-dasharray").value,b=p.layout.get("line-cap").value;if(y.kind==="constant"&&b.kind==="constant")continue;let T,M;if(y.kind==="constant"){if(T=y.value,!T)continue}else T=y.evaluate({zoom:u},e);M=b.kind==="constant"?b.value:b.evaluate({zoom:u},e),a.addDash(T,M),e.patterns[p.id]=a.getKey(T,M)}}update(e,a,u,p){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,a,this.stateDependentLayers,u,p)}addFeatures(e,a,u,p,y){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,a,u,p)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,nP)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,eP),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,a,u,p,y,b){const T=this.layers[0].layout,M=T.get("line-join").evaluate(e,{}),P=T.get("line-cap").evaluate(e,{}),O=T.get("line-miter-limit"),N=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const $ of a)this.addLine($,e,M,P,O,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,u,y,b,p)}addLine(e,a,u,p,y,b){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let yt=0;yt<e.length-1;yt++)this.totalDistance+=e[yt].dist(e[yt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T=sP[a.type]==="Polygon";let M=e.length;for(;M>=2&&e[M-1].equals(e[M-2]);)M--;let P=0;for(;P<M-1&&e[P].equals(e[P+1]);)P++;if(M<(T?3:2))return;u==="bevel"&&(y=1.05);const O=this.overscaling<=16?15*di/(512*this.overscaling):0,N=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let $,Z,X,J,ct;this.e1=this.e2=-1,T&&($=e[M-2],ct=e[P].sub($)._unit()._perp());for(let yt=P;yt<M;yt++){if(X=yt===M-1?T?e[P+1]:void 0:e[yt+1],X&&e[yt].equals(X))continue;ct&&(J=ct),$&&(Z=$),$=e[yt],ct=X?X.sub($)._unit()._perp():J,J=J||ct;let Ct=J.add(ct);Ct.x===0&&Ct.y===0||Ct._unit();const vt=J.x*ct.x+J.y*ct.y,St=Ct.x*ct.x+Ct.y*ct.y,Dt=St!==0?1/St:1/0,It=2*Math.sqrt(2-2*St),ie=St<rP&&Z&&X,Qt=J.x*ct.y-J.y*ct.x>0;if(ie&&yt>P){const re=$.dist(Z);if(re>2*O){const ve=$.sub($.sub(Z)._mult(O/re)._round());this.updateDistance(Z,ve),this.addCurrentVertex(ve,J,0,0,N),Z=ve}}const _e=Z&&X;let ke=_e?u:T?"butt":p;if(_e&&ke==="round"&&(Dt<b?ke="miter":Dt<=2&&(ke="fakeround")),ke==="miter"&&Dt>y&&(ke="bevel"),ke==="bevel"&&(Dt>2&&(ke="flipbevel"),Dt<y&&(ke="miter")),Z&&this.updateDistance(Z,$),ke==="miter")Ct._mult(Dt),this.addCurrentVertex($,Ct,0,0,N);else if(ke==="flipbevel"){if(Dt>100)Ct=ct.mult(-1);else{const re=Dt*J.add(ct).mag()/J.sub(ct).mag();Ct._perp()._mult(re*(Qt?-1:1))}this.addCurrentVertex($,Ct,0,0,N),this.addCurrentVertex($,Ct.mult(-1),0,0,N)}else if(ke==="bevel"||ke==="fakeround"){const re=-Math.sqrt(Dt*Dt-1),ve=Qt?re:0,xe=Qt?0:re;if(Z&&this.addCurrentVertex($,J,ve,xe,N),ke==="fakeround"){const Ce=Math.round(180*It/Math.PI/20);for(let De=1;De<Ce;De++){let pe=De/Ce;if(pe!==.5){const si=pe-.5;pe+=pe*si*(pe-1)*((1.0904+vt*(vt*(3.55645-1.43519*vt)-3.2452))*si*si+(.848013+vt*(.215638*vt-1.06021)))}const We=ct.sub(J)._mult(pe)._add(J)._unit()._mult(Qt?-1:1);this.addHalfVertex($,We.x,We.y,!1,Qt,0,N)}}X&&this.addCurrentVertex($,ct,-ve,-xe,N)}else if(ke==="butt")this.addCurrentVertex($,Ct,0,0,N);else if(ke==="square"){const re=Z?1:-1;Z||this.addCurrentVertex($,Ct,re,re,N),this.addCurrentVertex($,Ct,0,0,N),Z&&this.addCurrentVertex($,Ct,re,re,N)}else ke==="round"&&(Z&&(this.addCurrentVertex($,J,0,0,N),this.addCurrentVertex($,J,1,1,N,!0)),X&&(this.addCurrentVertex($,ct,-1,-1,N,!0),this.addCurrentVertex($,ct,0,0,N)));if(ie&&yt<M-1){const re=$.dist(X);if(re>2*O){const ve=$.add(X.sub($)._mult(O/re)._round());this.updateDistance($,ve),this.addCurrentVertex(ve,ct,0,0,N),$=ve}}}}addCurrentVertex(e,a,u,p,y,b=!1){const T=a.y*p-a.x,M=-a.y-a.x*p;this.addHalfVertex(e,a.x+a.y*u,a.y-a.x*u,b,!1,u,y),this.addHalfVertex(e,T,M,b,!0,-p,y)}addHalfVertex({x:e,y:a},u,p,y,b,T,M){this.layoutVertexArray.emplaceBack((e<<1)+(y?1:0),(a<<1)+(b?1:0),Math.round(63*u)+128,Math.round(63*p)+128,1+(T===0?0:T<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const P=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,P),M.primitiveLength++),b?this.e2=P:this.e1=P}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,a){this.distance+=e.dist(a),this.updateScaledDistance()}}Je(Wm,"LineBucket",{omit:["layers","patternFeatures"]});const oP=new gt({"line-cap":new st(le.layout_line["line-cap"]),"line-join":new st(le.layout_line["line-join"]),"line-miter-limit":new Y(le.layout_line["line-miter-limit"]),"line-round-limit":new Y(le.layout_line["line-round-limit"]),"line-sort-key":new st(le.layout_line["line-sort-key"])});var Db={paint:new gt({"line-opacity":new st(le.paint_line["line-opacity"]),"line-color":new st(le.paint_line["line-color"]),"line-translate":new Y(le.paint_line["line-translate"]),"line-translate-anchor":new Y(le.paint_line["line-translate-anchor"]),"line-width":new st(le.paint_line["line-width"]),"line-gap-width":new st(le.paint_line["line-gap-width"]),"line-offset":new st(le.paint_line["line-offset"]),"line-blur":new st(le.paint_line["line-blur"]),"line-dasharray":new st(le.paint_line["line-dasharray"]),"line-pattern":new st(le.paint_line["line-pattern"]),"line-gradient":new _t(le.paint_line["line-gradient"]),"line-trim-offset":new Y(le.paint_line["line-trim-offset"])}),layout:oP};const zb=new class extends st{possiblyEvaluate(s,e){return e=new B(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(s,e)}evaluate(s,e,a,u){return e=je({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(s,e,a,u)}}(Db.paint.properties["line-width"].specification);function Ob(s,e){return e>0?e+2*s:s}zb.useIntegerZoom=!0;const aP=Ut([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),lP=Ut([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),cP=Ut([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ut([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const uP=Ut([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),hP=Ut([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ut([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Rb=Ut([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),dP=Ut([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ut([{name:"triangle",components:3,type:"Uint16"}]),Ut([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ut([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ut([{type:"Float32",name:"offsetX"}]),Ut([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var br=24;const ql=128;function wy(s,e){const{expression:a}=e;if(a.kind==="constant")return{kind:"constant",layoutSize:a.evaluate(new B(s+1))};if(a.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:p}=a;let y=0;for(;y<u.length&&u[y]<=s;)y++;y=Math.max(0,y-1);let b=y;for(;b<u.length&&u[b]<s+1;)b++;b=Math.min(u.length-1,b);const T=u[y],M=u[b];return a.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:M,interpolationType:p}:{kind:"camera",minZoom:T,maxZoom:M,minSize:a.evaluate(new B(T)),maxSize:a.evaluate(new B(M)),interpolationType:p}}}function Zm(s,{uSize:e,uSizeT:a},{lowerSize:u,upperSize:p}){return s.kind==="source"?u/ql:s.kind==="composite"?Hi(u/ql,p/ql,a):e}function Hd(s,e){let a=0,u=0;if(s.kind==="constant")u=s.layoutSize;else if(s.kind!=="source"){const{interpolationType:p,minZoom:y,maxZoom:b}=s,T=p?Oe(no.interpolationFactor(p,e,y,b),0,1):0;s.kind==="camera"?u=Hi(s.minSize,s.maxSize,T):a=T}return{uSizeT:a,uSize:u}}var fP=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:ql,evaluateSizeForFeature:Zm,evaluateSizeForZoom:Hd,getSizeData:wy});function pP(s,e,a){return s.sections.forEach((u=>{u.text=(function(p,y,b){const T=y.layout.get("text-transform").evaluate(b,{});return T==="uppercase"?p=p.toLocaleUpperCase():T==="lowercase"&&(p=p.toLocaleLowerCase()),I.applyArabicShaping&&(p=I.applyArabicShaping(p)),p})(u.text,e,a)})),s}const ip={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function mP(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}function _P(s){return s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""||s===""}var Bb=Pn,Fb=function(s,e,a,u,p){var y,b,T=8*p-u-1,M=(1<<T)-1,P=M>>1,O=-7,N=p-1,$=-1,Z=s[e+N];for(N+=$,y=Z&(1<<-O)-1,Z>>=-O,O+=T;O>0;y=256*y+s[e+N],N+=$,O-=8);for(b=y&(1<<-O)-1,y>>=-O,O+=u;O>0;b=256*b+s[e+N],N+=$,O-=8);if(y===0)y=1-P;else{if(y===M)return b?NaN:1/0*(Z?-1:1);b+=Math.pow(2,u),y-=P}return(Z?-1:1)*b*Math.pow(2,y-u)},Nb=function(s,e,a,u,p,y){var b,T,M,P=8*y-p-1,O=(1<<P)-1,N=O>>1,$=p===23?Math.pow(2,-24)-Math.pow(2,-77):0,Z=0,X=1,J=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(T=isNaN(e)?1:0,b=O):(b=Math.floor(Math.log(e)/Math.LN2),e*(M=Math.pow(2,-b))<1&&(b--,M*=2),(e+=b+N>=1?$/M:$*Math.pow(2,1-N))*M>=2&&(b++,M/=2),b+N>=O?(T=0,b=O):b+N>=1?(T=(e*M-1)*Math.pow(2,p),b+=N):(T=e*Math.pow(2,N-1)*Math.pow(2,p),b=0));p>=8;s[a+Z]=255&T,Z+=X,T/=256,p-=8);for(b=b<<p|T,P+=p;P>0;s[a+Z]=255&b,Z+=X,b/=256,P-=8);s[a+Z-X]|=128*J};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Pn(s){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(s)?s:new Uint8Array(s||0),this.pos=0,this.type=0,this.length=this.buf.length}Pn.Varint=0,Pn.Fixed64=1,Pn.Bytes=2,Pn.Fixed32=5;var Ty=4294967296,jb=1/Ty,Vb=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function mu(s){return s.type===Pn.Bytes?s.readVarint()+s.pos:s.pos+1}function qd(s,e,a){return a?4294967296*e+(s>>>0):4294967296*(e>>>0)+(s>>>0)}function Ub(s,e,a){var u=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));a.realloc(u);for(var p=a.pos-1;p>=s;p--)a.buf[p+u]=a.buf[p]}function gP(s,e){for(var a=0;a<s.length;a++)e.writeVarint(s[a])}function yP(s,e){for(var a=0;a<s.length;a++)e.writeSVarint(s[a])}function vP(s,e){for(var a=0;a<s.length;a++)e.writeFloat(s[a])}function xP(s,e){for(var a=0;a<s.length;a++)e.writeDouble(s[a])}function bP(s,e){for(var a=0;a<s.length;a++)e.writeBoolean(s[a])}function wP(s,e){for(var a=0;a<s.length;a++)e.writeFixed32(s[a])}function TP(s,e){for(var a=0;a<s.length;a++)e.writeSFixed32(s[a])}function EP(s,e){for(var a=0;a<s.length;a++)e.writeFixed64(s[a])}function SP(s,e){for(var a=0;a<s.length;a++)e.writeSFixed64(s[a])}function Gm(s,e){return(s[e]|s[e+1]<<8|s[e+2]<<16)+16777216*s[e+3]}function Xd(s,e,a){s[a]=e,s[a+1]=e>>>8,s[a+2]=e>>>16,s[a+3]=e>>>24}function $b(s,e){return(s[e]|s[e+1]<<8|s[e+2]<<16)+(s[e+3]<<24)}Pn.prototype={destroy:function(){this.buf=null},readFields:function(s,e,a){for(a=a||this.length;this.pos<a;){var u=this.readVarint(),p=u>>3,y=this.pos;this.type=7&u,s(p,e,this),this.pos===y&&this.skip(u)}return e},readMessage:function(s,e){return this.readFields(s,e,this.readVarint()+this.pos)},readFixed32:function(){var s=Gm(this.buf,this.pos);return this.pos+=4,s},readSFixed32:function(){var s=$b(this.buf,this.pos);return this.pos+=4,s},readFixed64:function(){var s=Gm(this.buf,this.pos)+Gm(this.buf,this.pos+4)*Ty;return this.pos+=8,s},readSFixed64:function(){var s=Gm(this.buf,this.pos)+$b(this.buf,this.pos+4)*Ty;return this.pos+=8,s},readFloat:function(){var s=Fb(this.buf,this.pos,!0,23,4);return this.pos+=4,s},readDouble:function(){var s=Fb(this.buf,this.pos,!0,52,8);return this.pos+=8,s},readVarint:function(s){var e,a,u=this.buf;return e=127&(a=u[this.pos++]),a<128?e:(e|=(127&(a=u[this.pos++]))<<7,a<128?e:(e|=(127&(a=u[this.pos++]))<<14,a<128?e:(e|=(127&(a=u[this.pos++]))<<21,a<128?e:(function(p,y,b){var T,M,P=b.buf;if(T=(112&(M=P[b.pos++]))>>4,M<128||(T|=(127&(M=P[b.pos++]))<<3,M<128)||(T|=(127&(M=P[b.pos++]))<<10,M<128)||(T|=(127&(M=P[b.pos++]))<<17,M<128)||(T|=(127&(M=P[b.pos++]))<<24,M<128)||(T|=(1&(M=P[b.pos++]))<<31,M<128))return qd(p,T,y);throw new Error("Expected varint not more than 10 bytes")})(e|=(15&(a=u[this.pos]))<<28,s,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var s=this.readVarint();return s%2==1?(s+1)/-2:s/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var s=this.readVarint()+this.pos,e=this.pos;return this.pos=s,s-e>=12&&Vb?(function(a,u,p){return Vb.decode(a.subarray(u,p))})(this.buf,e,s):(function(a,u,p){for(var y="",b=u;b<p;){var T,M,P,O=a[b],N=null,$=O>239?4:O>223?3:O>191?2:1;if(b+$>p)break;$===1?O<128&&(N=O):$===2?(192&(T=a[b+1]))==128&&(N=(31&O)<<6|63&T)<=127&&(N=null):$===3?(M=a[b+2],(192&(T=a[b+1]))==128&&(192&M)==128&&((N=(15&O)<<12|(63&T)<<6|63&M)<=2047||N>=55296&&N<=57343)&&(N=null)):$===4&&(M=a[b+2],P=a[b+3],(192&(T=a[b+1]))==128&&(192&M)==128&&(192&P)==128&&((N=(15&O)<<18|(63&T)<<12|(63&M)<<6|63&P)<=65535||N>=1114112)&&(N=null)),N===null?(N=65533,$=1):N>65535&&(N-=65536,y+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),y+=String.fromCharCode(N),b+=$}return y})(this.buf,e,s)},readBytes:function(){var s=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,s);return this.pos=s,e},readPackedVarint:function(s,e){if(this.type!==Pn.Bytes)return s.push(this.readVarint(e));var a=mu(this);for(s=s||[];this.pos<a;)s.push(this.readVarint(e));return s},readPackedSVarint:function(s){if(this.type!==Pn.Bytes)return s.push(this.readSVarint());var e=mu(this);for(s=s||[];this.pos<e;)s.push(this.readSVarint());return s},readPackedBoolean:function(s){if(this.type!==Pn.Bytes)return s.push(this.readBoolean());var e=mu(this);for(s=s||[];this.pos<e;)s.push(this.readBoolean());return s},readPackedFloat:function(s){if(this.type!==Pn.Bytes)return s.push(this.readFloat());var e=mu(this);for(s=s||[];this.pos<e;)s.push(this.readFloat());return s},readPackedDouble:function(s){if(this.type!==Pn.Bytes)return s.push(this.readDouble());var e=mu(this);for(s=s||[];this.pos<e;)s.push(this.readDouble());return s},readPackedFixed32:function(s){if(this.type!==Pn.Bytes)return s.push(this.readFixed32());var e=mu(this);for(s=s||[];this.pos<e;)s.push(this.readFixed32());return s},readPackedSFixed32:function(s){if(this.type!==Pn.Bytes)return s.push(this.readSFixed32());var e=mu(this);for(s=s||[];this.pos<e;)s.push(this.readSFixed32());return s},readPackedFixed64:function(s){if(this.type!==Pn.Bytes)return s.push(this.readFixed64());var e=mu(this);for(s=s||[];this.pos<e;)s.push(this.readFixed64());return s},readPackedSFixed64:function(s){if(this.type!==Pn.Bytes)return s.push(this.readSFixed64());var e=mu(this);for(s=s||[];this.pos<e;)s.push(this.readSFixed64());return s},skip:function(s){var e=7&s;if(e===Pn.Varint)for(;this.buf[this.pos++]>127;);else if(e===Pn.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Pn.Fixed32)this.pos+=4;else{if(e!==Pn.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(s,e){this.writeVarint(s<<3|e)},realloc:function(s){for(var e=this.length||16;e<this.pos+s;)e*=2;if(e!==this.length){var a=new Uint8Array(e);a.set(this.buf),this.buf=a,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(s){this.realloc(4),Xd(this.buf,s,this.pos),this.pos+=4},writeSFixed32:function(s){this.realloc(4),Xd(this.buf,s,this.pos),this.pos+=4},writeFixed64:function(s){this.realloc(8),Xd(this.buf,-1&s,this.pos),Xd(this.buf,Math.floor(s*jb),this.pos+4),this.pos+=8},writeSFixed64:function(s){this.realloc(8),Xd(this.buf,-1&s,this.pos),Xd(this.buf,Math.floor(s*jb),this.pos+4),this.pos+=8},writeVarint:function(s){(s=+s||0)>268435455||s<0?(function(e,a){var u,p;if(e>=0?(u=e%4294967296|0,p=e/4294967296|0):(p=~(-e/4294967296),4294967295^(u=~(-e%4294967296))?u=u+1|0:(u=0,p=p+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),(function(y,b,T){T.buf[T.pos++]=127&y|128,y>>>=7,T.buf[T.pos++]=127&y|128,y>>>=7,T.buf[T.pos++]=127&y|128,y>>>=7,T.buf[T.pos++]=127&y|128,T.buf[T.pos]=127&(y>>>=7)})(u,0,a),(function(y,b){var T=(7&y)<<4;b.buf[b.pos++]|=T|((y>>>=3)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y|((y>>>=7)?128:0),y&&(b.buf[b.pos++]=127&y)))))})(p,a)})(s,this):(this.realloc(4),this.buf[this.pos++]=127&s|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=127&(s>>>=7)|(s>127?128:0),s<=127||(this.buf[this.pos++]=s>>>7&127))))},writeSVarint:function(s){this.writeVarint(s<0?2*-s-1:2*s)},writeBoolean:function(s){this.writeVarint(!!s)},writeString:function(s){s=String(s),this.realloc(4*s.length),this.pos++;var e=this.pos;this.pos=(function(u,p,y){for(var b,T,M=0;M<p.length;M++){if((b=p.charCodeAt(M))>55295&&b<57344){if(!T){b>56319||M+1===p.length?(u[y++]=239,u[y++]=191,u[y++]=189):T=b;continue}if(b<56320){u[y++]=239,u[y++]=191,u[y++]=189,T=b;continue}b=T-55296<<10|b-56320|65536,T=null}else T&&(u[y++]=239,u[y++]=191,u[y++]=189,T=null);b<128?u[y++]=b:(b<2048?u[y++]=b>>6|192:(b<65536?u[y++]=b>>12|224:(u[y++]=b>>18|240,u[y++]=b>>12&63|128),u[y++]=b>>6&63|128),u[y++]=63&b|128)}return y})(this.buf,s,this.pos);var a=this.pos-e;a>=128&&Ub(e,a,this),this.pos=e-1,this.writeVarint(a),this.pos+=a},writeFloat:function(s){this.realloc(4),Nb(this.buf,s,this.pos,!0,23,4),this.pos+=4},writeDouble:function(s){this.realloc(8),Nb(this.buf,s,this.pos,!0,52,8),this.pos+=8},writeBytes:function(s){var e=s.length;this.writeVarint(e),this.realloc(e);for(var a=0;a<e;a++)this.buf[this.pos++]=s[a]},writeRawMessage:function(s,e){this.pos++;var a=this.pos;s(e,this);var u=this.pos-a;u>=128&&Ub(a,u,this),this.pos=a-1,this.writeVarint(u),this.pos+=u},writeMessage:function(s,e,a){this.writeTag(s,Pn.Bytes),this.writeRawMessage(e,a)},writePackedVarint:function(s,e){e.length&&this.writeMessage(s,gP,e)},writePackedSVarint:function(s,e){e.length&&this.writeMessage(s,yP,e)},writePackedBoolean:function(s,e){e.length&&this.writeMessage(s,bP,e)},writePackedFloat:function(s,e){e.length&&this.writeMessage(s,vP,e)},writePackedDouble:function(s,e){e.length&&this.writeMessage(s,xP,e)},writePackedFixed32:function(s,e){e.length&&this.writeMessage(s,wP,e)},writePackedSFixed32:function(s,e){e.length&&this.writeMessage(s,TP,e)},writePackedFixed64:function(s,e){e.length&&this.writeMessage(s,EP,e)},writePackedSFixed64:function(s,e){e.length&&this.writeMessage(s,SP,e)},writeBytesField:function(s,e){this.writeTag(s,Pn.Bytes),this.writeBytes(e)},writeFixed32Field:function(s,e){this.writeTag(s,Pn.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(s,e){this.writeTag(s,Pn.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(s,e){this.writeTag(s,Pn.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(s,e){this.writeTag(s,Pn.Fixed64),this.writeSFixed64(e)},writeVarintField:function(s,e){this.writeTag(s,Pn.Varint),this.writeVarint(e)},writeSVarintField:function(s,e){this.writeTag(s,Pn.Varint),this.writeSVarint(e)},writeStringField:function(s,e){this.writeTag(s,Pn.Bytes),this.writeString(e)},writeFloatField:function(s,e){this.writeTag(s,Pn.Fixed32),this.writeFloat(e)},writeDoubleField:function(s,e){this.writeTag(s,Pn.Fixed64),this.writeDouble(e)},writeBooleanField:function(s,e){this.writeVarintField(s,!!e)}};var Hm=mt(Bb);const Ey=3;function MP(s,e,a){e.glyphs=[],s===1&&a.readMessage(CP,e)}function CP(s,e,a){if(s===3){const{id:u,bitmap:p,width:y,height:b,left:T,top:M,advance:P}=a.readMessage(AP,{});e.glyphs.push({id:u,bitmap:new pu({width:y+2*Ey,height:b+2*Ey},p),metrics:{width:y,height:b,left:T,top:M,advance:P}})}else s===4?e.ascender=a.readSVarint():s===5&&(e.descender=a.readSVarint())}function AP(s,e,a){s===1?e.id=a.readVarint():s===2?e.bitmap=a.readBytes():s===3?e.width=a.readVarint():s===4?e.height=a.readVarint():s===5?e.left=a.readSVarint():s===6?e.top=a.readSVarint():s===7&&(e.advance=a.readVarint())}const Wb=Ey;function Sy(s){let e=0,a=0;for(const b of s)e+=b.w*b.h,a=Math.max(a,b.w);s.sort(((b,T)=>T.h-b.h));const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),a),h:1/0}];let p=0,y=0;for(const b of s)for(let T=u.length-1;T>=0;T--){const M=u[T];if(!(b.w>M.w||b.h>M.h)){if(b.x=M.x,b.y=M.y,y=Math.max(y,b.y+b.h),p=Math.max(p,b.x+b.w),b.w===M.w&&b.h===M.h){const P=u.pop();T<u.length&&(u[T]=P)}else b.h===M.h?(M.x+=b.w,M.w-=b.w):b.w===M.w?(M.y+=b.h,M.h-=b.h):(u.push({x:M.x+b.w,y:M.y,w:M.w-b.w,h:b.h}),M.y+=b.h,M.h-=b.h);break}}return{w:p,h:y,fill:e/(p*y)||0}}const Ro=1;class My{constructor(e,{pixelRatio:a,version:u,stretchX:p,stretchY:y,content:b}){this.paddedRect=e,this.pixelRatio=a,this.stretchX=p,this.stretchY=y,this.content=b,this.version=u}get tl(){return[this.paddedRect.x+Ro,this.paddedRect.y+Ro]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ro,this.paddedRect.y+this.paddedRect.h-Ro]}get displaySize(){return[(this.paddedRect.w-2*Ro)/this.pixelRatio,(this.paddedRect.h-2*Ro)/this.pixelRatio]}}class Zb{constructor(e,a){const u={},p={};this.haveRenderCallbacks=[];const y=[];this.addImages(e,u,y),this.addImages(a,p,y);const{w:b,h:T}=Sy(y),M=new sa({width:b||1,height:T||1});for(const P in e){const O=e[P],N=u[P].paddedRect;sa.copy(O.data,M,{x:0,y:0},{x:N.x+Ro,y:N.y+Ro},O.data)}for(const P in a){const O=a[P],N=p[P].paddedRect,$=N.x+Ro,Z=N.y+Ro,X=O.data.width,J=O.data.height;sa.copy(O.data,M,{x:0,y:0},{x:$,y:Z},O.data),sa.copy(O.data,M,{x:0,y:J-1},{x:$,y:Z-1},{width:X,height:1}),sa.copy(O.data,M,{x:0,y:0},{x:$,y:Z+J},{width:X,height:1}),sa.copy(O.data,M,{x:X-1,y:0},{x:$-1,y:Z},{width:1,height:J}),sa.copy(O.data,M,{x:0,y:0},{x:$+X,y:Z},{width:1,height:J})}this.image=M,this.iconPositions=u,this.patternPositions=p}addImages(e,a,u){for(const p in e){const y=e[p],b={x:0,y:0,w:y.data.width+2*Ro,h:y.data.height+2*Ro};u.push(b),a[p]=new My(b,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(e,a){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((u=>e.hasImage(u))),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const u in e.updatedImages)this.patchUpdatedImage(this.iconPositions[u],e.getImage(u),a),this.patchUpdatedImage(this.patternPositions[u],e.getImage(u),a)}patchUpdatedImage(e,a,u){if(!e||!a||e.version===a.version)return;e.version=a.version;const[p,y]=e.tl;u.update(a.data,void 0,{x:p,y})}}Je(My,"ImagePosition"),Je(Zb,"ImageAtlas");const Pa={horizontal:1,vertical:2,horizontalOnly:3},Gb=-17;class np{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,a){const u=new np;return u.scale=e||1,u.fontStack=a,u}static forImage(e){const a=new np;return a.imageName=e,a}}class Kd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,a){const u=new Kd;for(let p=0;p<e.sections.length;p++){const y=e.sections[p];y.image?u.addImageSection(y):u.addTextSection(y,a)}return u}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=(function(a,u){let p="";for(let y=0;y<a.length;y++){const b=a.charCodeAt(y+1)||null,T=a.charCodeAt(y-1)||null;p+=!u&&(b&&ru(b)&&!ip[a[y+1]]||T&&ru(T)&&!ip[a[y-1]])||!ip[a[y]]?a[y]:ip[a[y]]}return p})(this.text,e)}trim(){let e=0;for(let u=0;u<this.text.length&&qm[this.text.charCodeAt(u)];u++)e++;let a=this.text.length;for(let u=this.text.length-1;u>=0&&u>=e&&qm[this.text.charCodeAt(u)];u--)a--;this.text=this.text.substring(e,a),this.sectionIndex=this.sectionIndex.slice(e,a)}substring(e,a){const u=new Kd;return u.text=this.text.substring(e,a),u.sectionIndex=this.sectionIndex.slice(e,a),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,a)=>Math.max(e,this.sections[a].scale)),0)}addTextSection(e,a){this.text+=e.text,this.sections.push(np.forText(e.scale,e.fontStack||a));const u=this.sections.length-1;for(let p=0;p<e.text.length;++p)this.sectionIndex.push(u)}addImageSection(e){const a=e.image?e.image.name:"";if(a.length===0)return void me("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCharCode(u),this.sections.push(np.forImage(a)),this.sectionIndex.push(this.sections.length-1)):me("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Cy(s,e,a,u,p,y,b,T,M,P,O,N,$,Z,X){const J=Kd.fromFeature(s,p);N===Pa.vertical&&J.verticalizePunctuation($);let ct=[];const yt=(function(It,ie,Qt,_e,ke,re){if(!It)return[];const ve=[],xe=(function(We,si,qe,Ci,ze,ui){let Ai=0;for(let Qi=0;Qi<We.length();Qi++){const Pi=We.getSection(Qi);Ai+=Hb(We.getCharCode(Qi),Pi,Ci,ze,si,ui)}return Ai/Math.max(1,Math.ceil(Ai/qe))})(It,ie,Qt,_e,ke,re),Ce=It.text.indexOf("")>=0;let De=0;for(let We=0;We<It.length();We++){const si=It.getSection(We),qe=It.getCharCode(We);if(qm[qe]||(De+=Hb(qe,si,_e,ke,ie,re)),We<It.length()-1){const Ci=!((pe=qe)<11904||!(Ze["Bopomofo Extended"](pe)||Ze.Bopomofo(pe)||Ze["CJK Compatibility Forms"](pe)||Ze["CJK Compatibility Ideographs"](pe)||Ze["CJK Compatibility"](pe)||Ze["CJK Radicals Supplement"](pe)||Ze["CJK Strokes"](pe)||Ze["CJK Symbols and Punctuation"](pe)||Ze["CJK Unified Ideographs Extension A"](pe)||Ze["CJK Unified Ideographs"](pe)||Ze["Enclosed CJK Letters and Months"](pe)||Ze["Halfwidth and Fullwidth Forms"](pe)||Ze.Hiragana(pe)||Ze["Ideographic Description Characters"](pe)||Ze["Kangxi Radicals"](pe)||Ze["Katakana Phonetic Extensions"](pe)||Ze.Katakana(pe)||Ze["Vertical Forms"](pe)||Ze["Yi Radicals"](pe)||Ze["Yi Syllables"](pe)));(PP[qe]||Ci||si.imageName)&&ve.push(Xb(We+1,De,xe,ve,kP(qe,It.getCharCode(We+1),Ci&&Ce),!1))}}var pe;return Kb(Xb(It.length(),De,xe,ve,0,!0))})(J,P,y,e,u,Z),{processBidirectionalText:Ct,processStyledBidirectionalText:vt}=I;if(Ct&&J.sections.length===1){const It=Ct(J.toString(),yt);for(const ie of It){const Qt=new Kd;Qt.text=ie,Qt.sections=J.sections;for(let _e=0;_e<ie.length;_e++)Qt.sectionIndex.push(0);ct.push(Qt)}}else if(vt){const It=vt(J.text,J.sectionIndex,yt);for(const ie of It){const Qt=new Kd;Qt.text=ie[0],Qt.sectionIndex=ie[1],Qt.sections=J.sections,ct.push(Qt)}}else ct=(function(It,ie){const Qt=[],_e=It.text;let ke=0;for(const re of ie)Qt.push(It.substring(ke,re)),ke=re;return ke<_e.length&&Qt.push(It.substring(ke,_e.length)),Qt})(J,yt);const St=[],Dt={positionedLines:St,text:J.toString(),top:O[1],bottom:O[1],left:O[0],right:O[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return(function(It,ie,Qt,_e,ke,re,ve,xe,Ce,De,pe,We){let si=0,qe=0,Ci=0;const ze=xe==="right"?1:xe==="left"?0:.5;let ui=!1;for(const zi of ke){const Oi=zi.getSections();for(const wn of Oi){if(wn.imageName)continue;const kn=ie[wn.fontStack];if(kn&&(ui=kn.ascender!==void 0&&kn.descender!==void 0,!ui))break}if(!ui)break}let Ai=0;for(const zi of ke){zi.trim();const Oi=zi.getMaxScale(),wn=(Oi-1)*br,kn={positionedGlyphs:[],lineOffset:0};It.positionedLines[Ai]=kn;const In=kn.positionedGlyphs;let Tn=0;if(!zi.length()){qe+=re,++Ai;continue}let Yn=0,hs=0;for(let En=0;En<zi.length();En++){const Fs=zi.getSection(En),Ms=zi.getSectionIndex(En),rs=zi.getCharCode(En);let nn=Fs.scale,Cs=null,Ln=null,ho=null,As=br,wr=0;const sr=!(Ce===Pa.horizontal||!pe&&!bc(rs)||pe&&(qm[rs]||(Qi=rs,Ze.Arabic(Qi)||Ze["Arabic Supplement"](Qi)||Ze["Arabic Extended-A"](Qi)||Ze["Arabic Presentation Forms-A"](Qi)||Ze["Arabic Presentation Forms-B"](Qi))));if(Fs.imageName){const fo=_e[Fs.imageName];if(!fo)continue;ho=Fs.imageName,It.iconsInText=It.iconsInText||!0,Ln=fo.paddedRect;const rr=fo.displaySize;nn=nn*br/We,Cs={width:rr[0],height:rr[1],left:Ro,top:-Wb,advance:sr?rr[1]:rr[0],localGlyph:!1},wr=ui?-Cs.height*nn:Gb+Oi*br-rr[1]*nn,As=Cs.advance;const Yl=(sr?rr[0]:rr[1])*nn-br*Oi;Yl>0&&Yl>Tn&&(Tn=Yl)}else{const fo=Qt[Fs.fontStack];if(!fo)continue;fo[rs]&&(Ln=fo[rs]);const rr=ie[Fs.fontStack];if(!rr)continue;const Yl=rr.glyphs[rs];if(!Yl)continue;if(Cs=Yl.metrics,As=rs!==8203?br:0,ui){const sf=rr.ascender!==void 0?Math.abs(rr.ascender):0,fp=rr.descender!==void 0?Math.abs(rr.descender):0,pp=(sf+fp)*nn;Yn<pp&&(Yn=pp,hs=(sf-fp)/2*nn),wr=-sf*nn}else wr=Gb+(Oi-nn)*br}sr?(It.verticalizable=!0,In.push({glyph:rs,imageName:ho,x:si,y:qe+wr,vertical:sr,scale:nn,localGlyph:Cs.localGlyph,fontStack:Fs.fontStack,sectionIndex:Ms,metrics:Cs,rect:Ln}),si+=As*nn+De):(In.push({glyph:rs,imageName:ho,x:si,y:qe+wr,vertical:sr,scale:nn,localGlyph:Cs.localGlyph,fontStack:Fs.fontStack,sectionIndex:Ms,metrics:Cs,rect:Ln}),si+=Cs.advance*nn+De)}In.length!==0&&(Ci=Math.max(si-De,Ci),ui?Yb(In,ze,Tn,hs,re*Oi/2):Yb(In,ze,Tn,0,re/2)),si=0;const Ss=re*Oi+Tn;kn.lineOffset=Math.max(Tn,wn),qe+=Ss,++Ai}var Qi;const Pi=qe,{horizontalAlign:gi,verticalAlign:Rn}=Ay(ve);(function(zi,Oi,wn,kn,In,Tn){const Yn=(Oi-wn)*In,hs=-Tn*kn;for(const Ss of zi)for(const En of Ss.positionedGlyphs)En.x+=Yn,En.y+=hs})(It.positionedLines,ze,gi,Rn,Ci,Pi),It.top+=-Rn*Pi,It.bottom=It.top+Pi,It.left+=-gi*Ci,It.right=It.left+Ci,It.hasBaseline=ui})(Dt,e,a,u,ct,b,T,M,N,P,$,X),!(function(It){for(const ie of It)if(ie.positionedGlyphs.length!==0)return!1;return!0})(St)&&Dt}const qm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},PP={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Hb(s,e,a,u,p,y){if(e.imageName){const b=u[e.imageName];return b?b.displaySize[0]*e.scale*br/y+p:0}{const b=a[e.fontStack],T=b&&b.glyphs[s];return T?T.metrics.advance*e.scale+p:0}}function qb(s,e,a,u){const p=Math.pow(s-e,2);return u?s<e?p/2:2*p:p+Math.abs(a)*a}function kP(s,e,a){let u=0;return s===10&&(u-=1e4),a&&(u+=150),s!==40&&s!==65288||(u+=50),e!==41&&e!==65289||(u+=50),u}function Xb(s,e,a,u,p,y){let b=null,T=qb(e,a,p,y);for(const M of u){const P=qb(e-M.x,a,p,y)+M.badness;P<=T&&(b=M,T=P)}return{index:s,x:e,priorBreak:b,badness:T}}function Kb(s){return s?Kb(s.priorBreak).concat(s.index):[]}function Ay(s){let e=.5,a=.5;switch(s){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(s){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:e,verticalAlign:a}}function Yb(s,e,a,u,p){if(!(e||a||u||p))return;const y=s.length-1,b=s[y],T=(b.x+b.metrics.advance*b.scale)*e;for(let M=0;M<=y;M++)s[M].x-=T,s[M].y+=a+u+p}function IP(s,e,a){const{horizontalAlign:u,verticalAlign:p}=Ay(a),y=e[0]-s.displaySize[0]*u,b=e[1]-s.displaySize[1]*p;return{image:s,top:b,bottom:b+s.displaySize[1],left:y,right:y+s.displaySize[0]}}function Jb(s,e,a,u,p,y){const b=s.image;let T;if(b.content){const ct=b.content,yt=b.pixelRatio||1;T=[ct[0]/yt,ct[1]/yt,b.displaySize[0]-ct[2]/yt,b.displaySize[1]-ct[3]/yt]}const M=e.left*y,P=e.right*y;let O,N,$,Z;a==="width"||a==="both"?(Z=p[0]+M-u[3],N=p[0]+P+u[1]):(Z=p[0]+(M+P-b.displaySize[0])/2,N=Z+b.displaySize[0]);const X=e.top*y,J=e.bottom*y;return a==="height"||a==="both"?(O=p[1]+X-u[0],$=p[1]+J+u[2]):(O=p[1]+(X+J-b.displaySize[1])/2,$=O+b.displaySize[1]),{image:b,top:O,right:N,bottom:$,left:Z,collisionPadding:T}}class _u extends Nt{constructor(e,a,u,p,y){super(e,a),this.angle=p,this.z=u,y!==void 0&&(this.segment=y)}clone(){return new _u(this.x,this.y,this.z,this.angle,this.segment)}}function Qb(s,e,a,u,p){if(e.segment===void 0)return!0;let y=e,b=e.segment+1,T=0;for(;T>-a/2;){if(b--,b<0)return!1;T-=s[b].dist(y),y=s[b]}T+=s[b].dist(s[b+1]),b++;const M=[];let P=0;for(;T<a/2;){const O=s[b],N=s[b+1];if(!N)return!1;let $=s[b-1].angleTo(O)-O.angleTo(N);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:T,angleDelta:$}),P+=$;T-M[0].distance>u;)P-=M.shift().angleDelta;if(P>p)return!1;b++,T+=O.dist(N)}return!0}function t1(s){let e=0;for(let a=0;a<s.length-1;a++)e+=s[a].dist(s[a+1]);return e}function e1(s,e,a){return s?.6*e*a:0}function i1(s,e){return Math.max(s?s.right-s.left:0,e?e.right-e.left:0)}function LP(s,e,a,u,p,y){const b=e1(a,p,y),T=i1(a,u)*y;let M=0;const P=t1(s)/2;for(let O=0;O<s.length-1;O++){const N=s[O],$=s[O+1],Z=N.dist($);if(M+Z>P){const X=(P-M)/Z,J=Hi(N.x,$.x,X),ct=Hi(N.y,$.y,X),yt=new _u(J,ct,0,$.angleTo(N),O);return!b||Qb(s,yt,T,b,e)?yt:void 0}M+=Z}}function DP(s,e,a,u,p,y,b,T,M){const P=e1(u,y,b),O=i1(u,p),N=O*b,$=s[0].x===0||s[0].x===M||s[0].y===0||s[0].y===M;return e-N<e/4&&(e=N+e/4),n1(s,$?e/2*T%e:(O/2+2*y)*b*T%e,e,P,a,N,$,!1,M)}function n1(s,e,a,u,p,y,b,T,M){const P=y/2,O=t1(s);let N=0,$=e-a,Z=[];for(let X=0;X<s.length-1;X++){const J=s[X],ct=s[X+1],yt=J.dist(ct),Ct=ct.angleTo(J);for(;$+a<N+yt;){$+=a;const vt=($-N)/yt,St=Hi(J.x,ct.x,vt),Dt=Hi(J.y,ct.y,vt);if(St>=0&&St<M&&Dt>=0&&Dt<M&&$-P>=0&&$+P<=O){const It=new _u(St,Dt,0,Ct,X);It._round(),u&&!Qb(s,It,y,u,p)||Z.push(It)}}N+=yt}return T||Z.length||b||(Z=n1(s,N/2,a,u,p,y,b,!0,M)),Z}function s1(s,e,a,u,p){const y=[];for(let b=0;b<s.length;b++){const T=s[b];let M;for(let P=0;P<T.length-1;P++){let O=T[P],N=T[P+1];O.x<e&&N.x<e||(O.x<e?O=new Nt(e,O.y+(e-O.x)/(N.x-O.x)*(N.y-O.y))._round():N.x<e&&(N=new Nt(e,O.y+(e-O.x)/(N.x-O.x)*(N.y-O.y))._round()),O.y<a&&N.y<a||(O.y<a?O=new Nt(O.x+(a-O.y)/(N.y-O.y)*(N.x-O.x),a)._round():N.y<a&&(N=new Nt(O.x+(a-O.y)/(N.y-O.y)*(N.x-O.x),a)._round()),O.x>=u&&N.x>=u||(O.x>=u?O=new Nt(u,O.y+(u-O.x)/(N.x-O.x)*(N.y-O.y))._round():N.x>=u&&(N=new Nt(u,O.y+(u-O.x)/(N.x-O.x)*(N.y-O.y))._round()),O.y>=p&&N.y>=p||(O.y>=p?O=new Nt(O.x+(p-O.y)/(N.y-O.y)*(N.x-O.x),p)._round():N.y>=p&&(N=new Nt(O.x+(p-O.y)/(N.y-O.y)*(N.x-O.x),p)._round()),M&&O.equals(M[M.length-1])||(M=[O],y.push(M)),M.push(N)))))}}return y}Je(_u,"Anchor");const sp=1e20;function r1(s,e,a,u,p,y,b,T,M){for(let P=e;P<e+u;P++)o1(s,a*y+P,y,p,b,T,M);for(let P=a;P<a+p;P++)o1(s,P*y+e,1,u,b,T,M)}function o1(s,e,a,u,p,y,b){y[0]=0,b[0]=-sp,b[1]=sp,p[0]=s[e];for(let T=1,M=0,P=0;T<u;T++){p[T]=s[e+T*a];const O=T*T;do{const N=y[M];P=(p[T]-p[N]+O-N*N)/(T-N)/2}while(P<=b[M]&&--M>-1);M++,y[M]=T,b[M]=P,b[M+1]=sp}for(let T=0,M=0;T<u;T++){for(;b[M+1]<T;)M++;const P=y[M],O=T-P;s[e+T*a]=p[P]+O*O}}const Xl=2,Py={none:0,ideographs:1,all:2};class Yd{constructor(e,a,u){this.requestManager=e,this.localGlyphMode=a,this.localFontFamily=u,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,a){const u=[];for(const p in e)for(const y of e[p])u.push({stack:p,id:y});ce(u,(({stack:p,id:y},b)=>{let T=this.entries[p];T||(T=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let M=T.glyphs[y];if(M!==void 0)return void b(null,{stack:p,id:y,glyph:M});if(M=this._tinySDF(T,p,y),M)return T.glyphs[y]=M,void b(null,{stack:p,id:y,glyph:M});const P=Math.floor(y/256);if(256*P>65535)return void b(new Error("glyphs > 65535 not supported"));if(T.ranges[P])return void b(null,{stack:p,id:y,glyph:M});let O=T.requests[P];O||(O=T.requests[P]=[],Yd.loadGlyphRange(p,P,this.url,this.requestManager,((N,$)=>{if($){T.ascender=$.ascender,T.descender=$.descender;for(const Z in $.glyphs)this._doesCharSupportLocalGlyph(+Z)||(T.glyphs[+Z]=$.glyphs[+Z]);T.ranges[P]=!0}for(const Z of O)Z(N,$);delete T.requests[P]}))),O.push(((N,$)=>{N?b(N):$&&b(null,{stack:p,id:y,glyph:$.glyphs[y]||null})}))}),((p,y)=>{if(p)a(p);else if(y){const b={};for(const{stack:T,id:M,glyph:P}of y)b[T]===void 0&&(b[T]={}),b[T].glyphs===void 0&&(b[T].glyphs={}),b[T].glyphs[M]=P&&{id:P.id,bitmap:P.bitmap.clone(),metrics:P.metrics},b[T].ascender=this.entries[T].ascender,b[T].descender=this.entries[T].descender;a(null,b)}}))}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Py.none&&(this.localGlyphMode===Py.all?!!this.localFontFamily:!!this.localFontFamily&&(Ze["CJK Unified Ideographs"](e)||Ze["Hangul Syllables"](e)||Ze.Hiragana(e)||Ze.Katakana(e)||Ze["CJK Symbols and Punctuation"](e)))}_tinySDF(e,a,u){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(u))return;let y=e.tinySDF;if(!y){let J="400";/bold/i.test(a)?J="900":/medium/i.test(a)?J="500":/light/i.test(a)&&(J="200"),y=e.tinySDF=new Yd.TinySDF({fontFamily:p,fontWeight:J,fontSize:24*Xl,buffer:3*Xl,radius:8*Xl}),y.fontWeight=J}if(this.localGlyphs[y.fontWeight][u])return this.localGlyphs[y.fontWeight][u];const b=String.fromCharCode(u),{data:T,width:M,height:P,glyphWidth:O,glyphHeight:N,glyphLeft:$,glyphTop:Z,glyphAdvance:X}=y.draw(b);return this.localGlyphs[y.fontWeight][u]={id:u,bitmap:new pu({width:M,height:P},T),metrics:{width:O/Xl,height:N/Xl,left:$/Xl,top:Z/Xl-27,advance:X/Xl,localGlyph:!0}}}}Yd.loadGlyphRange=function(s,e,a,u,p){const y=256*e,b=y+255,T=u.transformRequest(u.normalizeGlyphsURL(a).replace("{fontstack}",s).replace("{range}",`${y}-${b}`),Mr.Glyphs);Eo(T,((M,P)=>{if(M)p(M);else if(P){const O={},N=(function($){return new Hm($).readFields(MP,{})})(P);for(const $ of N.glyphs)O[$.id]=$;p(null,{glyphs:O,ascender:N.ascender,descender:N.descender})}}))},Yd.TinySDF=class{constructor({fontSize:s=24,buffer:e=3,radius:a=8,cutoff:u=.25,fontFamily:p="sans-serif",fontWeight:y="normal",fontStyle:b="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=a;const T=this.size=s+4*e,M=this._createCanvas(T),P=this.ctx=M.getContext("2d",{willReadFrequently:!0});P.font=`${b} ${y} ${s}px ${p}`,P.textBaseline="alphabetic",P.textAlign="left",P.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(s){const e=document.createElement("canvas");return e.width=e.height=s,e}draw(s){const{width:e,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:p,actualBoundingBoxRight:y}=this.ctx.measureText(s),b=Math.ceil(a),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-p))),M=Math.min(this.size-this.buffer,b+Math.ceil(u)),P=T+2*this.buffer,O=M+2*this.buffer,N=Math.max(P*O,0),$=new Uint8ClampedArray(N),Z={data:$,width:P,height:O,glyphWidth:T,glyphHeight:M,glyphTop:b,glyphLeft:0,glyphAdvance:e};if(T===0||M===0)return Z;const{ctx:X,buffer:J,gridInner:ct,gridOuter:yt}=this;X.clearRect(J,J,T,M),X.fillText(s,J,J+b);const Ct=X.getImageData(J,J,T,M);yt.fill(sp,0,N),ct.fill(0,0,N);for(let vt=0;vt<M;vt++)for(let St=0;St<T;St++){const Dt=Ct.data[4*(vt*T+St)+3]/255;if(Dt===0)continue;const It=(vt+J)*P+St+J;if(Dt===1)yt[It]=0,ct[It]=sp;else{const ie=.5-Dt;yt[It]=ie>0?ie*ie:0,ct[It]=ie<0?ie*ie:0}}r1(yt,0,0,P,O,P,this.f,this.v,this.z),r1(ct,J,J,T,M,P,this.f,this.v,this.z);for(let vt=0;vt<N;vt++){const St=Math.sqrt(yt[vt])-Math.sqrt(ct[vt]);$[vt]=Math.round(255-255*(St/this.radius+this.cutoff))}return Z}};const Jd=Ro;function a1(s,e,a,u){const p=[],y=s.image,b=y.pixelRatio,T=y.paddedRect.w-2*Jd,M=y.paddedRect.h-2*Jd,P=s.right-s.left,O=s.bottom-s.top,N=y.stretchX||[[0,T]],$=y.stretchY||[[0,M]],Z=(re,ve)=>re+ve[1]-ve[0],X=N.reduce(Z,0),J=$.reduce(Z,0),ct=T-X,yt=M-J;let Ct=0,vt=X,St=0,Dt=J,It=0,ie=ct,Qt=0,_e=yt;if(y.content&&u){const re=y.content;Ct=Xm(N,0,re[0]),St=Xm($,0,re[1]),vt=Xm(N,re[0],re[2]),Dt=Xm($,re[1],re[3]),It=re[0]-Ct,Qt=re[1]-St,ie=re[2]-re[0]-vt,_e=re[3]-re[1]-Dt}const ke=(re,ve,xe,Ce)=>{const De=Km(re.stretch-Ct,vt,P,s.left),pe=Ym(re.fixed-It,ie,re.stretch,X),We=Km(ve.stretch-St,Dt,O,s.top),si=Ym(ve.fixed-Qt,_e,ve.stretch,J),qe=Km(xe.stretch-Ct,vt,P,s.left),Ci=Ym(xe.fixed-It,ie,xe.stretch,X),ze=Km(Ce.stretch-St,Dt,O,s.top),ui=Ym(Ce.fixed-Qt,_e,Ce.stretch,J),Ai=new Nt(De,We),Qi=new Nt(qe,We),Pi=new Nt(qe,ze),gi=new Nt(De,ze),Rn=new Nt(pe/b,si/b),zi=new Nt(Ci/b,ui/b),Oi=e*Math.PI/180;if(Oi){const In=Math.sin(Oi),Tn=Math.cos(Oi),Yn=[Tn,-In,In,Tn];Ai._matMult(Yn),Qi._matMult(Yn),gi._matMult(Yn),Pi._matMult(Yn)}const wn=re.stretch+re.fixed,kn=ve.stretch+ve.fixed;return{tl:Ai,tr:Qi,bl:gi,br:Pi,tex:{x:y.paddedRect.x+Jd+wn,y:y.paddedRect.y+Jd+kn,w:xe.stretch+xe.fixed-wn,h:Ce.stretch+Ce.fixed-kn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Rn,pixelOffsetBR:zi,minFontScaleX:ie/b/P,minFontScaleY:_e/b/O,isSDF:a}};if(u&&(y.stretchX||y.stretchY)){const re=l1(N,ct,X),ve=l1($,yt,J);for(let xe=0;xe<re.length-1;xe++){const Ce=re[xe],De=re[xe+1];for(let pe=0;pe<ve.length-1;pe++)p.push(ke(Ce,ve[pe],De,ve[pe+1]))}}else p.push(ke({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:M+1}));return p}function Xm(s,e,a){let u=0;for(const p of s)u+=Math.max(e,Math.min(a,p[1]))-Math.max(e,Math.min(a,p[0]));return u}function l1(s,e,a){const u=[{fixed:-Jd,stretch:0}];for(const[p,y]of s){const b=u[u.length-1];u.push({fixed:p-b.stretch,stretch:b.stretch}),u.push({fixed:p-b.stretch,stretch:b.stretch+(y-p)})}return u.push({fixed:e+Jd,stretch:a}),u}function Km(s,e,a,u){return s/e*a+u}function Ym(s,e,a,u){return s-e*a/u}function zP(s,e,a,u){const p=e+s.positionedLines[u].lineOffset;return u===0?a+p/2:a+(p+(e+s.positionedLines[u-1].lineOffset))/2}class OP{constructor(e=[],a=RP){if(this.data=e,this.length=this.data.length,this.compare=a,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:a,compare:u}=this,p=a[e];for(;e>0;){const y=e-1>>1,b=a[y];if(u(p,b)>=0)break;a[e]=b,e=y}a[e]=p}_down(e){const{data:a,compare:u}=this,p=this.length>>1,y=a[e];for(;e<p;){let b=1+(e<<1),T=a[b];const M=b+1;if(M<this.length&&u(a[M],T)<0&&(b=M,T=a[M]),u(T,y)>=0)break;a[e]=T,e=b}a[e]=y}}function RP(s,e){return s<e?-1:s>e?1:0}function BP(s,e=1,a=!1){let u=1/0,p=1/0,y=-1/0,b=-1/0;const T=s[0];for(let Z=0;Z<T.length;Z++){const X=T[Z];(!Z||X.x<u)&&(u=X.x),(!Z||X.y<p)&&(p=X.y),(!Z||X.x>y)&&(y=X.x),(!Z||X.y>b)&&(b=X.y)}const M=Math.min(y-u,b-p);let P=M/2;const O=new OP([],FP);if(M===0)return new Nt(u,p);for(let Z=u;Z<y;Z+=M)for(let X=p;X<b;X+=M)O.push(new Qd(Z+P,X+P,P,s));let N=(function(Z){let X=0,J=0,ct=0;const yt=Z[0];for(let Ct=0,vt=yt.length,St=vt-1;Ct<vt;St=Ct++){const Dt=yt[Ct],It=yt[St],ie=Dt.x*It.y-It.x*Dt.y;J+=(Dt.x+It.x)*ie,ct+=(Dt.y+It.y)*ie,X+=3*ie}return new Qd(J/X,ct/X,0,Z)})(s),$=O.length;for(;O.length;){const Z=O.pop();(Z.d>N.d||!N.d)&&(N=Z,a&&console.log("found best %d after %d probes",Math.round(1e4*Z.d)/1e4,$)),Z.max-N.d<=e||(P=Z.h/2,O.push(new Qd(Z.p.x-P,Z.p.y-P,P,s)),O.push(new Qd(Z.p.x+P,Z.p.y-P,P,s)),O.push(new Qd(Z.p.x-P,Z.p.y+P,P,s)),O.push(new Qd(Z.p.x+P,Z.p.y+P,P,s)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${N.d}`)),N.p}function FP(s,e){return e.max-s.max}class Qd{constructor(e,a,u,p){this.p=new Nt(e,a),this.h=u,this.d=(function(y,b){let T=!1,M=1/0;for(let P=0;P<b.length;P++){const O=b[P];for(let N=0,$=O.length,Z=$-1;N<$;Z=N++){const X=O[N],J=O[Z];X.y>y.y!=J.y>y.y&&y.x<(J.x-X.x)*(y.y-X.y)/(J.y-X.y)+X.x&&(T=!T),M=Math.min(M,nb(y,X,J))}}return(T?1:-1)*Math.sqrt(M)})(this.p,p),this.max=this.d+this.h*Math.SQRT2}}const tf=7,ky=Number.POSITIVE_INFINITY,NP=Math.sqrt(2);function c1(s,[e,a]){let u=0,p=0;if(a===ky){e<0&&(e=0);const y=e/NP;switch(s){case"top-right":case"top-left":p=y-tf;break;case"bottom-right":case"bottom-left":p=-y+tf;break;case"bottom":p=-e+tf;break;case"top":p=e-tf}switch(s){case"top-right":case"bottom-right":u=-y;break;case"top-left":case"bottom-left":u=y;break;case"left":u=e;break;case"right":u=-e}}else{switch(e=Math.abs(e),a=Math.abs(a),s){case"top-right":case"top-left":case"top":p=a-tf;break;case"bottom-right":case"bottom-left":case"bottom":p=-a+tf}switch(s){case"top-right":case"bottom-right":case"right":u=-e;break;case"top-left":case"bottom-left":case"left":u=e}}return[u,p]}function jP(s,e,a,u,p,y,b,T,M,P){s.createArrays(),s.tilePixelRatio=di/(512*s.overscaling),s.compareText={},s.iconsNeedLinear=!1;const O=s.layers[0].layout,N=s.layers[0]._unevaluatedLayout._values,$={};if(s.textSizeData.kind==="composite"){const{minZoom:J,maxZoom:ct}=s.textSizeData;$.compositeTextSizes=[N["text-size"].possiblyEvaluate(new B(J),T),N["text-size"].possiblyEvaluate(new B(ct),T)]}if(s.iconSizeData.kind==="composite"){const{minZoom:J,maxZoom:ct}=s.iconSizeData;$.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new B(J),T),N["icon-size"].possiblyEvaluate(new B(ct),T)]}$.layoutTextSize=N["text-size"].possiblyEvaluate(new B(M+1),T),$.layoutIconSize=N["icon-size"].possiblyEvaluate(new B(M+1),T),$.textMaxSize=N["text-size"].possiblyEvaluate(new B(18),T);const Z=O.get("text-rotation-alignment")==="map"&&O.get("symbol-placement")!=="point",X=O.get("text-size");for(const J of s.features){const ct=O.get("text-font").evaluate(J,{},T).join(","),yt=X.evaluate(J,{},T),Ct=$.layoutTextSize.evaluate(J,{},T),vt=($.layoutIconSize.evaluate(J,{},T),{horizontal:{},vertical:void 0}),St=J.text;let Dt,It=[0,0];if(St){const _e=St.toString(),ke=O.get("text-letter-spacing").evaluate(J,{},T)*br,re=O.get("text-line-height").evaluate(J,{},T)*br,ve=Lf(_e)?ke:0,xe=O.get("text-anchor").evaluate(J,{},T),Ce=O.get("text-variable-anchor");if(!Ce){const qe=O.get("text-radial-offset").evaluate(J,{},T);It=qe?c1(xe,[qe*br,ky]):O.get("text-offset").evaluate(J,{},T).map((Ci=>Ci*br))}let De=Z?"center":O.get("text-justify").evaluate(J,{},T);const pe=O.get("symbol-placement")==="point",We=pe?O.get("text-max-width").evaluate(J,{},T)*br:1/0,si=qe=>{s.allowVerticalPlacement&&zh(_e)&&(vt.vertical=Cy(St,e,a,p,ct,We,re,xe,qe,ve,It,Pa.vertical,!0,Ct,yt))};if(!Z&&Ce){const qe=De==="auto"?Ce.map((ze=>Iy(ze))):[De];let Ci=!1;for(let ze=0;ze<qe.length;ze++){const ui=qe[ze];if(!vt.horizontal[ui])if(Ci)vt.horizontal[ui]=vt.horizontal[0];else{const Ai=Cy(St,e,a,p,ct,We,re,"center",ui,ve,It,Pa.horizontal,!1,Ct,yt);Ai&&(vt.horizontal[ui]=Ai,Ci=Ai.positionedLines.length===1)}}si("left")}else{if(De==="auto"&&(De=Iy(xe)),pe||O.get("text-writing-mode").indexOf("horizontal")>=0||!zh(_e)){const qe=Cy(St,e,a,p,ct,We,re,xe,De,ve,It,Pa.horizontal,!1,Ct,yt);qe&&(vt.horizontal[De]=qe)}si(pe?"left":De)}}let ie=!1;if(J.icon&&J.icon.name){const _e=u[J.icon.name];_e&&(Dt=IP(p[J.icon.name],O.get("icon-offset").evaluate(J,{},T),O.get("icon-anchor").evaluate(J,{},T)),ie=_e.sdf,s.sdfIcons===void 0?s.sdfIcons=_e.sdf:s.sdfIcons!==_e.sdf&&me("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(_e.pixelRatio!==s.pixelRatio||O.get("icon-rotate").constantOr(1)!==0)&&(s.iconsNeedLinear=!0))}const Qt=h1(vt.horizontal)||vt.vertical;s.iconsInText||(s.iconsInText=!!Qt&&Qt.iconsInText),(Qt||Dt)&&VP(s,J,vt,Dt,u,$,Ct,0,It,ie,b,T,P)}y&&s.generateCollisionDebugBuffers(M,s.collisionBoxArray)}function Iy(s){switch(s){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function VP(s,e,a,u,p,y,b,T,M,P,O,N,$){let Z=y.textMaxSize.evaluate(e,{},N);Z===void 0&&(Z=b);const X=s.layers[0].layout,J=X.get("icon-offset").evaluate(e,{},N),ct=h1(a.horizontal)||a.vertical,yt=$.name==="globe",Ct=br,vt=b/Ct,St=s.tilePixelRatio*Z/Ct,Dt=(xe=s.overscaling,s.zoom>18&&xe>2&&(xe>>=1),Math.max(di/(512*xe),1)*X.get("symbol-spacing")),It=X.get("text-padding")*s.tilePixelRatio,ie=X.get("icon-padding")*s.tilePixelRatio,Qt=ae(X.get("text-max-angle")),_e=X.get("text-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",ke=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",re=X.get("symbol-placement"),ve=Dt/2;var xe;const Ce=X.get("icon-text-fit");let De;u&&Ce!=="none"&&(s.allowVerticalPlacement&&a.vertical&&(De=Jb(u,a.vertical,Ce,X.get("icon-text-fit-padding"),J,vt)),ct&&(u=Jb(u,ct,Ce,X.get("icon-text-fit-padding"),J,vt)));const pe=(We,si,qe)=>{if(si.x<0||si.x>=di||si.y<0||si.y>=di)return;let Ci=null;if(yt){const{x:ze,y:ui,z:Ai}=$.projectTilePoint(si.x,si.y,qe);Ci={anchor:new _u(ze,ui,Ai,0,void 0),up:$.upVector(qe,si.x,si.y)}}(function(ze,ui,Ai,Qi,Pi,gi,Rn,zi,Oi,wn,kn,In,Tn,Yn,hs,Ss,En,Fs,Ms,rs,nn,Cs,Ln,ho,As){const wr=ze.addToLineVertexArray(ui,Qi);let sr,fo,rr,Yl,sf,fp,pp,W1=0,Z1=0,G1=0,H1=0,Gy=-1,Hy=-1;const Pc={};let q1=Ug("");const qh=Ai?Ai.anchor:ui;let qy=0,Xy=0;if(Oi._unevaluatedLayout.getValue("text-radial-offset")===void 0?[qy,Xy]=Oi.layout.get("text-offset").evaluate(nn,{},As).map((ra=>ra*br)):(qy=Oi.layout.get("text-radial-offset").evaluate(nn,{},As)*br,Xy=ky),ze.allowVerticalPlacement&&Pi.vertical){const ra=Pi.vertical;if(hs)fp=Ly(ra),zi&&(pp=Ly(zi));else{const oa=Oi.layout.get("text-rotate").evaluate(nn,{},As)+90;rr=Jm(wn,qh,ui,kn,In,Tn,ra,Yn,oa,Ss),zi&&(Yl=Jm(wn,qh,ui,kn,In,Tn,zi,Fs,oa))}}if(gi){const ra=Oi.layout.get("icon-rotate").evaluate(nn,{},As),oa=Oi.layout.get("icon-text-fit")!=="none",mp=a1(gi,ra,Ln,oa),Yy=zi?a1(zi,ra,Ln,oa):void 0;fo=Jm(wn,qh,ui,kn,In,Tn,gi,Fs,ra),W1=4*mp.length;const X1=ze.iconSizeData;let Xh=null;X1.kind==="source"?(Xh=[ql*Oi.layout.get("icon-size").evaluate(nn,{},As)],Xh[0]>Xu&&me(`${ze.layerIds[0]}: Value for "icon-size" is >= ${rp}. Reduce your "icon-size".`)):X1.kind==="composite"&&(Xh=[ql*Cs.compositeIconSizes[0].evaluate(nn,{},As),ql*Cs.compositeIconSizes[1].evaluate(nn,{},As)],(Xh[0]>Xu||Xh[1]>Xu)&&me(`${ze.layerIds[0]}: Value for "icon-size" is >= ${rp}. Reduce your "icon-size".`)),ze.addSymbols(ze.icon,mp,Xh,rs,Ms,nn,!1,Ai,ui,wr.lineStartIndex,wr.lineLength,-1,ho,As),Gy=ze.icon.placedSymbolArray.length-1,Yy&&(Z1=4*Yy.length,ze.addSymbols(ze.icon,Yy,Xh,rs,Ms,nn,Pa.vertical,Ai,ui,wr.lineStartIndex,wr.lineLength,-1,ho,As),Hy=ze.icon.placedSymbolArray.length-1)}for(const ra in Pi.horizontal){const oa=Pi.horizontal[ra];sr||(q1=Ug(oa.text),hs?sf=Ly(oa):sr=Jm(wn,qh,ui,kn,In,Tn,oa,Yn,Oi.layout.get("text-rotate").evaluate(nn,{},As),Ss));const mp=oa.positionedLines.length===1;if(G1+=u1(ze,Ai,ui,oa,Rn,Oi,hs,nn,Ss,wr,Pi.vertical?Pa.horizontal:Pa.horizontalOnly,mp?Object.keys(Pi.horizontal):[ra],Pc,Gy,Cs,ho,As),mp)break}Pi.vertical&&(H1+=u1(ze,Ai,ui,Pi.vertical,Rn,Oi,hs,nn,Ss,wr,Pa.vertical,["vertical"],Pc,Hy,Cs,ho,As));let eh=-1;const Ky=(ra,oa)=>ra?Math.max(ra,oa):oa;eh=Ky(sf,eh),eh=Ky(fp,eh),eh=Ky(pp,eh);const mk=eh>-1?1:0;ze.glyphOffsetArray.length>=Yu.MAX_GLYPHS&&me("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),nn.sortKey!==void 0&&ze.addToSortKeyRanges(ze.symbolInstances.length,nn.sortKey),ze.symbolInstances.emplaceBack(qh.x,qh.y,qh.z,ui.x,ui.y,Pc.right>=0?Pc.right:-1,Pc.center>=0?Pc.center:-1,Pc.left>=0?Pc.left:-1,Pc.vertical>=0?Pc.vertical:-1,Gy,Hy,q1,sr!==void 0?sr:ze.collisionBoxArray.length,sr!==void 0?sr+1:ze.collisionBoxArray.length,rr!==void 0?rr:ze.collisionBoxArray.length,rr!==void 0?rr+1:ze.collisionBoxArray.length,fo!==void 0?fo:ze.collisionBoxArray.length,fo!==void 0?fo+1:ze.collisionBoxArray.length,Yl||ze.collisionBoxArray.length,Yl?Yl+1:ze.collisionBoxArray.length,kn,G1,H1,W1,Z1,mk,0,qy,Xy,eh)})(s,si,Ci,We,a,u,p,De,s.layers[0],s.collisionBoxArray,e.index,e.sourceLayerIndex,s.index,It,_e,M,0,ie,ke,J,e,y,P,O,N)};if(re==="line")for(const We of s1(e.geometry,0,0,di,di)){const si=DP(We,Dt,Qt,a.vertical||ct,u,Ct,St,s.overscaling,di);for(const qe of si)ct&&UP(s,ct.text,ve,qe)||pe(We,qe,N)}else if(re==="line-center"){for(const We of e.geometry)if(We.length>1){const si=LP(We,Qt,a.vertical||ct,u,Ct,St);si&&pe(We,si,N)}}else if(e.type==="Polygon")for(const We of yy(e.geometry,0)){const si=BP(We,16);pe(We[0],new _u(si.x,si.y,0,0,void 0),N)}else if(e.type==="LineString")for(const We of e.geometry)pe(We,new _u(We[0].x,We[0].y,0,0,void 0),N);else if(e.type==="Point")for(const We of e.geometry)for(const si of We)pe([si],new _u(si.x,si.y,0,0,void 0),N)}const rp=255,Xu=rp*ql;function u1(s,e,a,u,p,y,b,T,M,P,O,N,$,Z,X,J,ct){const yt=(function(St,Dt,It,ie,Qt,_e,ke,re){const ve=[];if(Dt.positionedLines.length===0)return ve;const xe=ie.layout.get("text-rotate").evaluate(_e,{})*Math.PI/180,Ce=(function(qe){const Ci=qe[0],ze=qe[1],ui=Ci*ze;return ui>0?[Ci,-ze]:ui<0?[-Ci,ze]:Ci===0?[ze,Ci]:[ze,-Ci]})(It);let De=Math.abs(Dt.top-Dt.bottom);for(const qe of Dt.positionedLines)De-=qe.lineOffset;const pe=Dt.positionedLines.length,We=De/pe;let si=Dt.top-It[1];for(let qe=0;qe<pe;++qe){const Ci=Dt.positionedLines[qe];si=zP(Dt,We,si,qe);for(const ze of Ci.positionedGlyphs){if(!ze.rect)continue;const ui=ze.rect||{};let Ai=Wb+1,Qi=!0,Pi=1,gi=0;if(ze.imageName){const Ln=ke[ze.imageName];if(!Ln)continue;if(Ln.sdf){me("SDF images are not supported in formatted text and will be ignored.");continue}Qi=!1,Pi=Ln.pixelRatio,Ai=Ro/Pi}const Rn=(Qt||re)&&ze.vertical,zi=ze.metrics.advance*ze.scale/2,Oi=ze.metrics,wn=ze.rect;if(wn===null)continue;re&&Dt.verticalizable&&(gi=ze.imageName?zi-ze.metrics.width*ze.scale/2:0);const kn=Qt?[ze.x+zi,ze.y]:[0,0];let In=[0,0],Tn=[0,0],Yn=!1;Qt||(Rn?(Tn=[ze.x+zi+Ce[0],ze.y+Ce[1]-gi],Yn=!0):In=[ze.x+zi+It[0],ze.y+It[1]-gi]);const hs=wn.w*ze.scale/(Pi*(ze.localGlyph?Xl:1)),Ss=wn.h*ze.scale/(Pi*(ze.localGlyph?Xl:1));let En,Fs,Ms,rs;if(Rn){const Ln=ze.y-si,ho=new Nt(-zi,zi-Ln),As=-Math.PI/2,wr=new Nt(...Tn);En=new Nt(-zi+In[0],In[1]),En._rotateAround(As,ho)._add(wr),En.x+=-Ln+zi,En.y-=(Oi.left-Ai)*ze.scale;const sr=ze.imageName?Oi.advance*ze.scale:br*ze.scale,fo=String.fromCharCode(ze.glyph);mP(fo)?En.x+=(1-Ai)*ze.scale:_P(fo)?En.x+=sr-Oi.height*ze.scale+(-Ai-1)*ze.scale:En.x+=ze.imageName||Oi.width+2*Ai===wn.w&&Oi.height+2*Ai===wn.h?(sr-Ss)/2:(sr-(Oi.height+2*Ai)*ze.scale)/2,Fs=new Nt(En.x,En.y-hs),Ms=new Nt(En.x+Ss,En.y),rs=new Nt(En.x+Ss,En.y-hs)}else{const Ln=(Oi.left-Ai)*ze.scale-zi+In[0],ho=(-Oi.top-Ai)*ze.scale+In[1],As=Ln+hs,wr=ho+Ss;En=new Nt(Ln,ho),Fs=new Nt(As,ho),Ms=new Nt(Ln,wr),rs=new Nt(As,wr)}if(xe){let Ln;Ln=Qt?new Nt(0,0):Yn?new Nt(Ce[0],Ce[1]):new Nt(It[0],It[1]),En._rotateAround(xe,Ln),Fs._rotateAround(xe,Ln),Ms._rotateAround(xe,Ln),rs._rotateAround(xe,Ln)}const nn=new Nt(0,0),Cs=new Nt(0,0);ve.push({tl:En,tr:Fs,bl:Ms,br:rs,tex:ui,writingMode:Dt.writingMode,glyphOffset:kn,sectionIndex:ze.sectionIndex,isSDF:Qi,pixelOffsetTL:nn,pixelOffsetBR:Cs,minFontScaleX:0,minFontScaleY:0})}}return ve})(0,u,M,y,b,T,p,s.allowVerticalPlacement),Ct=s.textSizeData;let vt=null;Ct.kind==="source"?(vt=[ql*y.layout.get("text-size").evaluate(T,{},ct)],vt[0]>Xu&&me(`${s.layerIds[0]}: Value for "text-size" is >= ${rp}. Reduce your "text-size".`)):Ct.kind==="composite"&&(vt=[ql*X.compositeTextSizes[0].evaluate(T,{},ct),ql*X.compositeTextSizes[1].evaluate(T,{},ct)],(vt[0]>Xu||vt[1]>Xu)&&me(`${s.layerIds[0]}: Value for "text-size" is >= ${rp}. Reduce your "text-size".`)),s.addSymbols(s.text,yt,vt,M,b,T,O,e,a,P.lineStartIndex,P.lineLength,Z,J,ct);for(const St of N)$[St]=s.text.placedSymbolArray.length-1;return 4*yt.length}function h1(s){for(const e in s)return s[e];return null}function Jm(s,e,a,u,p,y,b,T,M,P){let O=b.top,N=b.bottom,$=b.left,Z=b.right;const X=b.collisionPadding;if(X&&($-=X[0],O-=X[1],Z+=X[2],N+=X[3]),M){const J=new Nt($,O),ct=new Nt(Z,O),yt=new Nt($,N),Ct=new Nt(Z,N),vt=ae(M);let St=new Nt(0,0);P&&(St=new Nt(P[0],P[1])),J._rotateAround(vt,St),ct._rotateAround(vt,St),yt._rotateAround(vt,St),Ct._rotateAround(vt,St),$=Math.min(J.x,ct.x,yt.x,Ct.x),Z=Math.max(J.x,ct.x,yt.x,Ct.x),O=Math.min(J.y,ct.y,yt.y,Ct.y),N=Math.max(J.y,ct.y,yt.y,Ct.y)}return s.emplaceBack(e.x,e.y,e.z,a.x,a.y,$,O,Z,N,T,u,p,y),s.length-1}function Ly(s){s.collisionPadding&&(s.top-=s.collisionPadding[1],s.bottom+=s.collisionPadding[3]);const e=s.bottom-s.top;return e>0?Math.max(10,e):null}function UP(s,e,a,u){const p=s.compareText;if(e in p){const y=p[e];for(let b=y.length-1;b>=0;b--)if(u.dist(y[b])<a)return!0}else p[e]=[];return p[e].push(u),!1}function d1(s,e){const a=s.fovAboveCenter,u=s.elevation?s.elevation.getMinElevationBelowMSL()*e:0,p=(s._camera.position[2]*s.worldSize-u)/Math.cos(s._pitch),y=Math.sin(a)*p/Math.sin(Math.max(Math.PI/2-s._pitch-a,.01)),b=Math.sin(s._pitch)*y+p;return Math.min(1.01*b,p*(1/s._horizonShift))}function Gh(s,e){if(!e.isReprojectedInTileSpace)return{scale:1<<s.z,x:s.x,y:s.y,x2:s.x+1,y2:s.y+1,projection:e};const a=Math.pow(2,-s.z),u=s.x*a,p=(s.x+1)*a,y=s.y*a,b=(s.y+1)*a,T=Aa(u),M=Aa(p),P=Rr(y),O=Rr(b),N=e.project(T,P),$=e.project(M,P),Z=e.project(M,O),X=e.project(T,O);let J=Math.min(N.x,$.x,Z.x,X.x),ct=Math.min(N.y,$.y,Z.y,X.y),yt=Math.max(N.x,$.x,Z.x,X.x),Ct=Math.max(N.y,$.y,Z.y,X.y);const vt=a/16;function St(It,ie,Qt,_e,ke,re){const ve=(Qt+ke)/2,xe=(_e+re)/2,Ce=e.project(Aa(ve),Rr(xe)),De=Math.max(0,J-Ce.x,ct-Ce.y,Ce.x-yt,Ce.y-Ct);J=Math.min(J,Ce.x),yt=Math.max(yt,Ce.x),ct=Math.min(ct,Ce.y),Ct=Math.max(Ct,Ce.y),De>vt&&(St(It,Ce,Qt,_e,ve,xe),St(Ce,ie,ve,xe,ke,re))}St(N,$,u,y,p,y),St($,Z,p,y,p,b),St(Z,X,p,b,u,b),St(X,N,u,b,u,y),J-=vt,ct-=vt,yt+=vt,Ct+=vt;const Dt=1/Math.max(yt-J,Ct-ct);return{scale:Dt,x:J*Dt,y:ct*Dt,x2:yt*Dt,y2:Ct*Dt,projection:e}}const $P=Zl(new Float32Array(16));class Ku{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,a){return{x:0,y:0,z:0}}unproject(e,a){return new bn(0,0)}projectTilePoint(e,a,u){return{x:e,y:a,z:0}}locationPoint(e,a,u=!0){return e._coordinatePoint(e.locationCoordinate(a),u)}pixelsPerMeter(e,a){return Hl(1,e)*a}pixelSpaceConversion(e,a,u){return 1}farthestPixelDistance(e){return d1(e,e.pixelsPerMeter)}pointCoordinate(e,a,u,p){const y=e.horizonLineFromTop(!1),b=new Nt(a,Math.max(y,u));return e.rayIntersectionCoordinate(e.pointRayIntersection(b,p))}pointCoordinate3D(e,a,u){const p=new Nt(a,u);if(e.elevation)return e.elevation.pointCoordinate(p);{const y=this.pointCoordinate(e,p.x,p.y,0);return[y.x,y.y,y.z]}}isPointAboveHorizon(e,a){if(e.elevation)return!this.pointCoordinate3D(e,a.x,a.y);const u=e.horizonLineFromTop();return a.y<u}createInversionMatrix(e,a){return $P}createTileMatrix(e,a,u){let p,y,b;const T=u.canonical,M=Zl(new Float64Array(16));if(this.isReprojectedInTileSpace){const P=Gh(T,this);p=1,y=P.x+u.wrap*P.scale,b=P.y,Nh(M,M,[p/P.scale,p/P.scale,e.pixelsPerMeter/a])}else p=a/e.zoomScale(T.z),y=(T.x+Math.pow(2,T.z)*u.wrap)*p,b=T.y*p;return Rf(M,M,[y,b,0]),Nh(M,M,[p/di,p/di,1]),M}upVector(e,a,u){return[0,0,1]}upVectorScale(e,a,u){return{metersToTile:1}}}class WP extends Ku{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[a,u]=this.parallels=e.parallels||[29.5,45.5],p=Math.sin(ae(a));this.n=(p+Math.sin(ae(u)))/2,this.c=1+p*(2*this.n-p),this.r0=Math.sqrt(this.c)/this.n}project(e,a){const{n:u,c:p,r0:y}=this,b=ae(e-this.center[0]),T=ae(a),M=Math.sqrt(p-2*u*Math.sin(T))/u;return{x:M*Math.sin(b*u),y:M*Math.cos(b*u)-y,z:0}}unproject(e,a){const{n:u,c:p,r0:y}=this,b=y+a;let T=Math.atan2(e,Math.abs(b))*Math.sign(b);b*u<0&&(T-=Math.PI*Math.sign(e)*Math.sign(b));const M=ae(this.center[0])*u;T=$t(T,-Math.PI-M,Math.PI-M);const P=Oe(ye(T/u)+this.center[0],-180,180),O=Math.asin(Oe((p-(e*e+b*b)*u*u)/(2*u),-1,1)),N=Oe(ye(O),-Br,Br);return new bn(P,N)}}const op=1.340264,ap=-.081106,lp=893e-6,cp=.003796,Qm=Math.sqrt(3)/2;class ZP extends Ku{project(e,a){a=a/180*Math.PI,e=e/180*Math.PI;const u=Math.asin(Qm*Math.sin(a)),p=u*u,y=p*p*p;return{x:.5*(e*Math.cos(u)/(Qm*(op+3*ap*p+y*(7*lp+9*cp*p)))/Math.PI+.5),y:1-.5*(u*(op+ap*p+y*(lp+cp*p))/Math.PI+1),z:0}}unproject(e,a){e=(2*e-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,p=u*u,y=p*p*p;for(let O,N,$,Z=0;Z<12&&(N=u*(op+ap*p+y*(lp+cp*p))-a,$=op+3*ap*p+y*(7*lp+9*cp*p),O=N/$,u=Oe(u-O,-Math.PI/3,Math.PI/3),p=u*u,y=p*p*p,!(Math.abs(O)<1e-12));++Z);const b=Qm*e*(op+3*ap*p+y*(7*lp+9*cp*p))/Math.cos(u),T=Math.asin(Math.sin(u)/Qm),M=Oe(180*b/Math.PI,-180,180),P=Oe(180*T/Math.PI,-Br,Br);return new bn(M,P)}}class GP extends Ku{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,a){return{x:.5+e/360,y:.5-a/360,z:0}}unproject(e,a){const u=360*(e-.5),p=Oe(360*(.5-a),-Br,Br);return new bn(u,p)}}const ef=Math.PI/2;function t_(s){return Math.tan((ef+s)/2)}class HP extends Ku{constructor(e){super(e),this.center=e.center||[0,30];const[a,u]=this.parallels=e.parallels||[30,30];let p=ae(a),y=ae(u);this.southernCenter=p+y<0,this.southernCenter&&(p=-p,y=-y);const b=Math.cos(p),T=t_(p);this.n=p===y?Math.sin(p):Math.log(b/Math.cos(y))/Math.log(t_(y)/T),this.f=b*Math.pow(t_(p),this.n)/this.n}project(e,a){a=ae(a),this.southernCenter&&(a=-a),e=ae(e-this.center[0]);const u=1e-6,{n:p,f:y}=this;y>0?a<-ef+u&&(a=-ef+u):a>ef-u&&(a=ef-u);const b=y/Math.pow(t_(a),p);let T=b*Math.sin(p*e),M=y-b*Math.cos(p*e);return T=.5*(T/Math.PI+.5),M=.5*(M/Math.PI+.5),{x:T,y:this.southernCenter?M:1-M,z:0}}unproject(e,a){e=(2*e-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:u,f:p}=this,y=p-a,b=Math.sign(y),T=Math.sign(u)*Math.sqrt(e*e+y*y);let M=Math.atan2(e,Math.abs(y))*b;y*u<0&&(M-=Math.PI*Math.sign(e)*b);const P=Oe(ye(M/u)+this.center[0],-180,180),O=Oe(ye(2*Math.atan(Math.pow(p/T,1/u))-ef),-Br,Br);return new bn(P,this.southernCenter?-O:O)}}class f1 extends Ku{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,a){return{x:Ec(e),y:Sc(a),z:0}}unproject(e,a){const u=Aa(e),p=Rr(a);return new bn(u,p)}}const p1=ae(Br);class qP extends Ku{project(e,a){const u=(a=ae(a))*a,p=u*u;return{x:.5*((e=ae(e))*(.8707-.131979*u+p*(p*(.003971*u-.001529*p)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+u*(.015085+p*(.028874*u-.044475-.005916*p)))/Math.PI+1),z:0}}unproject(e,a){e=(2*e-.5)*Math.PI;let u=a=(2*(1-a)-1)*Math.PI,p=25,y=0,b=u*u;do{b=u*u;const P=b*b;y=(u*(1.007226+b*(.015085+P*(.028874*b-.044475-.005916*P)))-a)/(1.007226+b*(.045255+P*(.259866*b-.311325-.005916*11*P))),u=Oe(u-y,-p1,p1)}while(Math.abs(y)>1e-6&&--p>0);b=u*u;const T=Oe(ye(e/(.8707+b*(b*(b*b*b*(.003971-.001529*b)-.013791)-.131979))),-180,180),M=ye(u);return new bn(T,M)}}const m1=ae(Br);class XP extends Ku{project(e,a){a=ae(a),e=ae(e);const u=Math.cos(a),p=2/Math.PI,y=Math.acos(u*Math.cos(e/2)),b=Math.sin(y)/y,T=.5*(e*p+2*u*Math.sin(e/2)/b)||0,M=.5*(a+Math.sin(a)/b)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(M/Math.PI+1),z:0}}unproject(e,a){let u=e=(2*e-.5)*Math.PI,p=a=(2*(1-a)-1)*Math.PI,y=25;const b=1e-6;let T=0,M=0;do{const P=Math.cos(p),O=Math.sin(p),N=2*O*P,$=O*O,Z=P*P,X=Math.cos(u/2),J=Math.sin(u/2),ct=2*X*J,yt=J*J,Ct=1-Z*X*X,vt=Ct?1/Ct:0,St=Ct?Math.acos(P*X)*Math.sqrt(1/Ct):0,Dt=.5*(2*St*P*J+2*u/Math.PI)-e,It=.5*(St*O+p)-a,ie=.5*vt*(Z*yt+St*P*X*$)+1/Math.PI,Qt=vt*(ct*N/4-St*O*J),_e=.125*vt*(N*J-St*O*Z*ct),ke=.5*vt*($*X+St*yt*P)+.5,re=Qt*_e-ke*ie;T=(It*Qt-Dt*ke)/re,M=(Dt*_e-It*ie)/re,u=Oe(u-T,-Math.PI,Math.PI),p=Oe(p-M,-m1,m1)}while((Math.abs(T)>b||Math.abs(M)>b)&&--y>0);return new bn(ye(u),ye(p))}}class _1 extends Ku{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ae(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,a){const{scale:u,cosPhi:p}=this;return{x:ae(e)*p*u+.5,y:-Math.sin(ae(a))/p*u+.5,z:0}}unproject(e,a){const{scale:u,cosPhi:p}=this,y=-(a-.5)/u,b=Oe(ye((e-.5)/u)/p,-180,180),T=Math.asin(Oe(y*p,-1,1)),M=Oe(ye(T),-Br,Br);return new bn(b,M)}}class KP extends f1{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,a,u){const p=Wf(e,a,u);return ms(p,p,Zf(Tc(u))),{x:p[0],y:p[1],z:p[2]}}locationPoint(e,a){const u=jd(a.lat,a.lng),p=lo([],u),y=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(a),e._centerAltitude):e._centerAltitude;jf(u,u,p,Hl(1,0)*di*y);const b=Zl(new Float64Array(16));return Fh(b,e.pixelMatrix,e.globeMatrix),ms(u,u,b),new Nt(u[0],u[1])}pixelsPerMeter(e,a){return Hl(1,0)*a}pixelSpaceConversion(e,a,u){const p=Hl(1,e)*a,y=Hi(Hl(1,45)*a,p,u);return this.pixelsPerMeter(e,a)/y}createTileMatrix(e,a,u){const p=iy(Tc(u.canonical));return Fh(new Float64Array(16),e.globeMatrix,p)}createInversionMatrix(e,a){const{center:u}=e,p=Zf(Tc(a));return Am(p,p,ae(u.lng)),Gg(p,p,ae(u.lat)),Nh(p,p,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(p)}pointCoordinate(e,a,u,p){return $0(e,a,u,!0)||new Ud(0,0)}pointCoordinate3D(e,a,u){const p=this.pointCoordinate(e,a,u,0);return[p.x,p.y,p.z]}isPointAboveHorizon(e,a){return!$0(e,a.x,a.y,!1)}farthestPixelDistance(e){const a=(function(p,y){const b=p.cameraToCenterDistance,T=p._centerAltitude*y,M=p._camera,P=p._camera.forward(),O=du([],Ca([],P,-b),[0,0,T]),N=p.worldSize/(2*Math.PI),$=[0,0,-N],Z=p.width/p.height,X=Math.tan(p.fovAboveCenter),J=Ca([],M.up(),X),ct=Ca([],M.right(),X*Z),yt=lo([],du([],du([],P,J),ct)),Ct=[];let vt;if(new Kg(O,yt).closestPointOnSphere($,N,Ct)){const St=du([],Ct,$),Dt=Gl([],St,O);vt=Math.cos(p.fovAboveCenter)*Bf(Dt)}else{const St=Gl([],O,$),Dt=Gl([],$,O);lo(Dt,Dt);const It=Bf(St)-N;vt=Math.sqrt(It*(It+2*N));const ie=Math.acos(vt/(N+It))-Math.acos(ol(P,Dt));vt*=Math.cos(ie)}return 1.01*vt})(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),u=Vd(e.zoom);if(u>0){const p=d1(e,Hl(1,e.center.lat)*e.worldSize),y=e.worldSize/(2*Math.PI),b=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Hi(a,p+y*(1-Math.cos(b)),Math.pow(u,10))}return a}upVector(e,a,u){return Wf(a,u,e,1)}upVectorScale(e){return{metersToTile:Pm(Im(Tc(e)))}}}function g1(s){const e=s.parallels,a=!!e&&Math.abs(e[0]+e[1])<.01;switch(s.name){case"mercator":return new f1(s);case"equirectangular":return new GP(s);case"naturalEarth":return new qP(s);case"equalEarth":return new ZP(s);case"winkelTripel":return new XP(s);case"albers":return a?new _1(s):new WP(s);case"lambertConformalConic":return a?new _1(s):new HP(s);case"globe":return new KP(s)}throw new Error(`Invalid projection name: ${s.name}`)}const YP=Vm.types,JP=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function e_(s,e,a,u,p,y,b,T,M,P,O,N,$){const Z=T?Math.min(Xu,Math.round(T[0])):0,X=T?Math.min(Xu,Math.round(T[1])):0;s.emplaceBack(e,a,Math.round(32*u),Math.round(32*p),y,b,(Z<<1)+(M?1:0),X,16*P,16*O,256*N,256*$)}function i_(s,e,a,u,p,y,b){s.emplaceBack(e,a,u,p,y,b)}function n_(s,e,a,u,p){s.emplaceBack(e,a,u,p),s.emplaceBack(e,a,u,p),s.emplaceBack(e,a,u,p),s.emplaceBack(e,a,u,p)}function QP(s){for(const e of s.sections)if(ou(e.text))return!0;return!1}class Dy{constructor(e){this.layoutVertexArray=new ge,this.indexArray=new oi,this.programConfigurations=e,this.segments=new Ts,this.dynamicLayoutVertexArray=new Ee,this.opacityVertexArray=new ai,this.placedSymbolArray=new Kn,this.globeExtVertexArray=new Me}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,a,u,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,aP.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,cP.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,JP,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,lP.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||p)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Je(Dy,"SymbolBuffers");class zy{constructor(e,a,u){this.layoutVertexArray=new e,this.layoutAttributes=a,this.indexArray=new u,this.segments=new Ts,this.collisionVertexArray=new $i,this.collisionVertexArrayExt=new ji}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,uP.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,hP.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Je(zy,"CollisionBuffers");class Yu{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((b=>b.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Zl([]),this.placementViewportMatrix=Zl([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wy(this.zoom,a["text-size"]),this.iconSizeData=wy(this.zoom,a["icon-size"]);const u=this.layers[0].layout,p=u.get("symbol-sort-key"),y=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&p.constantOr(1)!==void 0,this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map((b=>Pa[b])),this.stateDependentLayerIds=this.layers.filter((b=>b.isStateDependent())).map((b=>b.id)),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Dy(new Bh(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new Dy(new Bh(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new xr,this.lineVertexArray=new au,this.symbolInstances=new xn}calculateGlyphDependencies(e,a,u,p,y){for(let b=0;b<e.length;b++)if(a[e.charCodeAt(b)]=!0,p&&y){const T=ip[e.charAt(b)];T&&(a[T.charCodeAt(0)]=!0)}}populate(e,a,u,p){const y=this.layers[0],b=y.layout,T=this.projection.name==="globe",M=b.get("text-font"),P=b.get("text-field"),O=b.get("icon-image"),N=(P.value.kind!=="constant"||P.value.value instanceof bs&&!P.value.value.isEmpty()||P.value.value.toString().length>0)&&(M.value.kind!=="constant"||M.value.value.length>0),$=O.value.kind!=="constant"||!!O.value.value||Object.keys(O.parameters).length>0,Z=b.get("symbol-sort-key");if(this.features=[],!N&&!$)return;const X=a.iconDependencies,J=a.glyphDependencies,ct=a.availableImages,yt=new B(this.zoom);for(const{feature:Ct,id:vt,index:St,sourceLayerIndex:Dt}of e){const It=y._featureFilter.needGeometry,ie=$h(Ct,It);if(!y._featureFilter.filter(yt,ie,u))continue;if(It||(ie.geometry=fu(Ct,u,p)),T&&Ct.type!==1&&u.z<=5){const re=ie.geometry,ve=.98078528056,xe=(Ce,De)=>ol(Wf(Ce.x,Ce.y,u,1),Wf(De.x,De.y,u,1))<ve;for(let Ce=0;Ce<re.length;Ce++)re[Ce]=cA(re[Ce],xe)}let Qt,_e;if(N){const re=y.getValueAndResolveTokens("text-field",ie,u,ct),ve=bs.factory(re);QP(ve)&&(this.hasRTLText=!0),(!this.hasRTLText||S()==="unavailable"||this.hasRTLText&&I.isParsed())&&(Qt=pP(ve,y,ie))}if($){const re=y.getValueAndResolveTokens("icon-image",ie,u,ct);_e=re instanceof us?re:us.fromString(re)}if(!Qt&&!_e)continue;const ke=this.sortFeaturesByKey?Z.evaluate(ie,{},u):void 0;if(this.features.push({id:vt,text:Qt,icon:_e,index:St,sourceLayerIndex:Dt,geometry:ie.geometry,properties:Ct.properties,type:YP[Ct.type],sortKey:ke}),_e&&(X[_e.name]=!0),Qt){const re=M.evaluate(ie,{},u).join(","),ve=b.get("text-rotation-alignment")==="map"&&b.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Pa.vertical)>=0;for(const xe of Qt.sections)if(xe.image)X[xe.image.name]=!0;else{const Ce=zh(Qt.toString()),De=xe.fontStack||re,pe=J[De]=J[De]||{};this.calculateGlyphDependencies(xe.text,pe,ve,this.allowVerticalPlacement,Ce)}}}b.get("symbol-placement")==="line"&&(this.features=(function(Ct){const vt={},St={},Dt=[];let It=0;function ie(re){Dt.push(Ct[re]),It++}function Qt(re,ve,xe){const Ce=St[re];return delete St[re],St[ve]=Ce,Dt[Ce].geometry[0].pop(),Dt[Ce].geometry[0]=Dt[Ce].geometry[0].concat(xe[0]),Ce}function _e(re,ve,xe){const Ce=vt[ve];return delete vt[ve],vt[re]=Ce,Dt[Ce].geometry[0].shift(),Dt[Ce].geometry[0]=xe[0].concat(Dt[Ce].geometry[0]),Ce}function ke(re,ve,xe){const Ce=xe?ve[0][ve[0].length-1]:ve[0][0];return`${re}:${Ce.x}:${Ce.y}`}for(let re=0;re<Ct.length;re++){const ve=Ct[re],xe=ve.geometry,Ce=ve.text?ve.text.toString():null;if(!Ce){ie(re);continue}const De=ke(Ce,xe),pe=ke(Ce,xe,!0);if(De in St&&pe in vt&&St[De]!==vt[pe]){const We=_e(De,pe,xe),si=Qt(De,pe,Dt[We].geometry);delete vt[De],delete St[pe],St[ke(Ce,Dt[si].geometry,!0)]=si,Dt[We].geometry=null}else De in St?Qt(De,pe,xe):pe in vt?_e(De,pe,xe):(ie(re),vt[De]=It-1,St[pe]=It-1)}return Dt.filter((re=>re.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Ct,vt)=>Ct.sortKey-vt.sortKey))}update(e,a,u,p){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,a,this.layers,u,p),this.icon.programConfigurations.updatePaintArrays(e,a,this.layers,u,p))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=g1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,a){const u=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:p,y}of a)this.lineVertexArray.emplaceBack(p,y);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(e,a,u,p,y,b,T,M,P,O,N,$,Z,X){const J=e.indexArray,ct=e.layoutVertexArray,yt=e.globeExtVertexArray,Ct=e.segments.prepareSegment(4*a.length,ct,J,this.canOverlap?b.sortKey:void 0),vt=this.glyphOffsetArray.length,St=Ct.vertexLength,Dt=this.allowVerticalPlacement&&T===Pa.vertical?Math.PI/2:0,It=b.text&&b.text.sections;for(let Qt=0;Qt<a.length;Qt++){const{tl:_e,tr:ke,bl:re,br:ve,tex:xe,pixelOffsetTL:Ce,pixelOffsetBR:De,minFontScaleX:pe,minFontScaleY:We,glyphOffset:si,isSDF:qe,sectionIndex:Ci}=a[Qt],ze=Ct.vertexLength,ui=si[1];if(e_(ct,P.x,P.y,_e.x,ui+_e.y,xe.x,xe.y,u,qe,Ce.x,Ce.y,pe,We),e_(ct,P.x,P.y,ke.x,ui+ke.y,xe.x+xe.w,xe.y,u,qe,De.x,Ce.y,pe,We),e_(ct,P.x,P.y,re.x,ui+re.y,xe.x,xe.y+xe.h,u,qe,Ce.x,De.y,pe,We),e_(ct,P.x,P.y,ve.x,ui+ve.y,xe.x+xe.w,xe.y+xe.h,u,qe,De.x,De.y,pe,We),M){const{x:Ai,y:Qi,z:Pi}=M.anchor,[gi,Rn,zi]=M.up;i_(yt,Ai,Qi,Pi,gi,Rn,zi),i_(yt,Ai,Qi,Pi,gi,Rn,zi),i_(yt,Ai,Qi,Pi,gi,Rn,zi),i_(yt,Ai,Qi,Pi,gi,Rn,zi),n_(e.dynamicLayoutVertexArray,Ai,Qi,Pi,Dt)}else n_(e.dynamicLayoutVertexArray,P.x,P.y,P.z,Dt);J.emplaceBack(ze,ze+1,ze+2),J.emplaceBack(ze+1,ze+2,ze+3),Ct.vertexLength+=4,Ct.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(si[0]),Qt!==a.length-1&&Ci===a[Qt+1].sectionIndex||e.programConfigurations.populatePaintArrays(ct.length,b,b.index,{},Z,X,It&&It[Ci])}const ie=M?M.anchor:P;e.placedSymbolArray.emplaceBack(ie.x,ie.y,ie.z,P.x,P.y,vt,this.glyphOffsetArray.length-vt,St,O,N,P.segment,u?u[0]:0,u?u[1]:0,p[0],p[1],T,0,!1,0,$,0)}_commitLayoutVertex(e,a,u,p,y,b,T){e.emplaceBack(a,u,p,y,b,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(e,a,u,p,y,b,T){const M=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),P=M.vertexLength,O=T.tileAnchorX,N=T.tileAnchorY;for(let Z=0;Z<4;Z++)u.collisionVertexArray.emplaceBack(0,0,0,0);u.collisionVertexArrayExt.emplaceBack(a,-e.padding,-e.padding),u.collisionVertexArrayExt.emplaceBack(a,e.padding,-e.padding),u.collisionVertexArrayExt.emplaceBack(a,e.padding,e.padding),u.collisionVertexArrayExt.emplaceBack(a,-e.padding,e.padding),this._commitLayoutVertex(u.layoutVertexArray,p,y,b,O,N,new Nt(e.x1,e.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,y,b,O,N,new Nt(e.x2,e.y1)),this._commitLayoutVertex(u.layoutVertexArray,p,y,b,O,N,new Nt(e.x2,e.y2)),this._commitLayoutVertex(u.layoutVertexArray,p,y,b,O,N,new Nt(e.x1,e.y2)),M.vertexLength+=4;const $=u.indexArray;$.emplaceBack(P,P+1),$.emplaceBack(P+1,P+2),$.emplaceBack(P+2,P+3),$.emplaceBack(P+3,P),M.primitiveLength+=4}_addTextDebugCollisionBoxes(e,a,u,p,y,b){for(let T=p;T<y;T++){const M=u.get(T),P=this.getSymbolInstanceTextSize(e,b,a,T);this._addCollisionDebugVertices(M,P,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,b)}}_addIconDebugCollisionBoxes(e,a,u,p,y,b){for(let T=p;T<y;T++){const M=u.get(T),P=this.getSymbolInstanceIconSize(e,a,b.placedIconSymbolIndex);this._addCollisionDebugVertices(M,P,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,b)}}generateCollisionDebugBuffers(e,a){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new zy(ei,Rb.members,Bs),this.iconCollisionBox=new zy(ei,Rb.members,Bs);const u=Hd(this.iconSizeData,e),p=Hd(this.textSizeData,e);for(let y=0;y<this.symbolInstances.length;y++){const b=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(p,e,a,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(p,e,a,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(u,e,a,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(u,e,a,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(e,a,u,p){const y=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:p),b=Zm(this.textSizeData,e,y)/br;return this.tilePixelRatio*b}getSymbolInstanceIconSize(e,a,u){const p=this.icon.placedSymbolArray.get(u),y=Zm(this.iconSizeData,e,p);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(e,a,u){e.emplaceBack(a,-u,-u),e.emplaceBack(a,u,-u),e.emplaceBack(a,u,u),e.emplaceBack(a,-u,u)}_updateTextDebugCollisionBoxes(e,a,u,p,y,b){for(let T=p;T<y;T++){const M=u.get(T),P=this.getSymbolInstanceTextSize(e,b,a,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,P,M.padding)}}_updateIconDebugCollisionBoxes(e,a,u,p,y,b){for(let T=p;T<y;T++){const M=u.get(T),P=this.getSymbolInstanceIconSize(e,a,b);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,P,M.padding)}}updateCollisionDebugBuffers(e,a){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const u=Hd(this.iconSizeData,e),p=Hd(this.textSizeData,e);for(let y=0;y<this.symbolInstances.length;y++){const b=this.symbolInstances.get(y);this._updateTextDebugCollisionBoxes(p,e,a,b.textBoxStartIndex,b.textBoxEndIndex,b),this._updateTextDebugCollisionBoxes(p,e,a,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._updateIconDebugCollisionBoxes(u,e,a,b.iconBoxStartIndex,b.iconBoxEndIndex,b.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(u,e,a,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,a,u,p,y,b,T,M,P){const O={};if(a<u){const{x1:N,y1:$,x2:Z,y2:X,padding:J,projectedAnchorX:ct,projectedAnchorY:yt,projectedAnchorZ:Ct,tileAnchorX:vt,tileAnchorY:St,featureIndex:Dt}=e.get(a);O.textBox={x1:N,y1:$,x2:Z,y2:X,padding:J,projectedAnchorX:ct,projectedAnchorY:yt,projectedAnchorZ:Ct,tileAnchorX:vt,tileAnchorY:St},O.textFeatureIndex=Dt}if(p<y){const{x1:N,y1:$,x2:Z,y2:X,padding:J,projectedAnchorX:ct,projectedAnchorY:yt,projectedAnchorZ:Ct,tileAnchorX:vt,tileAnchorY:St,featureIndex:Dt}=e.get(p);O.verticalTextBox={x1:N,y1:$,x2:Z,y2:X,padding:J,projectedAnchorX:ct,projectedAnchorY:yt,projectedAnchorZ:Ct,tileAnchorX:vt,tileAnchorY:St},O.verticalTextFeatureIndex=Dt}if(b<T){const{x1:N,y1:$,x2:Z,y2:X,padding:J,projectedAnchorX:ct,projectedAnchorY:yt,projectedAnchorZ:Ct,tileAnchorX:vt,tileAnchorY:St,featureIndex:Dt}=e.get(b);O.iconBox={x1:N,y1:$,x2:Z,y2:X,padding:J,projectedAnchorX:ct,projectedAnchorY:yt,projectedAnchorZ:Ct,tileAnchorX:vt,tileAnchorY:St},O.iconFeatureIndex=Dt}if(M<P){const{x1:N,y1:$,x2:Z,y2:X,padding:J,projectedAnchorX:ct,projectedAnchorY:yt,projectedAnchorZ:Ct,tileAnchorX:vt,tileAnchorY:St,featureIndex:Dt}=e.get(M);O.verticalIconBox={x1:N,y1:$,x2:Z,y2:X,padding:J,projectedAnchorX:ct,projectedAnchorY:yt,projectedAnchorZ:Ct,tileAnchorX:vt,tileAnchorY:St},O.verticalIconFeatureIndex=Dt}return O}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const u=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,a){const u=e.placedSymbolArray.get(a),p=u.vertexStartIndex+4*u.numGlyphs;for(let y=u.vertexStartIndex;y<p;y+=4)e.indexArray.emplaceBack(y,y+1,y+2),e.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const a=Math.sin(e),u=Math.cos(e),p=[],y=[],b=[];for(let T=0;T<this.symbolInstances.length;++T){b.push(T);const M=this.symbolInstances.get(T);p.push(0|Math.round(a*M.tileAnchorX+u*M.tileAnchorY)),y.push(M.featureIndex)}return b.sort(((T,M)=>p[T]-p[M]||y[M]-y[T])),b}addToSortKeyRanges(e,a){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===a?u.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const u=this.symbolInstances.get(a);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:y,leftJustifiedTextSymbolIndex:b,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:P}=u;p>=0&&this.addIndicesForPlacedSymbol(this.text,p),y>=0&&y!==p&&this.addIndicesForPlacedSymbol(this.text,y),b>=0&&b!==y&&b!==p&&this.addIndicesForPlacedSymbol(this.text,b),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M),P>=0&&this.addIndicesForPlacedSymbol(this.icon,P)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Je(Yu,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Yu.MAX_GLYPHS=65535,Yu.addDynamicAttributes=n_;const tk=new gt({"symbol-placement":new Y(le.layout_symbol["symbol-placement"]),"symbol-spacing":new Y(le.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Y(le.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new st(le.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Y(le.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Y(le.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Y(le.layout_symbol["icon-ignore-placement"]),"icon-optional":new Y(le.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Y(le.layout_symbol["icon-rotation-alignment"]),"icon-size":new st(le.layout_symbol["icon-size"]),"icon-text-fit":new Y(le.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Y(le.layout_symbol["icon-text-fit-padding"]),"icon-image":new st(le.layout_symbol["icon-image"]),"icon-rotate":new st(le.layout_symbol["icon-rotate"]),"icon-padding":new Y(le.layout_symbol["icon-padding"]),"icon-keep-upright":new Y(le.layout_symbol["icon-keep-upright"]),"icon-offset":new st(le.layout_symbol["icon-offset"]),"icon-anchor":new st(le.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Y(le.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Y(le.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Y(le.layout_symbol["text-rotation-alignment"]),"text-field":new st(le.layout_symbol["text-field"]),"text-font":new st(le.layout_symbol["text-font"]),"text-size":new st(le.layout_symbol["text-size"]),"text-max-width":new st(le.layout_symbol["text-max-width"]),"text-line-height":new st(le.layout_symbol["text-line-height"]),"text-letter-spacing":new st(le.layout_symbol["text-letter-spacing"]),"text-justify":new st(le.layout_symbol["text-justify"]),"text-radial-offset":new st(le.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Y(le.layout_symbol["text-variable-anchor"]),"text-anchor":new st(le.layout_symbol["text-anchor"]),"text-max-angle":new Y(le.layout_symbol["text-max-angle"]),"text-writing-mode":new Y(le.layout_symbol["text-writing-mode"]),"text-rotate":new st(le.layout_symbol["text-rotate"]),"text-padding":new Y(le.layout_symbol["text-padding"]),"text-keep-upright":new Y(le.layout_symbol["text-keep-upright"]),"text-transform":new st(le.layout_symbol["text-transform"]),"text-offset":new st(le.layout_symbol["text-offset"]),"text-allow-overlap":new Y(le.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Y(le.layout_symbol["text-ignore-placement"]),"text-optional":new Y(le.layout_symbol["text-optional"])});var Oy={paint:new gt({"icon-opacity":new st(le.paint_symbol["icon-opacity"]),"icon-color":new st(le.paint_symbol["icon-color"]),"icon-halo-color":new st(le.paint_symbol["icon-halo-color"]),"icon-halo-width":new st(le.paint_symbol["icon-halo-width"]),"icon-halo-blur":new st(le.paint_symbol["icon-halo-blur"]),"icon-translate":new Y(le.paint_symbol["icon-translate"]),"icon-translate-anchor":new Y(le.paint_symbol["icon-translate-anchor"]),"text-opacity":new st(le.paint_symbol["text-opacity"]),"text-color":new st(le.paint_symbol["text-color"],{runtimeType:On,getOverride:s=>s.textColor,hasOverride:s=>!!s.textColor}),"text-halo-color":new st(le.paint_symbol["text-halo-color"]),"text-halo-width":new st(le.paint_symbol["text-halo-width"]),"text-halo-blur":new st(le.paint_symbol["text-halo-blur"]),"text-translate":new Y(le.paint_symbol["text-translate"]),"text-translate-anchor":new Y(le.paint_symbol["text-translate-anchor"])}),layout:tk};class y1{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:gn,this.defaultValue=e}evaluate(e){if(e.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(e.formattedSection))return a.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Je(y1,"FormatSectionOverride",{omit:["defaultValue"]});class s_ extends Wl{constructor(e){super(e,Oy)}recalculate(e,a){super.recalculate(e,a),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const p=[];for(const y of u)p.indexOf(y)<0&&p.push(y);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,a,u,p){const y=this.layout.get(e).evaluate(a,{},u,p),b=this._unevaluatedLayout._values[e];return b.isDataDriven()||Ea(b.value)||!y?y:(function(T,M){return M.replace(/{([^{}]+)}/g,((P,O)=>O in T?String(T[O]):""))})(a.properties,y)}createBucket(e){return new Yu(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Oy.paint.overridableProperties){if(!s_.hasPaintOverride(this.layout,e))continue;const a=this.paint.get(e),u=new y1(a),p=new zl(u,a.property.specification);let y=null;y=a.value.kind==="constant"||a.value.kind==="source"?new Ol("source",p):new Do("composite",p,a.value.zoomStops,a.value._interpolationType),this.paint._values[e]=new lt(a.property,y,a.parameters)}}_handleOverridablePaintPropertyUpdate(e,a,u){return!(!this.layout||a.isDataDriven()||u.isDataDriven())&&s_.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,a){const u=e.get("text-field"),p=Oy.paint.properties[a];let y=!1;const b=T=>{for(const M of T)if(p.overrides&&p.overrides.hasOverride(M))return void(y=!0)};if(u.value.kind==="constant"&&u.value.value instanceof bs)b(u.value.value.sections);else if(u.value.kind==="source"){const T=P=>{y||(P instanceof pr&&yn(P.value)===xs?b(P.value.sections):P instanceof Ir?b(P.sections):P.eachChild(T))},M=u.value;M._styleExpression&&T(M._styleExpression.expression)}return y}getProgramConfiguration(e){return new Gu(this,e)}}var ek={paint:new gt({"background-color":new Y(le.paint_background["background-color"]),"background-pattern":new Y(le.paint_background["background-pattern"]),"background-opacity":new Y(le.paint_background["background-opacity"])})},ik={paint:new gt({"raster-opacity":new Y(le.paint_raster["raster-opacity"]),"raster-hue-rotate":new Y(le.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Y(le.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Y(le.paint_raster["raster-brightness-max"]),"raster-saturation":new Y(le.paint_raster["raster-saturation"]),"raster-contrast":new Y(le.paint_raster["raster-contrast"]),"raster-resampling":new Y(le.paint_raster["raster-resampling"]),"raster-fade-duration":new Y(le.paint_raster["raster-fade-duration"])})};class nk extends Wl{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var sk={paint:new gt({"sky-type":new Y(le.paint_sky["sky-type"]),"sky-atmosphere-sun":new Y(le.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Y(le.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Y(le.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Y(le.paint_sky["sky-gradient-radius"]),"sky-gradient":new _t(le.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Y(le.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Y(le.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Y(le.paint_sky["sky-opacity"])})};function Ry(s,e,a){const u=[0,0,1],p=B0([]);return N0(p,p,a?-ae(s)+Math.PI:ae(s)),F0(p,p,-ae(e)),D0(u,u,p),lo(u,u)}const rk={circle:class extends Wl{constructor(s){super(s,_A)}createBucket(s){return new ly(s)}queryRadius(s){const e=s;return $d("circle-radius",this,e)+$d("circle-stroke-width",this,e)+zm(this.paint.get("circle-translate"))}queryIntersectsFeature(s,e,a,u,p,y,b,T){const M=ab(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,s.pixelToTileUnitsFactor),P=this.paint.get("circle-radius").evaluate(e,a)+this.paint.get("circle-stroke-width").evaluate(e,a);return lb(s,u,y,b,T,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",M,P)}getProgramIds(){return["circle"]}getProgramConfiguration(s){return new Gu(this,s)}},heatmap:class extends Wl{createBucket(s){return new ub(s)}constructor(s){super(s,xA),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=dy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(s){return $d("heatmap-radius",this,s)}queryIntersectsFeature(s,e,a,u,p,y,b,T){const M=this.paint.get("heatmap-radius").evaluate(e,a);return lb(s,u,y,b,T,!0,!0,new Nt(0,0),M)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(s){return new Gu(this,s)}},hillshade:class extends Wl{constructor(s){super(s,bA)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Wl{constructor(s){super(s,BA)}getProgramIds(){const s=this.paint.get("fill-pattern"),e=s&&s.constantOr(1),a=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getProgramConfiguration(s){return new Gu(this,s)}recalculate(s,e){super.recalculate(s,e);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(s){return new Nm(s)}queryRadius(){return zm(this.paint.get("fill-translate"))}queryIntersectsFeature(s,e,a,u,p,y){return!s.queryGeometry.isAboveHorizon&&ib(ob(s.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,s.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}},"fill-extrusion":class extends Wl{constructor(s){super(s,QA)}createBucket(s){return new Qf(s)}queryRadius(){return zm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(s){return new Gu(this,s)}queryIntersectsFeature(s,e,a,u,p,y,b,T,M){const P=ab(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,s.pixelToTileUnitsFactor),O=this.paint.get("fill-extrusion-height").evaluate(e,a),N=this.paint.get("fill-extrusion-base").evaluate(e,a),$=[0,0],Z=T&&y.elevation,X=y.elevation?y.elevation.exaggeration():1,J=s.tile.getBucket(this);if(Z&&J instanceof Qf){const St=J.centroidVertexArray,Dt=M+1;Dt<St.length&&($[0]=St.geta_centroid_pos0(Dt),$[1]=St.geta_centroid_pos1(Dt))}if($[0]===0&&$[1]===1)return!1;y.projection.name==="globe"&&(u=Ab([u],[new Nt(0,0),new Nt(di,di)],s.tileID.canonical).map((St=>St.polygon)).flat());const ct=Z?T:null,[yt,Ct]=(function(St,Dt,It,ie,Qt,_e,ke,re,ve,xe,Ce){return St.projection.name==="globe"?(function(De,pe,We,si,qe,Ci,ze,ui,Ai,Qi,Pi){const gi=[],Rn=[],zi=De.projection.upVectorScale(Pi,De.center.lat,De.worldSize).metersToTile,Oi=[0,0,0,1],wn=[0,0,0,1],kn=(Tn,Yn,hs,Ss)=>{Tn[0]=Yn,Tn[1]=hs,Tn[2]=Ss,Tn[3]=1},In=Cb();We>0&&(We+=In),si+=In;for(const Tn of pe){const Yn=[],hs=[];for(const Ss of Tn){const En=Ss.x+qe.x,Fs=Ss.y+qe.y,Ms=De.projection.projectTilePoint(En,Fs,Pi),rs=De.projection.upVector(Pi,Ss.x,Ss.y);let nn=We,Cs=si;if(ze){const Ln=Lb(En,Fs,We,si,ze,ui,Ai,Qi);nn+=Ln.base,Cs+=Ln.top}We!==0?kn(Oi,Ms.x+rs[0]*zi*nn,Ms.y+rs[1]*zi*nn,Ms.z+rs[2]*zi*nn):kn(Oi,Ms.x,Ms.y,Ms.z),kn(wn,Ms.x+rs[0]*zi*Cs,Ms.y+rs[1]*zi*Cs,Ms.z+rs[2]*zi*Cs),ms(Oi,Oi,Ci),ms(wn,wn,Ci),Yn.push(new Gd(Oi[0],Oi[1],Oi[2])),hs.push(new Gd(wn[0],wn[1],wn[2]))}gi.push(Yn),Rn.push(hs)}return[gi,Rn]})(St,Dt,It,ie,Qt,_e,ke,re,ve,xe,Ce):ke?(function(De,pe,We,si,qe,Ci,ze,ui,Ai){const Qi=[],Pi=[],gi=[0,0,0,1];for(const Rn of De){const zi=[],Oi=[];for(const wn of Rn){const kn=wn.x+si.x,In=wn.y+si.y,Tn=Lb(kn,In,pe,We,Ci,ze,ui,Ai);gi[0]=kn,gi[1]=In,gi[2]=Tn.base,gi[3]=1,jh(gi,gi,qe),gi[3]=Math.max(gi[3],1e-5);const Yn=new Gd(gi[0]/gi[3],gi[1]/gi[3],gi[2]/gi[3]);gi[0]=kn,gi[1]=In,gi[2]=Tn.top,gi[3]=1,jh(gi,gi,qe),gi[3]=Math.max(gi[3],1e-5);const hs=new Gd(gi[0]/gi[3],gi[1]/gi[3],gi[2]/gi[3]);zi.push(Yn),Oi.push(hs)}Qi.push(zi),Pi.push(Oi)}return[Qi,Pi]})(Dt,It,ie,Qt,_e,ke,re,ve,xe):(function(De,pe,We,si,qe){const Ci=[],ze=[],ui=qe[8]*pe,Ai=qe[9]*pe,Qi=qe[10]*pe,Pi=qe[11]*pe,gi=qe[8]*We,Rn=qe[9]*We,zi=qe[10]*We,Oi=qe[11]*We;for(const wn of De){const kn=[],In=[];for(const Tn of wn){const Yn=Tn.x+si.x,hs=Tn.y+si.y,Ss=qe[0]*Yn+qe[4]*hs+qe[12],En=qe[1]*Yn+qe[5]*hs+qe[13],Fs=qe[2]*Yn+qe[6]*hs+qe[14],Ms=qe[3]*Yn+qe[7]*hs+qe[15],rs=Ss+ui,nn=En+Ai,Cs=Fs+Qi,Ln=Math.max(Ms+Pi,1e-5),ho=Ss+gi,As=En+Rn,wr=Fs+zi,sr=Math.max(Ms+Oi,1e-5);kn.push(new Gd(rs/Ln,nn/Ln,Cs/Ln)),In.push(new Gd(ho/sr,As/sr,wr/sr))}Ci.push(kn),ze.push(In)}return[Ci,ze]})(Dt,It,ie,Qt,_e)})(y,u,N,O,P,b,ct,$,X,y.center.lat,s.tileID.canonical),vt=s.queryGeometry;return(function(St,Dt,It){let ie=1/0;ib(It,Dt)&&(ie=Ib(It,Dt[0]));for(let Qt=0;Qt<Dt.length;Qt++){const _e=Dt[Qt],ke=St[Qt];for(let re=0;re<_e.length-1;re++){const ve=_e[re],xe=[ve,_e[re+1],ke[re+1],ke[re],ve];eb(It,xe)&&(ie=Math.min(ie,Ib(It,xe)))}}return ie!==1/0&&ie})(yt,Ct,vt.isPointQuery()?vt.screenBounds:vt.screenGeometry)}},line:class extends Wl{constructor(s){super(s,Db),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(s){if(s==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof eo,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(s,e){super.recalculate(s,e),this.paint._values["line-floorwidth"]=zb.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,s)}createBucket(s){return new Wm(s)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(s){return new Gu(this,s)}queryRadius(s){const e=s,a=Ob($d("line-width",this,e),$d("line-gap-width",this,e)),u=$d("line-offset",this,e);return a/2+Math.abs(u)+zm(this.paint.get("line-translate"))}queryIntersectsFeature(s,e,a,u,p,y){if(s.queryGeometry.isAboveHorizon)return!1;const b=ob(s.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,s.pixelToTileUnitsFactor),T=s.pixelToTileUnitsFactor/2*Ob(this.paint.get("line-width").evaluate(e,a),this.paint.get("line-gap-width").evaluate(e,a)),M=this.paint.get("line-offset").evaluate(e,a);return M&&(u=(function(P,O){const N=[],$=new Nt(0,0);for(let Z=0;Z<P.length;Z++){const X=P[Z],J=[];for(let ct=0;ct<X.length;ct++){const yt=X[ct],Ct=X[ct+1],vt=ct===0?$:yt.sub(X[ct-1])._unit()._perp(),St=ct===X.length-1?$:Ct.sub(yt)._unit()._perp(),Dt=vt._add(St)._unit();Dt._mult(1/(Dt.x*St.x+Dt.y*St.y)),J.push(Dt._mult(O)._add(yt))}N.push(J)}return N})(u,M*s.pixelToTileUnitsFactor)),(function(P,O,N){for(let $=0;$<O.length;$++){const Z=O[$];if(P.length>=3){for(let X=0;X<Z.length;X++)if(Wh(P,Z[X]))return!0}if(dA(P,Z,N))return!0}return!1})(b,u,T)}isTileClipped(){return!0}},symbol:s_,background:class extends Wl{constructor(s){super(s,ek)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Wl{constructor(s){super(s,ik)}getProgramIds(){return["raster"]}},sky:class extends Wl{constructor(s){super(s,sk),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(s){s==="sky-gradient"?this._updateColorRamp():s!=="sky-atmosphere-sun"&&s!=="sky-atmosphere-halo-color"&&s!=="sky-atmosphere-color"&&s!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=dy({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(s){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=s.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(s,e){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),p=!u,y=s.style.light,b=y.properties.get("position");return p&&y.properties.get("anchor")==="viewport"&&me("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?Ry(b.azimuthal,90-b.polar,e):Ry(u[0],90-u[1],e)}const a=this.paint.get("sky-gradient-center");return Ry(a[0],90-a[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(s){this._skyboxInvalidated=!1,this._lightPosition=s.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const s=this.paint.get("sky-type");return s==="atmosphere"?["skyboxCapture","skybox"]:s==="gradient"?["skyboxGradient"]:null}}};class up{constructor(e,a,u,p){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(a,p)}update(e,a,u){const{width:p,height:y}=e,{context:b}=this,{gl:T}=b,{HTMLImageElement:M,HTMLCanvasElement:P,HTMLVideoElement:O,ImageData:N,ImageBitmap:$}=E;if(T.bindTexture(T.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!a||a.premultiply!==!1)),u||this.size&&this.size[0]===p&&this.size[1]===y){const{x:Z,y:X}=u||{x:0,y:0};e instanceof M||e instanceof P||e instanceof O||e instanceof N||$&&e instanceof $?T.texSubImage2D(T.TEXTURE_2D,0,Z,X,T.RGBA,T.UNSIGNED_BYTE,e):T.texSubImage2D(T.TEXTURE_2D,0,Z,X,p,y,T.RGBA,T.UNSIGNED_BYTE,e.data)}else this.size=[p,y],e instanceof M||e instanceof P||e instanceof O||e instanceof N||$&&e instanceof $?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,e):T.texImage2D(T.TEXTURE_2D,0,this.format,p,y,0,this.format,T.UNSIGNED_BYTE,e.data);this.useMipmap=!!(a&&a.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&T.generateMipmap(T.TEXTURE_2D)}bind(e,a){const{context:u}=this,{gl:p}=u;p.bindTexture(p.TEXTURE_2D,this.texture),e!==this.filter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,e),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap?e===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_NEAREST:e),this.filter=e),a!==this.wrap&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,a),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class ok{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class ak{constructor(){this.tasks={},this.taskQueue=[],_n(["process"],this),this.invoker=new ok(this.process),this.nextId=0}add(e,a){const u=this.nextId++,p=(function({type:y,isSymbolTile:b,zoom:T}){return T=T||0,y==="message"?0:y!=="maybePrepare"||b?y!=="parseTile"||b?y==="parseTile"&&b?300-T:y==="maybePrepare"&&b?400-T:500:200-T:100-T})(a);if(p===0){$e();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[u]={fn:e,metadata:a,priority:p,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){$e();try{if(this.taskQueue=this.taskQueue.filter((u=>!!this.tasks[u])),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const a=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let e=null,a=1/0;for(let p=0;p<this.taskQueue.length;p++){const y=this.tasks[this.taskQueue[p]];y.priority<a&&(a=y.priority,e=p)}if(e===null)return null;const u=this.taskQueue[e];return this.taskQueue.splice(e,1),u}remove(){this.invoker.remove()}}class v1{constructor(e){this._stringToNumber={},this._numberToString=[];for(let a=0;a<e.length;a++){const u=e[a];this._stringToNumber[u]=a,this._numberToString[a]=u}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const lk=["tile","layer","source","sourceLayer","state"];class x1{constructor(e,a,u,p,y){this.type="Feature",this._vectorTileFeature=e,this._z=a,this._x=u,this._y=p,this.properties=e.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const a of lk)this[a]!==void 0&&(e[a]=this[a]);return e}}const cl=32,Mc=33,Ju=new Uint16Array(8184);for(let s=0;s<2046;s++){let e=s+2,a=0,u=0,p=0,y=0,b=0,T=0;for(1&e?p=y=b=cl:a=u=T=cl;(e>>=1)>1;){const P=a+p>>1,O=u+y>>1;1&e?(p=a,y=u,a=b,u=T):(a=p,u=y,p=b,y=T),b=P,T=O}const M=4*s;Ju[M+0]=a,Ju[M+1]=u,Ju[M+2]=p,Ju[M+3]=y}const Cc=new Uint16Array(2178),Qu=new Uint8Array(1089),r_=new Uint16Array(1089);function b1(s){return s===0?-.03125:s===32?.03125:0}var w1=Ut([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const T1={type:2,extent:di,loadGeometry:()=>[[new Nt(0,0),new Nt(di+1,0),new Nt(di+1,di+1),new Nt(0,di+1),new Nt(0,0)]]};class By{constructor(e,a,u,p,y){this.tileID=e,this.uid=ri(),this.uses=0,this.tileSize=a,this.tileZoom=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=y,this.expiredRequestCount=0,this.state="loading",p&&p.transform&&(this.projection=p.transform.projection)}registerFadeDuration(e){const a=e+this.timeAdded;a<Vr.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Gh(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,a,u){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=(function(p,y){const b={};if(!y)return b;for(const T of p){const M=T.layerIds.map((P=>y.getLayer(P))).filter(Boolean);if(M.length!==0){T.layers=M,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map((P=>M.filter((O=>O.id===P))[0])));for(const P of M)b[P.id]=T}}return b})(e.buckets,a.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const y=this.buckets[p];if(y instanceof Yu){if(this.hasSymbolBuckets=!0,!u)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const y=this.buckets[p];if(y instanceof Yu&&y.hasRTLText){this.hasRTLText=!0,I.isLoading()||I.isLoaded()||S()!=="deferred"||k();break}}this.queryPadding=0;for(const p in this.buckets){const y=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(p).queryRadius(y))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new dn}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const u in this.buckets){const p=this.buckets[u];p.uploadPending()&&p.upload(e)}const a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new up(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new up(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new up(e,this.lineAtlas.image,a.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,a,u,p,y,b,T,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:T,transform:b,params:y,tileTransform:this.tileTransform},e,a,u):{}}querySourceFeatures(e,a){const u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;const p=u.loadVTLayers(),y=a?a.sourceLayer:"",b=p._geojsonTileLayer||p[y];if(!b)return;const T=ni(a&&a.filter),{z:M,x:P,y:O}=this.tileID.canonical,N={z:M,x:P,y:O};for(let $=0;$<b.length;$++){const Z=b.feature($);if(T.needGeometry){const ct=$h(Z,!0);if(!T.filter(new B(this.tileID.overscaledZ),ct,this.tileID.canonical))continue}else if(!T.filter(new B(this.tileID.overscaledZ),Z))continue;const X=u.getId(Z,y),J=new x1(Z,M,P,O,X);J.tile=N,e.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const a=this.expirationTime;if(e.cacheControl){const u=Ne(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const u=Date.now();let p=!1;if(this.expirationTime>u)p=!1;else if(a)if(this.expirationTime<a)p=!0;else{const y=this.expirationTime-a;y?this.expirationTime=u+Math.max(y,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0||!a)return;const u=this.latestFeatureIndex.loadVTLayers(),p=a.style.listImages();for(const y in this.buckets){if(!a.style.hasLayer(y))continue;const b=this.buckets[y],T=b.layers[0].sourceLayer||"_geojsonTileLayer",M=u[T],P=e[T];if(!M||!P||Object.keys(P).length===0)continue;if(b.update(P,M,p,this.imageAtlas&&this.imageAtlas.patternPositions||{}),b instanceof Wm||b instanceof Nm){const N=a.style._getSourceCache(b.layers[0].source);a._terrain&&a._terrain.enabled&&N&&b.programConfigurations.needsUpload&&a._terrain._clearRenderCacheForTile(N.id,this.tileID)}const O=a&&a.style&&a.style.getLayer(y);O&&(this.queryPadding=Math.max(this.queryPadding,O.queryRadius(b)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Vr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Vr.now()+e}setTexture(e,a){const u=a.context,p=u.gl;this.texture=this.texture||a.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new up(u,e,p.RGBA,{useMipmap:!0}),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE))}setDependencies(e,a){const u={};for(const p of a)u[p]=!0;this.dependencies[e]=u}hasDependency(e,a){for(const u of e){const p=this.dependencies[u];if(p){for(const y of a)if(p[y])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,a){if(!a||a.name==="mercator"||this._tileDebugBuffer)return;const u=fu(T1,this.tileID.canonical,this.tileTransform)[0],p=new Te,y=new ao;for(let b=0;b<u.length;b++){const{x:T,y:M}=u[b];p.emplaceBack(T,M),y.emplaceBack(b)}y.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(y),this._tileDebugBuffer=e.createVertexBuffer(p,Uf.members),this._tileDebugSegments=Ts.simpleSegment(0,0,p.length,y.length)}_makeTileBoundsBuffers(e,a){if(this._tileBoundsBuffer||!a||a.name==="mercator")return;const u=fu(T1,this.tileID.canonical,this.tileTransform)[0];let p,y;if(this.isRaster){const b=(function(T,M){const P=Gh(T,M),O=Math.pow(2,T.z);for(let ct=0;ct<Mc;ct++)for(let yt=0;yt<Mc;yt++){const Ct=Aa((T.x+(yt+b1(yt))/cl)/O),vt=Rr((T.y+(ct+b1(ct))/cl)/O),St=M.project(Ct,vt),Dt=ct*Mc+yt;Cc[2*Dt+0]=Math.round((St.x*P.scale-P.x)*di),Cc[2*Dt+1]=Math.round((St.y*P.scale-P.y)*di)}Qu.fill(0),r_.fill(0);for(let ct=2045;ct>=0;ct--){const yt=4*ct,Ct=Ju[yt+0],vt=Ju[yt+1],St=Ju[yt+2],Dt=Ju[yt+3],It=Ct+St>>1,ie=vt+Dt>>1,Qt=It+ie-vt,_e=ie+Ct-It,ke=vt*Mc+Ct,re=Dt*Mc+St,ve=ie*Mc+It,xe=Math.hypot((Cc[2*ke+0]+Cc[2*re+0])/2-Cc[2*ve+0],(Cc[2*ke+1]+Cc[2*re+1])/2-Cc[2*ve+1])>=16;Qu[ve]=Qu[ve]||(xe?1:0),ct<1022&&(Qu[ve]=Qu[ve]||Qu[(vt+_e>>1)*Mc+(Ct+Qt>>1)]||Qu[(Dt+_e>>1)*Mc+(St+Qt>>1)])}const N=new fe,$=new oi;let Z=0;function X(ct,yt){const Ct=yt*Mc+ct;return r_[Ct]===0&&(N.emplaceBack(Cc[2*Ct+0],Cc[2*Ct+1],ct*di/cl,yt*di/cl),r_[Ct]=++Z),r_[Ct]-1}function J(ct,yt,Ct,vt,St,Dt){const It=ct+Ct>>1,ie=yt+vt>>1;if(Math.abs(ct-St)+Math.abs(yt-Dt)>1&&Qu[ie*Mc+It])J(St,Dt,ct,yt,It,ie),J(Ct,vt,St,Dt,It,ie);else{const Qt=X(ct,yt),_e=X(Ct,vt),ke=X(St,Dt);$.emplaceBack(Qt,_e,ke)}}return J(0,0,cl,cl,cl,0),J(cl,cl,0,0,0,cl),{vertices:N,indices:$}})(this.tileID.canonical,a);p=b.vertices,y=b.indices}else{p=new fe,y=new oi;for(const{x:T,y:M}of u)p.emplaceBack(T,M,0,0);const b=gy(p.int16,void 0,4);for(let T=0;T<b.length;T+=3)y.emplaceBack(b[T],b[T+1],b[T+2])}this._tileBoundsBuffer=e.createVertexBuffer(p,w1.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(y),this._tileBoundsSegments=Ts.simpleSegment(0,0,p.length,y.length)}_makeGlobeTileDebugBuffers(e,a){const u=a.projection;if(!u||u.name!=="globe"||a.freezeTileCoverage)return;const p=this.tileID.canonical,y=Zf(W0(p,a)),b=Vd(a.zoom);let T;b>0&&(T=Zg(new Float64Array(16),a.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,p,a,y,T,b),this._makeGlobeTileDebugTextBuffer(e,p,a,y,T,b)}_globePoint(e,a,u,p,y,b,T){let M=Wf(e,a,u);if(b){const P=1<<u.z,O=Ec(p.center.lng),N=Sc(p.center.lat),$=(u.x+.5)/P-O;let Z=0;$>.5?Z=-1:$<-.5&&(Z=1);let X=(e/di+u.x)/P+Z,J=(a/di+u.y)/P;X=(X-O)*p._pixelsPerMercatorPixel+O,J=(J-N)*p._pixelsPerMercatorPixel+N;const ct=[X*p.worldSize,J*p.worldSize,0];ms(ct,ct,b),M=Uh(M,ct,T)}return ms(M,M,y)}_makeGlobeTileDebugBorderBuffer(e,a,u,p,y,b){const T=new Te,M=new ao,P=new Gt,O=($,Z,X,J,ct)=>{const yt=(X-$)/(ct-1),Ct=(J-Z)/(ct-1),vt=T.length;for(let St=0;St<ct;St++){const Dt=$+St*yt,It=Z+St*Ct;T.emplaceBack(Dt,It);const ie=this._globePoint(Dt,It,a,u,p,y,b);P.emplaceBack(ie[0],ie[1],ie[2]),M.emplaceBack(vt+St)}},N=di;O(0,0,N,0,16),O(N,0,N,N,16),O(N,N,0,N,16),O(0,N,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(M),this._tileDebugBuffer=e.createVertexBuffer(T,Uf.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(P,V0.members),this._tileDebugSegments=Ts.simpleSegment(0,0,T.length,M.length)}_makeGlobeTileDebugTextBuffer(e,a,u,p,y,b){const T=di/4,M=new Te,P=new oi,O=new Gt,N=25;P.reserve(32),M.reserve(N),O.reserve(N);const $=(Z,X)=>N*Z+X;for(let Z=0;Z<N;Z++){const X=Z*T;for(let J=0;J<N;J++){const ct=J*T;M.emplaceBack(ct,X);const yt=this._globePoint(ct,X,a,u,p,y,b);O.emplaceBack(yt[0],yt[1],yt[2])}}for(let Z=0;Z<4;Z++)for(let X=0;X<4;X++){const J=$(Z,X),ct=$(Z,X+1),yt=$(Z+1,X),Ct=$(Z+1,X+1);P.emplaceBack(J,ct,yt),P.emplaceBack(yt,ct,Ct)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(P),this._tileDebugTextBuffer=e.createVertexBuffer(M,Uf.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(O,V0.members),this._tileDebugTextSegments=Ts.simpleSegment(0,0,N,32)}}class ck{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,a,u){const p=String(a);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][p]=this.stateChanges[e][p]||{},je(this.stateChanges[e][p],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(const y in this.state[e])y!==p&&(this.deletedStates[e][y]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][p]===null){this.deletedStates[e][p]={};for(const y in this.state[e][p])u[y]||(this.deletedStates[e][p][y]=null)}else for(const y in u)this.deletedStates[e]&&this.deletedStates[e][p]&&this.deletedStates[e][p][y]===null&&delete this.deletedStates[e][p][y]}removeFeatureState(e,a,u){if(this.deletedStates[e]===null)return;const p=String(a);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&a!==void 0)this.deletedStates[e][p]!==null&&(this.deletedStates[e][p]=this.deletedStates[e][p]||{},this.deletedStates[e][p][u]=null);else if(a!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][p])for(u in this.deletedStates[e][p]={},this.stateChanges[e][p])this.deletedStates[e][p][u]=null;else this.deletedStates[e][p]=null;else this.deletedStates[e]=null}getState(e,a){const u=String(a),p=je({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const y=this.deletedStates[e][a];if(y===null)return{};for(const b in y)delete p[b]}return p}initializeTileState(e,a){e.setFeatureState(this.state,a)}coalesceChanges(e,a){const u={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const y={};for(const b in this.stateChanges[p])this.state[p][b]||(this.state[p][b]={}),je(this.state[p][b],this.stateChanges[p][b]),y[b]=this.state[p][b];u[p]=y}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const y={};if(this.deletedStates[p]===null)for(const b in this.state[p])y[b]={},this.state[p][b]={};else for(const b in this.deletedStates[p]){if(this.deletedStates[p][b]===null)this.state[p][b]={};else if(this.state[p][b])for(const T of Object.keys(this.deletedStates[p][b]))delete this.state[p][b][T];y[b]=this.state[p][b]}u[p]=u[p]||{},je(u[p],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(const p in e)e[p].setFeatureState(u,a)}}class E1{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,a){const u=this.toIdx(e,a);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(e,a){return this.leaves[this.toIdx(e,a)]}toIdx(e,a){return a*this.size+e}}function S1(s,e,a,u){let p=0,y=Number.MAX_VALUE;for(let b=0;b<3;b++)if(Math.abs(u[b])<1e-15){if(a[b]<s[b]||a[b]>e[b])return null}else{const T=1/u[b];let M=(s[b]-a[b])*T,P=(e[b]-a[b])*T;if(M>P){const O=M;M=P,P=O}if(M>p&&(p=M),P<y&&(y=P),p>y)return null}return p}function M1(s,e,a,u,p,y,b,T,M,P,O){const N=u-s,$=p-e,Z=y-a,X=b-s,J=T-e,ct=M-a,yt=O[1]*ct-O[2]*J,Ct=O[2]*X-O[0]*ct,vt=O[0]*J-O[1]*X,St=N*yt+$*Ct+Z*vt;if(Math.abs(St)<1e-15)return null;const Dt=1/St,It=P[0]-s,ie=P[1]-e,Qt=P[2]-a,_e=(It*yt+ie*Ct+Qt*vt)*Dt;if(_e<0||_e>1)return null;const ke=ie*Z-Qt*$,re=Qt*N-It*Z,ve=It*$-ie*N,xe=(O[0]*ke+O[1]*re+O[2]*ve)*Dt;return xe<0||_e+xe>1?null:(X*ke+J*re+ct*ve)*Dt}function C1(s,e,a){return(s-e)/(a-e)}function A1(s,e,a,u,p,y,b,T,M){const P=1<<a,O=y-u,N=b-p,$=(s+1)/P*O+u,Z=(e+0)/P*N+p,X=(e+1)/P*N+p;T[0]=(s+0)/P*O+u,T[1]=Z,M[0]=$,M[1]=X}class P1{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=(function(y){const b=Math.ceil(Math.log2(y.dim/8)),T=[];let M=Math.ceil(Math.pow(2,b));const P=1/M,O=(Z,X,J,ct,yt)=>{const Ct=ct?1:0,vt=(Z+1)*J-Ct,St=X*J,Dt=(X+1)*J-Ct;yt[0]=Z*J,yt[1]=St,yt[2]=vt,yt[3]=Dt};let N=new E1(M);const $=[];for(let Z=0;Z<M*M;Z++){O(Z%M,Math.floor(Z/M),P,!1,$);const X=th($[0],$[1],y),J=th($[2],$[1],y),ct=th($[2],$[3],y),yt=th($[0],$[3],y);N.minimums.push(Math.min(X,J,ct,yt)),N.maximums.push(Math.max(X,J,ct,yt)),N.leaves.push(1)}for(T.push(N),M/=2;M>=1;M/=2){const Z=T[T.length-1];N=new E1(M);for(let X=0;X<M*M;X++){O(X%M,Math.floor(X/M),2,!0,$);const J=Z.getElevation($[0],$[1]),ct=Z.getElevation($[2],$[1]),yt=Z.getElevation($[2],$[3]),Ct=Z.getElevation($[0],$[3]),vt=Z.isLeaf($[0],$[1]),St=Z.isLeaf($[2],$[1]),Dt=Z.isLeaf($[2],$[3]),It=Z.isLeaf($[0],$[3]),ie=Math.min(J.min,ct.min,yt.min,Ct.min),Qt=Math.max(J.max,ct.max,yt.max,Ct.max),_e=vt&&St&&Dt&&It;N.maximums.push(Qt),N.minimums.push(ie),N.leaves.push(Qt-ie<=5&&_e?1:0)}T.push(N)}return T})(this.dem),u=a.length-1,p=a[u];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(a,0,0,u,0)}raycastRoot(e,a,u,p,y,b,T=1){return S1([e,a,-100],[u,p,this.maximums[0]*T],y,b)}raycast(e,a,u,p,y,b,T=1){if(!this.nodeCount)return null;const M=this.raycastRoot(e,a,u,p,y,b,T);if(M==null)return null;const P=[],O=[],N=[],$=[],Z=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;Z.length>0;){const{idx:X,t:J,nodex:ct,nodey:yt,depth:Ct}=Z.pop();if(this.leaves[X]){A1(ct,yt,Ct,e,a,u,p,N,$);const St=1<<Ct,Dt=(ct+0)/St,It=(ct+1)/St,ie=(yt+0)/St,Qt=(yt+1)/St,_e=th(Dt,ie,this.dem)*T,ke=th(It,ie,this.dem)*T,re=th(It,Qt,this.dem)*T,ve=th(Dt,Qt,this.dem)*T,xe=M1(N[0],N[1],_e,$[0],N[1],ke,$[0],$[1],re,y,b),Ce=M1($[0],$[1],re,N[0],$[1],ve,N[0],N[1],_e,y,b),De=Math.min(xe!==null?xe:Number.MAX_VALUE,Ce!==null?Ce:Number.MAX_VALUE);if(De!==Number.MAX_VALUE)return De;{const pe=jf([],y,b,J);if(k1(_e,ke,ve,re,C1(pe[0],N[0],$[0]),C1(pe[1],N[1],$[1]))>=pe[2])return J}continue}let vt=0;for(let St=0;St<this._siblingOffset.length;St++){A1((ct<<1)+this._siblingOffset[St][0],(yt<<1)+this._siblingOffset[St][1],Ct+1,e,a,u,p,N,$),N[2]=-100,$[2]=this.maximums[this.childOffsets[X]+St]*T;const Dt=S1(N,$,y,b);if(Dt!=null){const It=Dt;P[St]=It;let ie=!1;for(let Qt=0;Qt<vt&&!ie;Qt++)It>=P[O[Qt]]&&(O.splice(Qt,0,St),ie=!0);ie||(O[vt]=St),vt++}}for(let St=0;St<vt;St++){const Dt=O[St];Z.push({idx:this.childOffsets[X]+Dt,t:P[Dt],nodex:(ct<<1)+this._siblingOffset[Dt][0],nodey:(yt<<1)+this._siblingOffset[Dt][1],depth:Ct+1})}}return null}_addNode(e,a,u){return this.minimums.push(e),this.maximums.push(a),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(e,a,u,p,y){if(e[p].isLeaf(a,u)===1)return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const b=p-1,T=e[b];let M=0,P=0;for(let O=0;O<this._siblingOffset.length;O++){const N=2*a+this._siblingOffset[O][0],$=2*u+this._siblingOffset[O][1],Z=T.getElevation(N,$),X=T.isLeaf(N,$),J=this._addNode(Z.min,Z.max,X);X&&(M|=1<<O),P||(P=J)}for(let O=0;O<this._siblingOffset.length;O++)M&1<<O||this._construct(e,2*a+this._siblingOffset[O][0],2*u+this._siblingOffset[O][1],b,P+O)}}function k1(s,e,a,u,p,y){return Hi(Hi(s,a,y),Hi(e,u,y),p)}function th(s,e,a){const u=a.dim,p=Oe(s*u-.5,0,u-1),y=Oe(e*u-.5,0,u-1),b=Math.floor(p),T=Math.floor(y),M=Math.min(b+1,u-1),P=Math.min(T+1,u-1);return k1(a.get(b,T),a.get(M,T),a.get(b,P),a.get(M,P),p-b,y-T)}const I1={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function uk(s,e,a){return(256*s*256+256*e+a)/10-1e4}function hk(s,e,a){return 256*s+e+a/256-32768}class o_{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,a,u,p=!1,y=!1){if(this.uid=e,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return me(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const b=this.dim=a.height-2,T=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.encoding=u||"mapbox",this.borderReady=p,!p){for(let M=0;M<b;M++)T[this._idx(-1,M)]=T[this._idx(0,M)],T[this._idx(b,M)]=T[this._idx(b-1,M)],T[this._idx(M,-1)]=T[this._idx(M,0)],T[this._idx(M,b)]=T[this._idx(M,b-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(b,-1)]=T[this._idx(b-1,0)],T[this._idx(-1,b)]=T[this._idx(0,b-1)],T[this._idx(b,b)]=T[this._idx(b-1,b-1)],y&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new P1(this)}get(e,a,u=!1){u&&(e=Oe(e,-1,this.dim),a=Oe(a,-1,this.dim));const p=4*this._idx(e,a);return(this.encoding==="terrarium"?hk:uk)(this.pixels[p],this.pixels[p+1],this.pixels[p+2])}static getUnpackVector(e){return I1[e]}get unpackVector(){return I1[this.encoding]}_idx(e,a){if(e<-1||e>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(e+1)}static pack(e,a){const u=[0,0,0,0],p=o_.getUnpackVector(a);let y=Math.floor((e+p[3])/p[2]);return u[2]=y%256,y=Math.floor(y/256),u[1]=y%256,y=Math.floor(y/256),u[0]=y,u}getPixels(){return new sa({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,a,u){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let p=a*this.dim,y=a*this.dim+this.dim,b=u*this.dim,T=u*this.dim+this.dim;switch(a){case-1:p=y-1;break;case 1:y=p+1}switch(u){case-1:b=T-1;break;case 1:T=b+1}const M=-a*this.dim,P=-u*this.dim;for(let O=b;O<T;O++)for(let N=p;N<y;N++){const $=4*this._idx(N,O),Z=4*this._idx(N+M,O+P);this.pixels[$+0]=e.pixels[Z+0],this.pixels[$+1]=e.pixels[Z+1],this.pixels[$+2]=e.pixels[Z+2],this.pixels[$+3]=e.pixels[Z+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Je(o_,"DEMData"),Je(P1,"DemMinMaxQuadTree",{omit:["dem"]});class dk{constructor(e,a){this.max=e,this.onRemove=a,this.reset()}reset(){for(const e in this.data)for(const a of this.data[e])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(e,a,u){const p=e.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const y={value:a,timeout:void 0};if(u!==void 0&&(y.timeout=setTimeout((()=>{this.remove(e,y)}),u)),this.data[p].push(y),this.order.push(p),this.order.length>this.max){const b=this._getAndRemoveByKey(this.order[0]);b&&this.onRemove(b)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const a=this.data[e].shift();return a.timeout&&clearTimeout(a.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),a.value}getByKey(e){const a=this.data[e];return a?a[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,a){if(!this.has(e))return this;const u=e.wrapped().key,p=a===void 0?0:this.data[u].indexOf(a),y=this.data[u][p];return this.data[u].splice(p,1),y.timeout&&clearTimeout(y.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(y.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(e){const a=[];for(const u in this.data)for(const p of this.data[u])e(p.value)||a.push(p);for(const u of a)this.remove(u.value.tileID,u)}}class nf{constructor(e,a,u){this.func=e,this.mask=a,this.range=u}}nf.ReadOnly=!1,nf.ReadWrite=!0,nf.disabled=new nf(519,nf.ReadOnly,[0,1]);const Fy=7680;class Ny{constructor(e,a,u,p,y,b){this.test=e,this.ref=a,this.mask=u,this.fail=p,this.depthFail=y,this.pass=b}}Ny.disabled=new Ny({func:519,mask:0},0,0,Fy,Fy,Fy);class Ac{constructor(e,a,u){this.blendFunction=e,this.blendColor=a,this.mask=u}}Ac.Replace=[1,0],Ac.disabled=new Ac(Ac.Replace,Xi.transparent,[!1,!1,!1,!1]),Ac.unblended=new Ac(Ac.Replace,Xi.transparent,[!0,!0,!0,!0]),Ac.alphaBlended=new Ac([1,771],Xi.transparent,[!0,!0,!0,!0]);const jy=1029,Vy=2305;class Kl{constructor(e,a,u){this.enable=e,this.mode=a,this.frontFace=u}}Kl.disabled=new Kl(!1,jy,Vy),Kl.backCCW=new Kl(!0,jy,Vy),Kl.backCW=new Kl(!0,jy,2304),Kl.frontCW=new Kl(!0,1028,2304),Kl.frontCCW=new Kl(!0,1028,Vy);class Hh extends ma{constructor(e,a,u){super(),this.id=e,this._onlySymbols=u,a.on("data",(p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),a.on("error",(()=>{this._sourceErrored=!0})),this._source=a,this._tiles={},this._cache=new dk(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new ck,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const a=this._tiles[e];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,a){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,a)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,(()=>{}))}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,(()=>{}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const u=this._tiles[a];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Ve(this._tiles).map((e=>e.tileID)).sort(L1).map((e=>e.key))}getRenderableIds(e){const a=[];for(const u in this._tiles)this._isIdRenderable(+u,e)&&a.push(this._tiles[u]);return e?a.sort(((u,p)=>{const y=u.tileID,b=p.tileID,T=new Nt(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),M=new Nt(b.canonical.x,b.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-b.overscaledZ||M.y-T.y||M.x-T.x})).map((u=>u.tileID.key)):a.map((u=>u.tileID)).sort(L1).map((u=>u.key))}hasRenderableParent(e){const a=this.findLoadedParent(e,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(e,a){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(a||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,a){const u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=a),this._loadTile(u,this._tileLoaded.bind(this,u,e,a)))}_tileLoaded(e,a,u,p){if(p)if(e.state="errored",p.status!==404)this._source.fire(new Cr(p,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const y=this.map.painter.terrain;this.update(this.transform,y.getScaledDemTileSize(),!0),y.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Vr.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(a,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new dr("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const a=this.getRenderableIds();for(let p=0;p<a.length;p++){const y=a[p];if(e.neighboringTiles&&e.neighboringTiles[y]){const b=this.getTileByID(y);u(e,b),u(b,e)}}function u(p,y){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let b=y.tileID.canonical.x-p.tileID.canonical.x;const T=y.tileID.canonical.y-p.tileID.canonical.y,M=Math.pow(2,p.tileID.canonical.z),P=y.tileID.key;b===0&&T===0||Math.abs(T)>1||(Math.abs(b)>1&&(Math.abs(b+M)===1?b+=M:Math.abs(b-M)===1&&(b-=M)),y.dem&&p.dem&&(p.dem.backfillBorder(y.dem,b,T),p.neighboringTiles&&p.neighboringTiles[P]&&(p.neighboringTiles[P].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,a,u,p){for(const y in this._tiles){let b=this._tiles[y];if(p[y]||!b.hasData()||b.tileID.overscaledZ<=a||b.tileID.overscaledZ>u)continue;let T=b.tileID;for(;b&&b.tileID.overscaledZ>a+1;){const P=b.tileID.scaledTo(b.tileID.overscaledZ-1);b=this._tiles[P.key],b&&b.hasData()&&(T=P)}let M=T;for(;M.overscaledZ>a;)if(M=M.scaledTo(M.overscaledZ-1),e[M.key]){p[T.key]=T;break}}}findLoadedParent(e,a){if(e.key in this._loadedParentTiles){const u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=a?u:null}for(let u=e.overscaledZ-1;u>=a;u--){const p=e.scaledTo(u),y=this._getLoadedTile(p);if(y)return y}}_getLoadedTile(e){const a=this._tiles[e.key];return a&&a.hasData()?a:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,a){a=a||this._source.tileSize;const u=Math.ceil(e.width/a)+1,p=Math.ceil(e.height/a)+1,y=Math.floor(u*p*5),b=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,y):y,T=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,b):b;this._cache.setMaxSize(T)}handleWrapJump(e){const a=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,a){const u={};for(const p in this._tiles){const y=this._tiles[p];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+a),u[y.tileID.key]=y}this._tiles=u;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(e,a,u){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!u)return;let p;this.updateCacheSize(e,a),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((T=>new uo(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y))):(p=e.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!u,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter((T=>this._source.hasTile(T))))):p=[];const y=this._updateRetainedTiles(p);if(D1(this._source.type)&&p.length!==0){const T={},M={},P=Object.keys(y);for(const N of P){const $=y[N],Z=this._tiles[N];if(!Z||Z.fadeEndTime&&Z.fadeEndTime<=Vr.now())continue;const X=this.findLoadedParent($,Math.max($.overscaledZ-Hh.maxOverzooming,this._source.minzoom));X&&(this._addTile(X.tileID),T[X.tileID.key]=X.tileID),M[N]=$}const O=p[p.length-1].overscaledZ;for(const N in this._tiles){const $=this._tiles[N];if(y[N]||!$.hasData())continue;let Z=$.tileID;for(;Z.overscaledZ>O;){Z=Z.scaledTo(Z.overscaledZ-1);const X=this._tiles[Z.key];if(X&&X.hasData()&&M[Z.key]){y[N]=$.tileID;break}}}for(const N in T)y[N]||(this._coveredTiles[N]=!0,y[N]=T[N])}for(const T in y)this._tiles[T].clearFadeHold();const b=(function(T,M){const P=[];for(const O in T)O in M||P.push(O);return P})(this._tiles,y);for(const T of b){const M=this._tiles[T];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(+T)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const a={};if(e.length===0)return a;const u={},p=e.reduce(((P,O)=>Math.min(P,O.overscaledZ)),1/0),y=e[0].overscaledZ,b=Math.max(y-Hh.maxOverzooming,this._source.minzoom),T=Math.max(y+Hh.maxUnderzooming,this._source.minzoom),M={};for(const P of e){const O=this._addTile(P);a[P.key]=P,O.hasData()||p<this._source.maxzoom&&(M[P.key]=P)}this._retainLoadedChildren(M,p,T,a);for(const P of e){let O=this._tiles[P.key];if(O.hasData())continue;if(P.canonical.z>=this._source.maxzoom){const $=P.children(this._source.maxzoom)[0],Z=this.getTile($);if(Z&&Z.hasData()){a[$.key]=$;continue}}else{const $=P.children(this._source.maxzoom);if(a[$[0].key]&&a[$[1].key]&&a[$[2].key]&&a[$[3].key])continue}let N=O.wasRequested();for(let $=P.overscaledZ-1;$>=b;--$){const Z=P.scaledTo($);if(u[Z.key]||(u[Z.key]=!0,O=this.getTile(Z),!O&&N&&(O=this._addTile(Z)),O&&(a[Z.key]=Z,N=O.wasRequested(),O.hasData())))break}}return a}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const a=[];let u,p=this._tiles[e].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){u=this._loadedParentTiles[p.key];break}a.push(p.key);const y=p.scaledTo(p.overscaledZ-1);if(u=this._getLoadedTile(y),u)break;p=y}for(const y of a)this._loadedParentTiles[y]=u}}_addTile(e){let a=this._tiles[e.key];if(a)return a;a=this._cache.getAndRemove(e),a&&(this._setTileReloadTimer(e.key,a),a.tileID=e,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,a)));const u=!!a;if(!u){const p=this.map?this.map.painter:null;a=new By(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,p,this._isRaster),this._loadTile(a,this._tileLoaded.bind(this,a,e.key,a.state))}return a?(a.uses++,this._tiles[e.key]=a,u||this._source.fire(new dr("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a):null}_setTileReloadTimer(e,a){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const u=a.getExpiryTimeout();u&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),u))}_removeTile(e){const a=this._tiles[e];a&&(a.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,a,u){const p=[],y=this.transform;if(!y)return p;const b=y.projection.name==="globe",T=Ec(y.center.lng);for(const M in this._tiles){const P=this._tiles[M];if(u&&P.clearQueryDebugViz(),P.holdingForFade())continue;let O;if(b){const N=P.tileID.canonical;if(N.z===0){const $=[Math.abs(Oe(T,...hp(N,-1))-T),Math.abs(Oe(T,...hp(N,1))-T)];O=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(Oe(T,...hp(N,-1))-T),Math.abs(Oe(T,...hp(N,0))-T),Math.abs(Oe(T,...hp(N,1))-T)];O=[$.indexOf(Math.min(...$))-1]}}else O=[0];for(const N of O){const $=e.containsTile(P,y,a,N);$&&p.push($)}}return p}getVisibleCoordinates(e){const a=this.getRenderableIds(e).map((u=>this._tiles[u].tileID));for(const u of a)u.projMatrix=this.transform.calculateProjMatrix(u.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(D1(this._source.type))for(const e in this._tiles){const a=this._tiles[e];if(a.fadeEndTime!==void 0&&a.fadeEndTime>=Vr.now())return!0}return!1}setFeatureState(e,a,u){this._state.updateState(e=e||"_geojsonTileLayer",a,u)}removeFeatureState(e,a,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",a,u)}getFeatureState(e,a){return this._state.getState(e=e||"_geojsonTileLayer",a)}setDependencies(e,a,u){const p=this._tiles[e];p&&p.setDependencies(a,u)}reloadTilesForDependencies(e,a){for(const u in this._tiles)this._tiles[u].hasDependency(e,a)&&this._reloadTile(+u,"reloading");this._cache.filter((u=>!u.hasDependency(e,a)))}_preloadTiles(e,a){if(!this._sourceLoaded){const T=()=>{this._sourceLoaded&&(this._source.off("data",T),this._preloadTiles(e,a))};return void this._source.on("data",T)}const u=new Map,p=Array.isArray(e)?e:[e],y=this.map.painter.terrain,b=this.usedForTerrain&&y?y.getScaledDemTileSize():this._source.tileSize;for(const T of p){const M=T.coveringTiles({tileSize:b,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const P of M)u.set(P.key,P);this.usedForTerrain&&T.updateElevation(!1)}ce(Array.from(u.values()),((T,M)=>{const P=new By(T,this._source.tileSize*T.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(P,(O=>{this._source.type==="raster-dem"&&P.dem&&this._backfillDEM(P),M(O,P)}))}),a)}}function L1(s,e){const a=Math.abs(2*s.wrap)-+(s.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return s.overscaledZ-e.overscaledZ||u-a||e.canonical.y-s.canonical.y||e.canonical.x-s.canonical.x}function D1(s){return s==="raster"||s==="image"||s==="video"||s==="custom"}function hp(s,e){const a=1<<s.z;return[s.x/a+e,(s.x+1)/a+e]}Hh.maxOverzooming=10,Hh.maxUnderzooming=3;class a_{constructor(e,a,u){this._demTile=e,this._dem=this._demTile.dem,this._scale=a,this._offset=u}static create(e,a,u){const p=u||e.findDEMTileFor(a);if(!p||!p.dem)return;const y=p.dem,b=p.tileID,T=1<<a.canonical.z-b.canonical.z;return new a_(p,p.tileSize/di/T,[(a.canonical.x/T-b.canonical.x)*y.dim,(a.canonical.y/T-b.canonical.y)*y.dim])}tileCoordToPixel(e,a){const u=a*this._scale+this._offset[1],p=Math.floor(e*this._scale+this._offset[0]),y=Math.floor(u);return new Nt(p,y)}getElevationAt(e,a,u,p){const y=e*this._scale+this._offset[0],b=a*this._scale+this._offset[1],T=Math.floor(y),M=Math.floor(b),P=this._dem;return p=!!p,u?Hi(Hi(P.get(T,M,p),P.get(T,M+1,p),b-M),Hi(P.get(T+1,M,p),P.get(T+1,M+1,p),b-M),y-T):P.get(T,M,p)}getElevationAtPixel(e,a,u){return this._dem.get(e,a,!!u)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Hl(1,e)*this._dem.stride}}class z1{constructor(e,a){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Gr(di,16,0),this.featureIndexArray=new lu,this.promoteId=a}insert(e,a,u,p,y,b=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,p,y,b);const M=this.grid;for(let P=0;P<a.length;P++){const O=a[P],N=[1/0,1/0,-1/0,-1/0];for(let $=0;$<O.length;$++){const Z=O[$];N[0]=Math.min(N[0],Z.x),N[1]=Math.min(N[1],Z.y),N[2]=Math.max(N[2],Z.x),N[3]=Math.max(N[3],Z.y)}N[0]<di&&N[1]<di&&N[2]>=0&&N[3]>=0&&M.insert(T,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new by(new Hm(this.rawTileData)).layers,this.sourceLayerCoder=new v1(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,a,u,p){this.loadVTLayers();const y=e.params||{},b=ni(y.filter),T=e.tileResult,M=e.transform,P=T.bufferedTilespaceBounds,O=this.grid.query(P.min.x,P.min.y,P.max.x,P.max.y,((X,J,ct,yt)=>rb(T.bufferedTilespaceGeometry,X,J,ct,yt)));O.sort(fk);let N=null;M.elevation&&O.length>0&&(N=a_.create(M.elevation,this.tileID));const $={};let Z;for(let X=0;X<O.length;X++){const J=O[X];if(J===Z)continue;Z=J;const ct=this.featureIndexArray.get(J);let yt=null;this.loadMatchingFeature($,ct,b,y.layers,y.availableImages,a,u,p,((Ct,vt,St,Dt=0)=>(yt||(yt=fu(Ct,this.tileID.canonical,e.tileTransform)),vt.queryIntersectsFeature(T,Ct,St,yt,this.z,e.transform,e.pixelPosMatrix,N,Dt))))}return $}loadMatchingFeature(e,a,u,p,y,b,T,M,P){const{featureIndex:O,bucketIndex:N,sourceLayerIndex:$,layoutVertexArrayOffset:Z}=a,X=this.bucketLayerIDs[N];if(p&&!(function(Ct,vt){for(let St=0;St<Ct.length;St++)if(vt.indexOf(Ct[St])>=0)return!0;return!1})(p,X))return;const J=this.sourceLayerCoder.decode($),ct=this.vtLayers[J].feature(O);if(u.needGeometry){const Ct=$h(ct,!0);if(!u.filter(new B(this.tileID.overscaledZ),Ct,this.tileID.canonical))return}else if(!u.filter(new B(this.tileID.overscaledZ),ct))return;const yt=this.getId(ct,J);for(let Ct=0;Ct<X.length;Ct++){const vt=X[Ct];if(p&&p.indexOf(vt)<0)continue;const St=b[vt];if(!St)continue;let Dt={};yt!==void 0&&M&&(Dt=M.getState(St.sourceLayer||"_geojsonTileLayer",yt));const It=je({},T[vt]);It.paint=O1(It.paint,St.paint,ct,Dt,y),It.layout=O1(It.layout,St.layout,ct,Dt,y);const ie=!P||P(ct,St,Dt,Z);if(!ie)continue;const Qt=new x1(ct,this.z,this.x,this.y,yt);Qt.layer=It;let _e=e[vt];_e===void 0&&(_e=e[vt]=[]),_e.push({featureIndex:O,feature:Qt,intersectionZ:ie})}}lookupSymbolFeatures(e,a,u,p,y,b,T,M){const P={};this.loadVTLayers();const O=ni(y);for(const N of e)this.loadMatchingFeature(P,{bucketIndex:u,sourceLayerIndex:p,featureIndex:N,layoutVertexArrayOffset:0},O,b,T,M,a);return P}loadFeature(e){const{featureIndex:a,sourceLayerIndex:u}=e;this.loadVTLayers();const p=this.sourceLayerCoder.decode(u),y=this.vtFeatures[p];if(y[a])return y[a];const b=this.vtLayers[p].feature(a);return y[a]=b,b}hasLayer(e){for(const a of this.bucketLayerIDs)for(const u of a)if(e===u)return!0;return!1}getId(e,a){let u=e.id;if(this.promoteId){const p=typeof this.promoteId=="string"?this.promoteId:this.promoteId[a];p!=null&&(u=e.properties[p]),typeof u=="boolean"&&(u=Number(u))}return u}}function O1(s,e,a,u,p){return Tt(s,((y,b)=>{const T=e instanceof dt?e.get(b):null;return T&&T.evaluate?T.evaluate(a,u,p):T}))}function fk(s,e){return e-s}Je(z1,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class R1{constructor(e,a){this.width=e,this.height=a,this.nextRow=0,this.image=new pu({width:e,height:a}),this.positions={},this.uploaded=!1}getDash(e,a){const u=this.getKey(e,a);return this.positions[u]}trim(){const e=this.width,a=this.height=Ii(this.nextRow);this.image.resize({width:e,height:a})}getKey(e,a){return e.join(",")+a}getDashRanges(e,a,u){const p=[];let y=e.length%2==1?-e[e.length-1]*u:0,b=e[0]*u,T=!0;p.push({left:y,right:b,isDash:T,zeroLength:e[0]===0});let M=e[0];for(let P=1;P<e.length;P++){T=!T;const O=e[P];y=M*u,M+=O,b=M*u,p.push({left:y,right:b,isDash:T,zeroLength:O===0})}return p}addRoundDash(e,a,u){const p=a/2;for(let y=-u;y<=u;y++){const b=this.width*(this.nextRow+u+y);let T=0,M=e[T];for(let P=0;P<this.width;P++){P/M.right>1&&(M=e[++T]);const O=Math.abs(P-M.left),N=Math.abs(P-M.right),$=Math.min(O,N);let Z;const X=y/u*(p+1);if(M.isDash){const J=p-Math.abs(X);Z=Math.sqrt($*$+J*J)}else Z=p-Math.sqrt($*$+X*X);this.image.data[b+P]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(e,a){for(let M=e.length-1;M>=0;--M){const P=e[M],O=e[M+1];P.zeroLength?e.splice(M,1):O&&O.isDash===P.isDash&&(O.left=P.left,e.splice(M,1))}const u=e[0],p=e[e.length-1];u.isDash===p.isDash&&(u.left=p.left-this.width,p.right=u.right+this.width);const y=this.width*this.nextRow;let b=0,T=e[b];for(let M=0;M<this.width;M++){M/T.right>1&&(T=e[++b]);const P=Math.abs(M-T.left),O=Math.abs(M-T.right),N=Math.min(P,O);this.image.data[y+M]=Math.max(0,Math.min(255,(T.isDash?N:-N)+a+128))}}addDash(e,a){const u=this.getKey(e,a);if(this.positions[u])return this.positions[u];const p=a==="round",y=p?7:0,b=2*y+1;if(this.nextRow+b>this.height)return me("LineAtlas out of space"),null;e.length===0&&e.push(1);let T=0;for(let O=0;O<e.length;O++)e[O]<0&&(me("Negative value is found in line dasharray, replacing values with 0"),e[O]=0),T+=e[O];if(T!==0){const O=this.width/T,N=this.getDashRanges(e,this.width,O);p?this.addRoundDash(N,O,y):this.addRegularDash(N,a==="square"?.5*O:0)}const M=this.nextRow+y;this.nextRow+=b;const P={tl:[M,y],br:[T,0]};return this.positions[u]=P,P}}Je(R1,"LineAtlas");const B1=1*Xl;class F1{constructor(e){const a={},u=[];for(const T in e){const M=e[T],P=a[T]={};for(const O in M.glyphs){const N=M.glyphs[+O];if(!N||N.bitmap.width===0||N.bitmap.height===0)continue;const $=N.metrics.localGlyph?B1:1,Z={x:0,y:0,w:N.bitmap.width+2*$,h:N.bitmap.height+2*$};u.push(Z),P[O]=Z}}const{w:p,h:y}=Sy(u),b=new pu({width:p||1,height:y||1});for(const T in e){const M=e[T];for(const P in M.glyphs){const O=M.glyphs[+P];if(!O||O.bitmap.width===0||O.bitmap.height===0)continue;const N=a[T][P],$=O.metrics.localGlyph?B1:1;pu.copy(O.bitmap,b,{x:0,y:0},{x:N.x+$,y:N.y+$},O.bitmap)}}this.image=b,this.positions=a}}Je(F1,"GlyphAtlas");class pk{constructor(e){this.tileID=new uo(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Gh(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,a,u,p,y){this.status="parsing",this.data=e,this.collisionBoxArray=new dn;const b=new v1(Object.keys(e.layers).sort()),T=new z1(this.tileID,this.promoteId);T.bucketLayerIDs=[];const M={},P=new R1(256,256),O={featureIndex:T,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:P,availableImages:u},N=a.familiesBySource[this.source];for(const Dt in N){const It=e.layers[Dt];if(!It)continue;let ie=!1,Qt=!1;for(const re of N[Dt])re[0].type==="symbol"?ie=!0:Qt=!0;if(this.isSymbolTile===!0&&!ie||this.isSymbolTile===!1&&!Qt)continue;It.version===1&&me(`Vector tile source "${this.source}" layer "${Dt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const _e=b.encode(Dt),ke=[];for(let re=0;re<It.length;re++){const ve=It.feature(re),xe=T.getId(ve,Dt);ke.push({feature:ve,id:xe,index:re,sourceLayerIndex:_e})}for(const re of N[Dt]){const ve=re[0];this.isSymbolTile!==void 0&&ve.type==="symbol"!==this.isSymbolTile||ve.minzoom&&this.zoom<Math.floor(ve.minzoom)||ve.maxzoom&&this.zoom>=ve.maxzoom||ve.visibility!=="none"&&(Uy(re,this.zoom,u),(M[ve.id]=ve.createBucket({index:T.bucketLayerIDs.length,layers:re,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:_e,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:u})).populate(ke,O,this.tileID.canonical,this.tileTransform),T.bucketLayerIDs.push(re.map((xe=>xe.id))))}}let $,Z,X,J;P.trim();const ct={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},yt=()=>{if($)return y($);if(Z&&X&&J){const Dt=new F1(Z),It=new Zb(X,J);for(const ie in M){const Qt=M[ie];Qt instanceof Yu?(Uy(Qt.layers,this.zoom,u),jP(Qt,Z,Dt.positions,X,It.iconPositions,this.showCollisionBoxes,u,this.tileID.canonical,this.tileZoom,this.projection)):Qt.hasPattern&&(Qt instanceof Wm||Qt instanceof Nm||Qt instanceof Qf)&&(Uy(Qt.layers,this.zoom,u),Qt.addFeatures(O,this.tileID.canonical,It.patternPositions,u,this.tileTransform))}this.status="done",y(null,{buckets:Ve(M).filter((ie=>!ie.isEmpty())),featureIndex:T,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Dt.image,lineAtlas:P,imageAtlas:It,glyphMap:this.returnDependencies?Z:null,iconMap:this.returnDependencies?X:null,glyphPositions:this.returnDependencies?Dt.positions:null})}},Ct=Tt(O.glyphDependencies,(Dt=>Object.keys(Dt).map(Number)));Object.keys(Ct).length?p.send("getGlyphs",{uid:this.uid,stacks:Ct},((Dt,It)=>{$||($=Dt,Z=It,yt())}),void 0,!1,ct):Z={};const vt=Object.keys(O.iconDependencies);vt.length?p.send("getImages",{icons:vt,source:this.source,tileID:this.tileID,type:"icons"},((Dt,It)=>{$||($=Dt,X=It,yt())}),void 0,!1,ct):X={};const St=Object.keys(O.patternDependencies);St.length?p.send("getImages",{icons:St,source:this.source,tileID:this.tileID,type:"patterns"},((Dt,It)=>{$||($=Dt,J=It,yt())}),void 0,!1,ct):J={},yt()}}function Uy(s,e,a){const u=new B(e);for(const p of s)p.recalculate(u,a)}class N1{constructor(e){this.entries={},this.scheduler=e}request(e,a,u,p){const y=this.entries[e]=this.entries[e]||{callbacks:[]};if(y.result){const[b,T]=y.result;return this.scheduler?this.scheduler.add((()=>{p(b,T)}),a):p(b,T),()=>{}}return y.callbacks.push(p),y.cancel||(y.cancel=u(((b,T)=>{y.result=[b,T];for(const M of y.callbacks)this.scheduler?this.scheduler.add((()=>{M(b,T)}),a):M(b,T);setTimeout((()=>delete this.entries[e]),3e3)}))),()=>{y.result||(y.callbacks=y.callbacks.filter((b=>b!==p)),y.callbacks.length||(y.cancel(),delete this.entries[e]))}}}function j1(s,e,a){const u=JSON.stringify(s.request);return s.data&&(this.deduped.entries[u]={result:[null,s.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom},(p=>{const y=Eo(s.request,((b,T,M,P)=>{b?p(b):T&&p(null,{vectorTile:a?void 0:new by(new Hm(T)),rawData:T,cacheControl:M,expires:P})}));return()=>{y.cancel(),p()}}),e)}const V1=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class $y{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,u]=new Uint8Array(e,0,2);if(a!==219)throw new Error("Data does not appear to be in a KDBush format.");const p=u>>4;if(p!==1)throw new Error(`Got v${p} data when expected v1.`);const y=V1[15&u];if(!y)throw new Error("Unrecognized array type.");const[b]=new Uint16Array(e,2,1),[T]=new Uint32Array(e,4,1);return new $y(T,b,y,e)}constructor(e,a=64,u=Float64Array,p){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=u,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const y=V1.indexOf(this.ArrayType),b=2*e*this.ArrayType.BYTES_PER_ELEMENT,T=e*this.IndexArrayType.BYTES_PER_ELEMENT,M=(8-T%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${u}.`);p&&p instanceof ArrayBuffer?(this.data=p,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+T+M,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+b+T+M),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+T+M,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=e)}add(e,a){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=e,this.coords[this._pos++]=a,u}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Wy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,a,u,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:b,nodeSize:T}=this,M=[0,y.length-1,0],P=[];for(;M.length;){const O=M.pop()||0,N=M.pop()||0,$=M.pop()||0;if(N-$<=T){for(let ct=$;ct<=N;ct++){const yt=b[2*ct],Ct=b[2*ct+1];yt>=e&&yt<=u&&Ct>=a&&Ct<=p&&P.push(y[ct])}continue}const Z=$+N>>1,X=b[2*Z],J=b[2*Z+1];X>=e&&X<=u&&J>=a&&J<=p&&P.push(y[Z]),(O===0?e<=X:a<=J)&&(M.push($),M.push(Z-1),M.push(1-O)),(O===0?u>=X:p>=J)&&(M.push(Z+1),M.push(N),M.push(1-O))}return P}within(e,a,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:b}=this,T=[0,p.length-1,0],M=[],P=u*u;for(;T.length;){const O=T.pop()||0,N=T.pop()||0,$=T.pop()||0;if(N-$<=b){for(let ct=$;ct<=N;ct++)$1(y[2*ct],y[2*ct+1],e,a)<=P&&M.push(p[ct]);continue}const Z=$+N>>1,X=y[2*Z],J=y[2*Z+1];$1(X,J,e,a)<=P&&M.push(p[Z]),(O===0?e-u<=X:a-u<=J)&&(T.push($),T.push(Z-1),T.push(1-O)),(O===0?e+u>=X:a+u>=J)&&(T.push(Z+1),T.push(N),T.push(1-O))}return M}}function Wy(s,e,a,u,p,y){if(p-u<=a)return;const b=u+p>>1;U1(s,e,b,u,p,y),Wy(s,e,a,u,b-1,1-y),Wy(s,e,a,b+1,p,1-y)}function U1(s,e,a,u,p,y){for(;p>u;){if(p-u>600){const P=p-u+1,O=a-u+1,N=Math.log(P),$=.5*Math.exp(2*N/3),Z=.5*Math.sqrt(N*$*(P-$)/P)*(O-P/2<0?-1:1);U1(s,e,a,Math.max(u,Math.floor(a-O*$/P+Z)),Math.min(p,Math.floor(a+(P-O)*$/P+Z)),y)}const b=e[2*a+y];let T=u,M=p;for(dp(s,e,u,a),e[2*p+y]>b&&dp(s,e,u,p);T<M;){for(dp(s,e,T,M),T++,M--;e[2*T+y]<b;)T++;for(;e[2*M+y]>b;)M--}e[2*u+y]===b?dp(s,e,u,M):(M++,dp(s,e,M,p)),M<=a&&(u=M+1),a<=M&&(p=M-1)}}function dp(s,e,a,u){Zy(s,a,u),Zy(e,2*a,2*u),Zy(e,2*a+1,2*u+1)}function Zy(s,e,a){const u=s[e];s[e]=s[a],s[a]=u}function $1(s,e,a,u){const p=s-a,y=e-u;return p*p+y*y}r.ARRAY_TYPE=na,r.AUTH_ERR_MSG=Lt,r.Aabb=co,r.Actor=class{constructor(s,e,a){this.target=s,this.parent=e,this.mapId=a,this.callbacks={},this.cancelCallbacks={},_n(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=$e()?s:E,this.scheduler=new ak}send(s,e,a,u,p=!1,y){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(a.metadata=y,this.callbacks[b]=a);const T=fi(this.globalScope)?void 0:[];return this.target.postMessage({id:b,type:s,hasCallback:!!a,targetMapId:u,mustQueue:p,sourceMapId:this.mapId,data:xc(e,T)},T),{cancel:()=>{a&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:u,sourceMapId:this.mapId})}}}receive(s){const e=s.data,a=e.id;if(a&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){const u=this.cancelCallbacks[a];delete this.cancelCallbacks[a],u&&u.cancel()}else if(e.mustQueue||$e()){const u=this.callbacks[a];this.cancelCallbacks[a]=this.scheduler.add((()=>this.processTask(a,e)),u&&u.metadata||{type:"message"})}else this.processTask(a,e)}processTask(s,e){if(e.type==="<response>"){const a=this.callbacks[s];delete this.callbacks[s],a&&(e.error?a(Vl(e.error)):a(null,Vl(e.data)))}else{const a=fi(this.globalScope)?void 0:[],u=e.hasCallback?(y,b)=>{delete this.cancelCallbacks[s],this.target.postMessage({id:s,type:"<response>",sourceMapId:this.mapId,error:y?xc(y):null,data:xc(b,a)},a)}:y=>{},p=Vl(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,p,u);else if(this.parent.getWorkerSource){const y=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,y[0],p.source)[y[1]](p,u)}else u(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},r.CanonicalTileID=$m,r.Color=Xi,r.ColorMode=Ac,r.CullFaceMode=Kl,r.DEMData=o_,r.DataConstantProperty=Y,r.DedupedRequest=N1,r.DepthMode=nf,r.EXTENT=di,r.Elevation=class{isDataAvailableAtPoint(s){const e=this._source();if(this.isUsingMockSource()||!e||s.y<0||s.y>1)return!1;const a=e.getSource().maxzoom,u=1<<a,p=Math.floor(s.x),y=Math.floor((s.x-p)*u),b=Math.floor(s.y*u),T=this.findDEMTileFor(new uo(a,p,a,y,b));return!(!T||!T.dem)}getAtPointOrZero(s,e=0){return this.getAtPoint(s,e)||0}getAtPoint(s,e,a=!0){if(this.isUsingMockSource())return null;e==null&&(e=null);const u=this._source();if(!u||s.y<0||s.y>1)return e;const p=u.getSource().maxzoom,y=1<<p,b=Math.floor(s.x),T=s.x-b,M=new uo(p,b,p,Math.floor(T*y),Math.floor(s.y*y)),P=this.findDEMTileFor(M);if(!P||!P.dem)return e;const O=P.dem,N=1<<P.tileID.canonical.z,$=(T*N-P.tileID.canonical.x)*O.dim,Z=(s.y*N-P.tileID.canonical.y)*O.dim,X=Math.floor($),J=Math.floor(Z);return(a?this.exaggeration():1)*Hi(Hi(O.get(X,J),O.get(X,J+1),Z-J),Hi(O.get(X+1,J),O.get(X+1,J+1),Z-J),$-X)}getAtTileOffset(s,e,a){const u=1<<s.canonical.z;return this.getAtPointOrZero(new Ud(s.wrap+(s.canonical.x+e/di)/u,(s.canonical.y+a/di)/u))}getAtTileOffsetFunc(s,e,a,u){return p=>{const y=this.getAtTileOffset(s,p.x,p.y),b=u.upVector(s.canonical,p.x,p.y);return Ca(b,b,y*u.upVectorScale(s.canonical,e,a).metersToTile),b}}getForTilePoints(s,e,a,u){if(this.isUsingMockSource())return!1;const p=a_.create(this,s,u);return!!p&&(e.forEach((y=>{y[2]=this.exaggeration()*p.getElevationAt(y[0],y[1],a)})),!0)}getMinMaxForTile(s){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(s);if(!e||!e.dem)return null;const a=e.dem.tree,u=e.tileID,p=1<<s.canonical.z-u.canonical.z;let y=s.canonical.x/p-u.canonical.x,b=s.canonical.y/p-u.canonical.y,T=0;for(let M=0;M<s.canonical.z-u.canonical.z&&!a.leaves[T];M++){y*=2,b*=2;const P=2*Math.floor(b)+Math.floor(y);T=a.childOffsets[T]+P,y%=1,b%=1}return{min:this.exaggeration()*a.minimums[T],max:this.exaggeration()*a.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(s,e,a){throw new Error("Pure virtual method called.")}pointCoordinate(s){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(s){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},r.ErrorEvent=Cr,r.EvaluationParameters=B,r.Event=dr,r.Evented=ma,r.FillExtrusionBucket=Qf,r.Frustum=Jg,r.FrustumCorners=Yg,r.GLOBE_RADIUS=wc,r.GLOBE_SCALE_MATCH_LATITUDE=45,r.GLOBE_ZOOM_THRESHOLD_MAX=U0,r.GLOBE_ZOOM_THRESHOLD_MIN=Qg,r.GlobeSharedBuffers=class{constructor(s){this._createGrid(s),this._createPoles(s)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const s of this._poleSegments)s.destroy();for(const s of this._gridSegments)s.withSkirts.destroy(),s.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const s of this._wireframeSegments)s.destroy()}}_fillGridMeshWithLods(s,e){const a=new Te,u=new oi,p=[],y=s+1+2,b=e[0]+1,T=e[0]+1+(1+e.length),M=(P,O,N)=>{let $=P===y-1?P-2:P===0?P:P-1;return $+=N?24575:0,[$,O]};for(let P=0;P<y;++P)a.emplaceBack(...M(P,0,!0));for(let P=0;P<b;++P)for(let O=0;O<y;++O)a.emplaceBack(...M(O,P,(O===0||O===y-1)&&!0));for(let P=0;P<e.length;++P){const O=e[P];for(let N=0;N<y;++N)a.emplaceBack(...M(N,O,!0))}for(let P=0;P<e.length;++P){const O=u.length,N=e[P]+1+2,$=new oi;for(let J=0;J<N-1;J++){const ct=J===N-2,yt=ct?y*(T-e.length+P-J):y;for(let Ct=0;Ct<y-1;Ct++){const vt=J*y+Ct;J===0||ct||Ct===0||Ct===y-2?($.emplaceBack(vt+1,vt,vt+yt),$.emplaceBack(vt+yt,vt+yt+1,vt+1)):(u.emplaceBack(vt+1,vt,vt+yt),u.emplaceBack(vt+yt,vt+yt+1,vt+1))}}const Z=Ts.simpleSegment(0,O,a.length,u.length-O);for(let J=0;J<$.uint16.length;J+=3)u.emplaceBack($.uint16[J],$.uint16[J+1],$.uint16[J+2]);const X=Ts.simpleSegment(0,O,a.length,u.length-O);p.push({withoutSkirts:Z,withSkirts:X})}return{vertices:a,indices:u,segments:p}}_createGrid(s){const e=this._fillGridMeshWithLods(Vh,$f);this._gridSegments=e.segments,this._gridBuffer=s.createVertexBuffer(e.vertices,Uf.members),this._gridIndexBuffer=s.createIndexBuffer(e.indices,!0)}_createPoles(s){const e=new oi;for(let p=0;p<=Vh;p++)e.emplaceBack(0,p+1,p+2);this._poleIndexBuffer=s.createIndexBuffer(e,!0);const a=new hn,u=new hn;this._poleSegments=[];for(let p=0,y=0;p<Qg;p++){const b=360/(1<<p);a.emplaceBack(0,-wc,0,.5,0),u.emplaceBack(0,-wc,0,.5,1);for(let T=0;T<=Vh;T++){const M=T/Vh,P=Hi(0,b,M),[O,N,$]=Nd(aA,lA,P,wc);a.emplaceBack(O,N,$,M,0),u.emplaceBack(O,N,$,M,1)}this._poleSegments.push(Ts.simpleSegment(y,0,66,64)),y+=66}this._poleNorthVertexBuffer=s.createVertexBuffer(a,j0,!1),this._poleSouthVertexBuffer=s.createVertexBuffer(u,j0,!1)}getGridBuffers(s,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[s].withSkirts:this._gridSegments[s].withoutSkirts]}getPoleBuffers(s){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[s]]}getWirefameBuffers(s,e){if(!this._wireframeSegments){const a=new Bs,u=Vh,p=u+1+2,y=1;this._wireframeSegments=[];for(let b=0,T=0;b<$f.length;b++){const M=$f[b];for(let O=y;O<M+y;O++)for(let N=y;N<u+y;N++){const $=O*p+N;a.emplaceBack($,$+1),a.emplaceBack($,$+p),a.emplaceBack($,$+p+1)}const P=M*u*3;this._wireframeSegments.push(Ts.simpleSegment(0,T,(M+1)*p,P)),T+=P}this._wireframeIndexBuffer=s.createIndexBuffer(a)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},r.GlyphManager=Yd,r.ImagePosition=My,r.KDBush=$y,r.LivePerformanceUtils=ur,r.LngLat=bn,r.LngLatBounds=Hu,r.LocalGlyphMode=Py,r.MAX_MERCATOR_LATITUDE=Br,r.MercatorCoordinate=Ud,r.ONE_EM=br,r.OverscaledTileID=uo,r.PerformanceMarkers=ns,r.Point=Nt,r.Properties=gt,r.RGBAImage=sa,r.Ray=Kg,r.RequestManager=class{constructor(s,e,a){this._transformRequestFn=s,this._customAccessToken=e,this._silenceAuthErrors=!!a,this._createSkuToken()}_createSkuToken(){const s=(function(){let e="";for(let a=0;a<10;a++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",xt,e].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,e){return this._transformRequestFn&&this._transformRequestFn(s,e)||{url:s}}normalizeStyleURL(s,e){if(!jt(s))return s;const a=Be(s);return a.path=`/styles/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||e)}normalizeGlyphsURL(s,e){if(!jt(s))return s;const a=Be(s);return a.path=`/fonts/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||e)}normalizeSourceURL(s,e,a,u){if(!jt(s))return s;const p=Be(s);return p.path=`/v4/${p.authority}.json`,p.params.push("secure"),a&&p.params.push(`language=${a}`),u&&p.params.push(`worldview=${u}`),this._makeAPIURL(p,this._customAccessToken||e)}normalizeSpriteURL(s,e,a,u){const p=Be(s);return jt(s)?(p.path=`/styles/v1${p.path}/sprite${e}${a}`,this._makeAPIURL(p,this._customAccessToken||u)):(p.path+=`${e}${a}`,Pe(p))}normalizeTileURL(s,e,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!jt(s))return s;const u=Be(s);u.path=u.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||a&&u.authority!=="raster"&&a===512?"@2x":""}${j.supported?".webp":"$1"}`),u.authority==="raster"?u.path=`/${R.RASTER_URL_PREFIX}${u.path}`:(u.path=u.path.replace(/^.+\/v4\//,"/"),u.path=`/${R.TILE_URL_VERSION}${u.path}`);const p=this._customAccessToken||(function(y){for(const b of y){const T=b.match(/^access_token=(.*)$/);if(T)return T[1]}return null})(u.params)||R.ACCESS_TOKEN;return R.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&u.params.push(`sku=${this._skuToken}`),this._makeAPIURL(u,p)}canonicalizeTileURL(s,e){const a=Be(s);if(!a.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!a.path.match(/\.[\w]+$/))return s;let u="mapbox://";a.path.match(/^\/raster\/v1\//)?u+=`raster/${a.path.replace(`/${R.RASTER_URL_PREFIX}/`,"")}`:u+=`tiles/${a.path.replace(`/${R.TILE_URL_VERSION}/`,"")}`;let p=a.params;return e&&(p=p.filter((y=>!y.match(/^access_token=/)))),p.length&&(u+=`?${p.join("&")}`),u}canonicalizeTileset(s,e){const a=!!e&&jt(e),u=[];for(const p of s.tiles||[])Kt(p)?u.push(this.canonicalizeTileURL(p,a)):u.push(p);return u}_makeAPIURL(s,e){const a="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",u=Be(R.API_URL);if(s.protocol=u.protocol,s.authority=u.authority,s.protocol==="http"){const p=s.params.indexOf("secure");p>=0&&s.params.splice(p,1)}if(u.path!=="/"&&(s.path=`${u.path}${s.path}`),!R.REQUIRE_ACCESS_TOKEN)return Pe(s);if(e=e||R.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${a}`);if(e[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${a}`)}return s.params=s.params.filter((p=>p.indexOf("access_token")===-1)),s.params.push(`access_token=${e||""}`),Pe(s)}},r.ResourceType=Mr,r.SegmentVector=Ts,r.SourceCache=Hh,r.StencilMode=Ny,r.StructArrayLayout1ui2=ao,r.StructArrayLayout2f1f2i16=li,r.StructArrayLayout2i4=Te,r.StructArrayLayout2ui4=Bs,r.StructArrayLayout3f12=ji,r.StructArrayLayout3ui6=oi,r.StructArrayLayout4i8=fe,r.StructArrayLayout5f20=hn,r.Texture=up,r.Tile=By,r.Transitionable=K,r.Uniform1f=Mm,r.Uniform1i=class extends uu{constructor(s){super(s),this.current=0}set(s,e,a){this.fetchUniformLocation(s,e)&&this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},r.Uniform2f=class extends uu{constructor(s){super(s),this.current=[0,0]}set(s,e,a){this.fetchUniformLocation(s,e)&&(a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1])))}},r.Uniform3f=class extends uu{constructor(s){super(s),this.current=[0,0,0]}set(s,e,a){this.fetchUniformLocation(s,e)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2])))}},r.Uniform4f=T0,r.UniformColor=E0,r.UniformMatrix2f=class extends uu{constructor(s){super(s),this.current=ZC}set(s,e,a){if(this.fetchUniformLocation(s,e)){for(let u=0;u<4;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix2fv(this.location,!1,a);break}}}},r.UniformMatrix3f=class extends uu{constructor(s){super(s),this.current=WC}set(s,e,a){if(this.fetchUniformLocation(s,e)){for(let u=0;u<9;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}}},r.UniformMatrix4f=class extends uu{constructor(s){super(s),this.current=$C}set(s,e,a){if(this.fetchUniformLocation(s,e)){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let u=1;u<16;u++)if(a[u]!==this.current[u]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}}},r.UnwrappedTileID=kb,r.ValidationError=x,r.VectorTileFeature=Vm,r.VectorTileWorkerSource=class extends ma{constructor(s,e,a,u,p){super(),this.actor=s,this.layerIndex=e,this.availableImages=a,this.loadVectorData=p||j1,this.loading={},this.loaded={},this.deduped=new N1(s.scheduler),this.isSpriteLoaded=u,this.scheduler=s.scheduler}loadTile(s,e){const a=s.uid,u=s&&s.request,p=u&&u.collectResourceTiming,y=this.loading[a]=new pk(s);y.abort=this.loadVectorData(s,((b,T)=>{const M=!this.loading[a];if(delete this.loading[a],M||b||!T)return y.status="done",M||(this.loaded[a]=y),e(b);const P=T.rawData,O={};T.expires&&(O.expires=T.expires),T.cacheControl&&(O.cacheControl=T.cacheControl),y.vectorTile=T.vectorTile||new by(new Hm(P));const N=()=>{y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,(($,Z)=>{if($||!Z)return e($);const X={};if(p){const J=ja(u);J.length>0&&(X.resourceTiming=JSON.parse(JSON.stringify(J)))}e(null,je({rawTileData:P.slice(0)},Z,O,X))}))};this.isSpriteLoaded?N():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(N,{type:"parseTile",isSymbolTile:s.isSymbolTile,zoom:s.tileZoom}):N()})),this.loaded=this.loaded||{},this.loaded[a]=y}))}reloadTile(s,e){const a=this.loaded,u=s.uid,p=this;if(a&&a[u]){const y=a[u];y.showCollisionBoxes=s.showCollisionBoxes,y.enableTerrain=!!s.enableTerrain,y.projection=s.projection,y.tileTransform=Gh(s.tileID.canonical,s.projection);const b=(T,M)=>{const P=y.reloadCallback;P&&(delete y.reloadCallback,y.parse(y.vectorTile,p.layerIndex,this.availableImages,p.actor,P)),e(T,M)};y.status==="parsing"?y.reloadCallback=b:y.status==="done"&&(y.vectorTile?y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,b):b())}}abortTile(s,e){const a=s.uid,u=this.loading[a];u&&(u.abort&&u.abort(),delete this.loading[a]),e()}removeTile(s,e){const a=this.loaded,u=s.uid;a&&a[u]&&delete a[u],e()}},r.WritingMode=Pa,r.ZoomDependentExpression=Do,r.add=du,r.addDynamicAttributes=n_,r.adjoint=function(s,e){var a=e[0],u=e[1],p=e[2],y=e[3],b=e[4],T=e[5],M=e[6],P=e[7],O=e[8];return s[0]=b*O-T*P,s[1]=p*P-u*O,s[2]=u*T-p*b,s[3]=T*M-y*O,s[4]=a*O-p*M,s[5]=p*y-a*T,s[6]=y*P-b*M,s[7]=u*M-a*P,s[8]=a*b-u*y,s},r.asyncAll=ce,r.bezier=he,r.bindAll=_n,r.boundsAttributes=w1,r.bufferConvexPolygon=function(s,e){const a=[];for(let u=0;u<s.length;u++){const p=$t(u-1,-1,s.length-1),y=$t(u+1,-1,s.length-1),b=s[u],T=s[y],M=s[p].sub(b).unit(),P=T.sub(b).unit(),O=P.angleWithSep(M.x,M.y),N=M.add(P).unit().mult(-1*e/Math.sin(O/2));a.push(b.add(N))}return a},r.cacheEntryPossiblyAdded=function(s){Us++,Us>Ji&&(s.getActor().send("enforceCacheSizeLimit",Ei),Us=0)},r.calculateGlobeLabelMatrix=function(s,e){const{x:a,y:u}=s.point,p=H0(a,u,s.worldSize/s._pixelsPerMercatorPixel,0,0);return Fh(p,p,iy(Tc(e)))},r.calculateGlobeMatrix=function(s){const{x:e,y:a}=s.point,{lng:u,lat:p}=s._center;return H0(e,a,s.worldSize,u,p)},r.calculateGlobeMercatorMatrix=function(s){const e=s.pixelsPerMeter,a=e/Hl(1,s.center.lat),u=Zl(new Float64Array(16));return Rf(u,u,[s.point.x,s.point.y,0]),Nh(u,u,[a,a,e]),Float32Array.from(u)},r.circumferenceAtLatitude=sy,r.clamp=Oe,r.clearTileCache=function(s){if(!Mn())return;const e=E.caches.delete(_i);s&&e.catch(s).then((()=>s()))},r.clipLine=s1,r.clone=function(s){var e=new na(16);return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],e[4]=s[4],e[5]=s[5],e[6]=s[6],e[7]=s[7],e[8]=s[8],e[9]=s[9],e[10]=s[10],e[11]=s[11],e[12]=s[12],e[13]=s[13],e[14]=s[14],e[15]=s[15],e},r.clone$1=Jt,r.collisionCircleLayout=dP,r.config=R,r.conjugate=function(s,e){return s[0]=-e[0],s[1]=-e[1],s[2]=-e[2],s[3]=e[3],s},r.create=function(){var s=new na(16);return na!=Float32Array&&(s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0),s[0]=1,s[5]=1,s[10]=1,s[15]=1,s},r.create$1=C0,r.createExpression=Sa,r.createLayout=Ut,r.createStyleLayer=function(s){return s.type==="custom"?new nk(s):new rk[s.type](s)},r.cross=Xg,r.degToRad=ae,r.distance=function(s,e){return Math.hypot(e[0]-s[0],e[1]-s[1],e[2]-s[2])},r.div=function(s,e,a){return s[0]=e[0]/a[0],s[1]=e[1]/a[1],s[2]=e[2]/a[2],s},r.dot=ol,r.earthRadius=Gf,r.ease=oe,r.easeCubicInOut=de,r.ecefToLatLng=function([s,e,a]){const u=Math.hypot(s,e,a),p=Math.atan2(s,a),y=.5*Math.PI-Math.acos(-e/u);return new bn(ye(p),ye(y))},r.emitValidationErrors=Wu,r.endsWith=ls,r.enforceCacheSizeLimit=function(s){zn(),Ri&&Ri.then((e=>{e.keys().then((a=>{for(let u=0;u<a.length-s;u++)e.delete(a[u])}))}))},r.evaluateSizeForFeature=Zm,r.evaluateSizeForZoom=Hd,r.evaluateVariableOffset=c1,r.evented=w,r.exactEquals=function(s,e){return s[0]===e[0]&&s[1]===e[1]&&s[2]===e[2]&&s[3]===e[3]},r.exactEquals$1=function(s,e){return s[0]===e[0]&&s[1]===e[1]&&s[2]===e[2]},r.exported=Vr,r.exported$1=j,r.extend=je,r.extend$1=Vi,r.fillExtrusionHeightLift=Cb,r.filterObject=Ft,r.fromMat4=function(s,e){return s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=e[4],s[4]=e[5],s[5]=e[6],s[6]=e[8],s[7]=e[9],s[8]=e[10],s},r.fromQuat=function(s,e){var a=e[0],u=e[1],p=e[2],y=e[3],b=a+a,T=u+u,M=p+p,P=a*b,O=u*b,N=u*T,$=p*b,Z=p*T,X=p*M,J=y*b,ct=y*T,yt=y*M;return s[0]=1-N-X,s[1]=O+yt,s[2]=$-ct,s[3]=0,s[4]=O-yt,s[5]=1-P-X,s[6]=Z+J,s[7]=0,s[8]=$+ct,s[9]=Z-J,s[10]=1-P-N,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},r.fromRotation=function(s,e){var a=Math.sin(e),u=Math.cos(e);return s[0]=u,s[1]=a,s[2]=0,s[3]=-a,s[4]=u,s[5]=0,s[6]=0,s[7]=0,s[8]=1,s},r.fromScaling=P0,r.furthestTileCorner=function(s){const e=Math.round((s+45+360)%360/90)%4;return He[e]},r.getAABBPointSquareDist=function(s,e,a){let u=0;for(let p=0;p<2;++p){const y=a?a[p]:0;s[p]>y&&(u+=(s[p]-y)*(s[p]-y)),e[p]<y&&(u+=(y-e[p])*(y-e[p]))}return u},r.getAnchorAlignment=Ay,r.getAnchorJustification=Iy,r.getBounds=function(s){let e=1/0,a=1/0,u=-1/0,p=-1/0;for(const y of s)e=Math.min(e,y.x),a=Math.min(a,y.y),u=Math.max(u,y.x),p=Math.max(p,y.y);return{min:new Nt(e,a),max:new Nt(u,p)}},r.getColumn=ci,r.getDefaultExportFromCjs=mt,r.getGridMatrix=function(s,e,a,u){const p=e.getNorth(),y=e.getSouth(),b=e.getWest(),T=e.getEast(),M=1<<s.z,P=T-b,O=p-y,N=P/Vh,$=-O/$f[a],Z=[0,N,0,$,0,0,p,b,0];if(s.z>0){const X=180/u;A0(Z,Z,[X/P+1,0,0,0,X/O+1,0,-.5*X/N,.5*X/$,1])}return Z[2]=M,Z[5]=s.x,Z[8]=s.y,Z},r.getImage=wt,r.getJSON=function(s,e){return Ys(je(s,{type:"json"}),e)},r.getLatitudinalLod=function(s){const e=Br-5;s=Oe(s,-e,e)/e*90;const a=Math.pow(Math.abs(Math.sin(ae(s))),3);return Math.round(a*($f.length-1))},r.getMapSessionAPI=cs,r.getPerformanceMeasurement=ja,r.getProjection=g1,r.getRTLTextPluginStatus=S,r.getReferrer=fs,r.getTilePoint=function(s,{x:e,y:a},u=0){return new Nt(((e-u)*s.scale-s.x)*di,(a*s.scale-s.y)*di)},r.getTileVec3=function(s,e,a=0){return Fd(((e.x-a)*s.scale-s.x)*di,(e.y*s.scale-s.y)*di,Y0(e.z,e.y))},r.getVideo=function(s,e){const a=E.document.createElement("video");a.muted=!0,a.onloadstart=function(){e(null,a)};for(let u=0;u<s.length;u++){const p=E.document.createElement("source");ec(s[u])||(a.crossOrigin="Anonymous"),p.src=s[u],a.appendChild(p)}return{cancel:()=>{}}},r.globeCenterToScreenPoint=function(s){const e=[0,0,0],a=Zl(new Float64Array(16));return Fh(a,s.pixelMatrix,s.globeMatrix),ms(e,e,a),new Nt(e[0],e[1])},r.globeDenormalizeECEF=iy,r.globeECEFOrigin=function(s,e){const a=[0,0,0];return ms(a,a,Zf(Tc(e.canonical))),ms(a,a,s),a},r.globeMetersToEcef=Pm,r.globeNormalizeECEF=Zf,r.globePixelsToTileUnits=function(s,e){return di/(512*Math.pow(2,s))*Im(Tc(e))},r.globePoleMatrixForTile=function(s,e,a){const u=Zl(new Float64Array(16)),p=(e/(1<<s)-.5)*Math.PI*2;return Am(u,a.globeMatrix,p),Float32Array.from(u)},r.globeTileBounds=Tc,r.globeTiltAtLngLat=q0,r.globeToMercatorTransition=Vd,r.globeUseCustomAntiAliasing=function(s,e,a){const u=Vd(a.zoom),p=s.style.map._antialias,y=!!e.extStandardDerivatives,b=e.extStandardDerivativesForceOff||s.terrain&&s.terrain.exaggeration()>0;return u===0&&!p&&!b&&y},r.identity=Zl,r.identity$1=B0,r.invert=Zg,r.isFullscreen=function(){return!!E.document.fullscreenElement||!!E.document.webkitFullscreenElement},r.isLngLatBehindGlobe=ny,r.isMapAuthenticated=function(s){return is.has(s)},r.isMapboxURL=jt,r.isSafariWithAntialiasingBug=function(s){const e=s.navigator?s.navigator.userAgent:null;return!!fi(s)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},r.latFromMercatorY=Rr,r.latLngToECEF=jd,r.len=tA,r.length=Bf,r.length$1=function(s){return Math.hypot(s[0],s[1],s[2],s[3])},r.lngFromMercatorX=Aa,r.loadVectorTile=j1,r.makeRequest=Ys,r.mapValue=function(s,e,a,u,p){return Oe((s-e)/(a-e)*(p-u)+u,u,p)},r.mercatorScale=J0,r.mercatorXfromLng=Ec,r.mercatorYfromLat=Sc,r.mercatorZfromAltitude=Hl,r.mul=JC,r.mul$1=QC,r.multiply=Fh,r.multiply$1=A0,r.multiply$2=L0,r.nextPowerOfTwo=Ii,r.normalize=lo,r.normalize$1=eA,r.normalize$2=O0,r.number=Hi,r.ortho=function(s,e,a,u,p,y,b){var T=1/(e-a),M=1/(u-p),P=1/(y-b);return s[0]=-2*T,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=-2*M,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=2*P,s[11]=0,s[12]=(e+a)*T,s[13]=(p+u)*M,s[14]=(b+y)*P,s[15]=1,s},r.pbf=Bb,r.perspective=function(s,e,a,u,p){var y,b=1/Math.tan(e/2);return s[0]=b/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=b,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[11]=-1,s[12]=0,s[13]=0,s[15]=0,p!=null&&p!==1/0?(s[10]=(p+u)*(y=1/(u-p)),s[14]=2*p*u*y):(s[10]=-1,s[14]=-2*u),s},r.pick=function(s,e){const a={};for(let u=0;u<e.length;u++){const p=e[u];p in s&&(a[p]=s[p])}return a},r.plugin=I,r.pointGeometry=Rt,r.polesInViewport=function(s){const e=Zl(new Float64Array(16));Fh(e,s.pixelMatrix,s.globeMatrix);const a=[0,al,0],u=[0,ll,0];return ms(a,a,e),ms(u,u,e),[a[0]>0&&a[0]<=s.width&&a[1]>0&&a[1]<=s.height&&!ny(s,new bn(s.center.lat,90)),u[0]>0&&u[0]<=s.width&&u[1]>0&&u[1]<=s.height&&!ny(s,new bn(s.center.lat,-90))]},r.polygonContainsPoint=Wh,r.polygonIntersectsBox=rb,r.polygonIntersectsPolygon=eb,r.polygonizeBounds=function(s,e,a=0,u=!0){const p=new Nt(a,a),y=s.sub(p),b=e.add(p),T=[y,new Nt(b.x,y.y),b,new Nt(y.x,b.y)];return u&&T.push(y.clone()),T},r.posAttributes=Uf,r.postMapLoadEvent=An,r.postPerformanceEvent=Nn,r.postTurnstileEvent=Bi,r.potpack=Sy,r.prevPowerOfTwo=function(s){return s<=1?1:Math.pow(2,Math.floor(Math.log(s)/Math.LN2))},r.radToDeg=ye,r.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],r.registerForPluginStateChange=function(s){return s({pluginStatus:m,pluginURL:o}),w.on("pluginStateChange",s),s},r.removeAuthState=function(s){is.delete(s)},r.renderColorRamp=dy,r.resample=Q0,r.rotateX=Gg,r.rotateX$1=F0,r.rotateY=Am,r.rotateY$1=N0,r.rotateZ=function(s,e,a){var u=Math.sin(a),p=Math.cos(a),y=e[0],b=e[1],T=e[2],M=e[3],P=e[4],O=e[5],N=e[6],$=e[7];return e!==s&&(s[8]=e[8],s[9]=e[9],s[10]=e[10],s[11]=e[11],s[12]=e[12],s[13]=e[13],s[14]=e[14],s[15]=e[15]),s[0]=y*p+P*u,s[1]=b*p+O*u,s[2]=T*p+N*u,s[3]=M*p+$*u,s[4]=P*p-y*u,s[5]=O*p-b*u,s[6]=N*p-T*u,s[7]=$*p-M*u,s},r.rotateZ$1=function(s,e,a){a*=.5;var u=e[0],p=e[1],y=e[2],b=e[3],T=Math.sin(a),M=Math.cos(a);return s[0]=u*M+p*T,s[1]=p*M-u*T,s[2]=y*M+b*T,s[3]=b*M-y*T,s},r.scale=Nh,r.scale$1=z0,r.scale$2=Ca,r.scaleAndAdd=jf,r.set=function(s,e,a,u){return s[0]=e,s[1]=a,s[2]=u,s},r.setCacheLimits=function(s,e){Ei=s,Ji=e},r.setColumn=function(s,e,a){s[4*e+0]=a[0],s[4*e+1]=a[1],s[4*e+2]=a[2],s[4*e+3]=a[3]},r.setRTLTextPlugin=function(s,e,a=!1){if(m===it||m===D||m===H)throw new Error("setRTLTextPlugin cannot be called multiple times.");o=Vr.resolveURL(s),m=it,pt=e,g(),a||k()},r.smoothstep=Ue,r.spec=le,r.squaredLength=function(s){var e=s[0],a=s[1],u=s[2];return e*e+a*a+u*u},r.storeAuthState=function(s,e){e?is.add(s):is.delete(s)},r.sub=Gl,r.subtract=qg,r.symbolSize=fP,r.tileAABB=function(s,e,a,u,p,y,b,T,M){if(M.name==="globe")return oA(s,e,new $m(a,u,p));const P=Gh({z:a,x:u,y:p},M);return new co([(y+P.x/P.scale)*e,e*(P.y/P.scale),b],[(y+P.x2/P.scale)*e,e*(P.y2/P.scale),T])},r.tileCornersToBounds=km,r.tileTransform=Gh,r.transformMat3=function(s,e,a){var u=e[0],p=e[1],y=e[2];return s[0]=u*a[0]+p*a[3]+y*a[6],s[1]=u*a[1]+p*a[4]+y*a[7],s[2]=u*a[2]+p*a[5]+y*a[8],s},r.transformMat4=ms,r.transformMat4$1=jh,r.transformQuat=D0,r.transitionTileAABBinECEF=W0,r.translate=Rf,r.transpose=function(s,e){if(s===e){var a=e[1],u=e[2],p=e[5];s[1]=e[3],s[2]=e[6],s[3]=a,s[5]=e[7],s[6]=u,s[7]=p}else s[0]=e[0],s[1]=e[3],s[2]=e[6],s[3]=e[1],s[4]=e[4],s[5]=e[7],s[6]=e[2],s[7]=e[5],s[8]=e[8];return s},r.triggerPluginCompletionEvent=h,r.uniqueId=ri,r.updateGlobeVertexNormal=function(s,e,a,u,p){const y=5*e+2;s.float32[y+0]=a,s.float32[y+1]=u,s.float32[y+2]=p},r.validateCustomStyleLayer=function(s){const e=[],a=s.id;return a===void 0&&e.push({message:`layers.${a}: missing required property "id"`}),s.render===void 0&&e.push({message:`layers.${a}: missing required method "render"`}),s.renderingMode&&s.renderingMode!=="2d"&&s.renderingMode!=="3d"&&e.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),e},r.validateFilter=s=>Wr(Nl(s)),r.validateFog=s=>Wr(Id(s)),r.validateLayer=s=>Wr(Uu(s)),r.validateLight=s=>Wr(kd(s)),r.validateSource=s=>Wr(su(s)),r.validateStyle=rl,r.validateTerrain=s=>Wr($u(s)),r.values=Ve,r.vectorTile=jm,r.version=C,r.warnOnce=me,r.window=E,r.wrap=$t})),_(["./shared"],(function(r){function E(Et){if(typeof Et=="number"||typeof Et=="boolean"||typeof Et=="string"||Et==null)return JSON.stringify(Et);if(Array.isArray(Et)){let nt="[";for(const wt of Et)nt+=`${E(wt)},`;return`${nt}]`}let et="{";for(const nt of Object.keys(Et).sort())et+=`${nt}:${E(Et[nt])},`;return`${et}}`}function C(Et){let et="";for(const nt of r.refProperties)et+=`/${E(Et[nt])}`;return et}class z{constructor(et){this.keyCache={},et&&this.replace(et)}replace(et){this._layerConfigs={},this._layers={},this.update(et,[])}update(et,nt){for(const Lt of et)this._layerConfigs[Lt.id]=Lt,(this._layers[Lt.id]=r.createStyleLayer(Lt)).compileFilter(),this.keyCache[Lt.id]&&delete this.keyCache[Lt.id];for(const Lt of nt)delete this.keyCache[Lt],delete this._layerConfigs[Lt],delete this._layers[Lt];this.familiesBySource={};const wt=(function(Lt,jt){const Kt={};for(let Vt=0;Vt<Lt.length;Vt++){const ne=jt&&jt[Lt[Vt].id]||C(Lt[Vt]);jt&&(jt[Lt[Vt].id]=ne);let Ae=Kt[ne];Ae||(Ae=Kt[ne]=[]),Ae.push(Lt[Vt])}const qt=[];for(const Vt in Kt)qt.push(Kt[Vt]);return qt})(r.values(this._layerConfigs),this.keyCache);for(const Lt of wt){const jt=Lt.map((Be=>this._layers[Be.id])),Kt=jt[0];if(Kt.visibility==="none")continue;const qt=Kt.source||"";let Vt=this.familiesBySource[qt];Vt||(Vt=this.familiesBySource[qt]={});const ne=Kt.sourceLayer||"_geojsonTileLayer";let Ae=Vt[ne];Ae||(Ae=Vt[ne]=[]),Ae.push(jt)}}}class R{loadTile(et,nt){const{uid:wt,encoding:Lt,rawImageData:jt,padding:Kt,buildQuadTree:qt}=et,Vt=r.window.ImageBitmap&&jt instanceof r.window.ImageBitmap?this.getImageData(jt,Kt):jt;nt(null,new r.DEMData(wt,Vt,Lt,Kt<1,qt))}getImageData(et,nt){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(et.width,et.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=et.width,this.offscreenCanvas.height=et.height,this.offscreenCanvasContext.drawImage(et,0,0,et.width,et.height);const wt=this.offscreenCanvasContext.getImageData(-nt,-nt,et.width+2*nt,et.height+2*nt);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),wt}}function j(Et,et){if(Et.length!==0){G(Et[0],et);for(var nt=1;nt<Et.length;nt++)G(Et[nt],!et)}}function G(Et,et){for(var nt=0,wt=0,Lt=0,jt=Et.length,Kt=jt-1;Lt<jt;Kt=Lt++){var qt=(Et[Lt][0]-Et[Kt][0])*(Et[Kt][1]+Et[Lt][1]),Vt=nt+qt;wt+=Math.abs(nt)>=Math.abs(qt)?nt-Vt+qt:qt-Vt+nt,nt=Vt}nt+wt>=0!=!!et&&Et.reverse()}var W=r.getDefaultExportFromCjs((function Et(et,nt){var wt,Lt=et&&et.type;if(Lt==="FeatureCollection")for(wt=0;wt<et.features.length;wt++)Et(et.features[wt],nt);else if(Lt==="GeometryCollection")for(wt=0;wt<et.geometries.length;wt++)Et(et.geometries[wt],nt);else if(Lt==="Feature")Et(et.geometry,nt);else if(Lt==="Polygon")j(et.coordinates,nt);else if(Lt==="MultiPolygon")for(wt=0;wt<et.coordinates.length;wt++)j(et.coordinates[wt],nt);return et}));const Q=r.VectorTileFeature.prototype.toGeoJSON;var rt={exports:{}},ft=r.pointGeometry,xt=r.vectorTile.VectorTileFeature,mt=bt;function bt(Et,et){this.options=et||{},this.features=Et,this.length=Et.length}function Ot(Et,et){this.id=typeof Et.id=="number"?Et.id:void 0,this.type=Et.type,this.rawGeometry=Et.type===1?[Et.geometry]:Et.geometry,this.properties=Et.tags,this.extent=et||4096}bt.prototype.feature=function(Et){return new Ot(this.features[Et],this.options.extent)},Ot.prototype.loadGeometry=function(){var Et=this.rawGeometry;this.geometry=[];for(var et=0;et<Et.length;et++){for(var nt=Et[et],wt=[],Lt=0;Lt<nt.length;Lt++)wt.push(new ft(nt[Lt][0],nt[Lt][1]));this.geometry.push(wt)}return this.geometry},Ot.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Et=this.geometry,et=1/0,nt=-1/0,wt=1/0,Lt=-1/0,jt=0;jt<Et.length;jt++)for(var Kt=Et[jt],qt=0;qt<Kt.length;qt++){var Vt=Kt[qt];et=Math.min(et,Vt.x),nt=Math.max(nt,Vt.x),wt=Math.min(wt,Vt.y),Lt=Math.max(Lt,Vt.y)}return[et,wt,nt,Lt]},Ot.prototype.toGeoJSON=xt.prototype.toGeoJSON;var zt=r.pbf,Rt=mt;function Bt(Et){var et=new zt;return(function(nt,wt){for(var Lt in nt.layers)wt.writeMessage(3,Nt,nt.layers[Lt])})(Et,et),et.finish()}function Nt(Et,et){var nt;et.writeVarintField(15,Et.version||1),et.writeStringField(1,Et.name||""),et.writeVarintField(5,Et.extent||4096);var wt={keys:[],values:[],keycache:{},valuecache:{}};for(nt=0;nt<Et.length;nt++)wt.feature=Et.feature(nt),et.writeMessage(2,ee,wt);var Lt=wt.keys;for(nt=0;nt<Lt.length;nt++)et.writeStringField(3,Lt[nt]);var jt=wt.values;for(nt=0;nt<jt.length;nt++)et.writeMessage(4,de,jt[nt])}function ee(Et,et){var nt=Et.feature;nt.id!==void 0&&et.writeVarintField(1,nt.id),et.writeMessage(2,Wt,Et),et.writeVarintField(3,nt.type),et.writeMessage(4,He,nt)}function Wt(Et,et){var nt=Et.feature,wt=Et.keys,Lt=Et.values,jt=Et.keycache,Kt=Et.valuecache;for(var qt in nt.properties){var Vt=nt.properties[qt],ne=jt[qt];if(Vt!==null){ne===void 0&&(wt.push(qt),jt[qt]=ne=wt.length-1),et.writeVarint(ne);var Ae=typeof Vt;Ae!=="string"&&Ae!=="boolean"&&Ae!=="number"&&(Vt=JSON.stringify(Vt));var Be=Ae+":"+Vt,Pe=Kt[Be];Pe===void 0&&(Lt.push(Vt),Kt[Be]=Pe=Lt.length-1),et.writeVarint(Pe)}}}function ae(Et,et){return(et<<3)+(7&Et)}function ye(Et){return Et<<1^Et>>31}function He(Et,et){for(var nt=Et.loadGeometry(),wt=Et.type,Lt=0,jt=0,Kt=nt.length,qt=0;qt<Kt;qt++){var Vt=nt[qt],ne=1;wt===1&&(ne=Vt.length),et.writeVarint(ae(1,ne));for(var Ae=wt===3?Vt.length-1:Vt.length,Be=0;Be<Ae;Be++){Be===1&&wt!==1&&et.writeVarint(ae(2,Ae-1));var Pe=Vt[Be].x-Lt,Si=Vt[Be].y-jt;et.writeVarint(ye(Pe)),et.writeVarint(ye(Si)),Lt+=Pe,jt+=Si}wt===3&&et.writeVarint(ae(7,1))}}function de(Et,et){var nt=typeof Et;nt==="string"?et.writeStringField(1,Et):nt==="boolean"?et.writeBooleanField(7,Et):nt==="number"&&(Et%1!=0?et.writeDoubleField(3,Et):Et<0?et.writeSVarintField(6,Et):et.writeVarintField(5,Et))}rt.exports=Bt,rt.exports.fromVectorTileJs=Bt,rt.exports.fromGeojsonVt=function(Et,et){et=et||{};var nt={};for(var wt in Et)nt[wt]=new Rt(Et[wt].features,et),nt[wt].name=wt,nt[wt].version=et.version,nt[wt].extent=et.extent;return Bt({layers:nt})},rt.exports.GeoJSONWrapper=Rt;var he=r.getDefaultExportFromCjs(rt.exports);const oe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Et=>Et},Oe=Math.fround||(Ue=new Float32Array(1),Et=>(Ue[0]=+Et,Ue[0]));var Ue;const $t=3,ce=5,Ve=6;class je{constructor(et){this.options=Object.assign(Object.create(oe),et),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(et){const{log:nt,minZoom:wt,maxZoom:Lt}=this.options;nt&&console.time("total time");const jt=`prepare ${et.length} points`;nt&&console.time(jt),this.points=et;const Kt=[];for(let Vt=0;Vt<et.length;Vt++){const ne=et[Vt];if(!ne.geometry)continue;const[Ae,Be]=ne.geometry.coordinates,Pe=Oe(vi(Ae)),Si=Oe(Ii(Be));Kt.push(Pe,Si,1/0,Vt,-1,1),this.options.reduce&&Kt.push(0)}let qt=this.trees[Lt+1]=this._createTree(Kt);nt&&console.timeEnd(jt);for(let Vt=Lt;Vt>=wt;Vt--){const ne=+Date.now();qt=this.trees[Vt]=this._createTree(this._cluster(qt,Vt)),nt&&console.log("z%d: %d clusters in %dms",Vt,qt.numItems,+Date.now()-ne)}return nt&&console.timeEnd("total time"),this}getClusters(et,nt){let wt=((et[0]+180)%360+360)%360-180;const Lt=Math.max(-90,Math.min(90,et[1]));let jt=et[2]===180?180:((et[2]+180)%360+360)%360-180;const Kt=Math.max(-90,Math.min(90,et[3]));if(et[2]-et[0]>=360)wt=-180,jt=180;else if(wt>jt){const Be=this.getClusters([wt,Lt,180,Kt],nt),Pe=this.getClusters([-180,Lt,jt,Kt],nt);return Be.concat(Pe)}const qt=this.trees[this._limitZoom(nt)],Vt=qt.range(vi(wt),Ii(Kt),vi(jt),Ii(Lt)),ne=qt.data,Ae=[];for(const Be of Vt){const Pe=this.stride*Be;Ae.push(ne[Pe+ce]>1?Xe(ne,Pe,this.clusterProps):this.points[ne[Pe+$t]])}return Ae}getChildren(et){const nt=this._getOriginId(et),wt=this._getOriginZoom(et),Lt="No cluster with the specified id.",jt=this.trees[wt];if(!jt)throw new Error(Lt);const Kt=jt.data;if(nt*this.stride>=Kt.length)throw new Error(Lt);const qt=this.options.radius/(this.options.extent*Math.pow(2,wt-1)),Vt=jt.within(Kt[nt*this.stride],Kt[nt*this.stride+1],qt),ne=[];for(const Ae of Vt){const Be=Ae*this.stride;Kt[Be+4]===et&&ne.push(Kt[Be+ce]>1?Xe(Kt,Be,this.clusterProps):this.points[Kt[Be+$t]])}if(ne.length===0)throw new Error(Lt);return ne}getLeaves(et,nt,wt){const Lt=[];return this._appendLeaves(Lt,et,nt=nt||10,wt=wt||0,0),Lt}getTile(et,nt,wt){const Lt=this.trees[this._limitZoom(et)],jt=Math.pow(2,et),{extent:Kt,radius:qt}=this.options,Vt=qt/Kt,ne=(wt-Vt)/jt,Ae=(wt+1+Vt)/jt,Be={features:[]};return this._addTileFeatures(Lt.range((nt-Vt)/jt,ne,(nt+1+Vt)/jt,Ae),Lt.data,nt,wt,jt,Be),nt===0&&this._addTileFeatures(Lt.range(1-Vt/jt,ne,1,Ae),Lt.data,jt,wt,jt,Be),nt===jt-1&&this._addTileFeatures(Lt.range(0,ne,Vt/jt,Ae),Lt.data,-1,wt,jt,Be),Be.features.length?Be:null}getClusterExpansionZoom(et){let nt=this._getOriginZoom(et)-1;for(;nt<=this.options.maxZoom;){const wt=this.getChildren(et);if(nt++,wt.length!==1)break;et=wt[0].properties.cluster_id}return nt}_appendLeaves(et,nt,wt,Lt,jt){const Kt=this.getChildren(nt);for(const qt of Kt){const Vt=qt.properties;if(Vt&&Vt.cluster?jt+Vt.point_count<=Lt?jt+=Vt.point_count:jt=this._appendLeaves(et,Vt.cluster_id,wt,Lt,jt):jt<Lt?jt++:et.push(qt),et.length===wt)break}return jt}_createTree(et){const nt=new r.KDBush(et.length/this.stride|0,this.options.nodeSize,Float32Array);for(let wt=0;wt<et.length;wt+=this.stride)nt.add(et[wt],et[wt+1]);return nt.finish(),nt.data=et,nt}_addTileFeatures(et,nt,wt,Lt,jt,Kt){for(const qt of et){const Vt=qt*this.stride,ne=nt[Vt+ce]>1;let Ae,Be,Pe;if(ne)Ae=ri(nt,Vt,this.clusterProps),Be=nt[Vt],Pe=nt[Vt+1];else{const Le=this.points[nt[Vt+$t]];Ae=Le.properties;const[Mi,Bi]=Le.geometry.coordinates;Be=vi(Mi),Pe=Ii(Bi)}const Si={type:1,geometry:[[Math.round(this.options.extent*(Be*jt-wt)),Math.round(this.options.extent*(Pe*jt-Lt))]],tags:Ae};let yi;yi=ne||this.options.generateId?nt[Vt+$t]:this.points[nt[Vt+$t]].id,yi!==void 0&&(Si.id=yi),Kt.features.push(Si)}}_limitZoom(et){return Math.max(this.options.minZoom,Math.min(Math.floor(+et),this.options.maxZoom+1))}_cluster(et,nt){const{radius:wt,extent:Lt,reduce:jt,minPoints:Kt}=this.options,qt=wt/(Lt*Math.pow(2,nt)),Vt=et.data,ne=[],Ae=this.stride;for(let Be=0;Be<Vt.length;Be+=Ae){if(Vt[Be+2]<=nt)continue;Vt[Be+2]=nt;const Pe=Vt[Be],Si=Vt[Be+1],yi=et.within(Vt[Be],Vt[Be+1],qt),Le=Vt[Be+ce];let Mi=Le;for(const Bi of yi){const tn=Bi*Ae;Vt[tn+2]>nt&&(Mi+=Vt[tn+ce])}if(Mi>Le&&Mi>=Kt){let Bi,tn=Pe*Le,An=Si*Le,ps=-1;const Nn=((Be/Ae|0)<<5)+(nt+1)+this.points.length;for(const $s of yi){const cs=$s*Ae;if(Vt[cs+2]<=nt)continue;Vt[cs+2]=nt;const is=Vt[cs+ce];tn+=Vt[cs]*is,An+=Vt[cs+1]*is,Vt[cs+4]=Nn,jt&&(Bi||(Bi=this._map(Vt,Be,!0),ps=this.clusterProps.length,this.clusterProps.push(Bi)),jt(Bi,this._map(Vt,cs)))}Vt[Be+4]=Nn,ne.push(tn/Mi,An/Mi,1/0,Nn,-1,Mi),jt&&ne.push(ps)}else{for(let Bi=0;Bi<Ae;Bi++)ne.push(Vt[Be+Bi]);if(Mi>1)for(const Bi of yi){const tn=Bi*Ae;if(!(Vt[tn+2]<=nt)){Vt[tn+2]=nt;for(let An=0;An<Ae;An++)ne.push(Vt[tn+An])}}}}return ne}_getOriginId(et){return et-this.points.length>>5}_getOriginZoom(et){return(et-this.points.length)%32}_map(et,nt,wt){if(et[nt+ce]>1){const Kt=this.clusterProps[et[nt+Ve]];return wt?Object.assign({},Kt):Kt}const Lt=this.points[et[nt+$t]].properties,jt=this.options.map(Lt);return wt&&jt===Lt?Object.assign({},jt):jt}}function Xe(Et,et,nt){return{type:"Feature",id:Et[et+$t],properties:ri(Et,et,nt),geometry:{type:"Point",coordinates:[(wt=Et[et],360*(wt-.5)),Qe(Et[et+1])]}};var wt}function ri(Et,et,nt){const wt=Et[et+ce],Lt=wt>=1e4?`${Math.round(wt/1e3)}k`:wt>=1e3?Math.round(wt/100)/10+"k":wt,jt=Et[et+Ve],Kt=jt===-1?{}:Object.assign({},nt[jt]);return Object.assign(Kt,{cluster:!0,cluster_id:Et[et+$t],point_count:wt,point_count_abbreviated:Lt})}function vi(Et){return Et/360+.5}function Ii(Et){const et=Math.sin(Et*Math.PI/180),nt=.5-.25*Math.log((1+et)/(1-et))/Math.PI;return nt<0?0:nt>1?1:nt}function Qe(Et){const et=(180-360*Et)*Math.PI/180;return 360*Math.atan(Math.exp(et))/Math.PI-90}function _n(Et,et,nt,wt){for(var Lt,jt=wt,Kt=nt-et>>1,qt=nt-et,Vt=Et[et],ne=Et[et+1],Ae=Et[nt],Be=Et[nt+1],Pe=et+3;Pe<nt;Pe+=3){var Si=ls(Et[Pe],Et[Pe+1],Vt,ne,Ae,Be);if(Si>jt)Lt=Pe,jt=Si;else if(Si===jt){var yi=Math.abs(Pe-Kt);yi<qt&&(Lt=Pe,qt=yi)}}jt>wt&&(Lt-et>3&&_n(Et,et,Lt,wt),Et[Lt+2]=jt,nt-Lt>3&&_n(Et,Lt,nt,wt))}function ls(Et,et,nt,wt,Lt,jt){var Kt=Lt-nt,qt=jt-wt;if(Kt!==0||qt!==0){var Vt=((Et-nt)*Kt+(et-wt)*qt)/(Kt*Kt+qt*qt);Vt>1?(nt=Lt,wt=jt):Vt>0&&(nt+=Kt*Vt,wt+=qt*Vt)}return(Kt=Et-nt)*Kt+(qt=et-wt)*qt}function Tt(Et,et,nt,wt){var Lt={id:Et===void 0?null:Et,type:et,geometry:nt,tags:wt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return(function(jt){var Kt=jt.geometry,qt=jt.type;if(qt==="Point"||qt==="MultiPoint"||qt==="LineString")Ft(jt,Kt);else if(qt==="Polygon"||qt==="MultiLineString")for(var Vt=0;Vt<Kt.length;Vt++)Ft(jt,Kt[Vt]);else if(qt==="MultiPolygon")for(Vt=0;Vt<Kt.length;Vt++)for(var ne=0;ne<Kt[Vt].length;ne++)Ft(jt,Kt[Vt][ne])})(Lt),Lt}function Ft(Et,et){for(var nt=0;nt<et.length;nt+=3)Et.minX=Math.min(Et.minX,et[nt]),Et.minY=Math.min(Et.minY,et[nt+1]),Et.maxX=Math.max(Et.maxX,et[nt]),Et.maxY=Math.max(Et.maxY,et[nt+1])}function Jt(Et,et,nt,wt){if(et.geometry){var Lt=et.geometry.coordinates,jt=et.geometry.type,Kt=Math.pow(nt.tolerance/((1<<nt.maxZoom)*nt.extent),2),qt=[],Vt=et.id;if(nt.promoteId?Vt=et.properties[nt.promoteId]:nt.generateId&&(Vt=wt||0),jt==="Point")Se(Lt,qt);else if(jt==="MultiPoint")for(var ne=0;ne<Lt.length;ne++)Se(Lt[ne],qt);else if(jt==="LineString")me(Lt,qt,Kt,!1);else if(jt==="MultiLineString"){if(nt.lineMetrics){for(ne=0;ne<Lt.length;ne++)me(Lt[ne],qt=[],Kt,!1),Et.push(Tt(Vt,"LineString",qt,et.properties));return}we(Lt,qt,Kt,!1)}else if(jt==="Polygon")we(Lt,qt,Kt,!0);else{if(jt!=="MultiPolygon"){if(jt==="GeometryCollection"){for(ne=0;ne<et.geometry.geometries.length;ne++)Jt(Et,{id:Vt,geometry:et.geometry.geometries[ne],properties:et.properties},nt,wt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ne=0;ne<Lt.length;ne++){var Ae=[];we(Lt[ne],Ae,Kt,!0),qt.push(Ae)}}Et.push(Tt(Vt,jt,qt,et.properties))}}function Se(Et,et){et.push(Ke(Et[0])),et.push($e(Et[1])),et.push(0)}function me(Et,et,nt,wt){for(var Lt,jt,Kt=0,qt=0;qt<Et.length;qt++){var Vt=Ke(Et[qt][0]),ne=$e(Et[qt][1]);et.push(Vt),et.push(ne),et.push(0),qt>0&&(Kt+=wt?(Lt*ne-Vt*jt)/2:Math.sqrt(Math.pow(Vt-Lt,2)+Math.pow(ne-jt,2))),Lt=Vt,jt=ne}var Ae=et.length-3;et[2]=1,_n(et,0,Ae,nt),et[Ae+2]=1,et.size=Math.abs(Kt),et.start=0,et.end=et.size}function we(Et,et,nt,wt){for(var Lt=0;Lt<Et.length;Lt++){var jt=[];me(Et[Lt],jt,nt,wt),et.push(jt)}}function Ke(Et){return Et/360+.5}function $e(Et){var et=Math.sin(Et*Math.PI/180),nt=.5-.25*Math.log((1+et)/(1-et))/Math.PI;return nt<0?0:nt>1?1:nt}function Ne(Et,et,nt,wt,Lt,jt,Kt,qt){if(wt/=et,jt>=(nt/=et)&&Kt<wt)return Et;if(Kt<nt||jt>=wt)return null;for(var Vt=[],ne=0;ne<Et.length;ne++){var Ae=Et[ne],Be=Ae.geometry,Pe=Ae.type,Si=Lt===0?Ae.minX:Ae.minY,yi=Lt===0?Ae.maxX:Ae.maxY;if(Si>=nt&&yi<wt)Vt.push(Ae);else if(!(yi<nt||Si>=wt)){var Le=[];if(Pe==="Point"||Pe==="MultiPoint")Re(Be,Le,nt,wt,Lt);else if(Pe==="LineString")fi(Be,Le,nt,wt,Lt,!1,qt.lineMetrics);else if(Pe==="MultiLineString")ci(Be,Le,nt,wt,Lt,!1);else if(Pe==="Polygon")ci(Be,Le,nt,wt,Lt,!0);else if(Pe==="MultiPolygon")for(var Mi=0;Mi<Be.length;Mi++){var Bi=[];ci(Be[Mi],Bi,nt,wt,Lt,!0),Bi.length&&Le.push(Bi)}if(Le.length){if(qt.lineMetrics&&Pe==="LineString"){for(Mi=0;Mi<Le.length;Mi++)Vt.push(Tt(Ae.id,Pe,Le[Mi],Ae.tags));continue}Pe!=="LineString"&&Pe!=="MultiLineString"||(Le.length===1?(Pe="LineString",Le=Le[0]):Pe="MultiLineString"),Pe!=="Point"&&Pe!=="MultiPoint"||(Pe=Le.length===3?"Point":"MultiPoint"),Vt.push(Tt(Ae.id,Pe,Le,Ae.tags))}}}return Vt.length?Vt:null}function Re(Et,et,nt,wt,Lt){for(var jt=0;jt<Et.length;jt+=3){var Kt=Et[jt+Lt];Kt>=nt&&Kt<=wt&&(et.push(Et[jt]),et.push(Et[jt+1]),et.push(Et[jt+2]))}}function fi(Et,et,nt,wt,Lt,jt,Kt){for(var qt,Vt,ne=ti(Et),Ae=Lt===0?Ei:Ji,Be=Et.start,Pe=0;Pe<Et.length-3;Pe+=3){var Si=Et[Pe],yi=Et[Pe+1],Le=Et[Pe+2],Mi=Et[Pe+3],Bi=Et[Pe+4],tn=Lt===0?Si:yi,An=Lt===0?Mi:Bi,ps=!1;Kt&&(qt=Math.sqrt(Math.pow(Si-Mi,2)+Math.pow(yi-Bi,2))),tn<nt?An>nt&&(Vt=Ae(ne,Si,yi,Mi,Bi,nt),Kt&&(ne.start=Be+qt*Vt)):tn>wt?An<wt&&(Vt=Ae(ne,Si,yi,Mi,Bi,wt),Kt&&(ne.start=Be+qt*Vt)):_i(ne,Si,yi,Le),An<nt&&tn>=nt&&(Vt=Ae(ne,Si,yi,Mi,Bi,nt),ps=!0),An>wt&&tn<=wt&&(Vt=Ae(ne,Si,yi,Mi,Bi,wt),ps=!0),!jt&&ps&&(Kt&&(ne.end=Be+qt*Vt),et.push(ne),ne=ti(Et)),Kt&&(Be+=qt)}var Nn=Et.length-3;Si=Et[Nn],yi=Et[Nn+1],Le=Et[Nn+2],(tn=Lt===0?Si:yi)>=nt&&tn<=wt&&_i(ne,Si,yi,Le),Nn=ne.length-3,jt&&Nn>=3&&(ne[Nn]!==ne[0]||ne[Nn+1]!==ne[1])&&_i(ne,ne[0],ne[1],ne[2]),ne.length&&et.push(ne)}function ti(Et){var et=[];return et.size=Et.size,et.start=Et.start,et.end=Et.end,et}function ci(Et,et,nt,wt,Lt,jt){for(var Kt=0;Kt<Et.length;Kt++)fi(Et[Kt],et,nt,wt,Lt,jt,!1)}function _i(Et,et,nt,wt){Et.push(et),Et.push(nt),Et.push(wt)}function Ei(Et,et,nt,wt,Lt,jt){var Kt=(jt-et)/(wt-et);return Et.push(jt),Et.push(nt+(Lt-nt)*Kt),Et.push(1),Kt}function Ji(Et,et,nt,wt,Lt,jt){var Kt=(jt-nt)/(Lt-nt);return Et.push(et+(wt-et)*Kt),Et.push(jt),Et.push(1),Kt}function Ri(Et,et){for(var nt=[],wt=0;wt<Et.length;wt++){var Lt,jt=Et[wt],Kt=jt.type;if(Kt==="Point"||Kt==="MultiPoint"||Kt==="LineString")Lt=Fn(jt.geometry,et);else if(Kt==="MultiLineString"||Kt==="Polygon"){Lt=[];for(var qt=0;qt<jt.geometry.length;qt++)Lt.push(Fn(jt.geometry[qt],et))}else if(Kt==="MultiPolygon")for(Lt=[],qt=0;qt<jt.geometry.length;qt++){for(var Vt=[],ne=0;ne<jt.geometry[qt].length;ne++)Vt.push(Fn(jt.geometry[qt][ne],et));Lt.push(Vt)}nt.push(Tt(jt.id,Kt,Lt,jt.tags))}return nt}function Fn(Et,et){var nt=[];nt.size=Et.size,Et.start!==void 0&&(nt.start=Et.start,nt.end=Et.end);for(var wt=0;wt<Et.length;wt+=3)nt.push(Et[wt]+et,Et[wt+1],Et[wt+2]);return nt}function Mn(Et,et){if(Et.transformed)return Et;var nt,wt,Lt,jt=1<<Et.z,Kt=Et.x,qt=Et.y;for(nt=0;nt<Et.features.length;nt++){var Vt=Et.features[nt],ne=Vt.geometry,Ae=Vt.type;if(Vt.geometry=[],Ae===1)for(wt=0;wt<ne.length;wt+=2)Vt.geometry.push(zn(ne[wt],ne[wt+1],et,jt,Kt,qt));else for(wt=0;wt<ne.length;wt++){var Be=[];for(Lt=0;Lt<ne[wt].length;Lt+=2)Be.push(zn(ne[wt][Lt],ne[wt][Lt+1],et,jt,Kt,qt));Vt.geometry.push(Be)}}return Et.transformed=!0,Et}function zn(Et,et,nt,wt,Lt,jt){return[Math.round(nt*(Et*wt-Lt)),Math.round(nt*(et*wt-jt))]}function Vn(Et,et,nt,wt,Lt){for(var jt=et===Lt.maxZoom?0:Lt.tolerance/((1<<et)*Lt.extent),Kt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:nt,y:wt,z:et,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},qt=0;qt<Et.length;qt++){Kt.numFeatures++,Us(Kt,Et[qt],jt,Lt);var Vt=Et[qt].minX,ne=Et[qt].minY,Ae=Et[qt].maxX,Be=Et[qt].maxY;Vt<Kt.minX&&(Kt.minX=Vt),ne<Kt.minY&&(Kt.minY=ne),Ae>Kt.maxX&&(Kt.maxX=Ae),Be>Kt.maxY&&(Kt.maxY=Be)}return Kt}function Us(Et,et,nt,wt){var Lt=et.geometry,jt=et.type,Kt=[];if(jt==="Point"||jt==="MultiPoint")for(var qt=0;qt<Lt.length;qt+=3)Kt.push(Lt[qt]),Kt.push(Lt[qt+1]),Et.numPoints++,Et.numSimplified++;else if(jt==="LineString")Mr(Kt,Lt,Et,nt,!1,!1);else if(jt==="MultiLineString"||jt==="Polygon")for(qt=0;qt<Lt.length;qt++)Mr(Kt,Lt[qt],Et,nt,jt==="Polygon",qt===0);else if(jt==="MultiPolygon")for(var Vt=0;Vt<Lt.length;Vt++){var ne=Lt[Vt];for(qt=0;qt<ne.length;qt++)Mr(Kt,ne[qt],Et,nt,!0,qt===0)}if(Kt.length){var Ae=et.tags||null;if(jt==="LineString"&&wt.lineMetrics){for(var Be in Ae={},et.tags)Ae[Be]=et.tags[Be];Ae.mapbox_clip_start=Lt.start/Lt.size,Ae.mapbox_clip_end=Lt.end/Lt.size}var Pe={geometry:Kt,type:jt==="Polygon"||jt==="MultiPolygon"?3:jt==="LineString"||jt==="MultiLineString"?2:1,tags:Ae};et.id!==null&&(Pe.id=et.id),Et.features.push(Pe)}}function Mr(Et,et,nt,wt,Lt,jt){var Kt=wt*wt;if(wt>0&&et.size<(Lt?Kt:wt))nt.numPoints+=et.length/3;else{for(var qt=[],Vt=0;Vt<et.length;Vt+=3)(wt===0||et[Vt+2]>Kt)&&(nt.numSimplified++,qt.push(et[Vt]),qt.push(et[Vt+1])),nt.numPoints++;Lt&&(function(ne,Ae){for(var Be=0,Pe=0,Si=ne.length,yi=Si-2;Pe<Si;yi=Pe,Pe+=2)Be+=(ne[Pe]-ne[yi])*(ne[Pe+1]+ne[yi+1]);if(Be>0===Ae)for(Pe=0,Si=ne.length;Pe<Si/2;Pe+=2){var Le=ne[Pe],Mi=ne[Pe+1];ne[Pe]=ne[Si-2-Pe],ne[Pe+1]=ne[Si-1-Pe],ne[Si-2-Pe]=Le,ne[Si-1-Pe]=Mi}})(qt,jt),Et.push(qt)}}function Cn(Et,et){var nt=(et=this.options=(function(Lt,jt){for(var Kt in jt)Lt[Kt]=jt[Kt];return Lt})(Object.create(this.options),et)).debug;if(nt&&console.time("preprocess data"),et.maxZoom<0||et.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(et.promoteId&&et.generateId)throw new Error("promoteId and generateId cannot be used together.");var wt=(function(Lt,jt){var Kt=[];if(Lt.type==="FeatureCollection")for(var qt=0;qt<Lt.features.length;qt++)Jt(Kt,Lt.features[qt],jt,qt);else Jt(Kt,Lt.type==="Feature"?Lt:{geometry:Lt},jt);return Kt})(Et,et);this.tiles={},this.tileCoords=[],nt&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",et.indexMaxZoom,et.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),wt=(function(Lt,jt){var Kt=jt.buffer/jt.extent,qt=Lt,Vt=Ne(Lt,1,-1-Kt,Kt,0,-1,2,jt),ne=Ne(Lt,1,1-Kt,2+Kt,0,-1,2,jt);return(Vt||ne)&&(qt=Ne(Lt,1,-Kt,1+Kt,0,-1,2,jt)||[],Vt&&(qt=Ri(Vt,1).concat(qt)),ne&&(qt=qt.concat(Ri(ne,-1)))),qt})(wt,et),wt.length&&this.splitTile(wt,0,0,0),nt&&(wt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function fs(Et,et,nt){return 32*((1<<Et)*nt+et)+Et}function Ys(Et,et){const nt=Et.tileID.canonical;if(!this._geoJSONIndex)return et(null,null);const wt=this._geoJSONIndex.getTile(nt.z,nt.x,nt.y);if(!wt)return et(null,null);const Lt=new class{constructor(Kt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=r.EXTENT,this.length=Kt.length,this._features=Kt}feature(Kt){return new class{constructor(qt){this._feature=qt,this.extent=r.EXTENT,this.type=qt.type,this.properties=qt.tags,"id"in qt&&!isNaN(qt.id)&&(this.id=parseInt(qt.id,10))}loadGeometry(){if(this._feature.type===1){const qt=[];for(const Vt of this._feature.geometry)qt.push([new r.Point(Vt[0],Vt[1])]);return qt}{const qt=[];for(const Vt of this._feature.geometry){const ne=[];for(const Ae of Vt)ne.push(new r.Point(Ae[0],Ae[1]));qt.push(ne)}return qt}}toGeoJSON(qt,Vt,ne){return Q.call(this,qt,Vt,ne)}}(this._features[Kt])}}(wt.features);let jt=he(Lt);jt.byteOffset===0&&jt.byteLength===jt.buffer.byteLength||(jt=new Uint8Array(jt)),et(null,{vectorTile:Lt,rawData:jt.buffer})}Cn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Cn.prototype.splitTile=function(Et,et,nt,wt,Lt,jt,Kt){for(var qt=[Et,et,nt,wt],Vt=this.options,ne=Vt.debug;qt.length;){wt=qt.pop(),nt=qt.pop(),et=qt.pop(),Et=qt.pop();var Ae=1<<et,Be=fs(et,nt,wt),Pe=this.tiles[Be];if(!Pe&&(ne>1&&console.time("creation"),Pe=this.tiles[Be]=Vn(Et,et,nt,wt,Vt),this.tileCoords.push({z:et,x:nt,y:wt}),ne)){ne>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",et,nt,wt,Pe.numFeatures,Pe.numPoints,Pe.numSimplified),console.timeEnd("creation"));var Si="z"+et;this.stats[Si]=(this.stats[Si]||0)+1,this.total++}if(Pe.source=Et,Lt){if(et===Vt.maxZoom||et===Lt)continue;var yi=1<<Lt-et;if(nt!==Math.floor(jt/yi)||wt!==Math.floor(Kt/yi))continue}else if(et===Vt.indexMaxZoom||Pe.numPoints<=Vt.indexMaxPoints)continue;if(Pe.source=null,Et.length!==0){ne>1&&console.time("clipping");var Le,Mi,Bi,tn,An,ps,Nn=.5*Vt.buffer/Vt.extent,$s=.5-Nn,cs=.5+Nn,is=1+Nn;Le=Mi=Bi=tn=null,An=Ne(Et,Ae,nt-Nn,nt+cs,0,Pe.minX,Pe.maxX,Vt),ps=Ne(Et,Ae,nt+$s,nt+is,0,Pe.minX,Pe.maxX,Vt),Et=null,An&&(Le=Ne(An,Ae,wt-Nn,wt+cs,1,Pe.minY,Pe.maxY,Vt),Mi=Ne(An,Ae,wt+$s,wt+is,1,Pe.minY,Pe.maxY,Vt),An=null),ps&&(Bi=Ne(ps,Ae,wt-Nn,wt+cs,1,Pe.minY,Pe.maxY,Vt),tn=Ne(ps,Ae,wt+$s,wt+is,1,Pe.minY,Pe.maxY,Vt),ps=null),ne>1&&console.timeEnd("clipping"),qt.push(Le||[],et+1,2*nt,2*wt),qt.push(Mi||[],et+1,2*nt,2*wt+1),qt.push(Bi||[],et+1,2*nt+1,2*wt),qt.push(tn||[],et+1,2*nt+1,2*wt+1)}}},Cn.prototype.getTile=function(Et,et,nt){var wt=this.options,Lt=wt.extent,jt=wt.debug;if(Et<0||Et>24)return null;var Kt=1<<Et,qt=fs(Et,et=(et%Kt+Kt)%Kt,nt);if(this.tiles[qt])return Mn(this.tiles[qt],Lt);jt>1&&console.log("drilling down to z%d-%d-%d",Et,et,nt);for(var Vt,ne=Et,Ae=et,Be=nt;!Vt&&ne>0;)ne--,Ae=Math.floor(Ae/2),Be=Math.floor(Be/2),Vt=this.tiles[fs(ne,Ae,Be)];return Vt&&Vt.source?(jt>1&&console.log("found parent tile z%d-%d-%d",ne,Ae,Be),jt>1&&console.time("drilling down"),this.splitTile(Vt.source,ne,Ae,Be,Et,et,nt),jt>1&&console.timeEnd("drilling down"),this.tiles[qt]?Mn(this.tiles[qt],Lt):null):null};class Eo extends r.VectorTileWorkerSource{constructor(et,nt,wt,Lt,jt){super(et,nt,wt,Lt,Ys),jt&&(this.loadGeoJSON=jt)}loadData(et,nt){const wt=et&&et.request,Lt=wt&&wt.collectResourceTiming;this.loadGeoJSON(et,((jt,Kt)=>{if(jt||!Kt)return nt(jt);if(typeof Kt!="object")return nt(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`));{W(Kt,!0);try{if(et.filter){const Vt=r.createExpression(et.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Vt.result==="error")throw new Error(Vt.value.map((Ae=>`${Ae.key}: ${Ae.message}`)).join(", "));Kt={type:"FeatureCollection",features:Kt.features.filter((Ae=>Vt.value.evaluate({zoom:0},Ae)))}}this._geoJSONIndex=et.cluster?new je((function({superclusterOptions:Vt,clusterProperties:ne}){if(!ne||!Vt)return Vt;const Ae={},Be={},Pe={accumulated:null,zoom:0},Si={properties:null},yi=Object.keys(ne);for(const Le of yi){const[Mi,Bi]=ne[Le],tn=r.createExpression(Bi),An=r.createExpression(typeof Mi=="string"?[Mi,["accumulated"],["get",Le]]:Mi);Ae[Le]=tn.value,Be[Le]=An.value}return Vt.map=Le=>{Si.properties=Le;const Mi={};for(const Bi of yi)Mi[Bi]=Ae[Bi].evaluate(Pe,Si);return Mi},Vt.reduce=(Le,Mi)=>{Si.properties=Mi;for(const Bi of yi)Pe.accumulated=Le[Bi],Le[Bi]=Be[Bi].evaluate(Pe,Si)},Vt})(et)).load(Kt.features):(function(Vt,ne){return new Cn(Vt,ne)})(Kt,et.geojsonVtOptions)}catch(Vt){return nt(Vt)}this.loaded={};const qt={};if(Lt){const Vt=r.getPerformanceMeasurement(wt);Vt&&(qt.resourceTiming={},qt.resourceTiming[et.source]=JSON.parse(JSON.stringify(Vt)))}nt(null,qt)}}))}reloadTile(et,nt){const wt=this.loaded;return wt&&wt[et.uid]?super.reloadTile(et,nt):this.loadTile(et,nt)}loadGeoJSON(et,nt){if(et.request)r.getJSON(et.request,nt);else{if(typeof et.data!="string")return nt(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`));try{return nt(null,JSON.parse(et.data))}catch{return nt(new Error(`Input data given to '${et.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(et,nt){try{nt(null,this._geoJSONIndex.getClusterExpansionZoom(et.clusterId))}catch(wt){nt(wt)}}getClusterChildren(et,nt){try{nt(null,this._geoJSONIndex.getChildren(et.clusterId))}catch(wt){nt(wt)}}getClusterLeaves(et,nt){try{nt(null,this._geoJSONIndex.getLeaves(et.clusterId,et.limit,et.offset))}catch(wt){nt(wt)}}}class ec{constructor(et){this.self=et,this.actor=new r.Actor(et,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=r.getProjection({name:"mercator"}),this.workerSourceTypes={vector:r.VectorTileWorkerSource,geojson:Eo},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(nt,wt)=>{if(this.workerSourceTypes[nt])throw new Error(`Worker source with name "${nt}" already registered.`);this.workerSourceTypes[nt]=wt},this.self.registerRTLTextPlugin=nt=>{if(r.plugin.isParsed())throw new Error("RTL text plugin already registered.");r.plugin.applyArabicShaping=nt.applyArabicShaping,r.plugin.processBidirectionalText=nt.processBidirectionalText,r.plugin.processStyledBidirectionalText=nt.processStyledBidirectionalText}}clearCaches(et,nt,wt){delete this.layerIndexes[et],delete this.availableImages[et],delete this.workerSources[et],delete this.demWorkerSources[et],wt()}checkIfReady(et,nt,wt){wt()}setReferrer(et,nt){this.referrer=nt}spriteLoaded(et,nt){this.isSpriteLoaded[et]=nt;for(const wt in this.workerSources[et]){const Lt=this.workerSources[et][wt];for(const jt in Lt)Lt[jt]instanceof r.VectorTileWorkerSource&&(Lt[jt].isSpriteLoaded=nt,Lt[jt].fire(new r.Event("isSpriteLoaded")))}}setImages(et,nt,wt){this.availableImages[et]=nt;for(const Lt in this.workerSources[et]){const jt=this.workerSources[et][Lt];for(const Kt in jt)jt[Kt].availableImages=nt}wt()}enableTerrain(et,nt,wt){this.terrain=nt,wt()}setProjection(et,nt){this.projections[et]=r.getProjection(nt)}setLayers(et,nt,wt){this.getLayerIndex(et).replace(nt),wt()}updateLayers(et,nt,wt){this.getLayerIndex(et).update(nt.layers,nt.removedIds),wt()}loadTile(et,nt,wt){const Lt=this.enableTerrain?r.extend({enableTerrain:this.terrain},nt):nt;Lt.projection=this.projections[et]||this.defaultProjection,this.getWorkerSource(et,nt.type,nt.source).loadTile(Lt,wt)}loadDEMTile(et,nt,wt){const Lt=this.enableTerrain?r.extend({buildQuadTree:this.terrain},nt):nt;this.getDEMWorkerSource(et,nt.source).loadTile(Lt,wt)}reloadTile(et,nt,wt){const Lt=this.enableTerrain?r.extend({enableTerrain:this.terrain},nt):nt;Lt.projection=this.projections[et]||this.defaultProjection,this.getWorkerSource(et,nt.type,nt.source).reloadTile(Lt,wt)}abortTile(et,nt,wt){this.getWorkerSource(et,nt.type,nt.source).abortTile(nt,wt)}removeTile(et,nt,wt){this.getWorkerSource(et,nt.type,nt.source).removeTile(nt,wt)}removeSource(et,nt,wt){if(!this.workerSources[et]||!this.workerSources[et][nt.type]||!this.workerSources[et][nt.type][nt.source])return;const Lt=this.workerSources[et][nt.type][nt.source];delete this.workerSources[et][nt.type][nt.source],Lt.removeSource!==void 0?Lt.removeSource(nt,wt):wt()}loadWorkerSource(et,nt,wt){try{this.self.importScripts(nt.url),wt()}catch(Lt){wt(Lt.toString())}}syncRTLPluginState(et,nt,wt){try{r.plugin.setState(nt);const Lt=r.plugin.getPluginURL();if(r.plugin.isLoaded()&&!r.plugin.isParsed()&&Lt!=null){this.self.importScripts(Lt);const jt=r.plugin.isParsed();wt(jt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Lt}`),jt)}}catch(Lt){wt(Lt.toString())}}getAvailableImages(et){let nt=this.availableImages[et];return nt||(nt=[]),nt}getLayerIndex(et){let nt=this.layerIndexes[et];return nt||(nt=this.layerIndexes[et]=new z),nt}getWorkerSource(et,nt,wt){if(this.workerSources[et]||(this.workerSources[et]={}),this.workerSources[et][nt]||(this.workerSources[et][nt]={}),!this.workerSources[et][nt][wt]){const Lt={send:(jt,Kt,qt,Vt,ne,Ae)=>{this.actor.send(jt,Kt,qt,et,ne,Ae)},scheduler:this.actor.scheduler};this.workerSources[et][nt][wt]=new this.workerSourceTypes[nt](Lt,this.getLayerIndex(et),this.getAvailableImages(et),this.isSpriteLoaded[et])}return this.workerSources[et][nt][wt]}getDEMWorkerSource(et,nt){return this.demWorkerSources[et]||(this.demWorkerSources[et]={}),this.demWorkerSources[et][nt]||(this.demWorkerSources[et][nt]=new R),this.demWorkerSources[et][nt]}enforceCacheSizeLimit(et,nt){r.enforceCacheSizeLimit(nt)}getWorkerPerformanceMetrics(et,nt,wt){wt(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new ec(self)),ec})),_(["./shared"],(function(r){function E(m,o){if(Array.isArray(m)){if(!Array.isArray(o)||m.length!==o.length)return!1;for(let h=0;h<m.length;h++)if(!E(m[h],o[h]))return!1;return!0}if(typeof m=="object"&&m!==null&&o!==null){if(typeof o!="object"||Object.keys(m).length!==Object.keys(o).length)return!1;for(const h in m)if(!E(m[h],o[h]))return!1;return!0}return m===o}var C=z;function z(m){return!(function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,w,S=new Blob([""],{type:"text/javascript"}),k=URL.createObjectURL(S);try{w=new Worker(k),g=!0}catch{g=!1}return w&&w.terminate(),URL.revokeObjectURL(k),g})()?"Uint8ClampedArray"in window?ArrayBuffer.isView?(function(){var g=document.createElement("canvas");g.width=g.height=1;var w=g.getContext("2d");if(!w)return!1;var S=w.getImageData(0,0,1,1);return S&&S.width===g.width})()?(R[h=o&&o.failIfMajorPerformanceCaveat]===void 0&&(R[h]=(function(g){var w,S=(function(k){var I=document.createElement("canvas"),B=Object.create(z.webGLContextAttributes);return B.failIfMajorPerformanceCaveat=k,I.getContext("webgl",B)||I.getContext("experimental-webgl",B)})(g);if(!S)return!1;try{w=S.createShader(S.VERTEX_SHADER)}catch{return!1}return!(!w||S.isContextLost())&&(S.shaderSource(w,"void main() {}"),S.compileShader(w),S.getShaderParameter(w,S.COMPILE_STATUS)===!0)})(h)),R[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h})(m)}var R={};function j(m,o,h){const g=r.window.document.createElement(m);return o!==void 0&&(g.className=o),h&&h.appendChild(g),g}function G(m,o,h){const g=r.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const w of Object.keys(o))g.setAttributeNS(null,w,o[w]);return h&&h.appendChild(g),g}z.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const W=r.window.document&&r.window.document.documentElement.style,Q=W&&W.userSelect!==void 0?"userSelect":"WebkitUserSelect";let rt;function ft(){W&&Q&&(rt=W[Q],W[Q]="none")}function xt(){W&&Q&&(W[Q]=rt)}function mt(m){m.preventDefault(),m.stopPropagation(),r.window.removeEventListener("click",mt,!0)}function bt(){r.window.addEventListener("click",mt,!0),r.window.setTimeout((()=>{r.window.removeEventListener("click",mt,!0)}),0)}function Ot(m,o){const h=m.getBoundingClientRect();return Bt(m,h,o)}function zt(m,o){const h=m.getBoundingClientRect(),g=[];for(let w=0;w<o.length;w++)g.push(Bt(m,h,o[w]));return g}function Rt(m){return r.window.InstallTrigger!==void 0&&m.button===2&&m.ctrlKey&&r.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function Bt(m,o,h){const g=m.offsetWidth===o.width?1:m.offsetWidth/o.width;return new r.Point((h.clientX-o.left)*g,(h.clientY-o.top)*g)}function Nt(m,o){var h=o[0],g=o[1],w=o[2],S=o[3],k=h*S-w*g;return k?(m[0]=S*(k=1/k),m[1]=-g*k,m[2]=-w*k,m[3]=h*k,m):null}function ee(m){const{userImage:o}=m;return!!(o&&o.render&&o.render())&&(m.data.replace(new Uint8Array(o.data.buffer)),!0)}class Wt extends r.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new r.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:h,callback:g}of this.requestors)this._notify(h,g);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,h){this._validate(o,h)&&(this.images[o]=h)}_validate(o,h){let g=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new r.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),g=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new r.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),g=!1),this._validateContent(h.content,h)||(this.fire(new r.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),g=!1),g}_validateStretch(o,h){if(!o)return!0;let g=0;for(const w of o){if(w[0]<g||w[1]<w[0]||h<w[1])return!1;g=w[1]}return!0}_validateContent(o,h){return!(o&&(o.length!==4||o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,h){h.version=this.images[o].version+1,this.images[o]=h,this.updatedImages[o]=!0}removeImage(o){const h=this.images[o];delete this.images[o],delete this.patterns[o],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,h){let g=!0;if(!this.isLoaded())for(const w of o)this.images[w]||(g=!1);this.isLoaded()||g?this._notify(o,h):this.requestors.push({ids:o,callback:h})}_notify(o,h){const g={};for(const w of o){this.images[w]||this.fire(new r.Event("styleimagemissing",{id:w}));const S=this.images[w];S?g[w]={data:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!!(S.userImage&&S.userImage.render)}:r.warnOnce(`Image "${w}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,g)}getPixelSize(){const{width:o,height:h}=this.atlasImage;return{width:o,height:h}}getPattern(o){const h=this.patterns[o],g=this.getImage(o);if(!g)return null;if(h&&h.position.version===g.version)return h.position;if(h)h.position.version=g.version;else{const w={w:g.data.width+2,h:g.data.height+2,x:0,y:0},S=new r.ImagePosition(w,g);this.patterns[o]={bin:w,position:S}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const h=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new r.Texture(o,this.atlasImage,h.RGBA),this.atlasTexture&&this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const S in this.patterns)o.push(this.patterns[S].bin);const{w:h,h:g}=r.potpack(o),w=this.atlasImage;w.resize({width:h||1,height:g||1});for(const S in this.patterns){const{bin:k}=this.patterns[S],I=k.x+1,B=k.y+1,V=this.images[S].data,U=V.width,K=V.height;r.RGBAImage.copy(V,w,{x:0,y:0},{x:I,y:B},{width:U,height:K}),r.RGBAImage.copy(V,w,{x:0,y:K-1},{x:I,y:B-1},{width:U,height:1}),r.RGBAImage.copy(V,w,{x:0,y:0},{x:I,y:B+K},{width:U,height:1}),r.RGBAImage.copy(V,w,{x:U-1,y:0},{x:I-1,y:B},{width:1,height:K}),r.RGBAImage.copy(V,w,{x:0,y:0},{x:I+U,y:B},{width:1,height:K})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const h of o){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const g=this.images[h];ee(g)&&this.updateImage(h,g)}}}const ae=new r.Properties({anchor:new r.DataConstantProperty(r.spec.light.anchor),position:new class{constructor(){this.specification=r.spec.light.position}possiblyEvaluate(m,o){return(function([h,g,w]){const S=r.degToRad(g+90),k=r.degToRad(w);return{x:h*Math.cos(S)*Math.sin(k),y:h*Math.sin(S)*Math.sin(k),z:h*Math.cos(k),azimuthal:g,polar:w}})(m.expression.evaluate(o))}interpolate(m,o,h){return{x:r.number(m.x,o.x,h),y:r.number(m.y,o.y,h),z:r.number(m.z,o.z,h),azimuthal:r.number(m.azimuthal,o.azimuthal,h),polar:r.number(m.polar,o.polar,h)}}},color:new r.DataConstantProperty(r.spec.light.color),intensity:new r.DataConstantProperty(r.spec.light.intensity)});class ye extends r.Evented{constructor(o){super(),this._transitionable=new r.Transitionable(ae),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h={}){if(!this._validate(r.validateLight,o,h))for(const g in o){const w=o[g];r.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),w):this._transitionable.setValue(g,w)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,g){return(!g||g.validate!==!1)&&r.emitValidationErrors(this,o.call(r.validateStyle,r.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}const He=new r.Properties({source:new r.DataConstantProperty(r.spec.terrain.source),exaggeration:new r.DataConstantProperty(r.spec.terrain.exaggeration)});let de=class extends r.Evented{constructor(m,o){super(),this._transitionable=new r.Transitionable(He),this.set(m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(m){for(const o in m){const h=m[o];r.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),h):this._transitionable.setValue(o,h)}}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}};function he(m,o,h,g){const w=r.smoothstep(45,65,h),[S,k]=oe(m,g),I=r.length(o);let B=1-Math.min(1,Math.exp((I-S)/(k-S)*-6));return B*=B*B,B=Math.min(1,1.00747*B),B*w*m.alpha}function oe(m,o){const h=.5/Math.tan(.5*o);return[m.range[0]+h,m.range[1]+h]}const Oe=new r.Properties({range:new r.DataConstantProperty(r.spec.fog.range),color:new r.DataConstantProperty(r.spec.fog.color),"high-color":new r.DataConstantProperty(r.spec.fog["high-color"]),"space-color":new r.DataConstantProperty(r.spec.fog["space-color"]),"horizon-blend":new r.DataConstantProperty(r.spec.fog["horizon-blend"]),"star-intensity":new r.DataConstantProperty(r.spec.fog["star-intensity"])});class Ue extends r.Evented{constructor(o,h){super(),this._transitionable=new r.Transitionable(Oe),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const o=this._transform,h=o.projection.name==="globe",g=r.globeToMercatorTransition(o.zoom),w=this.properties.get("range"),S=[.5,3];return{range:h?[r.number(S[0],w[0],g),r.number(S[1],w[1],g)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,h={}){if(!this._validate(r.validateFog,o,h)){for(const g of Object.keys(r.spec.fog))o&&o[g]===void 0&&(o[g]=r.spec.fog[g].default);for(const g in o){const w=o[g];r.endsWith(g,"-transition")?this._transitionable.setTransition(g.slice(0,-11),w):this._transitionable.setValue(g,w)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:r.smoothstep(45,65,o))*h.a}getOpacityAtLatLng(o,h){return this._transform.projection.supportsFog?(function(g,w,S){const k=r.MercatorCoordinate.fromLngLat(w),I=S.elevation?S.elevation.getAtPointOrZero(k):0,B=[k.x,k.y,I];return r.transformMat4(B,B,S.mercatorFogMatrix),he(g,B,S.pitch,S._fov)})(this.state,o,h):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?oe(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,g){return(!g||g.validate!==!1)&&r.emitValidationErrors(this,o.call(r.validateStyle,r.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:r.spec})))}}class $t{constructor(o,h){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=r.uniqueId();const g=this.workerPool.acquire(this.id);for(let w=0;w<g.length;w++){const S=new $t.Actor(g[w],h,this.id);S.name=`Worker ${w}`,this.actors.push(S)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(o,h,g){r.asyncAll(this.actors,((w,S)=>{w.send(o,h,S)}),g=g||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((o=>{o.remove()})),this.actors=[],this.workerPool.release(this.id)}}function ce(m,o,h){return o*(r.EXTENT/(m.tileSize*Math.pow(2,h-m.tileID.overscaledZ)))}$t.Actor=r.Actor;class Ve{constructor(o,h,g,w){this.screenBounds=o,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(o,h){let g,w;if(o instanceof r.Point||typeof o[0]=="number"){const S=r.Point.convert(o);g=[S],w=h.isPointAboveHorizon(S)}else{const S=r.Point.convert(o[0]),k=r.Point.convert(o[1]);g=[S,k],w=r.polygonizeBounds(S,k).every((I=>h.isPointAboveHorizon(I)))}return new Ve(g,h.getCameraPoint(),w,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return r.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const h=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new r.Point(1,1)):this.screenBounds[1],w=r.polygonizeBounds(h,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<g.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?w[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(w[3]=this.cameraPoint)),r.bufferConvexPolygon(w,o)}bufferedCameraGeometryGlobe(o){const h=this.screenBounds[0],g=this.screenBounds.length===1?this.screenBounds[0].add(new r.Point(1,1)):this.screenBounds[1],w=r.polygonizeBounds(h,g,o),S=this.cameraPoint.clone();switch(3*((S.y>h.y)+(S.y>g.y))+((S.x>h.x)+(S.x>g.x))){case 0:w[0]=S,w[4]=S.clone();break;case 1:w.splice(1,0,S);break;case 2:w[1]=S;break;case 3:w.splice(4,0,S);break;case 5:w.splice(2,0,S);break;case 6:w[3]=S;break;case 7:w.splice(3,0,S);break;case 8:w[2]=S}return w}containsTile(o,h,g,w=0){const S=o.queryPadding/h._pixelsPerMercatorPixel+1,k=g?this._bufferedCameraMercator(S,h):this._bufferedScreenMercator(S,h);let I=o.tileID.wrap+(k.unwrapped?w:0);const B=k.polygon.map((dt=>r.getTilePoint(o.tileTransform,dt,I)));if(!r.polygonIntersectsBox(B,0,0,r.EXTENT,r.EXTENT))return;I=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const V=this.screenGeometryMercator.polygon.map((dt=>r.getTileVec3(o.tileTransform,dt,I))),U=V.map((dt=>new r.Point(dt[0],dt[1]))),K=h.getFreeCameraOptions().position||new r.MercatorCoordinate(0,0,0),tt=r.getTileVec3(o.tileTransform,K,I),at=V.map((dt=>{const Y=r.sub(dt,dt,tt);return r.normalize(Y,Y),new r.Ray(tt,Y)})),ut=ce(o,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:U,tilespaceRays:at,bufferedTilespaceGeometry:B,bufferedTilespaceBounds:(lt=r.getBounds(B),lt.min.x=r.clamp(lt.min.x,0,r.EXTENT),lt.min.y=r.clamp(lt.min.y,0,r.EXTENT),lt.max.x=r.clamp(lt.max.x,0,r.EXTENT),lt.max.y=r.clamp(lt.max.y,0,r.EXTENT),lt),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:ut};var lt}_bufferedScreenMercator(o,h){const g=ri(o);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let w;return w=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),h):{polygon:this.bufferedScreenGeometry(o).map((S=>h.pointCoordinate3D(S))),unwrapped:!0},this._screenRaycastCache[g]=w,w}}_bufferedCameraMercator(o,h){const g=ri(o);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let w;return w=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),h):{polygon:this.bufferedCameraGeometry(o).map((S=>h.pointCoordinate3D(S))),unwrapped:!0},this._cameraRaycastCache[g]=w,w}}_projectAndResample(o,h){const g=(function(S,k){const I=r.multiply([],k.pixelMatrix,k.globeMatrix),B=[0,-r.GLOBE_RADIUS,0,1],V=[0,r.GLOBE_RADIUS,0,1],U=[0,0,0,1];r.transformMat4$1(B,B,I),r.transformMat4$1(V,V,I),r.transformMat4$1(U,U,I);const K=new r.Point(B[0]/B[3],B[1]/B[3]),tt=new r.Point(V[0]/V[3],V[1]/V[3]),at=r.polygonContainsPoint(S,K)&&B[3]<U[3],ut=r.polygonContainsPoint(S,tt)&&V[3]<U[3];if(!at&&!ut)return null;const lt=(function(kt,Zt,Ut){for(let Xt=1;Xt<kt.length;Xt++){const Te=Xe(Zt.pointCoordinate3D(kt[Xt-1]).x),Gt=Xe(Zt.pointCoordinate3D(kt[Xt]).x);if(Ut<0){if(Te<Gt)return{idx:Xt,t:-Te/(Gt-1-Te)}}else if(Gt<Te)return{idx:Xt,t:(1-Te)/(Gt+1-Te)}}return null})(S,k,at?-1:1);if(!lt)return null;const{idx:dt,t:Y}=lt;let st=dt>1?je(S.slice(0,dt),k):[],_t=dt<S.length?je(S.slice(dt),k):[];st=st.map((kt=>new r.Point(Xe(kt.x),kt.y))),_t=_t.map((kt=>new r.Point(Xe(kt.x),kt.y)));const gt=[...st];gt.length===0&&gt.push(_t[_t.length-1]);const Mt=r.number(gt[gt.length-1].y,(_t.length===0?st[0]:_t[0]).y,Y);let At;return At=at?[new r.Point(0,Mt),new r.Point(0,0),new r.Point(1,0),new r.Point(1,Mt)]:[new r.Point(1,Mt),new r.Point(1,1),new r.Point(0,1),new r.Point(0,Mt)],gt.push(...At),_t.length===0?gt.push(st[0]):gt.push(..._t),{polygon:gt.map((kt=>new r.MercatorCoordinate(kt.x,kt.y))),unwrapped:!1}})(o,h);if(g)return g;const w=(function(S,k){let I=!1,B=-1/0,V=0;for(let K=0;K<S.length-1;K++)S[K].x>B&&(B=S[K].x,V=K);for(let K=0;K<S.length-1;K++){const tt=(V+K)%(S.length-1),at=S[tt],ut=S[tt+1];Math.abs(at.x-ut.x)>.5&&(at.x<ut.x?(at.x+=1,tt===0&&(S[S.length-1].x+=1)):(ut.x+=1,tt+1===S.length-1&&(S[0].x+=1)),I=!0)}const U=r.mercatorXfromLng(k.center.lng);return I&&U<Math.abs(U-1)&&S.forEach((K=>{K.x-=1})),{polygon:S,unwrapped:I}})(je(o,h).map((S=>new r.Point(Xe(S.x),S.y))),h);return{polygon:w.polygon.map((S=>new r.MercatorCoordinate(S.x,S.y))),unwrapped:w.unwrapped}}}function je(m,o){return r.resample(m,(h=>{const g=o.pointCoordinate3D(h);h.x=g.x,h.y=g.y}),1/256)}function Xe(m){return m<0?1+m%1:m%1}function ri(m){return 100*m|0}function vi(m,o,h,g,w){const S=function(k,I){if(k)return w(k);if(I){m.url&&I.tiles&&m.tiles&&delete m.tiles;const B=r.pick(r.extend(I,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(B.vectorLayers=I.vector_layers,B.vectorLayerIds=B.vectorLayers.map((V=>V.id))),B.tiles=o.canonicalizeTileset(B,m.url),w(null,B)}};return m.url?r.getJSON(o.transformRequest(o.normalizeSourceURL(m.url,null,h,g),r.ResourceType.Source),S):r.exported.frame((()=>S(null,m)))}class Ii{constructor(o,h,g){this.bounds=r.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=h||0,this.maxzoom=g||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const h=Math.pow(2,o.z),g=Math.floor(r.mercatorXfromLng(this.bounds.getWest())*h),w=Math.floor(r.mercatorYfromLat(this.bounds.getNorth())*h),S=Math.ceil(r.mercatorXfromLng(this.bounds.getEast())*h),k=Math.ceil(r.mercatorYfromLat(this.bounds.getSouth())*h);return o.x>=g&&o.x<S&&o.y>=w&&o.y<k}}class Qe{constructor(o,h,g){this.context=o;const w=o.gl;this.buffer=w.createBuffer(),this.dynamicDraw=!!g,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),w.bufferData(w.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const _n={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ls{constructor(o,h,g,w){this.length=h.length,this.attributes=g,this.itemSize=h.bytesPerElement,this.dynamicDraw=w,this.context=o;const S=o.gl;this.buffer=S.createBuffer(),o.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let g=0;g<this.attributes.length;g++){const w=h.attributes[this.attributes[g].name];w!==void 0&&o.enableVertexAttribArray(w)}}setVertexAttribPointers(o,h,g){for(let w=0;w<this.attributes.length;w++){const S=this.attributes[w],k=h.attributes[S.name];k!==void 0&&o.vertexAttribPointer(k,S.components,o[_n[S.type]],!1,this.itemSize,S.offset+this.itemSize*(g||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Tt{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ft extends Tt{getDefault(){return r.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Jt extends Tt{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Se extends Tt{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class me extends Tt{getDefault(){return[!0,!0,!0,!0]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class we extends Tt{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Ke extends Tt{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class $e extends Tt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Ne extends Tt{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Re extends Tt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class fi extends Tt{getDefault(){return[0,1]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class ti extends Tt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class ci extends Tt{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class _i extends Tt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class Ei extends Tt{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class Ji extends Tt{getDefault(){return r.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Ri extends Tt{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Fn extends Tt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class Mn extends Tt{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class zn extends Tt{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let Vn,Us=class extends Tt{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Mr extends Tt{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Cn extends Tt{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class fs extends Tt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Ys extends Tt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Eo extends Tt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class ec extends Tt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Et extends Tt{getDefault(){return null}set(o){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class et extends Tt{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class nt extends Tt{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class wt extends Tt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Lt extends Tt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class jt extends Tt{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class Kt extends jt{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class qt extends jt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Vt extends qt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class ne{constructor(o,h,g,w){this.context=o,this.width=h,this.height=g;const S=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Kt(o,S),w&&(this.depthAttachment=new qt(o,S))}destroy(){const o=this.context.gl,h=this.colorAttachment.get();if(h&&o.deleteTexture(h),this.depthAttachment){const g=this.depthAttachment.get();g&&o.deleteRenderbuffer(g)}o.deleteFramebuffer(this.framebuffer)}}class Ae{constructor(o,h=!1){if(this.gl=o,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){const g=o;this.extVertexArrayObject={createVertexArrayOES:g.createVertexArray.bind(o),deleteVertexArrayOES:g.deleteVertexArray.bind(o),bindVertexArrayOES:g.bindVertexArray.bind(o)}}this.clearColor=new Ft(this),this.clearDepth=new Jt(this),this.clearStencil=new Se(this),this.colorMask=new me(this),this.depthMask=new we(this),this.stencilMask=new Ke(this),this.stencilFunc=new $e(this),this.stencilOp=new Ne(this),this.stencilTest=new Re(this),this.depthRange=new fi(this),this.depthTest=new ti(this),this.depthFunc=new ci(this),this.blend=new _i(this),this.blendFunc=new Ei(this),this.blendColor=new Ji(this),this.blendEquation=new Ri(this),this.cullFace=new Fn(this),this.cullFaceSide=new Mn(this),this.frontFace=new zn(this),this.program=new Us(this),this.activeTexture=new Mr(this),this.viewport=new Cn(this),this.bindFramebuffer=new fs(this),this.bindRenderbuffer=new Ys(this),this.bindTexture=new Eo(this),this.bindVertexBuffer=new ec(this),this.bindElementBuffer=new Et(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new et(this),this.pixelStoreUnpack=new nt(this),this.pixelStoreUnpackPremultiplyAlpha=new wt(this),this.pixelStoreUnpackFlipY=new Lt(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=o.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&o.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h){return new Qe(this,o,h)}createVertexBuffer(o,h,g){return new ls(this,o,h,g)}createRenderbuffer(o,h,g){const w=this.gl,S=w.createRenderbuffer();return this.bindRenderbuffer.set(S),w.renderbufferStorage(w.RENDERBUFFER,o,h,g),this.bindRenderbuffer.set(null),S}createFramebuffer(o,h,g){return new ne(this,o,h,g)}clear({color:o,depth:h,stencil:g}){const w=this.gl;let S=0;o&&(S|=w.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(S|=w.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),g!==void 0&&(S|=w.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),w.clear(S)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){E(o.blendFunction,r.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Be extends r.Evented{constructor(o,h,g,w){if(super(),this.id=o,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,r.extend(this,r.pick(h,["url","scheme","tileSize","promoteId"])),this._options=r.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new r.DedupedRequest}load(o){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map._worldview;this._tileJSONRequest=vi(this._options,this.map._requestManager,h,g,((w,S)=>{this._tileJSONRequest=null,this._loaded=!0,w?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),g&&g.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new r.ErrorEvent(w))):S&&(r.extend(this,S),S.bounds&&(this.tileBounds=new Ii(S.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(S.tiles,this.map._requestManager._customAccessToken),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(w)}))}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return r.extend({},this._options)}loadTile(o,h){const g=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(g,r.ResourceType.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile};if(w.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",w,S.bind(this));else if(o.actor=this._tileWorkers[g]=this._tileWorkers[g]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",w,S.bind(this),void 0,!0);else{const k=r.loadVectorTile.call({deduped:this._deduped},w,((I,B)=>{I||!B?S.call(this,I):(w.data={cacheControl:B.cacheControl,expires:B.expires,rawData:B.rawData.slice(0)},o.actor&&o.actor.send("loadTile",w,S.bind(this),void 0,!0))}),!0);o.request={cancel:k}}function S(k,I){return delete o.request,o.aborted?h(null):k&&k.status!==404?h(k):(I&&I.resourceTiming&&(o.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&o.setExpiryData(I),o.loadVectorData(I,this.map.painter),r.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id})}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Pe extends r.Evented{constructor(o,h,g,w){super(),this.id=o,this.dispatcher=g,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=r.extend({type:"raster"},h),r.extend(this,r.pick(h,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=vi(this._options,this.map._requestManager,null,null,((h,g)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new r.ErrorEvent(h)):g&&(r.extend(this,g),g.bounds&&(this.tileBounds=new Ii(g.bounds,this.minzoom,this.maxzoom)),r.postTurnstileEvent(g.tiles),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(h)}))}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return r.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){const g=r.exported.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);o.request=r.getImage(this.map._requestManager.transformRequest(w,r.ResourceType.Tile),((S,k,I,B)=>(delete o.request,o.aborted?(o.state="unloaded",h(null)):S?(o.state="errored",h(S)):k?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:I,expires:B}),o.setTexture(k,this.map.painter),o.state="loaded",r.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null))))}static loadTileData(o,h,g){o.setTexture(h,g)}static unloadTileData(o,h){o.texture&&h.saveTileTexture(o.texture)}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h()}unloadTile(o,h){o.texture&&this.map.painter.saveTileTexture(o.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Si(m,o,h,g,w,S,k,I){const B=[m,h,w,o,g,S,1,1,1],V=[k,I,1],U=r.adjoint([],B),[K,tt,at]=r.transformMat3(V,V,r.transpose(U,U));return r.multiply$1(B,[K,0,0,0,tt,0,0,0,at],B)}class yi extends r.Evented{constructor(o,h,g,w){super(),this.id=o,this.dispatcher=g,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(w),this.options=h,this._dirty=!1}load(o,h){this._loaded=h||!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=r.getImage(this.map._requestManager.transformRequest(this.url,r.ResourceType.Image),((g,w)=>{if(this._imageRequest=null,this._loaded=!0,g)this.fire(new r.ErrorEvent(g));else if(w){const{HTMLImageElement:S}=r.window;this.image=w instanceof S?r.exported.getImageData(w):w,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}}))}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const h=o.map(r.MercatorCoordinate.fromLngLat);return this.tileID=(function(g){let w=1/0,S=1/0,k=-1/0,I=-1/0;for(const K of g)w=Math.min(w,K.x),S=Math.min(S,K.y),k=Math.max(k,K.x),I=Math.max(I,K.y);const B=Math.max(k-w,I-S),V=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),U=Math.pow(2,V);return new r.CanonicalTileID(V,Math.floor((w+k)/2*U),Math.floor((S+I)/2*U))})(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const B in this.tiles){const V=this.tiles[B];V.state!=="loaded"&&(V.state="loaded",V.texture=this.texture)}if(this._boundsArray)return;const h=r.tileTransform(this.tileID,this.map.transform.projection),[g,w,S,k]=this.coordinates.map((B=>{const V=h.projection.project(B[0],B[1]);return r.getTilePoint(h,V)._round()}));this.perspectiveTransform=(function(B,V,U,K,tt,at,ut,lt,dt,Y){const st=Si(0,0,B,0,0,V,B,V),_t=Si(U,K,tt,at,ut,lt,dt,Y);return r.multiply$1(_t,r.adjoint(st,st),_t),[_t[6]/_t[8]*B/r.EXTENT,_t[7]/_t[8]*V/r.EXTENT]})(this.width,this.height,g.x,g.y,w.x,w.y,k.x,k.y,S.x,S.y);const I=this._boundsArray=new r.StructArrayLayout4i8;I.emplaceBack(g.x,g.y,0,0),I.emplaceBack(w.x,w.y,r.EXTENT,0),I.emplaceBack(k.x,k.y,0,r.EXTENT),I.emplaceBack(S.x,S.y,r.EXTENT,r.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(I,r.boundsAttributes.members),this.boundsSegments=r.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,h=o.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new r.Texture(o,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(o)}loadTile(o,h){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},h(null)):(o.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Le={vector:Be,raster:Pe,"raster-dem":class extends Pe{constructor(m,o,h,g){super(m,o,h,g),this.type="raster-dem",this.maxzoom=22,this._options=r.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(m,o){const h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(w,S){w&&(m.state="errored",o(w)),S&&(m.dem=S,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",o(null))}m.request=r.getImage(this.map._requestManager.transformRequest(h,r.ResourceType.Tile),(function(w,S,k,I){if(delete m.request,m.aborted)m.state="unloaded",o(null);else if(w)m.state="errored",o(w);else if(S){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:k,expires:I});const B=r.window.ImageBitmap&&S instanceof r.window.ImageBitmap&&(Vn==null&&(Vn=r.window.OffscreenCanvas&&new r.window.OffscreenCanvas(1,1).getContext("2d")&&typeof r.window.createImageBitmap=="function"),Vn),V=1-(S.width-r.prevPowerOfTwo(S.width))/2;V<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const U=B?S:r.exported.getImageData(S,V),K={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:U,encoding:this.encoding,padding:V};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",K,g.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){const o=m.canonical,h=Math.pow(2,o.z),g=(o.x-1+h)%h,w=o.x===0?m.wrap-1:m.wrap,S=(o.x+1+h)%h,k=o.x+1===h?m.wrap+1:m.wrap,I={};return I[new r.OverscaledTileID(m.overscaledZ,w,o.z,g,o.y).key]={backfilled:!1},I[new r.OverscaledTileID(m.overscaledZ,k,o.z,S,o.y).key]={backfilled:!1},o.y>0&&(I[new r.OverscaledTileID(m.overscaledZ,w,o.z,g,o.y-1).key]={backfilled:!1},I[new r.OverscaledTileID(m.overscaledZ,m.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},I[new r.OverscaledTileID(m.overscaledZ,k,o.z,S,o.y-1).key]={backfilled:!1}),o.y+1<h&&(I[new r.OverscaledTileID(m.overscaledZ,w,o.z,g,o.y+1).key]={backfilled:!1},I[new r.OverscaledTileID(m.overscaledZ,m.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},I[new r.OverscaledTileID(m.overscaledZ,k,o.z,S,o.y+1).key]={backfilled:!1}),I}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends r.Evented{constructor(m,o,h,g){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(g),this._data=o.data,this._options=r.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const w=r.EXTENT/this.tileSize;this.workerOptions=r.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*w,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*w,extent:r.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:r.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*w,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},o),this}getClusterChildren(m,o){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},o),this}getClusterLeaves(m,o,h,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:o,offset:h},g),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new r.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=r.extend({},this.workerOptions),o=this._data;typeof o=="string"?(m.request=this.map._requestManager.transformRequest(r.exported.resolveURL(o),r.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,((h,g)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new r.ErrorEvent(h));else{const w={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&g&&g.resourceTiming&&g.resourceTiming[this.id]&&(w.resourceTiming=g.resourceTiming[this.id]),this.fire(new r.Event("data",w)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(m,o){const h=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(h,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:r.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((g,w)=>(delete m.request,m.unloadVectorData(),m.aborted?o(null):g?o(g):(m.loadVectorData(w,this.map.painter,h==="reloadTile"),o(null)))),void 0,h==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return r.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends yi{constructor(m,o,h,g){super(m,o,h,g),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const o of m.urls)this.urls.push(this.map._requestManager.transformRequest(o,r.ResourceType.Source).url);r.getVideo(this.urls,((o,h)=>{this._loaded=!0,o?this.fire(new r.ErrorEvent(o)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const o=this.video.seekable;m<o.start(0)||m>o.end(0)?this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,o=m.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new r.Texture(m,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:yi,canvas:class extends yi{constructor(m,o,h,g){super(m,o,h,g),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((w=>!Array.isArray(w)||w.length!==2||w.some((S=>typeof S!="number"))))||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof r.window.HTMLCanvasElement||this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new r.ErrorEvent(new r.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof r.window.HTMLCanvasElement?this.options.canvas:r.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new r.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new r.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends r.Evented{constructor(m,o,h,g){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=o,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new r.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new r.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ii(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),r.extend(this,r.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return r.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new r.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new r.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:o,y:h,z:g}=m.canonical;return this._implementation.hasTile({x:o,y:h,z:g})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,o){const{x:h,y:g,z:w}=m.tileID.canonical,S=new r.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:h,y:g,z:w},{signal:S.signal})).then((function(k){return delete m.request,m.aborted?(m.state="unloaded",o(null)):k===void 0?(m.state="errored",o(null)):k===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",o(null)):(function(I){return I instanceof r.window.ImageData||I instanceof r.window.HTMLCanvasElement||I instanceof r.window.ImageBitmap||I instanceof r.window.HTMLImageElement})(k)?(this.loadTileData(m,k),m.state="loaded",void o(null)):(m.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((k=>{k.code!==20&&(m.state="errored",o(k))})),m.request.cancel=()=>S.abort()}loadTileData(m,o){Pe.loadTileData(m,o,this._map.painter)}unloadTileData(m){Pe.unloadTileData(m,this._map.painter)}unloadTile(m,o){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:h,y:g,z:w}=m.tileID.canonical;this._implementation.unloadTile({x:h,y:g,z:w})}o()}abortTile(m,o){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z})))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new r.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Mi=function(m,o,h,g){const w=new Le[o.type](m,o,h,g);if(w.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${w.id}`);return r.bindAll(["load","abort","unload","serialize","prepare"],w),w};function Bi(m,o){const h=r.identity([]);return r.scale(h,h,[.5*m.width,.5*-m.height,1]),r.translate(h,h,[1,-1,0]),r.multiply(h,h,m.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(h)}function tn(m,o,h,g,w,S,k,I=!1){const B=m.tilesIn(g,k,I);B.sort(ps);const V=[];for(const K of B)V.push({wrappedTileID:K.tile.tileID.wrapped().key,queryResults:K.tile.queryRenderedFeatures(o,h,m._state,K,w,S,Bi(m.transform,K.tile.tileID),I)});const U=(function(K){const tt={},at={};for(const ut of K){const lt=ut.queryResults,dt=ut.wrappedTileID,Y=at[dt]=at[dt]||{};for(const st in lt){const _t=lt[st],gt=Y[st]=Y[st]||{},Mt=tt[st]=tt[st]||[];for(const At of _t)gt[At.featureIndex]||(gt[At.featureIndex]=!0,Mt.push(At))}}return tt})(V);for(const K in U)U[K].forEach((tt=>{const at=tt.feature,ut=at.layer;ut&&ut.type!=="background"&&ut.type!=="sky"&&(at.source=ut.source,ut["source-layer"]&&(at.sourceLayer=ut["source-layer"]),at.state=at.id!==void 0?m.getFeatureState(ut["source-layer"],at.id):{})}));return U}function An(m,o){const h=m.getRenderableIds().map((S=>m.getTileByID(S))),g=[],w={};for(let S=0;S<h.length;S++){const k=h[S],I=k.tileID.canonical.key;w[I]||(w[I]=!0,k.querySourceFeatures(g,o))}return g}function ps(m,o){const h=m.tileID,g=o.tileID;return h.overscaledZ-g.overscaledZ||h.canonical.y-g.canonical.y||h.wrap-g.wrap||h.canonical.x-g.canonical.x}function Nn(){return pt.workerClass!=null?new pt.workerClass:new r.window.Worker(pt.workerUrl)}const $s="mapboxgl_preloaded_worker_pool";class cs{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<cs.workerCount;)this.workers.push(new Nn);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach((h=>{h.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[$s]}numActive(){return Object.keys(this.active).length}}let is;function ns(){return is||(is=new cs),is}function ur(m,o){const h={};for(const g in m)g!=="ref"&&(h[g]=m[g]);return r.refProperties.forEach((g=>{g in o&&(h[g]=o[g])})),h}function Js(m){m=m.slice();const o=Object.create(null);for(let h=0;h<m.length;h++)o[m[h].id]=m[h];for(let h=0;h<m.length;h++)"ref"in m[h]&&(m[h]=ur(m[h],o[m[h].ref]));return m}cs.workerCount=2;const Ti={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ja(m,o,h){h.push({command:Ti.addSource,args:[m,o[m]]})}function hr(m,o,h){o.push({command:Ti.removeSource,args:[m]}),h[m]=!0}function So(m,o,h,g){hr(m,h,g),ja(m,o,h)}function Mo(m,o,h){let g;for(g in m[h])if(m[h].hasOwnProperty(g)&&g!=="data"&&!E(m[h][g],o[h][g]))return!1;for(g in o[h])if(o[h].hasOwnProperty(g)&&g!=="data"&&!E(m[h][g],o[h][g]))return!1;return!0}function jr(m,o,h,g,w,S){let k;for(k in o=o||{},m=m||{})m.hasOwnProperty(k)&&(E(m[k],o[k])||h.push({command:S,args:[g,k,o[k],w]}));for(k in o)o.hasOwnProperty(k)&&!m.hasOwnProperty(k)&&(E(m[k],o[k])||h.push({command:S,args:[g,k,o[k],w]}))}function Vr(m){return m.id}function Vo(m,o){return m[o.id]=o,m}class Va{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=r.clamp(o,0,1);let h=1,g=this._distances[h];const w=o*this.paddedLength+this.padding;for(;g<w&&h<this._distances.length;)g=this._distances[++h];const S=h-1,k=this._distances[S],I=g-k,B=I>0?(w-k)/I:0;return this.points[S].mult(1-B).add(this.points[h].mult(B))}}class dr{constructor(o,h,g){const w=this.boxCells=[],S=this.circleCells=[];this.xCellCount=Math.ceil(o/g),this.yCellCount=Math.ceil(h/g);for(let k=0;k<this.xCellCount*this.yCellCount;k++)w.push([]),S.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,g,w,S){this._forEachCell(h,g,w,S,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(w),this.bboxes.push(S)}insertCircle(o,h,g,w){this._forEachCell(h-w,g-w,h+w,g+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(g),this.circles.push(w)}_insertBoxCell(o,h,g,w,S,k){this.boxCells[S].push(k)}_insertCircleCell(o,h,g,w,S,k){this.circleCells[S].push(k)}_query(o,h,g,w,S,k){if(g<0||o>this.width||w<0||h>this.height)return!S&&[];const I=[];if(o<=0&&h<=0&&this.width<=g&&this.height<=w){if(S)return!0;for(let B=0;B<this.boxKeys.length;B++)I.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const V=this.circles[3*B],U=this.circles[3*B+1],K=this.circles[3*B+2];I.push({key:this.circleKeys[B],x1:V-K,y1:U-K,x2:V+K,y2:U+K})}return k?I.filter(k):I}return this._forEachCell(o,h,g,w,this._queryCell,I,{hitTest:S,seenUids:{box:{},circle:{}}},k),S?I.length>0:I}_queryCircle(o,h,g,w,S){const k=o-g,I=o+g,B=h-g,V=h+g;if(I<0||k>this.width||V<0||B>this.height)return!w&&[];const U=[];return this._forEachCell(k,B,I,V,this._queryCellCircle,U,{hitTest:w,circle:{x:o,y:h,radius:g},seenUids:{box:{},circle:{}}},S),w?U.length>0:U}query(o,h,g,w,S){return this._query(o,h,g,w,!1,S)}hitTest(o,h,g,w,S){return this._query(o,h,g,w,!0,S)}hitTestCircle(o,h,g,w){return this._queryCircle(o,h,g,!0,w)}_queryCell(o,h,g,w,S,k,I,B){const V=I.seenUids,U=this.boxCells[S];if(U!==null){const tt=this.bboxes;for(const at of U)if(!V.box[at]){V.box[at]=!0;const ut=4*at;if(o<=tt[ut+2]&&h<=tt[ut+3]&&g>=tt[ut+0]&&w>=tt[ut+1]&&(!B||B(this.boxKeys[at]))){if(I.hitTest)return k.push(!0),!0;k.push({key:this.boxKeys[at],x1:tt[ut],y1:tt[ut+1],x2:tt[ut+2],y2:tt[ut+3]})}}}const K=this.circleCells[S];if(K!==null){const tt=this.circles;for(const at of K)if(!V.circle[at]){V.circle[at]=!0;const ut=3*at;if(this._circleAndRectCollide(tt[ut],tt[ut+1],tt[ut+2],o,h,g,w)&&(!B||B(this.circleKeys[at]))){if(I.hitTest)return k.push(!0),!0;{const lt=tt[ut],dt=tt[ut+1],Y=tt[ut+2];k.push({key:this.circleKeys[at],x1:lt-Y,y1:dt-Y,x2:lt+Y,y2:dt+Y})}}}}}_queryCellCircle(o,h,g,w,S,k,I,B){const V=I.circle,U=I.seenUids,K=this.boxCells[S];if(K!==null){const at=this.bboxes;for(const ut of K)if(!U.box[ut]){U.box[ut]=!0;const lt=4*ut;if(this._circleAndRectCollide(V.x,V.y,V.radius,at[lt+0],at[lt+1],at[lt+2],at[lt+3])&&(!B||B(this.boxKeys[ut])))return k.push(!0),!0}}const tt=this.circleCells[S];if(tt!==null){const at=this.circles;for(const ut of tt)if(!U.circle[ut]){U.circle[ut]=!0;const lt=3*ut;if(this._circlesCollide(at[lt],at[lt+1],at[lt+2],V.x,V.y,V.radius)&&(!B||B(this.circleKeys[ut])))return k.push(!0),!0}}}_forEachCell(o,h,g,w,S,k,I,B){const V=this._convertToXCellCoord(o),U=this._convertToYCellCoord(h),K=this._convertToXCellCoord(g),tt=this._convertToYCellCoord(w);for(let at=V;at<=K;at++)for(let ut=U;ut<=tt;ut++)if(S.call(this,o,h,g,w,this.xCellCount*ut+at,k,I,B))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,g,w,S,k){const I=w-o,B=S-h,V=g+k;return V*V>I*I+B*B}_circleAndRectCollide(o,h,g,w,S,k,I){const B=(k-w)/2,V=Math.abs(o-(w+B));if(V>B+g)return!1;const U=(I-S)/2,K=Math.abs(h-(S+U));if(K>U+g)return!1;if(V<=B||K<=U)return!0;const tt=V-B,at=K-U;return tt*tt+at*at<=g*g}}const Cr={unknown:0,flipRequired:1,flipNotRequired:2},ma=Math.tan(85*Math.PI/180);function le(m,o,h,g,w,S,k){const I=r.create();if(h)if(S.name==="globe"){const B=r.calculateGlobeLabelMatrix(w,o);r.multiply(I,I,B)}else{const B=Nt([],k);I[0]=B[0],I[1]=B[1],I[4]=B[2],I[5]=B[3],g||r.rotateZ(I,I,w.angle)}else r.multiply(I,w.labelPlaneMatrix,m);return I}function Vi(m,o,h,g,w,S,k){const I=le(m,o,h,g,w,S,k);return S.name==="globe"&&h||(I[2]=I[6]=I[10]=I[14]=0),I}function Li(m,o,h,g,w,S,k){if(h){if(S.name==="globe"){const I=le(m,o,h,g,w,S,k);return r.invert(I,I),r.multiply(I,m,I),I}{const I=r.clone(m),B=r.identity([]);return B[0]=k[0],B[1]=k[1],B[4]=k[2],B[5]=k[3],r.multiply(I,I,B),g||r.rotateZ(I,I,-w.angle),I}}return w.glCoordMatrix}function Un(m,o,h,g){const w=[m,o,h,1];h?r.transformMat4$1(w,w,g):xi(w,w,g);const S=w[3];return w[0]/=S,w[1]/=S,w[2]/=S,w}function Uo(m,o){return Math.min(.5+m/o*.5,1.5)}function Is(m,o){const h=m[0]/m[3],g=m[1]/m[3];return h>=-o[0]&&h<=o[0]&&g>=-o[1]&&g<=o[1]}function Ua(m,o,h,g,w,S,k,I,B,V){const U=h.transform,K=g?m.textSizeData:m.iconSizeData,tt=r.evaluateSizeForZoom(K,h.transform.zoom),at=U.projection.name==="globe",ut=[256/h.width*2+1,256/h.height*2+1],lt=g?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;lt.clear();let dt=null;at&&(dt=g?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const Y=m.lineVertexArray,st=g?m.text.placedSymbolArray:m.icon.placedSymbolArray,_t=h.transform.width/h.transform.height;let gt,Mt=!1;for(let At=0;At<st.length;At++){const kt=st.get(At),{numGlyphs:Zt,writingMode:Ut}=kt;if(Ut!==r.WritingMode.vertical||Mt||gt===r.WritingMode.horizontal||(Mt=!0),gt=Ut,(kt.hidden||Ut===r.WritingMode.vertical)&&!Mt){Ls(Zt,lt);continue}Mt=!1;const Xt=new r.Point(kt.tileAnchorX,kt.tileAnchorY);let{x:Te,y:Gt,z:fe}=U.projection.projectTilePoint(Xt.x,Xt.y,V.canonical);if(B){const[bi,ei,li]=B(Xt);Te+=bi,Gt+=ei,fe+=li}const te=[Te,Gt,fe,1];if(r.transformMat4$1(te,te,o),!Is(te,ut)){Ls(Zt,lt);continue}const Ee=Uo(h.transform.cameraToCenterDistance,te[3]),Ht=r.evaluateSizeForFeature(K,tt,kt),se=k?Ht/Ee:Ht*Ee,be=Un(Te,Gt,fe,w);if(be[3]<=0){Ls(Zt,lt);continue}let ge={};const Me=k?null:B,ai=Fe(kt,se,!1,I,o,w,S,m.glyphOffsetArray,Y,lt,dt,be,Xt,ge,_t,Me,U.projection,V,k);Mt=ai.useVertical,Me&&ai.needsFlipping&&(ge={}),(ai.notEnoughRoom||Mt||ai.needsFlipping&&Fe(kt,se,!0,I,o,w,S,m.glyphOffsetArray,Y,lt,dt,be,Xt,ge,_t,Me,U.projection,V,k).notEnoughRoom)&&Ls(Zt,lt)}g?(m.text.dynamicLayoutVertexBuffer.updateData(lt),dt&&m.text.globeExtVertexBuffer.updateData(dt)):(m.icon.dynamicLayoutVertexBuffer.updateData(lt),dt&&m.icon.globeExtVertexBuffer.updateData(dt))}function Fi(m,o,h,g,w,S,k,I,B,V,U,K,tt,at,ut,lt){const{lineStartIndex:dt,glyphStartIndex:Y,segment:st}=I,_t=Y+I.numGlyphs,gt=dt+I.lineLength,Mt=o.getoffsetX(Y),At=o.getoffsetX(_t-1),kt=On(m*Mt,h,g,w,S,k,st,dt,gt,B,V,U,K,tt,!0,at,ut,lt);if(!kt)return null;const Zt=On(m*At,h,g,w,S,k,st,dt,gt,B,V,U,K,tt,!0,at,ut,lt);return Zt?{first:kt,last:Zt}:null}function gn(m,o,h,g){return m===r.WritingMode.horizontal&&Math.abs(g)>Math.abs(h)?{useVertical:!0}:m===r.WritingMode.vertical?g>0?{needsFlipping:!0}:null:o!==Cr.unknown&&(function(w,S){return w===0||Math.abs(S/w)>ma})(h,g)?o===Cr.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function Fe(m,o,h,g,w,S,k,I,B,V,U,K,tt,at,ut,lt,dt,Y,st){const _t=o/24,gt=m.lineOffsetX*_t,Mt=m.lineOffsetY*_t,{lineStartIndex:At,glyphStartIndex:kt,numGlyphs:Zt,segment:Ut,writingMode:Xt,flipState:Te}=m,Gt=At+m.lineLength,fe=te=>{if(U){const[be,ge,Me]=te.up,ai=V.length;r.updateGlobeVertexNormal(U,ai+0,be,ge,Me),r.updateGlobeVertexNormal(U,ai+1,be,ge,Me),r.updateGlobeVertexNormal(U,ai+2,be,ge,Me),r.updateGlobeVertexNormal(U,ai+3,be,ge,Me)}const[Ee,Ht,se]=te.point;r.addDynamicAttributes(V,Ee,Ht,se,te.angle)};if(Zt>1){const te=Fi(_t,I,gt,Mt,h,K,tt,m,B,S,at,lt,!1,dt,Y,st);if(!te)return{notEnoughRoom:!0};if(g&&!h){let[Ee,Ht,se]=te.first.point,[be,ge,Me]=te.last.point;[Ee,Ht]=Un(Ee,Ht,se,k),[be,ge]=Un(be,ge,Me,k);const ai=gn(Xt,Te,(be-Ee)*ut,ge-Ht);if(m.flipState=ai&&ai.needsFlipping?Cr.flipRequired:Cr.flipNotRequired,ai)return ai}fe(te.first);for(let Ee=kt+1;Ee<kt+Zt-1;Ee++){const Ht=On(_t*I.getoffsetX(Ee),gt,Mt,h,K,tt,Ut,At,Gt,B,S,at,lt,!1,!1,dt,Y,st);if(!Ht)return V.length-=4*(Ee-kt),{notEnoughRoom:!0};fe(Ht)}fe(te.last)}else{if(g&&!h){const Ee=Un(tt.x,tt.y,0,w),Ht=At+Ut+1,se=new r.Point(B.getx(Ht),B.gety(Ht)),be=Un(se.x,se.y,0,w),ge=be[3]>0?be:hi(tt,se,Ee,1,w,void 0,dt,Y.canonical),Me=gn(Xt,Te,(ge[0]-Ee[0])*ut,ge[1]-Ee[1]);if(m.flipState=Me&&Me.needsFlipping?Cr.flipRequired:Cr.flipNotRequired,Me)return Me}const te=On(_t*I.getoffsetX(kt),gt,Mt,h,K,tt,Ut,At,Gt,B,S,at,lt,!1,!1,dt,Y,st);if(!te)return{notEnoughRoom:!0};fe(te)}return{}}function mi(m,o,h,g,w){const{x:S,y:k,z:I}=g.projectTilePoint(m.x,m.y,o);if(!w)return Un(S,k,I,h);const[B,V,U]=w(m);return Un(S+B,k+V,I+U,h)}function hi(m,o,h,g,w,S,k,I){const B=mi(m.sub(o)._unit()._add(m),I,w,k,S);return r.sub(B,h,B),r.normalize(B,B),r.scaleAndAdd(B,h,B,g)}function On(m,o,h,g,w,S,k,I,B,V,U,K,tt,at,ut,lt,dt,Y){const st=g?m-o:m+o;let _t=st>0?1:-1,gt=0;g&&(_t*=-1,gt=Math.PI),_t<0&&(gt+=Math.PI);let Mt=I+k+(_t>0?0:1)|0,At=w,kt=w,Zt=0,Ut=0;const Xt=Math.abs(st),Te=[],Gt=[];let fe=S,te=fe;const Ee=()=>hi(te,fe,kt,Xt-Zt+1,U,tt,lt,dt.canonical);for(;Zt+Ut<=Xt;){if(Mt+=_t,Mt<I||Mt>=B)return null;if(kt=At,te=fe,Te.push(kt),at&&Gt.push(te),fe=new r.Point(V.getx(Mt),V.gety(Mt)),At=K[Mt],!At){const li=mi(fe,dt.canonical,U,lt,tt);At=li[3]>0?K[Mt]=li:Ee()}Zt+=Ut,Ut=r.distance(kt,At)}ut&&tt&&(K[Mt]&&(At=Ee(),Ut=r.distance(kt,At)),K[Mt]=At);const Ht=(Xt-Zt)/Ut,se=fe.sub(te)._mult(Ht)._add(te),be=r.sub([],At,kt),ge=r.scaleAndAdd([],kt,be,Ht);let Me=[0,0,1],ai=be[0],bi=be[1];if(Y&&(Me=lt.upVector(dt.canonical,se.x,se.y),Me[0]!==0||Me[1]!==0||Me[2]!==1)){const li=[Me[2],0,-Me[0]],$i=r.cross([],Me,li);r.normalize(li,li),r.normalize($i,$i),ai=r.dot(be,li),bi=r.dot(be,$i)}if(h){const li=r.cross([],Me,be);r.normalize(li,li),r.scaleAndAdd(ge,ge,li,h*_t)}const ei=gt+Math.atan2(bi,ai);return Te.push(ge),at&&Gt.push(se),{point:ge,angle:ei,path:Te,tilePath:Gt,up:Me}}function Ls(m,o){const h=o.length,g=h+4*m;o.resize(g),o.float32.fill(-1/0,4*h,4*g)}function xi(m,o,h){const g=o[0],w=o[1];return m[0]=h[0]*g+h[4]*w+h[12],m[1]=h[1]*g+h[5]*w+h[13],m[3]=h[3]*g+h[7]*w+h[15],m}const Ui=100;class xs{constructor(o,h,g=new dr(o.width+200,o.height+200,25),w=new dr(o.width+200,o.height+200,25)){this.transform=o,this.grid=g,this.ignoredGrid=w,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Ui,this.screenBottomBoundary=o.height+Ui,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=h}placeCollisionBox(o,h,g,w,S,k,I,B){let V=g.projectedAnchorX,U=g.projectedAnchorY,K=g.projectedAnchorZ;const tt=g.elevation,at=g.tileID,ut=o.getProjection();if(tt&&at){const[At,kt,Zt]=ut.upVector(at.canonical,g.tileAnchorX,g.tileAnchorY),Ut=ut.upVectorScale(at.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;V+=At*tt*Ut,U+=kt*tt*Ut,K+=Zt*tt*Ut}const lt=this.projectAndGetPerspectiveRatio(I,V,U,K,g.tileID,ut.name==="globe"||!!tt||this.transform.pitch>0,ut),dt=k*lt.perspectiveRatio,Y=(g.x1*h+w.x-g.padding)*dt+lt.point.x,st=(g.y1*h+w.y-g.padding)*dt+lt.point.y,_t=(g.x2*h+w.x+g.padding)*dt+lt.point.x,gt=(g.y2*h+w.y+g.padding)*dt+lt.point.y,Mt=lt.perspectiveRatio<=.55||lt.occluded;return!this.isInsideGrid(Y,st,_t,gt)||!S&&this.grid.hitTest(Y,st,_t,gt,B)||Mt?{box:[],offscreen:!1,occluded:lt.occluded}:{box:[Y,st,_t,gt],offscreen:this.isOffscreen(Y,st,_t,gt),occluded:!1}}placeCollisionCircles(o,h,g,w,S,k,I,B,V,U,K,tt,at,ut,lt){const dt=[],Y=this.transform.elevation,st=o.getProjection(),_t=Y?Y.getAtTileOffsetFunc(lt,this.transform.center.lat,this.transform.worldSize,st):null,gt=new r.Point(g.tileAnchorX,g.tileAnchorY);let{x:Mt,y:At,z:kt}=st.projectTilePoint(gt.x,gt.y,lt.canonical);if(_t){const[se,be,ge]=_t(gt);Mt+=se,At+=be,kt+=ge}const Zt=st.name==="globe",Ut=this.projectAndGetPerspectiveRatio(I,Mt,At,kt,lt,Zt||!!Y||this.transform.pitch>0,st),{perspectiveRatio:Xt}=Ut,Te=(K?k/Xt:k*Xt)/r.ONE_EM,Gt=Un(Mt,At,kt,B),fe=Ut.signedDistanceFromCamera>0?Fi(Te,S,g.lineOffsetX*Te,g.lineOffsetY*Te,!1,Gt,gt,g,w,B,{},Y&&!K?_t:null,K&&!!Y,st,lt,K):null;let te=!1,Ee=!1,Ht=!0;if(fe&&!Ut.occluded){const se=.5*at*Xt+ut,be=new r.Point(-100,-100),ge=new r.Point(this.screenRightBoundary,this.screenBottomBoundary),Me=new Va,{first:ai,last:bi}=fe,ei=ai.path.length;let li=[];for(let oi=ei-1;oi>=1;oi--)li.push(ai.path[oi]);for(let oi=1;oi<bi.path.length;oi++)li.push(bi.path[oi]);const $i=2.5*se;V&&(li=li.map((([oi,en,un],mn)=>(_t&&!Zt&&(un=_t(mn<ei-1?ai.tilePath[ei-1-mn]:bi.tilePath[mn-ei+2])[2]),Un(oi,en,un,V)))),li.some((oi=>oi[3]<=0))&&(li=[]));let ji=[];if(li.length>0){let oi=1/0,en=-1/0,un=1/0,mn=-1/0;for(const hn of li)oi=Math.min(oi,hn[0]),un=Math.min(un,hn[1]),en=Math.max(en,hn[0]),mn=Math.max(mn,hn[1]);en>=be.x&&oi<=ge.x&&mn>=be.y&&un<=ge.y&&(ji=[li.map((hn=>new r.Point(hn[0],hn[1])))],(oi<be.x||en>ge.x||un<be.y||mn>ge.y)&&(ji=r.clipLine(ji,be.x,be.y,ge.x,ge.y)))}for(const oi of ji){Me.reset(oi,.25*se);let en=0;en=Me.length<=.5*se?1:Math.ceil(Me.paddedLength/$i)+1;for(let un=0;un<en;un++){const mn=un/Math.max(en-1,1),hn=Me.lerp(mn),qs=hn.x+Ui,Bs=hn.y+Ui;dt.push(qs,Bs,se,0);const ao=qs-se,ir=Bs-se,vn=qs+se,dn=Bs+se;if(Ht=Ht&&this.isOffscreen(ao,ir,vn,dn),Ee=Ee||this.isInsideGrid(ao,ir,vn,dn),!h&&this.grid.hitTestCircle(qs,Bs,se,tt)&&(te=!0,!U))return{circles:[],offscreen:!1,collisionDetected:te,occluded:!1}}}}return{circles:!U&&te||!Ee?[]:dt,offscreen:Ht,collisionDetected:te,occluded:Ut.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let g=1/0,w=1/0,S=-1/0,k=-1/0;for(const U of o){const K=new r.Point(U.x+Ui,U.y+Ui);g=Math.min(g,K.x),w=Math.min(w,K.y),S=Math.max(S,K.x),k=Math.max(k,K.y),h.push(K)}const I=this.grid.query(g,w,S,k).concat(this.ignoredGrid.query(g,w,S,k)),B={},V={};for(const U of I){const K=U.key;if(B[K.bucketInstanceId]===void 0&&(B[K.bucketInstanceId]={}),B[K.bucketInstanceId][K.featureIndex])continue;const tt=[new r.Point(U.x1,U.y1),new r.Point(U.x2,U.y1),new r.Point(U.x2,U.y2),new r.Point(U.x1,U.y2)];r.polygonIntersectsPolygon(h,tt)&&(B[K.bucketInstanceId][K.featureIndex]=!0,V[K.bucketInstanceId]===void 0&&(V[K.bucketInstanceId]=[]),V[K.bucketInstanceId].push(K.featureIndex))}return V}insertCollisionBox(o,h,g,w,S){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:w,collisionGroupID:S},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,g,w,S){const k=h?this.ignoredGrid:this.grid,I={bucketInstanceId:g,featureIndex:w,collisionGroupID:S};for(let B=0;B<o.length;B+=4)k.insertCircle(I,o[B],o[B+1],o[B+2])}projectAndGetPerspectiveRatio(o,h,g,w,S,k,I){const B=[h,g,w,1];let V=!1;w||this.transform.pitch>0?(r.transformMat4$1(B,B,o),this.fogState&&S&&I.name!=="globe"&&(V=(function(tt,at,ut,lt,dt,Y){const st=Y.calculateFogTileMatrix(dt),_t=[at,ut,lt];return r.transformMat4(_t,_t,st),he(tt,_t,Y.pitch,Y._fov)})(this.fogState,h,g,w,S.toUnwrapped(),this.transform)>.9)):xi(B,B,o);const U=B[3];return{point:new r.Point((B[0]/U+1)/2*this.transform.width+Ui,(-B[1]/U+1)/2*this.transform.height+Ui),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/U*.5,1.5),signedDistanceFromCamera:U,occluded:k&&B[2]>U||V}}isOffscreen(o,h,g,w){return g<Ui||o>=this.screenRightBoundary||w<Ui||h>this.screenBottomBoundary}isInsideGrid(o,h,g,w){return g>=0&&o<this.gridRightBoundary&&w>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const o=r.identity([]);return r.translate(o,o,[-100,-100,0]),o}}function Qs(m,o,h){const g=o.createTileMatrix(m,m.worldSize,h.toUnwrapped());return r.multiply(new Float32Array(16),m.projMatrix,g)}function Zn(m,o,h){if(o.projection.name===h.projection.name)return m.projMatrix;const g=h.clone();return g.setProjection(o.projection),Qs(g,o.getProjection(),m)}function on(m,o,h){return o.name===h.projection.name?m.projMatrix:Qs(h,o,m)}class _a{constructor(o,h,g,w){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):w&&g?1:0,this.placed=g}isHidden(){return this.opacity===0&&!this.placed}}class Ds{constructor(o,h,g,w,S,k=!1){this.text=new _a(o?o.text:null,h,g,S),this.icon=new _a(o?o.icon:null,h,w,S),this.clipped=k}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Co{constructor(o,h,g,w=!1){this.text=o,this.icon=h,this.skipFade=g,this.clipped=w}}class Ao{constructor(){this.invProjMatrix=r.create(),this.viewportMatrix=r.create(),this.circles=[]}}class fr{constructor(o,h,g,w,S){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=g,this.bucketIndex=w,this.tileID=S}}class ic{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:g=>g.collisionGroupID===h}}return this.collisionGroups[o]}}function Ws(m,o,h,g,w){const{horizontalAlign:S,verticalAlign:k}=r.getAnchorAlignment(m),I=-(S-.5)*o,B=-(k-.5)*h,V=r.evaluateVariableOffset(m,g);return new r.Point(I+V[0]*w,B+V[1]*w)}function Po(m,o,h,g,w){const S=new r.Point(m,o);return h&&S._rotate(g?w:-w),S}class ga{constructor(o,h,g,w,S){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new xs(this.transform,S),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new ic(g),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,g,w){const S=g.getBucket(h),k=g.latestFeatureIndex;if(!S||!k||h.id!==S.layerIds[0])return;const I=S.layers[0].layout,B=g.collisionBoxArray,V=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),U=g.tileSize/r.EXTENT,K=g.tileID.toUnwrapped();this.transform.setProjection(S.projection);const tt=(at=g.tileID,ut=S.getProjection(),lt=this.transform,ut.name===this.projection?lt.calculateProjMatrix(at.toUnwrapped()):Qs(lt,ut,at));var at,ut,lt;const dt=I.get("text-pitch-alignment")==="map",Y=I.get("text-rotation-alignment")==="map";h.compileFilter();const st=h.dynamicFilter(),_t=h.dynamicFilterNeedsFeature(),gt=this.transform.calculatePixelsToTileUnitsMatrix(g),Mt=Vi(tt,g.tileID.canonical,dt,Y,this.transform,S.getProjection(),gt);let At=null;if(dt){const Ut=Li(tt,g.tileID.canonical,dt,Y,this.transform,S.getProjection(),gt);At=r.multiply([],this.transform.labelPlaneMatrix,Ut)}let kt=null;st&&g.latestFeatureIndex&&(kt={unwrappedTileID:K,dynamicFilter:st,dynamicFilterNeedsFeature:_t,featureIndex:g.latestFeatureIndex}),this.retainedQueryData[S.bucketInstanceId]=new fr(S.bucketInstanceId,k,S.sourceLayerIndex,S.index,g.tileID);const Zt={bucket:S,layout:I,posMatrix:tt,textLabelPlaneMatrix:Mt,labelToScreenMatrix:At,clippingData:kt,scale:V,textPixelRatio:U,holdingForFade:g.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:r.evaluateSizeForZoom(S.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:r.evaluateSizeForZoom(S.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(S.sourceID)};if(w)for(const Ut of S.sortKeyRanges){const{sortKey:Xt,symbolInstanceStart:Te,symbolInstanceEnd:Gt}=Ut;o.push({sortKey:Xt,symbolInstanceStart:Te,symbolInstanceEnd:Gt,parameters:Zt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:S.symbolInstances.length,parameters:Zt})}attemptAnchorPlacement(o,h,g,w,S,k,I,B,V,U,K,tt,at,ut,lt,dt,Y,st){const{textOffset0:_t,textOffset1:gt,crossTileID:Mt}=tt,At=[_t,gt],kt=Ws(o,g,w,At,S),Zt=this.collisionIndex.placeCollisionBox(ut,S,h,Po(kt.x,kt.y,k,I,this.transform.angle),K,B,V,U.predicate);if(dt){const Ut=ut.getSymbolInstanceIconSize(st,this.transform.zoom,tt.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ut,Ut,dt,Po(kt.x,kt.y,k,I,this.transform.angle),K,B,V,U.predicate).box.length===0)return}if(Zt.box.length>0){let Ut;return this.prevPlacement&&this.prevPlacement.variableOffsets[Mt]&&this.prevPlacement.placements[Mt]&&this.prevPlacement.placements[Mt].text&&(Ut=this.prevPlacement.variableOffsets[Mt].anchor),this.variableOffsets[Mt]={textOffset:At,width:g,height:w,anchor:o,textScale:S,prevAnchor:Ut},this.markUsedJustification(ut,o,tt,lt),ut.allowVerticalPlacement&&(this.markUsedOrientation(ut,lt,tt),this.placedOrientations[Mt]=lt),{shift:kt,placedGlyphBoxes:Zt}}}placeLayerBucketPart(o,h,g,w){const{bucket:S,layout:k,posMatrix:I,textLabelPlaneMatrix:B,labelToScreenMatrix:V,clippingData:U,textPixelRatio:K,holdingForFade:tt,collisionBoxArray:at,partiallyEvaluatedTextSize:ut,partiallyEvaluatedIconSize:lt,collisionGroup:dt}=o.parameters,Y=k.get("text-optional"),st=k.get("icon-optional"),_t=k.get("text-allow-overlap"),gt=k.get("icon-allow-overlap"),Mt=k.get("text-rotation-alignment")==="map",At=k.get("text-pitch-alignment")==="map",kt=k.get("icon-text-fit")!=="none",Zt=k.get("symbol-z-order")==="viewport-y";this.transform.setProjection(S.projection);let Ut=_t&&(gt||!S.hasIconData()||st),Xt=gt&&(_t||!S.hasTextData()||Y);!S.collisionArrays&&at&&S.deserializeCollisionBoxes(at),g&&w&&S.updateCollisionDebugBuffers(this.transform.zoom,at);const Te=(Gt,fe,te)=>{const{crossTileID:Ee,numVerticalGlyphVertices:Ht}=Gt;if(U){const vn={zoom:this.transform.zoom,pitch:this.transform.pitch};let dn=null;if(U.dynamicFilterNeedsFeature){const Ki=this.retainedQueryData[S.bucketInstanceId];dn=U.featureIndex.loadFeature({featureIndex:Gt.featureIndex,bucketIndex:Ki.bucketIndex,sourceLayerIndex:Ki.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,U.dynamicFilter)(vn,dn,this.retainedQueryData[S.bucketInstanceId].tileID.canonical,new r.Point(Gt.tileAnchorX,Gt.tileAnchorY),this.transform.calculateDistanceTileData(U.unwrappedTileID)))return this.placements[Ee]=new Co(!1,!1,!1,!0),void h.add(Ee)}if(h.has(Ee))return;if(tt)return void(this.placements[Ee]=new Co(!1,!1,!1));let se=!1,be=!1,ge=!0,Me=!1,ai=!1,bi=null,ei={box:null,offscreen:null,occluded:null},li={box:null},$i=null,ji=null,oi=null,en=0,un=0,mn=0;te.textFeatureIndex?en=te.textFeatureIndex:Gt.useRuntimeCollisionCircles&&(en=Gt.featureIndex),te.verticalTextFeatureIndex&&(un=te.verticalTextFeatureIndex);const hn=vn=>{vn.tileID=this.retainedQueryData[S.bucketInstanceId].tileID;const dn=this.transform.elevation;(dn||vn.elevation)&&(vn.elevation=dn?dn.getAtTileOffset(vn.tileID,vn.tileAnchorX,vn.tileAnchorY):0)},qs=te.textBox;if(qs){hn(qs);const vn=Ki=>{let Kn=r.WritingMode.horizontal;if(S.allowVerticalPlacement&&!Ki&&this.prevPlacement){const nr=this.prevPlacement.placedOrientations[Ee];nr&&(this.placedOrientations[Ee]=nr,Kn=nr,this.markUsedOrientation(S,Kn,Gt))}return Kn},dn=(Ki,Kn)=>{if(S.allowVerticalPlacement&&Ht>0&&te.verticalTextBox){for(const nr of S.writingModes)if(nr===r.WritingMode.vertical?(ei=Kn(),li=ei):ei=Ki(),ei&&ei.box&&ei.box.length)break}else ei=Ki()};if(k.get("text-variable-anchor")){let Ki=k.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ee]){const xn=this.prevPlacement.variableOffsets[Ee];Ki.indexOf(xn.anchor)>0&&(Ki=Ki.filter((xr=>xr!==xn.anchor)),Ki.unshift(xn.anchor))}const Kn=(xn,xr,au)=>{const Ul=S.getSymbolInstanceTextSize(ut,Gt,this.transform.zoom,fe),lu=(xn.x2-xn.x1)*Ul+2*xn.padding,Oo=(xn.y2-xn.y1)*Ul+2*xn.padding,Ma=kt&&!gt?xr:null;Ma&&hn(Ma);let cu={box:[],offscreen:!1,occluded:!1};const Rd=_t?2*Ki.length:Ki.length;for(let Rh=0;Rh<Rd;++Rh){const zf=this.attemptAnchorPlacement(Ki[Rh%Ki.length],xn,lu,Oo,Ul,Mt,At,K,I,dt,Rh>=Ki.length,Gt,fe,S,au,Ma,ut,lt);if(zf&&(cu=zf.placedGlyphBoxes,cu&&cu.box&&cu.box.length)){se=!0,bi=zf.shift;break}}return cu};dn((()=>Kn(qs,te.iconBox,r.WritingMode.horizontal)),(()=>{const xn=te.verticalTextBox;return xn&&hn(xn),S.allowVerticalPlacement&&!(ei&&ei.box&&ei.box.length)&&Ht>0&&xn?Kn(xn,te.verticalIconBox,r.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),ei&&(se=ei.box,ge=ei.offscreen,Me=ei.occluded);const nr=vn(!(!ei||!ei.box));if(!se&&this.prevPlacement){const xn=this.prevPlacement.variableOffsets[Ee];xn&&(this.variableOffsets[Ee]=xn,this.markUsedJustification(S,xn.anchor,Gt,nr))}}else{const Ki=(Kn,nr)=>{const xn=S.getSymbolInstanceTextSize(ut,Gt,this.transform.zoom,fe),xr=this.collisionIndex.placeCollisionBox(S,xn,Kn,new r.Point(0,0),_t,K,I,dt.predicate);return xr&&xr.box&&xr.box.length&&(this.markUsedOrientation(S,nr,Gt),this.placedOrientations[Ee]=nr),xr};dn((()=>Ki(qs,r.WritingMode.horizontal)),(()=>{const Kn=te.verticalTextBox;return S.allowVerticalPlacement&&Ht>0&&Kn?(hn(Kn),Ki(Kn,r.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),vn(!!(ei&&ei.box&&ei.box.length))}}if($i=ei,se=$i&&$i.box&&$i.box.length>0,ge=$i&&$i.offscreen,Me=$i&&$i.occluded,Gt.useRuntimeCollisionCircles){const vn=S.text.placedSymbolArray.get(Gt.centerJustifiedTextSymbolIndex>=0?Gt.centerJustifiedTextSymbolIndex:Gt.verticalPlacedTextSymbolIndex),dn=r.evaluateSizeForFeature(S.textSizeData,ut,vn),Ki=k.get("text-padding");ji=this.collisionIndex.placeCollisionCircles(S,_t,vn,S.lineVertexArray,S.glyphOffsetArray,dn,I,B,V,g,At,dt.predicate,Gt.collisionCircleDiameter*dn/r.ONE_EM,Ki,this.retainedQueryData[S.bucketInstanceId].tileID),se=_t||ji.circles.length>0&&!ji.collisionDetected,ge=ge&&ji.offscreen,Me=ji.occluded}if(te.iconFeatureIndex&&(mn=te.iconFeatureIndex),te.iconBox){const vn=dn=>{hn(dn);const Ki=kt&&bi?Po(bi.x,bi.y,Mt,At,this.transform.angle):new r.Point(0,0),Kn=S.getSymbolInstanceIconSize(lt,this.transform.zoom,Gt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(S,Kn,dn,Ki,gt,K,I,dt.predicate)};li&&li.box&&li.box.length&&te.verticalIconBox?(oi=vn(te.verticalIconBox),be=oi.box.length>0):(oi=vn(te.iconBox),be=oi.box.length>0),ge=ge&&oi.offscreen,ai=oi.occluded}const Bs=Y||Gt.numHorizontalGlyphVertices===0&&Ht===0,ao=st||Gt.numIconVertices===0;if(Bs||ao?ao?Bs||(be=be&&se):se=be&&se:be=se=be&&se,se&&$i&&$i.box&&this.collisionIndex.insertCollisionBox($i.box,k.get("text-ignore-placement"),S.bucketInstanceId,li&&li.box&&un?un:en,dt.ID),be&&oi&&this.collisionIndex.insertCollisionBox(oi.box,k.get("icon-ignore-placement"),S.bucketInstanceId,mn,dt.ID),ji&&(se&&this.collisionIndex.insertCollisionCircles(ji.circles,k.get("text-ignore-placement"),S.bucketInstanceId,en,dt.ID),g)){const vn=S.bucketInstanceId;let dn=this.collisionCircleArrays[vn];dn===void 0&&(dn=this.collisionCircleArrays[vn]=new Ao);for(let Ki=0;Ki<ji.circles.length;Ki+=4)dn.circles.push(ji.circles[Ki+0]),dn.circles.push(ji.circles[Ki+1]),dn.circles.push(ji.circles[Ki+2]),dn.circles.push(ji.collisionDetected?1:0)}const ir=S.projection.name!=="globe";Ut=Ut&&(ir||!Me),Xt=Xt&&(ir||!ai),this.placements[Ee]=new Co(se||Ut,be||Xt,ge||S.justReloaded),h.add(Ee)};if(Zt){const Gt=S.getSortedSymbolIndexes(this.transform.angle);for(let fe=Gt.length-1;fe>=0;--fe){const te=Gt[fe];Te(S.symbolInstances.get(te),te,S.collisionArrays[te])}}else for(let Gt=o.symbolInstanceStart;Gt<o.symbolInstanceEnd;Gt++)Te(S.symbolInstances.get(Gt),Gt,S.collisionArrays[Gt]);if(g&&S.bucketInstanceId in this.collisionCircleArrays){const Gt=this.collisionCircleArrays[S.bucketInstanceId];r.invert(Gt.invProjMatrix,I),Gt.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(o,h,g,w){const{leftJustifiedTextSymbolIndex:S,centerJustifiedTextSymbolIndex:k,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:B,crossTileID:V}=g,U=r.getAnchorJustification(h),K=w===r.WritingMode.vertical?B:U==="left"?S:U==="center"?k:U==="right"?I:-1;S>=0&&(o.text.placedSymbolArray.get(S).crossTileID=K>=0&&S!==K?0:V),k>=0&&(o.text.placedSymbolArray.get(k).crossTileID=K>=0&&k!==K?0:V),I>=0&&(o.text.placedSymbolArray.get(I).crossTileID=K>=0&&I!==K?0:V),B>=0&&(o.text.placedSymbolArray.get(B).crossTileID=K>=0&&B!==K?0:V)}markUsedOrientation(o,h,g){const w=h===r.WritingMode.horizontal||h===r.WritingMode.horizontalOnly?h:0,S=h===r.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:k,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:B,verticalPlacedTextSymbolIndex:V}=g,U=o.text.placedSymbolArray;k>=0&&(U.get(k).placedOrientation=w),I>=0&&(U.get(I).placedOrientation=w),B>=0&&(U.get(B).placedOrientation=w),V>=0&&(U.get(V).placedOrientation=S)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let g=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const w=h?h.symbolFadeChange(o):1,S=h?h.opacities:{},k=h?h.variableOffsets:{},I=h?h.placedOrientations:{};for(const B in this.placements){const V=this.placements[B],U=S[B];U?(this.opacities[B]=new Ds(U,w,V.text,V.icon,null,V.clipped),g=g||V.text!==U.text.placed||V.icon!==U.icon.placed):(this.opacities[B]=new Ds(null,w,V.text,V.icon,V.skipFade,V.clipped),g=g||V.text||V.icon)}for(const B in S){const V=S[B];if(!this.opacities[B]){const U=new Ds(V,w,!1,!1);U.isHidden()||(this.opacities[B]=U,g=g||V.text.placed||V.icon.placed)}}for(const B in k)this.variableOffsets[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.variableOffsets[B]=k[B]);for(const B in I)this.placedOrientations[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.placedOrientations[B]=I[B]);g?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h){const g=new Set;for(const w of h){const S=w.getBucket(o);S&&w.latestFeatureIndex&&o.id===S.layerIds[0]&&this.updateBucketOpacities(S,g,w.collisionBoxArray)}}updateBucketOpacities(o,h,g){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const w=o.layers[0].layout,S=!!o.layers[0].dynamicFilter(),k=new Ds(null,0,!1,!1,!0),I=w.get("text-allow-overlap"),B=w.get("icon-allow-overlap"),V=w.get("text-variable-anchor"),U=w.get("text-rotation-alignment")==="map",K=w.get("text-pitch-alignment")==="map",tt=w.get("icon-text-fit")!=="none",at=new Ds(null,0,I&&(B||!o.hasIconData()||w.get("icon-optional")),B&&(I||!o.hasTextData()||w.get("text-optional")),!0);!o.collisionArrays&&g&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(g);const ut=(dt,Y,st)=>{for(let _t=0;_t<Y/4;_t++)dt.opacityVertexArray.emplaceBack(st)};let lt=0;for(let dt=0;dt<o.symbolInstances.length;dt++){const Y=o.symbolInstances.get(dt),{numHorizontalGlyphVertices:st,numVerticalGlyphVertices:_t,crossTileID:gt,numIconVertices:Mt}=Y,At=h.has(gt);let kt=this.opacities[gt];At?kt=k:kt||(kt=at,this.opacities[gt]=kt),h.add(gt);const Zt=st>0||_t>0,Ut=Mt>0,Xt=this.placedOrientations[gt],Te=Xt===r.WritingMode.vertical,Gt=Xt===r.WritingMode.horizontal||Xt===r.WritingMode.horizontalOnly;if(!Zt&&!Ut||kt.isHidden()||lt++,Zt){const fe=Ar(kt.text);ut(o.text,st,Te?yn:fe),ut(o.text,_t,Gt?yn:fe);const te=kt.text.isHidden(),{leftJustifiedTextSymbolIndex:Ee,centerJustifiedTextSymbolIndex:Ht,rightJustifiedTextSymbolIndex:se,verticalPlacedTextSymbolIndex:be}=Y,ge=o.text.placedSymbolArray,Me=te||Te?1:0;Ee>=0&&(ge.get(Ee).hidden=Me),Ht>=0&&(ge.get(Ht).hidden=Me),se>=0&&(ge.get(se).hidden=Me),be>=0&&(ge.get(be).hidden=te||Gt?1:0);const ai=this.variableOffsets[gt];ai&&this.markUsedJustification(o,ai.anchor,Y,Xt);const bi=this.placedOrientations[gt];bi&&(this.markUsedJustification(o,"left",Y,bi),this.markUsedOrientation(o,bi,Y))}if(Ut){const fe=Ar(kt.icon),{placedIconSymbolIndex:te,verticalPlacedIconSymbolIndex:Ee}=Y,Ht=o.icon.placedSymbolArray,se=kt.icon.isHidden()?1:0;te>=0&&(ut(o.icon,Mt,Te?yn:fe),Ht.get(te).hidden=se),Ee>=0&&(ut(o.icon,Y.numVerticalIconVertices,Gt?yn:fe),Ht.get(Ee).hidden=se)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const fe=o.collisionArrays[dt];if(fe){let te=new r.Point(0,0),Ee=!0;if(fe.textBox||fe.verticalTextBox){if(V){const se=this.variableOffsets[gt];se?(te=Ws(se.anchor,se.width,se.height,se.textOffset,se.textScale),U&&te._rotate(K?this.transform.angle:-this.transform.angle)):Ee=!1}S&&(Ee=!kt.clipped),fe.textBox&&Yr(o.textCollisionBox.collisionVertexArray,kt.text.placed,!Ee||Te,te.x,te.y),fe.verticalTextBox&&Yr(o.textCollisionBox.collisionVertexArray,kt.text.placed,!Ee||Gt,te.x,te.y)}const Ht=Ee&&!!(!Gt&&fe.verticalIconBox);fe.iconBox&&Yr(o.iconCollisionBox.collisionVertexArray,kt.icon.placed,Ht,tt?te.x:0,tt?te.y:0),fe.verticalIconBox&&Yr(o.iconCollisionBox.collisionVertexArray,kt.icon.placed,!Ht,tt?te.x:0,tt?te.y:0)}}}if(o.fullyClipped=lt===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const dt=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=dt.invProjMatrix,o.placementViewportMatrix=dt.viewportMatrix,o.collisionCircleArray=dt.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){const g=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*g>o}setStale(){this.stale=!0}}function Yr(m,o,h,g,w){m.emplaceBack(o?1:0,h?1:0,g||0,w||0),m.emplaceBack(o?1:0,h?1:0,g||0,w||0),m.emplaceBack(o?1:0,h?1:0,g||0,w||0),m.emplaceBack(o?1:0,h?1:0,g||0,w||0)}const pi=Math.pow(2,25),Xi=Math.pow(2,24),cn=Math.pow(2,17),vl=Math.pow(2,16),bs=Math.pow(2,9),us=Math.pow(2,8),nc=Math.pow(2,1);function Ar(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const o=m.placed?1:0,h=Math.floor(127*m.opacity);return h*pi+o*Xi+h*cn+o*vl+h*bs+o*us+h*nc+o}const yn=0;class Pr{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,h,g,w,S){const k=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(k,w,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,S())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort(((I,B)=>I.sortKey-B.sortKey)));this._currentPartIndex<k.length;){const I=k[this._currentPartIndex];if(h.placeLayerBucketPart(I,this._seenCrossTileIDs,g,I.symbolInstanceStart===0),this._currentPartIndex++,S())return!0}return!1}}class Gn{constructor(o,h,g,w,S,k,I,B){this.placement=new ga(o,S,k,I,B),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(o,h,g){const w=r.exported.now(),S=()=>{const k=r.exported.now()-w;return!this._forceFullPlacement&&k>2};for(;this._currentPlacementIndex>=0;){const k=h[o[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(k.type==="symbol"&&(!k.minzoom||k.minzoom<=I)&&(!k.maxzoom||k.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Pr(k)),this._inProgressLayer.continuePlacement(g[k.source],this.placement,this._showCollisionBoxes,k,S))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const pr=512/r.EXTENT/2;class Hn{constructor(o,h,g){this.tileID=o,this.bucketInstanceId=g,this.index=new r.KDBush(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=o.canonical.x*r.EXTENT,S=o.canonical.y*r.EXTENT;for(let k=0;k<h.length;k++){const{key:I,crossTileID:B,tileAnchorX:V,tileAnchorY:U}=h.get(k),K=Math.floor((w+V)*pr),tt=Math.floor((S+U)*pr);this.index.add(K,tt),this.keys.push(I),this.crossTileIDs.push(B)}this.index.finish()}findMatches(o,h,g){const w=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),S=pr/Math.pow(2,h.canonical.z-this.tileID.canonical.z),k=h.canonical.x*r.EXTENT,I=h.canonical.y*r.EXTENT;for(let B=0;B<o.length;B++){const V=o.get(B);if(V.crossTileID)continue;const{key:U,tileAnchorX:K,tileAnchorY:tt}=V,at=Math.floor((k+K)*S),ut=Math.floor((I+tt)*S),lt=this.index.range(at-w,ut-w,at+w,ut+w);for(const dt of lt){const Y=this.crossTileIDs[dt];if(this.keys[dt]===U&&!g.has(Y)){g.add(Y),V.crossTileID=Y;break}}}}}class sc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class rc{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const h=Math.round((o-this.lng)/360);if(h!==0)for(const g in this.indexes){const w=this.indexes[g],S={};for(const k in w){const I=w[k];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+h),S[I.tileID.key]=I}this.indexes[g]=S}this.lng=o}addBucket(o,h,g){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let S=0;S<h.symbolInstances.length;S++)h.symbolInstances.get(S).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const w=this.usedCrossTileIDs[o.overscaledZ];for(const S in this.indexes){const k=this.indexes[S];if(Number(S)>o.overscaledZ)for(const I in k){const B=k[I];B.tileID.isChildOf(o)&&B.findMatches(h.symbolInstances,o,w)}else{const I=k[o.scaledTo(Number(S)).key];I&&I.findMatches(h.symbolInstances,o,w)}}for(let S=0;S<h.symbolInstances.length;S++){const k=h.symbolInstances.get(S);k.crossTileID||(k.crossTileID=g.generate(),w.add(k.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Hn(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(const g of h.crossTileIDs)this.usedCrossTileIDs[o].delete(g)}removeStaleBuckets(o){let h=!1;for(const g in this.indexes){const w=this.indexes[g];for(const S in w)o[w[S].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,w[S]),delete w[S],h=!0)}return h}}class kr{constructor(){this.layerIndexes={},this.crossTileIDs=new sc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,g,w){let S=this.layerIndexes[o.id];S===void 0&&(S=this.layerIndexes[o.id]=new rc);let k=!1;const I={};w.name!=="globe"&&S.handleWrapJump(g);for(const B of h){const V=B.getBucket(o);V&&o.id===V.layerIds[0]&&(V.bucketInstanceId||(V.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(B.tileID,V,this.crossTileIDs)&&(k=!0),I[V.bucketInstanceId]=!0)}return S.removeStaleBuckets(I)&&(k=!0),k}pruneUnusedLayers(o){const h={};o.forEach((g=>{h[g]=!0}));for(const g in this.layerIndexes)h[g]||delete this.layerIndexes[g]}}const Ir=(m,o)=>r.emitValidationErrors(m,o&&o.filter((h=>h.identifier!=="source.canvas"))),$a=r.pick(Ti,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Zc=r.pick(Ti,["setCenter","setZoom","setBearing","setPitch"]),Wi={version:8,layers:[],sources:{}},$o={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class qn extends r.Evented{constructor(o,h={}){super(),this.map=o,this.dispatcher=new $t(ns(),this),this.imageManager=new Wt,this.imageManager.setEventedParent(this),this.glyphManager=new r.GlyphManager(o._requestManager,h.localFontFamily?r.LocalGlyphMode.all:h.localIdeographFontFamily?r.LocalGlyphMode.ideographs:r.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new kr,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",r.getReferrer());const g=this;this._rtlTextPluginCallback=qn.registerForPluginStateChange((w=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},((S,k)=>{if(r.triggerPluginCompletionEvent(S),k&&k.every((I=>I)))for(const I in g._sourceCaches){const B=g._sourceCaches[I],V=B.getSource().type;V!=="vector"&&V!=="geojson"||B.reload()}}))})),this.on("data",(w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const S=this.getSource(w.sourceId);if(S&&S.vectorLayerIds)for(const k in this._layers){const I=this._layers[k];I.source===S.id&&this._validateLayer(I)}}))}loadURL(o,h={}){this.fire(new r.Event("dataloading",{dataType:"style"}));const g=typeof h.validate=="boolean"?h.validate:!r.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,h.accessToken);const w=this.map._requestManager.transformRequest(o,r.ResourceType.Style);this._request=r.getJSON(w,((S,k)=>{this._request=null,S?this.fire(new r.ErrorEvent(S)):k&&this._load(k,g)}))}loadJSON(o,h={}){this.fire(new r.Event("dataloading",{dataType:"style"})),this._request=r.exported.frame((()=>{this._request=null,this._load(o,h.validate!==!1)}))}loadEmpty(){this.fire(new r.Event("dataloading",{dataType:"style"})),this._load(Wi,!1)}_updateLayerCount(o,h){const g=h?1:-1;o.is3D()&&(this._num3DLayers+=g),o.type==="circle"&&(this._numCircleLayers+=g),o.type==="symbol"&&(this._numSymbolLayers+=g)}_load(o,h){if(h&&Ir(this,r.validateStyle(o)))return;this._loaded=!0,this.stylesheet=r.clone$1(o),this._updateMapProjection();for(const w in o.sources)this.addSource(w,o.sources[w],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const g=Js(this.stylesheet.layers);this._order=g.map((w=>w.id)),this._layers={},this._serializedLayers={};for(const w of g){const S=r.createStyleLayer(w);S.setEventedParent(this,{layer:{id:S.id}}),this._layers[S.id]=S,this._serializedLayers[S.id]=S.serialize(),this._updateLayerCount(S,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ye(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new r.Event("data",{dataType:"style"})),this.fire(new r.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=(function(h,g,w){let S,k,I;const B=r.exported.devicePixelRatio>1?"@2x":"";let V=r.getJSON(g.transformRequest(g.normalizeSpriteURL(h,B,".json"),r.ResourceType.SpriteJSON),((tt,at)=>{V=null,I||(I=tt,S=at,K())})),U=r.getImage(g.transformRequest(g.normalizeSpriteURL(h,B,".png"),r.ResourceType.SpriteImage),((tt,at)=>{U=null,I||(I=tt,k=at,K())}));function K(){if(I)w(I);else if(S&&k){const tt=r.exported.getImageData(k),at={};for(const ut in S){const{width:lt,height:dt,x:Y,y:st,sdf:_t,pixelRatio:gt,stretchX:Mt,stretchY:At,content:kt}=S[ut],Zt=new r.RGBAImage({width:lt,height:dt});r.RGBAImage.copy(tt,Zt,{x:Y,y:st},{x:0,y:0},{width:lt,height:dt}),at[ut]={data:Zt,pixelRatio:gt,sdf:_t,stretchX:Mt,stretchY:At,content:kt}}w(null,at)}}return{cancel(){V&&(V.cancel(),V=null),U&&(U.cancel(),U=null)}}})(o,this.map._requestManager,((h,g)=>{if(this._spriteRequest=null,h)this.fire(new r.ErrorEvent(h));else if(g)for(const w in g)this.imageManager.addImage(w,g[w]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new r.Event("data",{dataType:"style"}))}))}_validateLayer(o){const h=this.getSource(o.source);if(!h)return;const g=o.sourceLayer;g&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(g)===-1)&&this.fire(new r.ErrorEvent(new Error(`Source layer "${g}" does not exist on source "${h.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const h=[];for(const g of o){const w=this._layers[g];w.type!=="custom"&&h.push(w.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&(typeof o.isLayerDraped=="function"?o.isLayerDraped():$o[o.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const h=this._changed;if(this._changed){const w=Object.keys(this._updatedLayers),S=Object.keys(this._removedLayers);(w.length||S.length)&&this._updateWorkerLayers(w,S);for(const k in this._updatedSources){const I=this._updatedSources[k];I==="reload"?this._reloadSource(k):I==="clear"&&this._clearSource(k)}this._updateTilesForChangedImages();for(const k in this._updatedPaintProps)this._layers[k].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const g={};for(const w in this._sourceCaches){const S=this._sourceCaches[w];g[w]=S.used,S.used=!1}for(const w of this._order){const S=this._layers[w];if(S.recalculate(o,this._availableImages),!S.isHidden(o.zoom)){const I=this._getLayerSourceCache(S);I&&(I.used=!0)}const k=this.map.painter;if(k){const I=S.getProgramIds();if(!I)continue;const B=S.getProgramConfiguration(o.zoom);for(const V of I)k.useProgram(V,B)}}for(const w in g){const S=this._sourceCaches[w];g[w]!==S.used&&S.getSource().fire(new r.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:S.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new r.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),Ir(this,r.validateStyle(o)))return!1;(o=r.clone$1(o)).layers=Js(o.layers);const h=(function(w,S){if(!w)return[{command:Ti.setStyle,args:[S]}];let k=[];try{if(!E(w.version,S.version))return[{command:Ti.setStyle,args:[S]}];E(w.center,S.center)||k.push({command:Ti.setCenter,args:[S.center]}),E(w.zoom,S.zoom)||k.push({command:Ti.setZoom,args:[S.zoom]}),E(w.bearing,S.bearing)||k.push({command:Ti.setBearing,args:[S.bearing]}),E(w.pitch,S.pitch)||k.push({command:Ti.setPitch,args:[S.pitch]}),E(w.sprite,S.sprite)||k.push({command:Ti.setSprite,args:[S.sprite]}),E(w.glyphs,S.glyphs)||k.push({command:Ti.setGlyphs,args:[S.glyphs]}),E(w.transition,S.transition)||k.push({command:Ti.setTransition,args:[S.transition]}),E(w.light,S.light)||k.push({command:Ti.setLight,args:[S.light]}),E(w.fog,S.fog)||k.push({command:Ti.setFog,args:[S.fog]}),E(w.projection,S.projection)||k.push({command:Ti.setProjection,args:[S.projection]});const I={},B=[];(function(K,tt,at,ut){let lt;for(lt in tt=tt||{},K=K||{})K.hasOwnProperty(lt)&&(tt.hasOwnProperty(lt)||hr(lt,at,ut));for(lt in tt){if(!tt.hasOwnProperty(lt))continue;const dt=tt[lt];K.hasOwnProperty(lt)?E(K[lt],dt)||(K[lt].type==="geojson"&&dt.type==="geojson"&&Mo(K,tt,lt)?at.push({command:Ti.setGeoJSONSourceData,args:[lt,dt.data]}):So(lt,tt,at,ut)):ja(lt,tt,at)}})(w.sources,S.sources,B,I);const V=[];w.layers&&w.layers.forEach((K=>{K.source&&I[K.source]?k.push({command:Ti.removeLayer,args:[K.id]}):V.push(K)}));let U=w.terrain;U&&I[U.source]&&(k.push({command:Ti.setTerrain,args:[void 0]}),U=void 0),k=k.concat(B),E(U,S.terrain)||k.push({command:Ti.setTerrain,args:[S.terrain]}),(function(K,tt,at){tt=tt||[];const ut=(K=K||[]).map(Vr),lt=tt.map(Vr),dt=K.reduce(Vo,{}),Y=tt.reduce(Vo,{}),st=ut.slice(),_t=Object.create(null);let gt,Mt,At,kt,Zt,Ut,Xt;for(gt=0,Mt=0;gt<ut.length;gt++)At=ut[gt],Y.hasOwnProperty(At)?Mt++:(at.push({command:Ti.removeLayer,args:[At]}),st.splice(st.indexOf(At,Mt),1));for(gt=0,Mt=0;gt<lt.length;gt++)At=lt[lt.length-1-gt],st[st.length-1-gt]!==At&&(dt.hasOwnProperty(At)?(at.push({command:Ti.removeLayer,args:[At]}),st.splice(st.lastIndexOf(At,st.length-Mt),1)):Mt++,Ut=st[st.length-gt],at.push({command:Ti.addLayer,args:[Y[At],Ut]}),st.splice(st.length-gt,0,At),_t[At]=!0);for(gt=0;gt<lt.length;gt++)if(At=lt[gt],kt=dt[At],Zt=Y[At],!_t[At]&&!E(kt,Zt))if(E(kt.source,Zt.source)&&E(kt["source-layer"],Zt["source-layer"])&&E(kt.type,Zt.type)){for(Xt in jr(kt.layout,Zt.layout,at,At,null,Ti.setLayoutProperty),jr(kt.paint,Zt.paint,at,At,null,Ti.setPaintProperty),E(kt.filter,Zt.filter)||at.push({command:Ti.setFilter,args:[At,Zt.filter]}),E(kt.minzoom,Zt.minzoom)&&E(kt.maxzoom,Zt.maxzoom)||at.push({command:Ti.setLayerZoomRange,args:[At,Zt.minzoom,Zt.maxzoom]}),kt)kt.hasOwnProperty(Xt)&&Xt!=="layout"&&Xt!=="paint"&&Xt!=="filter"&&Xt!=="metadata"&&Xt!=="minzoom"&&Xt!=="maxzoom"&&(Xt.indexOf("paint.")===0?jr(kt[Xt],Zt[Xt],at,At,Xt.slice(6),Ti.setPaintProperty):E(kt[Xt],Zt[Xt])||at.push({command:Ti.setLayerProperty,args:[At,Xt,Zt[Xt]]}));for(Xt in Zt)Zt.hasOwnProperty(Xt)&&!kt.hasOwnProperty(Xt)&&Xt!=="layout"&&Xt!=="paint"&&Xt!=="filter"&&Xt!=="metadata"&&Xt!=="minzoom"&&Xt!=="maxzoom"&&(Xt.indexOf("paint.")===0?jr(kt[Xt],Zt[Xt],at,At,Xt.slice(6),Ti.setPaintProperty):E(kt[Xt],Zt[Xt])||at.push({command:Ti.setLayerProperty,args:[At,Xt,Zt[Xt]]}))}else at.push({command:Ti.removeLayer,args:[At]}),Ut=st[st.lastIndexOf(At)+1],at.push({command:Ti.addLayer,args:[Zt,Ut]})})(V,S.layers,k)}catch(I){console.warn("Unable to compute style diff:",I),k=[{command:Ti.setStyle,args:[S]}]}return k})(this.serialize(),o).filter((w=>!(w.command in Zc)));if(h.length===0)return!1;const g=h.filter((w=>!(w.command in $a)));if(g.length>0)throw new Error(`Unimplemented: ${g.map((w=>w.command)).join(", ")}.`);return h.forEach((w=>{w.command!=="setTransition"&&w.command!=="setProjection"&&this[w.command].apply(this,w.args)})),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,h){return this.getImage(o)?this.fire(new r.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,h),this._afterImageUpdated(o),this)}updateImage(o,h){this.imageManager.updateImage(o,h)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new r.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new r.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,h,g={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(r.validateSource,`sources.${o}`,h,null,g))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const w=Mi(o,h,this.dispatcher,this);w.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:w.serialize(),sourceId:o})));const S=k=>{const I=(k?"symbol:":"other:")+o,B=this._sourceCaches[I]=new r.SourceCache(I,w,k);(k?this._symbolSourceCaches:this._otherSourceCaches)[o]=B,B.style=this,B.onAdd(this.map)};S(!1),h.type!=="vector"&&h.type!=="geojson"||S(!0),w.onAdd&&w.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const h=this.getSource(o);if(!h)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===o)return this.fire(new r.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new r.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const g=this._getSourceCaches(o);for(const w of g)delete this._sourceCaches[w.id],delete this._updatedSources[w.id],w.fire(new r.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,h){this._checkLoaded(),this.getSource(o).setData(h),this._changed=!0}getSource(o){const h=this._getSourceCache(o);return h&&h.getSource()}_getSources(){const o=[];for(const h in this._otherSourceCaches){const g=this._getSourceCache(h);g&&o.push(g.getSource())}return o}addLayer(o,h,g={}){this._checkLoaded();const w=o.id;if(this.getLayer(w))return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${w}" already exists on this map`)));let S;if(o.type==="custom"){if(Ir(this,r.validateCustomStyleLayer(o)))return;S=r.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=r.clone$1(o),o=r.extend(o,{source:w})),this._validate(r.validateLayer,`layers.${w}`,o,{arrayIndex:-1},g))return;S=r.createStyleLayer(o),this._validateLayer(S),S.setEventedParent(this,{layer:{id:w}}),this._serializedLayers[S.id]=S.serialize(),this._updateLayerCount(S,!0)}const k=h?this._order.indexOf(h):this._order.length;if(h&&k===-1)return void this.fire(new r.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(k,0,w),this._layerOrderChanged=!0,this._layers[w]=S;const I=this._getLayerSourceCache(S);if(this._removedLayers[w]&&S.source&&I&&S.type!=="custom"){const B=this._removedLayers[w];delete this._removedLayers[w],B.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",I.pause())}this._updateLayer(S),S.onAdd&&S.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,h){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===h)return;const g=this._order.indexOf(o);this._order.splice(g,1);const w=h?this._order.indexOf(h):this._order.length;h&&w===-1?this.fire(new r.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(w,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const h=this._layers[o];if(!h)return void this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const g=this._order.indexOf(o);this._order.splice(g,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=h,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const h in this._layers)if(this._layers[h].type===o)return!0;return!1}setLayerZoomRange(o,h,g){this._checkLoaded();const w=this.getLayer(o);w?w.minzoom===h&&w.maxzoom===g||(h!=null&&(w.minzoom=h),g!=null&&(w.maxzoom=g),this._updateLayer(w)):this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,h,g={}){this._checkLoaded();const w=this.getLayer(o);if(w){if(!E(w.filter,h))return h==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(r.validateFilter,`layers.${w.id}.filter`,h,{layerType:w.type},g)||(w.filter=r.clone$1(h),this._updateLayer(w)))}else this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const h=this.getLayer(o);return h&&r.clone$1(h.filter)}setLayoutProperty(o,h,g,w={}){this._checkLoaded();const S=this.getLayer(o);S?E(S.getLayoutProperty(h),g)||(S.setLayoutProperty(h,g,w),this._updateLayer(S)):this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,h){const g=this.getLayer(o);if(g)return g.getLayoutProperty(h);this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,h,g,w={}){this._checkLoaded();const S=this.getLayer(o);S?E(S.getPaintProperty(h),g)||(S.setPaintProperty(h,g,w)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new r.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,h){const g=this.getLayer(o);return g&&g.getPaintProperty(h)}setFeatureState(o,h){this._checkLoaded();const g=o.source,w=o.sourceLayer,S=this.getSource(g);if(!S)return void this.fire(new r.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const k=S.type;if(k==="geojson"&&w)return void this.fire(new r.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(k==="vector"&&!w)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(g);for(const B of I)B.setFeatureState(w,o.id,h)}removeFeatureState(o,h){this._checkLoaded();const g=o.source,w=this.getSource(g);if(!w)return void this.fire(new r.ErrorEvent(new Error(`The source '${g}' does not exist in the map's style.`)));const S=w.type,k=S==="vector"?o.sourceLayer:void 0;if(S==="vector"&&!k)return void this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new r.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(g);for(const B of I)B.removeFeatureState(k,o.id,h)}getFeatureState(o){this._checkLoaded();const h=o.source,g=o.sourceLayer,w=this.getSource(h);if(w){if(w.type!=="vector"||g)return o.id===void 0&&this.fire(new r.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(g,o.id);this.fire(new r.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new r.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return r.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const h in this._sourceCaches){const g=this._sourceCaches[h].getSource();o[g.id]||(o[g.id]=g.serialize())}return r.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},(h=>h!==void 0))}_updateLayer(o){this._updatedLayers[o.id]=!0;const h=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&h&&h.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",h.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const h=k=>this._layers[k].type==="fill-extrusion",g={},w=[];for(let k=this._order.length-1;k>=0;k--){const I=this._order[k];if(h(I)){g[I]=k;for(const B of o){const V=B[I];if(V)for(const U of V)w.push(U)}}}w.sort(((k,I)=>I.intersectionZ-k.intersectionZ));const S=[];for(let k=this._order.length-1;k>=0;k--){const I=this._order[k];if(h(I))for(let B=w.length-1;B>=0;B--){const V=w[B].feature;if(g[V.layer.id]<k)break;S.push(V),w.pop()}else for(const B of o){const V=B[I];if(V)for(const U of V)S.push(U.feature)}}return S}queryRenderedFeatures(o,h,g){h&&h.filter&&this._validate(r.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const w={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new r.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const B of h.layers){const V=this._layers[B];if(!V)return this.fire(new r.ErrorEvent(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];w[V.source]=!0}}const S=[];h.availableImages=this._availableImages;const k=h&&h.layers?h.layers.some((B=>{const V=this.getLayer(B);return V&&V.is3D()})):this.has3DLayers(),I=Ve.createFromScreenPoints(o,g);for(const B in this._sourceCaches){const V=this._sourceCaches[B].getSource().id;h.layers&&!w[V]||S.push(tn(this._sourceCaches[B],this._layers,this._serializedLayers,I,h,g,k,!!this.map._showQueryGeometry))}return this.placement&&S.push((function(B,V,U,K,tt,at,ut){const lt={},dt=at.queryRenderedSymbols(K),Y=[];for(const st of Object.keys(dt).map(Number))Y.push(ut[st]);Y.sort(ps);for(const st of Y){const _t=st.featureIndex.lookupSymbolFeatures(dt[st.bucketInstanceId],V,st.bucketIndex,st.sourceLayerIndex,tt.filter,tt.layers,tt.availableImages,B);for(const gt in _t){const Mt=lt[gt]=lt[gt]||[],At=_t[gt];At.sort(((kt,Zt)=>{const Ut=st.featureSortOrder;if(Ut){const Xt=Ut.indexOf(kt.featureIndex);return Ut.indexOf(Zt.featureIndex)-Xt}return Zt.featureIndex-kt.featureIndex}));for(const kt of At)Mt.push(kt)}}for(const st in lt)lt[st].forEach((_t=>{const gt=_t.feature,Mt=U(B[st]);if(!Mt)return;const At=Mt.getFeatureState(gt.layer["source-layer"],gt.id);gt.source=gt.layer.source,gt.layer["source-layer"]&&(gt.sourceLayer=gt.layer["source-layer"]),gt.state=At}));return lt})(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(S)}querySourceFeatures(o,h){h&&h.filter&&this._validate(r.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const g=this._getSourceCaches(o);let w=[];for(const S of g)w=w.concat(An(S,h));return w}addSourceType(o,h,g){return qn.getSourceType(o)?g(new Error(`A source type called "${o}" already exists.`)):(qn.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},g):g(null,null))}getLight(){return this.light.getLight()}setLight(o,h={}){this._checkLoaded();const g=this.light.getLight();let w=!1;for(const k in o)if(!E(o[k],g[k])){w=!0;break}if(!w)return;const S=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,h),this.light.updateTransitions(S)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,h=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let g=o;if(h===1){if(typeof g.source=="object"){const w="terrain-dem-src";this.addSource(w,g.source),g=r.clone$1(g),g=r.extend(g,{source:w})}if(this._validate(r.validateTerrain,"terrain",g))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,h)}else{const w=this.terrain,S=w.get();for(const k of Object.keys(r.spec.terrain))!g.hasOwnProperty(k)&&r.spec.terrain[k].default&&(g[k]=r.spec.terrain[k].default);for(const k in g)if(!E(g[k],S[k])){w.set(g),this.stylesheet.terrain=g;const I=this._setTransitionParameters({duration:0});w.updateTransitions(I);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const h=this.fog=new Ue(o,this.map.transform);this.stylesheet.fog=o;const g=this._setTransitionParameters({duration:0});h.updateTransitions(g)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const o of this.map._markers)o._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,g=h.get();Object.keys(o).length===0&&h.set(o);for(const w in o)if(!E(o[w],g[w])){h.set(o),this.stylesheet.fog=o;const S=this._setTransitionParameters({duration:0});h.updateTransitions(S);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:r.exported.now(),transition:r.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter((g=>this.isLayerDraped(this._layers[g]))),h=this._order.filter((g=>!this.isLayerDraped(this._layers[g])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...h)}_createTerrain(o,h){const g=this.terrain=new de(o,h);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const w=this._setTransitionParameters({duration:0});g.updateTransitions(w)}_force3DLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="symbol"&&this._updateLayer(h)}}_validate(o,h,g,w,S={}){return(!S||S.validate!==!1)&&Ir(this,o.call(r.validateStyle,r.extend({key:h,style:this.serialize(),value:g,styleSpec:r.spec},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),r.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const h=this._getSourceCaches(o);for(const g of h)g.clearTiles()}_reloadSource(o){const h=this._getSourceCaches(o);for(const g of h)g.resume(),g.reload()}_reloadSources(){for(const o of this._getSources())o.reload&&o.reload()}_updateSources(o){for(const h in this._sourceCaches)this._sourceCaches[h].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const h=this._sourceCaches[o];h.resume(),h.reload()}}_updatePlacement(o,h,g,w,S=!1){let k=!1,I=!1;const B={};for(const V of this._order){const U=this._layers[V];if(U.type!=="symbol")continue;if(!B[U.source]){const tt=this._getLayerSourceCache(U);if(!tt)continue;B[U.source]=tt.getRenderableIds(!0).map((at=>tt.getTileByID(at))).sort(((at,ut)=>ut.tileID.overscaledZ-at.tileID.overscaledZ||(at.tileID.isLessThan(ut.tileID)?-1:1)))}const K=this.crossTileSymbolIndex.addLayer(U,B[U.source],o.center.lng,o.projection);k=k||K}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),S=S||this._layerOrderChanged||g===0,this._layerOrderChanged&&this.fire(new r.Event("neworder")),(S||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(r.exported.now(),o.zoom))&&(this.pauseablePlacement=new Gn(o,this._order,S,h,g,w,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,B),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(r.exported.now()),I=!0),k&&this.pauseablePlacement.placement.setStale()),I||k)for(const V of this._order){const U=this._layers[V];U.type==="symbol"&&this.placement.updateLayerOpacities(U,B[U.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(r.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,h,g){this.imageManager.getImages(h.icons,g),this._updateTilesForChangedImages();const w=S=>{S&&S.setDependencies(h.tileID.key,h.type,h.icons)};w(this._otherSourceCaches[h.source]),w(this._symbolSourceCaches[h.source])}getGlyphs(o,h,g){this.glyphManager.getGlyphs(h.stacks,g)}getResource(o,h,g){return r.makeRequest(h,g)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const h=[];return this._otherSourceCaches[o]&&h.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&h.push(this._symbolSourceCaches[o]),h}_isSourceCacheLoaded(o){const h=this._getSourceCaches(o);return h.length===0?(this.fire(new r.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):h.every((g=>g.loaded()))}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}qn.getSourceType=function(m){return Le[m]},qn.setSourceType=function(m,o){Le[m]=o},qn.registerForPluginStateChange=r.registerForPluginStateChange;var Wo=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,mr="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ko=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Zo=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Jr=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Wa={},ya={};const Za=[];Go(Wo,Za),Go(ko,Za),Go(Zo,Za),Go(Jr,Za),Wa=Ni("",ko),ya=Ni(Jr,Zo);const Ga=Ni(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),xl=Wo,Lr=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var Gc={background:Ni(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Ni(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Ni(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Ni("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ni(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Ni(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Ni("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Ni("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Ni("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Ni(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Ni(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Ni(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Ni(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Ni(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Ni(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Ni(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ni(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Ni(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Ni(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Ni(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Ni(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Ni(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Ni(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Ni(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Ni(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Ni(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,mr),skyboxGradient:Ni(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,mr),skyboxCapture:Ni(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Ni(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Ni(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Go(m,o){const h=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let g of h)if(g=g.trim(),g[0]==="#"&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=g.split(" ");for(const S of w)o.includes(S)||o.push(S)}}function Ni(m,o){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,g=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),w={},S=[...Za];return Go(m,S),Go(o,S),{fragmentSource:m=m.replace(h,((k,I,B,V,U)=>(w[U]=!0,I==="define"?`
#ifndef HAS_UNIFORM_u_${U}
varying ${B} ${V} ${U};
#else
uniform ${B} ${V} u_${U};
#endif
`:`
#ifdef HAS_UNIFORM_u_${U}
    ${B} ${V} ${U} = u_${U};
#endif
`))),vertexSource:o=o.replace(h,((k,I,B,V,U)=>{const K=V==="float"?"vec2":"vec4",tt=U.match(/color/)?"color":K;return w[U]?I==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${B} ${K} a_${U};
varying ${B} ${V} ${U};
#else
uniform ${B} ${V} u_${U};
#endif
`:tt==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = a_${U};
#else
    ${B} ${V} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${U} = unpack_mix_${tt}(a_${U}, u_${U}_t);
#else
    ${B} ${V} ${U} = u_${U};
#endif
`:I==="define"?`
#ifndef HAS_UNIFORM_u_${U}
uniform lowp float u_${U}_t;
attribute ${B} ${K} a_${U};
#else
uniform ${B} ${V} u_${U};
#endif
`:tt==="vec4"?`
#ifndef HAS_UNIFORM_u_${U}
    ${B} ${V} ${U} = a_${U};
#else
    ${B} ${V} ${U} = u_${U};
#endif
`:`
#ifndef HAS_UNIFORM_u_${U}
    ${B} ${V} ${U} = unpack_mix_${tt}(a_${U}, u_${U}_t);
#else
    ${B} ${V} ${U} = u_${U};
#endif
`})),staticAttributes:g,usedDefines:S}}class bl{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,h,g,w,S,k,I){this.context=o;let B=this.boundPaintVertexBuffers.length!==w.length;for(let U=0;!B&&U<w.length;U++)this.boundPaintVertexBuffers[U]!==w[U]&&(B=!0);let V=this.boundDynamicVertexBuffers.length!==I.length;for(let U=0;!V&&U<I.length;U++)this.boundDynamicVertexBuffers[U]!==I[U]&&(V=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==g||B||V||this.boundIndexBuffer!==S||this.boundVertexOffset!==k)this.freshBind(h,g,w,S,k,I);else{o.bindVertexArrayOES.set(this.vao);for(const U of I)U&&U.bind();S&&S.dynamicDraw&&S.bind()}}freshBind(o,h,g,w,S,k){let I;const B=o.numAttributes,V=this.context,U=V.gl;if(V.extVertexArrayObject)this.vao&&this.destroy(),this.vao=V.extVertexArrayObject.createVertexArrayOES(),V.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=w,this.boundVertexOffset=S,this.boundDynamicVertexBuffers=k;else{I=V.currentNumAttributes||0;for(let K=B;K<I;K++)U.disableVertexAttribArray(K)}h.enableAttributes(U,o),h.bind(),h.setVertexAttribPointers(U,o,S);for(const K of g)K.enableAttributes(U,o),K.bind(),K.setVertexAttribPointers(U,o,S);for(const K of k)K&&(K.enableAttributes(U,o),K.bind(),K.setVertexAttribPointers(U,o,S));w&&w.bind(),V.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function oc(m,o){const h=Math.pow(2,o.canonical.z),g=o.canonical.y;return[new r.MercatorCoordinate(0,g/h).toLngLat().lat,new r.MercatorCoordinate(0,(g+1)/h).toLngLat().lat]}function ac(m,o,h,g,w,S,k){const I=m.context,B=I.gl,V=h.fbo;if(!V)return;m.prepareDrawTile();const U=m.useProgram("hillshade");I.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,V.colorAttachment.get());const K=((lt,dt,Y,st)=>{const _t=Y.paint.get("hillshade-shadow-color"),gt=Y.paint.get("hillshade-highlight-color"),Mt=Y.paint.get("hillshade-accent-color");let At=Y.paint.get("hillshade-illumination-direction")*(Math.PI/180);Y.paint.get("hillshade-illumination-anchor")==="viewport"&&(At-=lt.transform.angle);const kt=!lt.options.moving;return{u_matrix:st||lt.transform.calculateProjMatrix(dt.tileID.toUnwrapped(),kt),u_image:0,u_latrange:oc(0,dt.tileID),u_light:[Y.paint.get("hillshade-exaggeration"),At],u_shadow:_t,u_highlight:gt,u_accent:Mt}})(m,h,g,m.terrain?o.projMatrix:null);m.prepareDrawProgram(I,U,o.toUnwrapped());const{tileBoundsBuffer:tt,tileBoundsIndexBuffer:at,tileBoundsSegments:ut}=m.getTileBoundsBuffers(h);U.draw(I,B.TRIANGLES,w,S,k,r.CullFaceMode.disabled,K,g.id,tt,at,ut)}function wl(m,o,h){if(!o.needsDEMTextureUpload)return;const g=m.context,w=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||m.getTileTexture(h.stride);const S=h.getPixels();o.demTexture?o.demTexture.update(S,{premultiply:!1}):o.demTexture=new r.Texture(g,S,w.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function lc(m,o,h,g,w,S){const k=m.context,I=k.gl;if(!o.dem)return;const B=o.dem;if(k.activeTexture.set(I.TEXTURE1),wl(m,o,B),!o.demTexture)return;o.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const V=B.dim;k.activeTexture.set(I.TEXTURE0);let U=o.fbo;if(!U){const ut=new r.Texture(k,{width:V,height:V,data:null},I.RGBA);ut.bind(I.LINEAR,I.CLAMP_TO_EDGE),U=o.fbo=k.createFramebuffer(V,V,!0),U.colorAttachment.set(ut.texture)}k.bindFramebuffer.set(U.framebuffer),k.viewport.set([0,0,V,V]);const{tileBoundsBuffer:K,tileBoundsIndexBuffer:tt,tileBoundsSegments:at}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(k,I.TRIANGLES,g,w,S,r.CullFaceMode.disabled,((ut,lt)=>{const dt=lt.stride,Y=r.create();return r.ortho(Y,0,r.EXTENT,-r.EXTENT,0,0,1),r.translate(Y,Y,[0,-r.EXTENT,0]),{u_matrix:Y,u_image:1,u_dimension:[dt,dt],u_zoom:ut.overscaledZ,u_unpack:lt.unpackVector}})(o.tileID,B),h.id,K,tt,at),o.needsHillshadePrepare=!1}const Tl=m=>({u_matrix:new r.UniformMatrix4f(m),u_image0:new r.Uniform1i(m),u_skirt_height:new r.Uniform1f(m)}),Dr=(m,o)=>({u_matrix:m,u_image0:0,u_skirt_height:o}),Ha=(m,o,h,g,w,S,k,I,B,V,U,K,tt,at,ut)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:h,u_zoom_transition:w,u_merc_center:S,u_image0:0,u_frustum_tl:k,u_frustum_tr:I,u_frustum_br:B,u_frustum_bl:V,u_globe_pos:U,u_globe_radius:K,u_viewport:tt,u_grid_matrix:ut?Float32Array.from(ut):new Float32Array(9),u_skirt_height:at});function Ho(m,o){return m!=null&&o!=null&&!(!m.hasData()||!o.hasData())&&m.demTexture!=null&&o.demTexture!=null&&m.tileID.key!==o.tileID.key}const Qr=new class{constructor(){this.operations={}}newMorphing(m,o,h,g,w){if(m in this.operations){const S=this.operations[m];S.to.tileID.key!==h.tileID.key&&(S.queued=h)}else this.operations[m]={startTime:g,phase:0,duration:w,from:o,to:h,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const o=this.operations[m];return{from:o.from,to:o.to,phase:o.phase}}update(m){for(const o in this.operations){const h=this.operations[o];for(h.phase=(m-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,m)){delete this.operations[o];break}}}_nextOp(m,o){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=o,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},qo={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function El(m){return 6*Math.pow(1.5,22-m)}function Sl(m,o){const h=1<<m.z;return!o&&(m.x===0||m.x===h-1)||m.y===0||m.y===h-1}const Ur=m=>({u_matrix:m});function cc(m,o,h,g,w){if(w>0){const S=r.exported.now(),k=(S-m.timeAdded)/w,I=o?(S-o.timeAdded)/w:-1,B=h.getSource(),V=g.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),U=!o||Math.abs(o.tileID.overscaledZ-V)>Math.abs(m.tileID.overscaledZ-V),K=U&&m.refreshedUponExpiration?1:r.clamp(U?k:1-I,0,1);return m.refreshedUponExpiration&&k>=1&&(m.refreshedUponExpiration=!1),o?{opacity:1,mix:1-K}:{opacity:K,mix:0}}return{opacity:1,mix:0}}class Xo extends r.SourceCache{constructor(o){const h={type:"raster-dem",maxzoom:o.transform.maxZoom},g=new $t(ns(),null),w=Mi("mock-dem",h,g,o.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,h){o.state="loaded",h(null)}}class Zs extends r.SourceCache{constructor(o){const h=Mi("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new $t(ns(),null),o.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,h,g){if(o.freezeTileCoverage)return;this.transform=o;const w=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((S,k)=>{if(S[k.key]="",!this._tiles[k.key]){const I=new r.Tile(k,this._source.tileSize*k.overscaleFactor(),o.tileZoom);I.state="loaded",this._tiles[k.key]=I}return S}),{});for(const S in this._tiles)S in w||(this.freeFBO(S),this._tiles[S].unloadVectorData(),delete this._tiles[S])}freeFBO(o){const h=this.proxyCachedFBO[o];if(h!==void 0){const g=Object.values(h);this.renderCachePool.push(...g),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach((o=>o.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class to extends r.OverscaledTileID{constructor(o,h,g){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=h,this.projMatrix=g}}class eo extends r.Elevation{constructor(o,h){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,w,S]=(function(B){const V=new r.StructArrayLayout2i4,U=new r.StructArrayLayout3ui6,K=131;V.reserve(17161),U.reserve(33800);const tt=r.EXTENT/128,at=r.EXTENT+tt/2,ut=at+tt;for(let dt=-tt;dt<ut;dt+=tt)for(let Y=-tt;Y<ut;Y+=tt){const st=Y<0||Y>at||dt<0||dt>at?24575:0,_t=r.clamp(Math.round(Y),0,r.EXTENT),gt=r.clamp(Math.round(dt),0,r.EXTENT);V.emplaceBack(_t+st,gt)}const lt=(dt,Y)=>{const st=Y*K+dt;U.emplaceBack(st+1,st,st+K),U.emplaceBack(st+K,st+K+1,st+1)};for(let dt=1;dt<129;dt++)for(let Y=1;Y<129;Y++)lt(Y,dt);return[0,129].forEach((dt=>{for(let Y=0;Y<130;Y++)lt(Y,dt),lt(dt,Y)})),[V,U,32768]})(),k=o.context;this.gridBuffer=k.createVertexBuffer(g,r.posAttributes.members),this.gridIndexBuffer=k.createIndexBuffer(w),this.gridSegments=r.SegmentVector.simpleSegment(0,0,g.length,w.length),this.gridNoSkirtSegments=r.SegmentVector.simpleSegment(0,0,g.length,S),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Zs(h.map),this.orthoMatrix=r.create(),r.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,r.EXTENT,0,r.EXTENT,0,1);const I=k.gl;this._overlapStencilMode=new r.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Xo(h.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(o,h,g){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const w=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(w.get("source")),this._exaggeration=w.get("exaggeration");const S=()=>{this.sourceCache.used&&r.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const k=this.getScaledDemTileSize();this.sourceCache.update(h,k,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,S(),this._initializing=!0),S(),h.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&r.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((o=>o.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=g._centerAltitude===0&&this.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(g.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=h.getIds().map((B=>{const V=h.getTileByID(B).tileID;return V.projMatrix=g.calculateProjMatrix(V.toUnwrapped()),V}));(function(B,V){const U=V.transform.pointCoordinate(V.transform.getCameraPoint()),K=new r.Point(U.x,U.y);B.sort(((tt,at)=>{if(at.overscaledZ-tt.overscaledZ)return at.overscaledZ-tt.overscaledZ;const ut=new r.Point(tt.canonical.x+(1<<tt.canonical.z)*tt.wrap,tt.canonical.y),lt=new r.Point(at.canonical.x+(1<<at.canonical.z)*at.wrap,at.canonical.y),dt=K.mult(1<<tt.canonical.z);return dt.x-=.5,dt.y-=.5,dt.distSqr(ut)-dt.distSqr(lt)}))})(w,this.painter),this._previousZoom=g.zoom;const S=this.proxyToSource||{};this.proxyToSource={},w.forEach((B=>{this.proxyToSource[B.key]={}})),this.terrainTileForTile={};const k=this._style._sourceCaches;for(const B in k){const V=k[B];if(!V.used||(V!==this.sourceCache&&this.resetTileLookupCache(V.id),this._setupProxiedCoordsForOrtho(V,o[B],S),V.usedForTerrain))continue;const U=o[B];V.getSource().reparseOverscaled&&this._assignTerrainTiles(U)}this.proxiedCoords[h.id]=w.map((B=>new to(B,B.key,this.orthoMatrix))),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(S),this.renderingToTexture=!1,this._updateTimestamp=r.exported.now();const I={};this._visibleDemTiles=[];for(const B of this.proxyCoords){const V=this.terrainTileForTile[B.key];if(!V)continue;const U=V.tileID.key;U in I||(this._visibleDemTiles.push(V),I[U]=U)}}_assignTerrainTiles(o){this._initializing||o.forEach((h=>{if(this.terrainTileForTile[h.key])return;const g=this._findTileCoveringTileID(h,this.sourceCache);g&&(this.terrainTileForTile[h.key]=g)}))}_prepareDEMTextures(){const o=this.painter.context,h=o.gl;for(const g in this.terrainTileForTile){const w=this.terrainTileForTile[g],S=w.dem;!S||w.demTexture&&!w.needsDEMTextureUpload||(o.activeTexture.set(h.TEXTURE1),wl(this.painter,w,S))}}_prepareDemTileUniforms(o,h,g,w){if(!h||h.demTexture==null)return!1;const S=o.tileID.canonical,k=Math.pow(2,h.tileID.canonical.z-S.z),I=w||"";return g[`u_dem_tl${I}`]=[S.x*k%1,S.y*k%1],g[`u_dem_scale${I}`]=k,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,h=o.gl;if(!this._emptyDepthBufferTexture){const g=new r.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new r.Texture(o,g,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const h=this._visibleDemTiles.reduce(((g,w)=>{if(!w.dem)return g;const S=w.dem.tree.minimums[0];return S>0&&o++,g+S}),0);return o?h/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,h=o.gl;o.activeTexture.set(h.TEXTURE2);const g=this._getLoadedAreaMinimum(),w=new r.RGBAImage({width:1,height:1},new Uint8Array(r.DEMData.pack(g,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let S=this._emptyDEMTexture;return S?S.update(w,{premultiply:!1}):S=this._emptyDEMTexture=new r.Texture(o,w,h.RGBA,{premultiply:!1}),S}setupElevationDraw(o,h,g){const w=this.painter.context,S=w.gl,k=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:r.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;k.u_dem_size=this.sourceCache.getSource().tileSize,k.u_exaggeration=this.exaggeration();let B=null,V=null,U=1;if(g&&g.morphing&&this._useVertexMorphing){const K=g.morphing.srcDemTile,tt=g.morphing.dstDemTile;U=g.morphing.phase,K&&tt&&(this._prepareDemTileUniforms(o,K,k,"_prev")&&(V=K),this._prepareDemTileUniforms(o,tt,k)&&(B=tt))}if(V&&B?(w.activeTexture.set(S.TEXTURE2),B.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),w.activeTexture.set(S.TEXTURE4),V.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE,S.NEAREST),k.u_dem_lerp=U):(B=this.terrainTileForTile[o.tileID.key],w.activeTexture.set(S.TEXTURE2),(this._prepareDemTileUniforms(o,B,k)?B.demTexture:this.emptyDEMTexture).bind(S.NEAREST,S.CLAMP_TO_EDGE)),w.activeTexture.set(S.TEXTURE3),g&&g.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),this._depthFBO&&(k.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE),k.u_depth_size_inv=[1,1]),g&&g.useMeterToDem&&B){const K=(1<<B.tileID.canonical.z)*r.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;k.u_meter_to_dem=K}if(g&&g.labelPlaneMatrixInv&&(k.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),h.setTerrainUniformValues(w,k),this.painter.transform.projection.name==="globe"){const K=this.globeUniformValues(this.painter.transform,o.tileID.canonical,g&&g.useDenormalizedUpVectorScale);h.setGlobeUniformValues(w,K)}}globeUniformValues(o,h,g){const w=o.projection;return{u_tile_tl_up:w.upVector(h,0,0),u_tile_tr_up:w.upVector(h,r.EXTENT,0),u_tile_br_up:w.upVector(h,r.EXTENT,r.EXTENT),u_tile_bl_up:w.upVector(h,0,r.EXTENT),u_tile_up_scale:g?r.globeMetersToEcef(1):w.upVectorScale(h,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const h=this.painter,g=this.painter.context;o.length!==0&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(w,S,k,I,B){if(w.transform.projection.name==="globe")(function(V,U,K,tt,at){const ut=V.context,lt=ut.gl;let dt,Y;const st=V.options.showTerrainWireframe?2:0,_t=V.transform,gt=r.globeUseCustomAntiAliasing(V,ut,_t),Mt=(Ee,Ht)=>{if(Y===Ee)return;const se=[qo[Ee],"PROJECTION_GLOBE_VIEW"];gt&&se.push("CUSTOM_ANTIALIASING"),Ht&&se.push(qo[st]),dt=V.useProgram("globeRaster",null,se),Y=Ee},At=V.colorModeForRenderPass(),kt=new r.DepthMode(lt.LEQUAL,r.DepthMode.ReadWrite,V.depthRangeFor3D);Qr.update(at);const Zt=r.calculateGlobeMercatorMatrix(_t),Ut=[r.mercatorXfromLng(_t.center.lng),r.mercatorYfromLat(_t.center.lat)],Xt=st?[!1,!0]:[!1],Te=V.globeSharedBuffers,Gt=[_t.width*r.exported.devicePixelRatio,_t.height*r.exported.devicePixelRatio],fe=Float32Array.from(_t.globeMatrix),te={useDenormalizedUpVectorScale:!0};if(Xt.forEach((Ee=>{const Ht=V.transform,se=El(Ht.zoom)*U.exaggeration();Y=-1;const be=Ee?lt.LINES:lt.TRIANGLES;for(const ge of tt){const Me=K.getTile(ge),ai=r.StencilMode.disabled,bi=U.prevTerrainTileForTile[ge.key],ei=U.terrainTileForTile[ge.key];Ho(bi,ei)&&Qr.newMorphing(ge.key,bi,ei,at,250),ut.activeTexture.set(lt.TEXTURE0),Me.texture.bind(lt.LINEAR,lt.CLAMP_TO_EDGE);const li=Qr.getMorphValuesForProxy(ge.key),$i=li?1:0;li&&r.extend$1(te,{morphing:{srcDemTile:li.from,dstDemTile:li.to,phase:r.easeCubicInOut(li.phase)}});const ji=r.tileCornersToBounds(ge.canonical),oi=r.getLatitudinalLod(ji.getCenter().lat),en=r.getGridMatrix(ge.canonical,ji,oi,Ht.worldSize/Ht._pixelsPerMercatorPixel),un=r.globeNormalizeECEF(r.globeTileBounds(ge.canonical)),mn=Ha(Ht.projMatrix,fe,Zt,un,r.globeToMercatorTransition(Ht.zoom),Ut,Ht.frustumCorners.TL,Ht.frustumCorners.TR,Ht.frustumCorners.BR,Ht.frustumCorners.BL,Ht.globeCenterInViewSpace,Ht.globeRadius,Gt,se,en);if(Mt($i,Ee),U.setupElevationDraw(Me,dt,te),V.prepareDrawProgram(ut,dt,ge.toUnwrapped()),Te){const[hn,qs,Bs]=Ee?Te.getWirefameBuffers(V.context,oi):Te.getGridBuffers(oi,se!==0);dt.draw(ut,be,kt,ai,At,r.CullFaceMode.backCCW,mn,"globe_raster",hn,qs,Bs)}}})),Te){const Ee=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];gt&&Ee.push("CUSTOM_ANTIALIASING"),dt=V.useProgram("globeRaster",null,Ee);for(const Ht of tt){const{x:se,y:be,z:ge}=Ht.canonical,Me=be===0,ai=be===(1<<ge)-1,[bi,ei,li,$i]=Te.getPoleBuffers(ge);if($i&&(Me||ai)){const ji=K.getTile(Ht);ut.activeTexture.set(lt.TEXTURE0),ji.texture.bind(lt.LINEAR,lt.CLAMP_TO_EDGE);let oi=r.globePoleMatrixForTile(ge,se,_t);const en=r.globeNormalizeECEF(r.globeTileBounds(Ht.canonical)),un=(mn,hn)=>mn.draw(ut,lt.TRIANGLES,kt,r.StencilMode.disabled,At,r.CullFaceMode.disabled,Ha(_t.projMatrix,oi,oi,en,0,Ut,_t.frustumCorners.TL,_t.frustumCorners.TR,_t.frustumCorners.BR,_t.frustumCorners.BL,_t.globeCenterInViewSpace,_t.globeRadius,Gt,0),"globe_pole_raster",hn,li,$i);U.setupElevationDraw(ji,dt,te),V.prepareDrawProgram(ut,dt,Ht.toUnwrapped()),Me&&un(dt,bi),ai&&(oi=r.scale(r.create(),oi,[1,-1,1]),un(dt,ei))}}}})(w,S,k,I,B);else{const V=w.context,U=V.gl;let K,tt;const at=w.options.showTerrainWireframe?2:0,ut=(_t,gt)=>{if(tt===_t)return;const Mt=[qo[_t]];gt&&Mt.push(qo[at]),K=w.useProgram("terrainRaster",null,Mt),tt=_t},lt=w.colorModeForRenderPass(),dt=new r.DepthMode(U.LEQUAL,r.DepthMode.ReadWrite,w.depthRangeFor3D);Qr.update(B);const Y=w.transform,st=El(Y.zoom)*S.exaggeration();(at?[!1,!0]:[!1]).forEach((_t=>{tt=-1;const gt=_t?U.LINES:U.TRIANGLES,[Mt,At]=_t?S.getWirefameBuffer():[S.gridIndexBuffer,S.gridSegments];for(const kt of I){const Zt=k.getTile(kt),Ut=r.StencilMode.disabled,Xt=S.prevTerrainTileForTile[kt.key],Te=S.terrainTileForTile[kt.key];Ho(Xt,Te)&&Qr.newMorphing(kt.key,Xt,Te,B,250),V.activeTexture.set(U.TEXTURE0),Zt.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE,U.LINEAR_MIPMAP_NEAREST);const Gt=Qr.getMorphValuesForProxy(kt.key),fe=Gt?1:0;let te;Gt&&(te={morphing:{srcDemTile:Gt.from,dstDemTile:Gt.to,phase:r.easeCubicInOut(Gt.phase)}});const Ee=Dr(kt.projMatrix,Sl(kt.canonical,Y.renderWorldCopies)?st/10:st);ut(fe,_t),S.setupElevationDraw(Zt,K,te),w.prepareDrawProgram(V,K,kt.toUnwrapped()),K.draw(V,gt,dt,Ut,lt,r.CullFaceMode.backCCW,Ee,"terrain_raster",S.gridBuffer,Mt,At)}}))}})(h,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const h=this.painter,g=this.painter.context,w=this.proxySourceCache,S=this.proxiedCoords[w.id],k=this._drapedRenderBatches.shift(),I=[],B=h.style.order;let V=0;for(const U of S){const K=w.getTileByID(U.proxyTileKey),tt=w.proxyCachedFBO[U.key]?w.proxyCachedFBO[U.key][o]:void 0,at=tt!==void 0?w.renderCache[tt]:this.pool[V++],ut=tt!==void 0;if(K.texture=at.tex,ut&&!at.dirty){I.push(K.tileID);continue}let lt;g.bindFramebuffer.set(at.fb.framebuffer),this.renderedToTile=!1,at.dirty&&(g.clear({color:r.Color.transparent,stencil:0}),at.dirty=!1);for(let dt=k.start;dt<=k.end;++dt){const Y=h.style._layers[B[dt]];if(Y.isHidden(h.transform.zoom))continue;const st=h.style._getLayerSourceCache(Y),_t=st?this.proxyToSource[U.key][st.id]:[U];if(!_t)continue;const gt=_t;g.viewport.set([0,0,at.fb.width,at.fb.height]),lt!==(st?st.id:null)&&(this._setupStencil(at,_t,Y,st),lt=st?st.id:null),h.renderLayer(h,st,Y,gt)}this.renderedToTile?(at.dirty=!0,I.push(K.tileID)):ut||--V,V===5&&(V=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,h.width,h.height]),k.end+1}postRender(){}renderCacheEfficiency(o){const h=o.order.length;if(h===0)return{efficiency:100};let g,w=0,S=0,k=!1;for(let I=0;I<h;++I){const B=o._layers[o.order[I]];this._style.isLayerDraped(B)?(k&&++w,++S):k||(k=!0,g=B.id)}return S===0?{efficiency:100}:{efficiency:100*(1-w/S),firstUndrapedLayer:g}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter((h=>h.dem)).forEach((h=>{o=Math.min(o,h.dem.tree.minimums[0])})),o===0?o:(o-30)*this._exaggeration}raycast(o,h,g){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter((S=>S.dem)).map((S=>{const k=S.tileID,I=1<<k.overscaledZ,{x:B,y:V}=k.canonical,U=B/I,K=(B+1)/I,tt=V/I,at=(V+1)/I;return{minx:U,miny:tt,maxx:K,maxy:at,t:S.dem.tree.raycastRoot(U,tt,K,at,o,h,g),tile:S}}));w.sort(((S,k)=>(S.t!==null?S.t:Number.MAX_VALUE)-(k.t!==null?k.t:Number.MAX_VALUE)));for(const S of w){if(S.t==null)return null;const k=S.tile.dem.tree.raycast(S.minx,S.miny,S.maxx,S.maxy,o,h,g);if(k!=null)return k}return null}_createFBO(){const o=this.painter.context,h=o.gl,g=this.drapeBufferSize;o.activeTexture.set(h.TEXTURE0);const w=new r.Texture(o,{width:g[0],height:g[1],data:null},h.RGBA);w.bind(h.LINEAR,h.CLAMP_TO_EDGE);const S=o.createFramebuffer(g[0],g[1],!1);return S.colorAttachment.set(w.texture),S.depthAttachment=new Vt(o,S.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,S.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):S.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:S,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some((o=>{const h=this._style._layers[o],g=h.isHidden(this.painter.transform.zoom);return h.type==="custom"?!g&&h.shouldRedrape():!g&&h.hasTransition()}))}_clearLineLayersFromRenderCache(){let o=!1;for(const g of this._style._getSources())if(g instanceof Be){o=!0;break}if(!o)return;const h={};for(let g=0;g<this._style.order.length;++g){const w=this._style._layers[this._style.order[g]],S=this._style._getLayerSourceCache(w);if(S&&!h[S.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof r.ZoomDependentExpression){h[S.id]=!0;for(const k of this.proxyCoords){const I=this.proxyToSource[k.key][S.id];if(I)for(const B of I)this._clearRenderCacheForTile(S.id,B)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const g in this._style._sourceCaches)if(this._style._sourceCaches[g]._source instanceof Pe){o=!0;break}if(!o)return;const h={};for(let g=0;g<this._style.order.length;++g){const w=this._style._layers[this._style.order[g]],S=this._style._getLayerSourceCache(w);if(!S||h[S.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const k=w.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const B=this.proxyToSource[I.key][S.id];if(B)for(const V of B){const U=cc(S.getTile(V),S.findLoadedParent(V,0),S,this.painter.transform,k);(U.opacity!==1||U.mix!==0)&&this._clearRenderCacheForTile(S.id,V)}}}}_setupDrapedRenderBatches(){const o=this._style.order,h=o.length;if(h===0)return;const g=[];let w,S=0,k=this._style._layers[o[S]];for(;!this._style.isLayerDraped(k)&&k.isHidden(this.painter.transform.zoom)&&++S<h;)k=this._style._layers[o[S]];for(;S<h;++S){const I=this._style._layers[o[S]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?w===void 0&&(w=S):w!==void 0&&(g.push({start:w,end:S-1}),w=void 0))}w!==void 0&&g.push({start:w,end:S-1}),this._drapedRenderBatches=g}_setupRenderCache(o){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const k=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let I=0;I<k.length;++I){const B=Object.values(k[I]);h.renderCachePool.push(...B)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,w=this._tilesDirty;for(let k=g.length-1;k>=0;k--){const I=g[k];if(h.getTileByID(I.key),h.proxyCachedFBO[I.key]!==void 0){const B=o[I.key],V=this.proxyToSource[I.key];let U=0;for(const K in V){const tt=V[K],at=B[K];if(!at||at.length!==tt.length||tt.some(((ut,lt)=>ut!==at[lt]||w[K]&&w[K].hasOwnProperty(ut.key)))){U=-1;break}++U}for(const K in h.proxyCachedFBO[I.key])h.renderCache[h.proxyCachedFBO[I.key][K]].dirty=U<0||U!==Object.values(B).length}}const S=[...this._drapedRenderBatches];S.sort(((k,I)=>I.end-I.start-(k.end-k.start)));for(const k of S)for(const I of g){if(h.proxyCachedFBO[I.key])continue;let B=h.renderCachePool.pop();B===void 0&&h.renderCache.length<50&&(B=h.renderCache.length,h.renderCache.push(this._createFBO())),B!==void 0&&(h.proxyCachedFBO[I.key]={},h.proxyCachedFBO[I.key][k.start]=B,h.renderCache[B].dirty=!0)}this._tilesDirty={}}_setupStencil(o,h,g,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const S=this.painter.context,k=S.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let I;if(g.isTileClipped())I=h.length,this._overlapStencilMode.test={func:k.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:k.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(S.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):r.StencilMode.disabled}_renderTileClippingMasks(o,h){const g=this.painter,w=this.painter.context,S=w.gl;g._tileClippingMaskIDs={},w.setColorMode(r.ColorMode.disabled),w.setDepthMode(r.DepthMode.disabled);const k=g.useProgram("clippingMask");for(const I of o){const B=g._tileClippingMaskIDs[I.key]=--h;k.draw(w,S.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:S.ALWAYS,mask:0},B,255,S.KEEP,S.KEEP,S.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,Ur(I.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(o){const h=this.painter.transform;if(o.x<0||o.x>h.width||o.y<0||o.y>h.height)return null;const g=[o.x,o.y,1,1];r.transformMat4$1(g,g,h.pixelMatrixInverse),r.scale$1(g,g,1/g[3]),g[0]/=h.worldSize,g[1]/=h.worldSize;const w=h._camera.position,S=r.mercatorZfromAltitude(1,h.center.lat),k=[w[0],w[1],w[2]/S,0],I=r.subtract([],g.slice(0,3),k);r.normalize(I,I);const B=this.raycast(k,I,this._exaggeration);return B!==null&&B?(r.scaleAndAdd(k,k,I,B),k[3]=k[2],k[2]*=S,k):null}drawDepth(){const o=this.painter,h=o.context,g=this.proxySourceCache,w=Math.ceil(o.width),S=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===w&&this._depthFBO.height===S||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const k=h.gl,I=h.createFramebuffer(w,S,!0);h.activeTexture.set(k.TEXTURE0);const B=new r.Texture(h,{width:w,height:S,data:null},k.RGBA);B.bind(k.NEAREST,k.CLAMP_TO_EDGE),I.colorAttachment.set(B.texture);const V=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,w,S);I.depthAttachment.set(V),this._depthFBO=I,this._depthTexture=B}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,w,S]),(function(k,I,B,V){if(k.transform.projection.name==="globe")return;const U=k.context,K=U.gl;U.clear({depth:1});const tt=k.useProgram("terrainDepth"),at=new r.DepthMode(K.LESS,r.DepthMode.ReadWrite,k.depthRangeFor3D);for(const ut of V){const lt=B.getTile(ut),dt=Dr(ut.projMatrix,0);I.setupElevationDraw(lt,tt),tt.draw(U,K.TRIANGLES,at,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.backCCW,dt,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}})(o,this,g,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,h,g){if(o.getSource()instanceof yi)return this._setupProxiedCoordsForImageSource(o,h,g);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const w=this.proxiedCoords[o.id]=[],S=this.proxyCoords;for(let I=0;I<S.length;I++){const B=S[I],V=this._findTileCoveringTileID(B,o);if(V){const U=this._createProxiedId(B,V,g[B.key]&&g[B.key][o.id]);w.push(U),this.proxyToSource[B.key][o.id]=[U]}}let k=!1;for(let I=0;I<h.length;I++){const B=o.getTile(h[I]);if(!B||!B.hasData())continue;const V=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if(V&&V.tileID.canonical.z!==B.tileID.canonical.z){const U=this.proxyToSource[V.tileID.key][o.id],K=this._createProxiedId(V.tileID,B,g[V.tileID.key]&&g[V.tileID.key][o.id]);U?U.splice(U.length-1,0,K):this.proxyToSource[V.tileID.key][o.id]=[K],w.push(K),k=!0}}this._sourceTilesOverlap[o.id]=k}_setupProxiedCoordsForImageSource(o,h,g){if(!o.getSource().loaded())return;const w=this.proxiedCoords[o.id]=[],S=this.proxyCoords,k=o.getSource(),I=new r.Point(k.tileID.x,k.tileID.y)._div(1<<k.tileID.z),B=k.coordinates.map(r.MercatorCoordinate.fromLngLat).reduce(((U,K)=>(U.min.x=Math.min(U.min.x,K.x-I.x),U.min.y=Math.min(U.min.y,K.y-I.y),U.max.x=Math.max(U.max.x,K.x-I.x),U.max.y=Math.max(U.max.y,K.y-I.y),U)),{min:new r.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new r.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),V=(U,K)=>{const tt=U.wrap+U.canonical.x/(1<<U.canonical.z),at=U.canonical.y/(1<<U.canonical.z),ut=r.EXTENT/(1<<U.canonical.z),lt=K.wrap+K.canonical.x/(1<<K.canonical.z),dt=K.canonical.y/(1<<K.canonical.z);return tt+ut<lt+B.min.x||tt>lt+B.max.x||at+ut<dt+B.min.y||at>dt+B.max.y};for(let U=0;U<S.length;U++){const K=S[U];for(let tt=0;tt<h.length;tt++){const at=o.getTile(h[tt]);if(!at||!at.hasData()||V(K,at.tileID))continue;const ut=this._createProxiedId(K,at,g[K.key]&&g[K.key][o.id]),lt=this.proxyToSource[K.key][o.id];lt?lt.push(ut):this.proxyToSource[K.key][o.id]=[ut],w.push(ut)}}}_createProxiedId(o,h,g){let w=this.orthoMatrix;if(g){const S=g.find((k=>k.key===h.tileID.key));if(S)return S}if(h.tileID.key!==o.key){const S=o.canonical.z-h.tileID.canonical.z;let k,I,B;w=r.create();const V=h.tileID.wrap-o.wrap<<o.overscaledZ;S>0?(k=r.EXTENT>>S,I=k*((h.tileID.canonical.x<<S)-o.canonical.x+V),B=k*((h.tileID.canonical.y<<S)-o.canonical.y)):(k=r.EXTENT<<-S,I=r.EXTENT*(h.tileID.canonical.x-(o.canonical.x+V<<-S)),B=r.EXTENT*(h.tileID.canonical.y-(o.canonical.y<<-S))),r.ortho(w,0,k,0,k,0,1),r.translate(w,w,[I,B,0])}return new to(h.tileID,o.key,w)}_findTileCoveringTileID(o,h){let g=h.getTile(o);if(g&&g.hasData())return g;const w=this._findCoveringTileCache[h.id],S=w[o.key];if(g=S?h.getTileByID(S):null,g&&g.hasData()||S===null)return g;let k=g?g.tileID:o,I=k.overscaledZ;const B=h.getSource().minzoom,V=[];if(!S){const K=h.getSource().maxzoom;if(o.canonical.z>=K){const tt=o.canonical.z-K;h.getSource().reparseOverscaled?(I=Math.max(o.canonical.z+2,h.transform.tileZoom),k=new r.OverscaledTileID(I,o.wrap,K,o.canonical.x>>tt,o.canonical.y>>tt)):tt!==0&&(I=K,k=new r.OverscaledTileID(I,o.wrap,K,o.canonical.x>>tt,o.canonical.y>>tt))}k.key!==o.key&&(V.push(k.key),g=h.getTile(k))}const U=K=>{V.forEach((tt=>{w[tt]=K})),V.length=0};for(I-=1;I>=B&&(!g||!g.hasData());I--){g&&U(g.tileID.key);const K=k.calculateScaledKey(I);if(g=h.getTileByID(K),g&&g.hasData())break;const tt=w[K];if(tt===null)break;tt===void 0?V.push(K):g=h.getTileByID(tt)}return U(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,h){let g=this._tilesDirty[o];g||(g=this._tilesDirty[o]={}),g[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=(function(h){let g=0;const w=new r.StructArrayLayout2ui4,S=131;for(let k=1;k<129;k++){for(let I=1;I<129;I++)g=k*S+I,w.emplaceBack(g,g+1),w.emplaceBack(g,g+S),w.emplaceBack(g+1,g+S),k===128&&w.emplaceBack(g+S,g+S+1);w.emplaceBack(g+1,g+1+S)}return w})();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=r.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Hi{static cacheKey(o,h,g,w){let S=`${h}${w?w.cacheKey:""}`;for(const k of g)o.usedDefines.includes(k)&&(S+=`/${k}`);return S}constructor(o,h,g,w,S,k){const I=o.gl;this.program=I.createProgram();const B=(function(Y){const st=[];for(let _t=0;_t<Y.length;_t++){if(Y[_t]===null)continue;const gt=Y[_t].split(" ");st.push(gt.pop())}return st})(g.staticAttributes),V=w?w.getBinderAttributes():[],U=B.concat(V);let K=w?w.defines():[];K=K.concat(k.map((Y=>`#define ${Y}`)));const tt=o.isWebGL2?`#version 300 es
`:"",at=tt+K.concat(o.extStandardDerivatives&&tt.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Lr):Lr,Lr,xl,Ga.fragmentSource,ya.fragmentSource,g.fragmentSource).join(`
`),ut=tt+K.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,xl,Ga.vertexSource,ya.vertexSource,Wa.vertexSource,g.vertexSource).join(`
`),lt=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource(lt,at),I.compileShader(lt),I.attachShader(this.program,lt);const dt=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(dt,ut),I.compileShader(dt),I.attachShader(this.program,dt),this.attributes={},this.numAttributes=U.length;for(let Y=0;Y<this.numAttributes;Y++)U[Y]&&(I.bindAttribLocation(this.program,Y,U[Y]),this.attributes[U[Y]]=Y);I.linkProgram(this.program),I.deleteShader(dt),I.deleteShader(lt),this.fixedUniforms=S(o),this.binderUniforms=w?w.getUniforms(o):[],k.includes("TERRAIN")&&(this.terrainUniforms=(Y=>({u_dem:new r.Uniform1i(Y),u_dem_prev:new r.Uniform1i(Y),u_dem_unpack:new r.Uniform4f(Y),u_dem_tl:new r.Uniform2f(Y),u_dem_scale:new r.Uniform1f(Y),u_dem_tl_prev:new r.Uniform2f(Y),u_dem_scale_prev:new r.Uniform1f(Y),u_dem_size:new r.Uniform1f(Y),u_dem_lerp:new r.Uniform1f(Y),u_exaggeration:new r.Uniform1f(Y),u_depth:new r.Uniform1i(Y),u_depth_size_inv:new r.Uniform2f(Y),u_meter_to_dem:new r.Uniform1f(Y),u_label_plane_matrix_inv:new r.UniformMatrix4f(Y)}))(o)),k.includes("GLOBE")&&(this.globeUniforms=(Y=>({u_tile_tl_up:new r.Uniform3f(Y),u_tile_tr_up:new r.Uniform3f(Y),u_tile_br_up:new r.Uniform3f(Y),u_tile_bl_up:new r.Uniform3f(Y),u_tile_up_scale:new r.Uniform1f(Y)}))(o)),k.includes("FOG")&&(this.fogUniforms=(Y=>({u_fog_matrix:new r.UniformMatrix4f(Y),u_fog_range:new r.Uniform2f(Y),u_fog_color:new r.Uniform4f(Y),u_fog_horizon_blend:new r.Uniform1f(Y),u_fog_temporal_offset:new r.Uniform1f(Y),u_frustum_tl:new r.Uniform3f(Y),u_frustum_tr:new r.Uniform3f(Y),u_frustum_br:new r.Uniform3f(Y),u_frustum_bl:new r.Uniform3f(Y),u_globe_pos:new r.Uniform3f(Y),u_globe_radius:new r.Uniform1f(Y),u_globe_transition:new r.Uniform1f(Y),u_is_globe:new r.Uniform1i(Y),u_viewport:new r.Uniform2f(Y)}))(o))}}setTerrainUniformValues(o,h){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in h)g[w]&&g[w].set(this.program,w,h[w])}}setGlobeUniformValues(o,h){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in h)g[w]&&g[w].set(this.program,w,h[w])}}setFogUniformValues(o,h){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in h)g[w].set(this.program,w,h[w])}}draw(o,h,g,w,S,k,I,B,V,U,K,tt,at,ut,lt){const dt=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(g),o.setStencilMode(w),o.setColorMode(S),o.setCullFace(k);for(const st of Object.keys(this.fixedUniforms))this.fixedUniforms[st].set(this.program,st,I[st]);ut&&ut.setUniforms(this.program,o,this.binderUniforms,tt,{zoom:at});const Y={[dt.LINES]:2,[dt.TRIANGLES]:3,[dt.LINE_STRIP]:1}[h];for(const st of K.get()){const _t=st.vaos||(st.vaos={});(_t[B]||(_t[B]=new bl)).bind(o,this,V,ut?ut.getPaintVertexBuffers():[],U,st.vertexOffset,lt||[]),dt.drawElements(h,st.primitiveLength*Y,dt.UNSIGNED_SHORT,st.primitiveOffset*Y*2)}}}function io(m,o){const h=Math.pow(2,o.tileID.overscaledZ),g=o.tileSize*Math.pow(2,m.transform.tileZoom)/h,w=g*(o.tileID.canonical.x+o.tileID.wrap*h),S=g*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_tile_units_to_pixels:1/ce(o,1,m.transform.tileZoom),u_pixel_coord_upper:[w>>16,S>>16],u_pixel_coord_lower:[65535&w,65535&S]}}const uc=r.create(),Hc=(m,o,h,g,w,S,k,I,B,V,U)=>{const K=o.style.light,tt=K.properties.get("position"),at=[tt.x,tt.y,tt.z],ut=r.create$1();K.properties.get("anchor")==="viewport"&&(r.fromRotation(ut,-o.transform.angle),r.transformMat3(at,at,ut));const lt=K.properties.get("color"),dt=o.transform,Y={u_matrix:m,u_lightpos:at,u_lightintensity:K.properties.get("intensity"),u_lightcolor:[lt.r,lt.g,lt.b],u_vertical_gradient:+h,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:uc,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:w,u_edge_radius:S};return dt.projection.name==="globe"&&(Y.u_tile_id=[k.canonical.x,k.canonical.y,1<<k.canonical.z],Y.u_zoom_transition=B,Y.u_inv_rot_matrix=U,Y.u_merc_center=V,Y.u_up_dir=dt.projection.upVector(new r.CanonicalTileID(0,0,0),V[0]*r.EXTENT,V[1]*r.EXTENT),Y.u_height_lift=I),Y},Nu=(m,o,h,g,w,S,k,I,B,V,U,K)=>{const tt=Hc(m,o,h,g,w,S,k,B,V,U,K),at={u_height_factor:-Math.pow(2,k.overscaledZ)/I.tileSize/8};return r.extend(tt,io(o,I),at)},Ko=m=>({u_matrix:m}),qc=(m,o,h)=>r.extend(Ko(m),io(o,h)),$r=(m,o)=>({u_matrix:m,u_world:o}),qa=(m,o,h,g)=>r.extend(qc(m,o,h),{u_world:g}),Ch=r.create(),Xn=(m,o,h,g,w,S)=>{const k=m.transform,I=k.projection.name==="globe";let B;if(S.paint.get("circle-pitch-alignment")==="map")if(I){const U=r.globePixelsToTileUnits(k.zoom,o.canonical)*k._pixelsPerMercatorPixel;B=Float32Array.from([U,0,0,U])}else B=k.calculatePixelsToTileUnitsMatrix(h);else B=new Float32Array([k.pixelsToGLUnits[0],0,0,k.pixelsToGLUnits[1]]);const V={u_camera_to_center_distance:k.cameraToCenterDistance,u_matrix:m.translatePosMatrix(o.projMatrix,h,S.paint.get("circle-translate"),S.paint.get("circle-translate-anchor")),u_device_pixel_ratio:r.exported.devicePixelRatio,u_extrude_scale:B,u_inv_rot_matrix:Ch,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){V.u_inv_rot_matrix=g,V.u_merc_center=w,V.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],V.u_zoom_transition=r.globeToMercatorTransition(k.zoom);const U=w[0]*r.EXTENT,K=w[1]*r.EXTENT;V.u_up_dir=k.projection.upVector(new r.CanonicalTileID(0,0,0),U,K)}return V},hc=m=>{const o=[];return m.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),m.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},Io=(m,o,h,g)=>{const w=r.EXTENT/h.tileSize;return{u_matrix:m,u_camera_to_center_distance:o.getCameraToCenterDistance(g),u_extrude_scale:[o.pixelsToGLUnits[0]/w,o.pixelsToGLUnits[1]/w]}},Ml=(m,o,h=1)=>({u_matrix:m,u_color:o,u_overlay:0,u_overlay_scale:h}),Xa=r.create(),Xc=(m,o,h,g,w,S,k)=>{const I=m.transform,B=I.projection.name==="globe",V=B?r.globePixelsToTileUnits(I.zoom,o.canonical)*I._pixelsPerMercatorPixel:ce(h,1,S),U={u_matrix:o.projMatrix,u_extrude_scale:V,u_intensity:k,u_inv_rot_matrix:Xa,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(B){U.u_inv_rot_matrix=g,U.u_merc_center=w,U.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],U.u_zoom_transition=r.globeToMercatorTransition(I.zoom);const K=w[0]*r.EXTENT,tt=w[1]*r.EXTENT;U.u_up_dir=I.projection.upVector(new r.CanonicalTileID(0,0,0),K,tt)}return U},Cl=(m,o,h,g,w,S,k)=>{const I=m.transform,B=I.calculatePixelsToTileUnitsMatrix(o);return{u_matrix:Ka(m,o,h,g),u_pixels_to_tile_units:B,u_device_pixel_ratio:S,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:w,u_texsize:Ya(h)?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:_r(o,m.transform),u_alpha_discard_threshold:0,u_trim_offset:k}},Yo=(m,o,h,g,w)=>{const S=m.transform;return{u_matrix:Ka(m,o,h,g),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:S.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:w,u_image:0,u_tile_units_to_pixels:_r(o,S),u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function _r(m,o){return 1/ce(m,1,o.tileZoom)}function Ka(m,o,h,g){return m.translatePosMatrix(g||o.tileID.projMatrix,o,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function Ya(m){const o=m.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const Al=(m,o,h,g,w,S)=>{return{u_matrix:m,u_tl_parent:o,u_scale_parent:h,u_fade_t:g.mix,u_opacity:g.opacity*w.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:w.paint.get("raster-brightness-min"),u_brightness_high:w.paint.get("raster-brightness-max"),u_saturation_factor:(I=w.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(k=w.paint.get("raster-contrast"),k>0?1/(1-k):1+k),u_spin_weights:no(w.paint.get("raster-hue-rotate")),u_perspective_transform:S};var k,I};function no(m){m*=Math.PI/180;const o=Math.sin(m),h=Math.cos(m);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}const gr=r.create(),dc=(m,o,h,g,w,S,k,I,B,V,U,K,tt,at,ut,lt)=>{const dt=w.transform,Y={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:dt.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:dt.width/dt.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:S,u_label_plane_matrix:k,u_coord_matrix:I,u_is_text:+B,u_pitch_with_map:+g,u_texsize:V,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gr,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:gr,u_up_vector:[0,-1,0]};return lt.name==="globe"&&(Y.u_tile_id=[U.canonical.x,U.canonical.y,1<<U.canonical.z],Y.u_zoom_transition=K,Y.u_inv_rot_matrix=at,Y.u_merc_center=tt,Y.u_camera_forward=dt._camera.forward(),Y.u_ecef_origin=r.globeECEFOrigin(dt.globeMatrix,U.toUnwrapped()),Y.u_tile_matrix=Float32Array.from(dt.globeMatrix),Y.u_up_vector=ut),Y},so=(m,o,h,g,w,S,k,I,B,V,U,K,tt,at,ut,lt,dt)=>r.extend(dc(m,o,h,g,w,S,k,I,B,V,K,tt,at,ut,lt,dt),{u_gamma_scale:g?w.transform.cameraToCenterDistance*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:r.exported.devicePixelRatio,u_is_halo:1}),Pl=(m,o,h,g,w,S,k,I,B,V,U,K,tt,at,ut,lt)=>r.extend(so(m,o,h,g,w,S,k,I,!0,B,!0,U,K,tt,at,ut,lt),{u_texsize_icon:V,u_texture_icon:1}),zr=(m,o,h)=>({u_matrix:m,u_opacity:o,u_color:h}),Ja=(m,o,h,g,w)=>r.extend((function(S,k,I){const B=k.imageManager.getPattern(S.toString()),{width:V,height:U}=k.imageManager.getPixelSize(),K=Math.pow(2,I.tileID.overscaledZ),tt=I.tileSize*Math.pow(2,k.transform.tileZoom)/K,at=tt*(I.tileID.canonical.x+I.tileID.wrap*K),ut=tt*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:B.tl,u_pattern_br:B.br,u_texsize:[V,U],u_pattern_size:B.displaySize,u_tile_units_to_pixels:1/ce(I,1,k.transform.tileZoom),u_pixel_coord_upper:[at>>16,ut>>16],u_pixel_coord_lower:[65535&at,65535&ut]}})(g,h,w),{u_matrix:m,u_opacity:o}),Gs={fillExtrusion:m=>({u_matrix:new r.UniformMatrix4f(m),u_lightpos:new r.Uniform3f(m),u_lightintensity:new r.Uniform1f(m),u_lightcolor:new r.Uniform3f(m),u_vertical_gradient:new r.Uniform1f(m),u_opacity:new r.Uniform1f(m),u_edge_radius:new r.Uniform1f(m),u_ao:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_up_dir:new r.Uniform3f(m),u_height_lift:new r.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_lightpos:new r.Uniform3f(m),u_lightintensity:new r.Uniform1f(m),u_lightcolor:new r.Uniform3f(m),u_vertical_gradient:new r.Uniform1f(m),u_height_factor:new r.Uniform1f(m),u_edge_radius:new r.Uniform1f(m),u_ao:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_up_dir:new r.Uniform3f(m),u_height_lift:new r.Uniform1f(m),u_image:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_pixel_coord_upper:new r.Uniform2f(m),u_pixel_coord_lower:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m),u_opacity:new r.Uniform1f(m)}),fill:m=>({u_matrix:new r.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_image:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_pixel_coord_upper:new r.Uniform2f(m),u_pixel_coord_lower:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m)}),fillOutline:m=>({u_matrix:new r.UniformMatrix4f(m),u_world:new r.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_world:new r.Uniform2f(m),u_image:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_pixel_coord_upper:new r.Uniform2f(m),u_pixel_coord_lower:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new r.Uniform1f(m),u_extrude_scale:new r.UniformMatrix2f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_up_dir:new r.Uniform3f(m)}),collisionBox:m=>({u_matrix:new r.UniformMatrix4f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_extrude_scale:new r.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new r.UniformMatrix4f(m),u_inv_matrix:new r.UniformMatrix4f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_viewport_size:new r.Uniform2f(m)}),debug:m=>({u_color:new r.UniformColor(m),u_matrix:new r.UniformMatrix4f(m),u_overlay:new r.Uniform1i(m),u_overlay_scale:new r.Uniform1f(m)}),clippingMask:m=>({u_matrix:new r.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new r.Uniform1f(m),u_intensity:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_up_dir:new r.Uniform3f(m)}),heatmapTexture:m=>({u_image:new r.Uniform1i(m),u_color_ramp:new r.Uniform1i(m),u_opacity:new r.Uniform1f(m)}),hillshade:m=>({u_matrix:new r.UniformMatrix4f(m),u_image:new r.Uniform1i(m),u_latrange:new r.Uniform2f(m),u_light:new r.Uniform2f(m),u_shadow:new r.UniformColor(m),u_highlight:new r.UniformColor(m),u_accent:new r.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new r.UniformMatrix4f(m),u_image:new r.Uniform1i(m),u_dimension:new r.Uniform2f(m),u_zoom:new r.Uniform1f(m),u_unpack:new r.Uniform4f(m)}),line:m=>({u_matrix:new r.UniformMatrix4f(m),u_pixels_to_tile_units:new r.UniformMatrix2f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_units_to_pixels:new r.Uniform2f(m),u_dash_image:new r.Uniform1i(m),u_gradient_image:new r.Uniform1i(m),u_image_height:new r.Uniform1f(m),u_texsize:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m),u_alpha_discard_threshold:new r.Uniform1f(m),u_trim_offset:new r.Uniform2f(m)}),linePattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_texsize:new r.Uniform2f(m),u_pixels_to_tile_units:new r.UniformMatrix2f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_image:new r.Uniform1i(m),u_units_to_pixels:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m),u_alpha_discard_threshold:new r.Uniform1f(m)}),raster:m=>({u_matrix:new r.UniformMatrix4f(m),u_tl_parent:new r.Uniform2f(m),u_scale_parent:new r.Uniform1f(m),u_fade_t:new r.Uniform1f(m),u_opacity:new r.Uniform1f(m),u_image0:new r.Uniform1i(m),u_image1:new r.Uniform1i(m),u_brightness_low:new r.Uniform1f(m),u_brightness_high:new r.Uniform1f(m),u_saturation_factor:new r.Uniform1f(m),u_contrast_factor:new r.Uniform1f(m),u_spin_weights:new r.Uniform3f(m),u_perspective_transform:new r.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new r.Uniform1i(m),u_is_size_feature_constant:new r.Uniform1i(m),u_size_t:new r.Uniform1f(m),u_size:new r.Uniform1f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_rotate_symbol:new r.Uniform1i(m),u_aspect_ratio:new r.Uniform1f(m),u_fade_change:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_label_plane_matrix:new r.UniformMatrix4f(m),u_coord_matrix:new r.UniformMatrix4f(m),u_is_text:new r.Uniform1i(m),u_pitch_with_map:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_camera_forward:new r.Uniform3f(m),u_tile_matrix:new r.UniformMatrix4f(m),u_up_vector:new r.Uniform3f(m),u_ecef_origin:new r.Uniform3f(m),u_texture:new r.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new r.Uniform1i(m),u_is_size_feature_constant:new r.Uniform1i(m),u_size_t:new r.Uniform1f(m),u_size:new r.Uniform1f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_rotate_symbol:new r.Uniform1i(m),u_aspect_ratio:new r.Uniform1f(m),u_fade_change:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_label_plane_matrix:new r.UniformMatrix4f(m),u_coord_matrix:new r.UniformMatrix4f(m),u_is_text:new r.Uniform1i(m),u_pitch_with_map:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_texture:new r.Uniform1i(m),u_gamma_scale:new r.Uniform1f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_tile_id:new r.Uniform3f(m),u_zoom_transition:new r.Uniform1f(m),u_inv_rot_matrix:new r.UniformMatrix4f(m),u_merc_center:new r.Uniform2f(m),u_camera_forward:new r.Uniform3f(m),u_tile_matrix:new r.UniformMatrix4f(m),u_up_vector:new r.Uniform3f(m),u_ecef_origin:new r.Uniform3f(m),u_is_halo:new r.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new r.Uniform1i(m),u_is_size_feature_constant:new r.Uniform1i(m),u_size_t:new r.Uniform1f(m),u_size:new r.Uniform1f(m),u_camera_to_center_distance:new r.Uniform1f(m),u_rotate_symbol:new r.Uniform1i(m),u_aspect_ratio:new r.Uniform1f(m),u_fade_change:new r.Uniform1f(m),u_matrix:new r.UniformMatrix4f(m),u_label_plane_matrix:new r.UniformMatrix4f(m),u_coord_matrix:new r.UniformMatrix4f(m),u_is_text:new r.Uniform1i(m),u_pitch_with_map:new r.Uniform1i(m),u_texsize:new r.Uniform2f(m),u_texsize_icon:new r.Uniform2f(m),u_texture:new r.Uniform1i(m),u_texture_icon:new r.Uniform1i(m),u_gamma_scale:new r.Uniform1f(m),u_device_pixel_ratio:new r.Uniform1f(m),u_is_halo:new r.Uniform1i(m)}),background:m=>({u_matrix:new r.UniformMatrix4f(m),u_opacity:new r.Uniform1f(m),u_color:new r.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new r.UniformMatrix4f(m),u_opacity:new r.Uniform1f(m),u_image:new r.Uniform1i(m),u_pattern_tl:new r.Uniform2f(m),u_pattern_br:new r.Uniform2f(m),u_texsize:new r.Uniform2f(m),u_pattern_size:new r.Uniform2f(m),u_pixel_coord_upper:new r.Uniform2f(m),u_pixel_coord_lower:new r.Uniform2f(m),u_tile_units_to_pixels:new r.Uniform1f(m)}),terrainRaster:Tl,terrainDepth:Tl,skybox:m=>({u_matrix:new r.UniformMatrix4f(m),u_sun_direction:new r.Uniform3f(m),u_cubemap:new r.Uniform1i(m),u_opacity:new r.Uniform1f(m),u_temporal_offset:new r.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new r.UniformMatrix4f(m),u_color_ramp:new r.Uniform1i(m),u_center_direction:new r.Uniform3f(m),u_radius:new r.Uniform1f(m),u_opacity:new r.Uniform1f(m),u_temporal_offset:new r.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new r.UniformMatrix3f(m),u_sun_direction:new r.Uniform3f(m),u_sun_intensity:new r.Uniform1f(m),u_color_tint_r:new r.Uniform4f(m),u_color_tint_m:new r.Uniform4f(m),u_luminance:new r.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new r.UniformMatrix4f(m),u_globe_matrix:new r.UniformMatrix4f(m),u_normalize_matrix:new r.UniformMatrix4f(m),u_merc_matrix:new r.UniformMatrix4f(m),u_zoom_transition:new r.Uniform1f(m),u_merc_center:new r.Uniform2f(m),u_image0:new r.Uniform1i(m),u_grid_matrix:new r.UniformMatrix3f(m),u_skirt_height:new r.Uniform1f(m),u_frustum_tl:new r.Uniform3f(m),u_frustum_tr:new r.Uniform3f(m),u_frustum_br:new r.Uniform3f(m),u_frustum_bl:new r.Uniform3f(m),u_globe_pos:new r.Uniform3f(m),u_globe_radius:new r.Uniform1f(m),u_viewport:new r.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new r.Uniform3f(m),u_frustum_tr:new r.Uniform3f(m),u_frustum_br:new r.Uniform3f(m),u_frustum_bl:new r.Uniform3f(m),u_horizon:new r.Uniform1f(m),u_transition:new r.Uniform1f(m),u_fadeout_range:new r.Uniform1f(m),u_color:new r.Uniform4f(m),u_high_color:new r.Uniform4f(m),u_space_color:new r.Uniform4f(m),u_star_intensity:new r.Uniform1f(m),u_star_density:new r.Uniform1f(m),u_star_size:new r.Uniform1f(m),u_temporal_offset:new r.Uniform1f(m),u_horizon_angle:new r.Uniform1f(m),u_rotation_matrix:new r.UniformMatrix4f(m)})};let Qa;function Jo(m,o,h,g,w,S,k){const I=m.context,B=I.gl,V=m.transform,U=m.useProgram("collisionBox"),K=[];let tt=0,at=0;for(let gt=0;gt<g.length;gt++){const Mt=g[gt],At=o.getTile(Mt),kt=At.getBucket(h);if(!kt)continue;const Zt=Zn(Mt,kt,V);let Ut=Zt;w[0]===0&&w[1]===0||(Ut=m.translatePosMatrix(Zt,At,w,S));const Xt=k?kt.textCollisionBox:kt.iconCollisionBox,Te=kt.collisionCircleArray;if(Te.length>0){const Gt=r.create(),fe=Ut;r.mul(Gt,kt.placementInvProjMatrix,V.glCoordMatrix),r.mul(Gt,Gt,kt.placementViewportMatrix),K.push({circleArray:Te,circleOffset:at,transform:fe,invTransform:Gt,projection:kt.getProjection()}),tt+=Te.length/4,at=tt}Xt&&(m.terrain&&m.terrain.setupElevationDraw(At,U),U.draw(I,B.LINES,r.DepthMode.disabled,r.StencilMode.disabled,m.colorModeForRenderPass(),r.CullFaceMode.disabled,Io(Ut,V,At,kt.getProjection()),h.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Xt.segments,null,V.zoom,null,[Xt.collisionVertexBuffer,Xt.collisionVertexBufferExt]))}if(!k||!K.length)return;const ut=m.useProgram("collisionCircle"),lt=new r.StructArrayLayout2f1f2i16;lt.resize(4*tt),lt._trim();let dt=0;for(const gt of K)for(let Mt=0;Mt<gt.circleArray.length/4;Mt++){const At=4*Mt,kt=gt.circleArray[At+0],Zt=gt.circleArray[At+1],Ut=gt.circleArray[At+2],Xt=gt.circleArray[At+3];lt.emplace(dt++,kt,Zt,Ut,Xt,0),lt.emplace(dt++,kt,Zt,Ut,Xt,1),lt.emplace(dt++,kt,Zt,Ut,Xt,2),lt.emplace(dt++,kt,Zt,Ut,Xt,3)}(!Qa||Qa.length<2*tt)&&(Qa=(function(gt){const Mt=2*gt,At=new r.StructArrayLayout3ui6;At.resize(Mt),At._trim();for(let kt=0;kt<Mt;kt++){const Zt=6*kt;At.uint16[Zt+0]=4*kt+0,At.uint16[Zt+1]=4*kt+1,At.uint16[Zt+2]=4*kt+2,At.uint16[Zt+3]=4*kt+2,At.uint16[Zt+4]=4*kt+3,At.uint16[Zt+5]=4*kt+0}return At})(tt));const Y=I.createIndexBuffer(Qa,!0),st=I.createVertexBuffer(lt,r.collisionCircleLayout.members,!0);for(const gt of K){const Mt={u_matrix:gt.transform,u_inv_matrix:gt.invTransform,u_camera_to_center_distance:(_t=V).getCameraToCenterDistance(gt.projection),u_viewport_size:[_t.width,_t.height]};ut.draw(I,B.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,m.colorModeForRenderPass(),r.CullFaceMode.disabled,Mt,h.id,st,Y,r.SegmentVector.simpleSegment(0,2*gt.circleOffset,gt.circleArray.length,gt.circleArray.length/2),null,V.zoom)}var _t;st.destroy(),Y.destroy()}const kl=r.create();function va({width:m,height:o,anchor:h,textOffset:g,textScale:w},S){const{horizontalAlign:k,verticalAlign:I}=r.getAnchorAlignment(h),B=-(k-.5)*m,V=-(I-.5)*o,U=r.evaluateVariableOffset(h,g);return new r.Point((B/w+U[0])*S,(V/w+U[1])*S)}function tl(m,o,h,g,w,S,k,I,B,V,U){const K=m.text.placedSymbolArray,tt=m.text.dynamicLayoutVertexArray,at=m.icon.dynamicLayoutVertexArray,ut={},lt=m.getProjection(),dt=on(I,lt,S),Y=S.elevation,st=lt.upVectorScale(I.canonical,S.center.lat,S.worldSize).metersToTile;tt.clear();for(let _t=0;_t<K.length;_t++){const gt=K.get(_t),{tileAnchorX:Mt,tileAnchorY:At,numGlyphs:kt}=gt,Zt=gt.hidden||!gt.crossTileID||m.allowVerticalPlacement&&!gt.placedOrientation?null:g[gt.crossTileID];if(Zt){let Ut=0,Xt=0,Te=0;if(Y){const Me=Y?Y.getAtTileOffset(I,Mt,At):0,[ai,bi,ei]=lt.upVector(I.canonical,Mt,At);Ut=Me*ai*st,Xt=Me*bi*st,Te=Me*ei*st}let[Gt,fe,te,Ee]=Un(gt.projectedAnchorX+Ut,gt.projectedAnchorY+Xt,gt.projectedAnchorZ+Te,h?dt:k);const Ht=Uo(S.getCameraToCenterDistance(lt),Ee);let se=w.evaluateSizeForFeature(m.textSizeData,V,gt)*Ht/r.ONE_EM;h&&(se*=m.tilePixelRatio/B);const be=va(Zt,se);h?({x:Gt,y:fe,z:te}=lt.projectTilePoint(Mt+be.x,At+be.y,I.canonical),[Gt,fe,te]=Un(Gt+Ut,fe+Xt,te+Te,k)):(o&&be._rotate(-S.angle),Gt+=be.x,fe+=be.y,te=0);const ge=m.allowVerticalPlacement&&gt.placedOrientation===r.WritingMode.vertical?Math.PI/2:0;for(let Me=0;Me<kt;Me++)r.addDynamicAttributes(tt,Gt,fe,te,ge);U&&gt.associatedIconIndex>=0&&(ut[gt.associatedIconIndex]={x:Gt,y:fe,z:te,angle:ge})}else Ls(kt,tt)}if(U){at.clear();const _t=m.icon.placedSymbolArray;for(let gt=0;gt<_t.length;gt++){const Mt=_t.get(gt),{numGlyphs:At}=Mt,kt=ut[gt];if(Mt.hidden||!kt)Ls(At,at);else{const{x:Zt,y:Ut,z:Xt,angle:Te}=kt;for(let Gt=0;Gt<At;Gt++)r.addDynamicAttributes(at,Zt,Ut,Xt,Te)}}m.icon.dynamicLayoutVertexBuffer.updateData(at)}m.text.dynamicLayoutVertexBuffer.updateData(tt)}function el(m,o,h){return h.iconsInText&&o?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function fc(m,o,h,g,w,S,k,I,B,V,U,K){const tt=m.context,at=tt.gl,ut=m.transform,lt=I==="map",dt=B==="map",Y=lt&&h.layout.get("symbol-placement")!=="point",st=lt&&!dt&&!Y,_t=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let gt=!1;const Mt=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),At=[r.mercatorXfromLng(ut.center.lng),r.mercatorYfromLat(ut.center.lat)],kt=h.layout.get("text-variable-anchor"),Zt=ut.projection.name==="globe",Ut=[],Xt=[0,-1,0];let Te=Xt;!Zt&&!ut.mercatorFromTransition||lt||(Te=(function(Gt){const fe=Gt._camera.getWorldToCamera(Gt.worldSize,1),te=r.multiply([],fe,Gt.globeMatrix);r.invert(te,te);const Ee=[0,0,0],Ht=[0,1,0,0];return r.transformMat4$1(Ht,Ht,te),Ee[0]=Ht[0],Ee[1]=Ht[1],Ee[2]=Ht[2],r.normalize(Ee,Ee),Ee})(ut));for(const Gt of g){const fe=o.getTile(Gt),te=fe.getBucket(h);if(!te||te.projection.name==="mercator"&&Zt)continue;const Ee=w?te.text:te.icon;if(!Ee||te.fullyClipped||!Ee.segments.get().length)continue;const Ht=Ee.programConfigurations.get(h.id),se=w||te.sdfIcons,be=w?te.textSizeData:te.iconSizeData,ge=dt||ut.pitch!==0,Me=r.evaluateSizeForZoom(be,ut.zoom);let ai,bi,ei,li,$i=[0,0],ji=null;if(w)bi=fe.glyphAtlasTexture,ei=at.LINEAR,ai=fe.glyphAtlasTexture.size,te.iconsInText&&($i=fe.imageAtlasTexture.size,ji=fe.imageAtlasTexture,li=ge||m.options.rotating||m.options.zooming||be.kind==="composite"||be.kind==="camera"?at.LINEAR:at.NEAREST);else{const Oo=h.layout.get("icon-size").constantOr(0)!==1||te.iconsNeedLinear;bi=fe.imageAtlasTexture,ei=se||m.options.rotating||m.options.zooming||Oo||ge?at.LINEAR:at.NEAREST,ai=fe.imageAtlasTexture.size}const oi=te.projection.name==="globe",en=oi?Te:Xt,un=oi?r.globeToMercatorTransition(ut.zoom):0,mn=on(Gt,te.getProjection(),ut),hn=ut.calculatePixelsToTileUnitsMatrix(fe),qs=le(mn,fe.tileID.canonical,dt,lt,ut,te.getProjection(),hn),Bs=m.terrain&&dt&&Y?r.invert(r.create(),qs):kl,ao=Li(mn,fe.tileID.canonical,dt,lt,ut,te.getProjection(),hn),ir=kt&&te.hasTextData(),vn=h.layout.get("icon-text-fit")!=="none"&&ir&&te.hasIconData();if(Y){const Oo=ut.elevation,Ma=Oo?Oo.getAtTileOffsetFunc(Gt,ut.center.lat,ut.worldSize,te.getProjection()):null,cu=Vi(mn,fe.tileID.canonical,dt,lt,ut,te.getProjection(),hn);Ua(te,mn,m,w,cu,ao,dt,V,Ma,Gt)}const dn=Y||w&&kt||vn,Ki=m.translatePosMatrix(mn,fe,S,k),Kn=dn?kl:qs,nr=m.translatePosMatrix(ao,fe,S,k,!0),xn=te.getProjection().createInversionMatrix(ut,Gt.canonical),xr=[];m.terrainRenderModeElevated()&&dt&&xr.push("PITCH_WITH_MAP_TERRAIN"),oi&&xr.push("PROJECTION_GLOBE_VIEW"),dn&&xr.push("PROJECTED_POS_ON_VIEWPORT");const au=se&&h.paint.get(w?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ul;Ul=se?te.iconsInText?Pl(be.kind,Me,st,dt,m,Ki,Kn,nr,ai,$i,Gt,un,At,xn,en,te.getProjection()):so(be.kind,Me,st,dt,m,Ki,Kn,nr,w,ai,!0,Gt,un,At,xn,en,te.getProjection()):dc(be.kind,Me,st,dt,m,Ki,Kn,nr,w,ai,Gt,un,At,xn,en,te.getProjection());const lu={program:m.useProgram(el(se,w,te),Ht,xr),buffers:Ee,uniformValues:Ul,atlasTexture:bi,atlasTextureIcon:ji,atlasInterpolation:ei,atlasInterpolationIcon:li,isSDF:se,hasHalo:au,tile:fe,labelPlaneMatrixInv:Bs};if(_t&&te.canOverlap){gt=!0;const Oo=Ee.segments.get();for(const Ma of Oo)Ut.push({segments:new r.SegmentVector([Ma]),sortKey:Ma.sortKey,state:lu})}else Ut.push({segments:Ee.segments,sortKey:0,state:lu})}gt&&Ut.sort(((Gt,fe)=>Gt.sortKey-fe.sortKey));for(const Gt of Ut){const fe=Gt.state;if(m.terrain&&m.terrain.setupElevationDraw(fe.tile,fe.program,{useDepthForOcclusion:!Zt,labelPlaneMatrixInv:fe.labelPlaneMatrixInv}),tt.activeTexture.set(at.TEXTURE0),fe.atlasTexture.bind(fe.atlasInterpolation,at.CLAMP_TO_EDGE),fe.atlasTextureIcon&&(tt.activeTexture.set(at.TEXTURE1),fe.atlasTextureIcon&&fe.atlasTextureIcon.bind(fe.atlasInterpolationIcon,at.CLAMP_TO_EDGE)),fe.isSDF){const te=fe.uniformValues;fe.hasHalo&&(te.u_is_halo=1,il(fe.buffers,Gt.segments,h,m,fe.program,Mt,U,K,te)),te.u_is_halo=0}il(fe.buffers,Gt.segments,h,m,fe.program,Mt,U,K,fe.uniformValues)}}function il(m,o,h,g,w,S,k,I,B){const V=g.context,U=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];w.draw(V,V.gl.TRIANGLES,S,k,I,r.CullFaceMode.disabled,B,h.id,m.layoutVertexBuffer,m.indexBuffer,o,h.paint,g.transform.zoom,m.programConfigurations.get(h.id),U)}function ju(m,o,h,g,w,S,k){const I=m.context.gl,B=h.paint.get("fill-pattern"),V=B&&B.constantOr(1);let U,K,tt,at,ut;k?(K=V&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",U=I.LINES):(K=V?"fillPattern":"fill",U=I.TRIANGLES);for(const lt of g){const dt=o.getTile(lt);if(V&&!dt.patternsLoaded())continue;const Y=dt.getBucket(h);if(!Y)continue;m.prepareDrawTile();const st=Y.programConfigurations.get(h.id),_t=m.useProgram(K,st);V&&(m.context.activeTexture.set(I.TEXTURE0),dt.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),st.updatePaintBuffers());const gt=B.constantOr(null);if(gt&&dt.imageAtlas){const At=dt.imageAtlas.patternPositions[gt.toString()];At&&st.setConstantPatternPositions(At)}const Mt=m.translatePosMatrix(lt.projMatrix,dt,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(k){at=Y.indexBuffer2,ut=Y.segments2;const At=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];tt=K==="fillOutlinePattern"&&V?qa(Mt,m,dt,At):$r(Mt,At)}else at=Y.indexBuffer,ut=Y.segments,tt=V?qc(Mt,m,dt):Ko(Mt);m.prepareDrawProgram(m.context,_t,lt.toUnwrapped()),_t.draw(m.context,U,w,m.stencilModeForClipping(lt),S,r.CullFaceMode.disabled,tt,h.id,Y.layoutVertexBuffer,at,ut,h.paint,m.transform.zoom,st)}}function xa(m,o,h,g,w,S,k){const I=m.context,B=I.gl,V=m.transform,U=h.paint.get("fill-extrusion-pattern"),K=U.constantOr(1),tt=h.paint.get("fill-extrusion-opacity"),at=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],ut=h.layout.get("fill-extrusion-edge-radius"),lt=ut>0&&!h.paint.get("fill-extrusion-rounded-roof"),dt=lt?0:ut,Y=V.projection.name==="globe"?r.fillExtrusionHeightLift():0,st=V.projection.name==="globe",_t=st?r.globeToMercatorTransition(V.zoom):0,gt=[r.mercatorXfromLng(V.center.lng),r.mercatorYfromLat(V.center.lat)],Mt=[];st&&Mt.push("PROJECTION_GLOBE_VIEW"),at[0]>0&&Mt.push("FAUX_AO"),lt&&Mt.push("ZERO_ROOF_RADIUS");for(const At of g){const kt=o.getTile(At),Zt=kt.getBucket(h);if(!Zt||Zt.projection.name!==V.projection.name)continue;const Ut=Zt.programConfigurations.get(h.id),Xt=m.useProgram(K?"fillExtrusionPattern":"fillExtrusion",Ut,Mt);if(m.terrain){const se=m.terrain;if(m.style.terrainSetForDrapingOnly())se.setupElevationDraw(kt,Xt,{useMeterToDem:!0});else{if(!Zt.enableTerrain)continue;if(se.setupElevationDraw(kt,Xt,{useMeterToDem:!0}),Kc(I,o,At,Zt,h,se),!Zt.centroidVertexBuffer){const be=Xt.attributes.a_centroid_pos;be!==void 0&&B.vertexAttrib2f(be,0,0)}}}K&&(m.context.activeTexture.set(B.TEXTURE0),kt.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Ut.updatePaintBuffers());const Te=U.constantOr(null);if(Te&&kt.imageAtlas){const se=kt.imageAtlas.patternPositions[Te.toString()];se&&Ut.setConstantPatternPositions(se)}const Gt=m.translatePosMatrix(At.projMatrix,kt,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),fe=V.projection.createInversionMatrix(V,At.canonical),te=h.paint.get("fill-extrusion-vertical-gradient"),Ee=K?Nu(Gt,m,te,tt,at,dt,At,kt,Y,_t,gt,fe):Hc(Gt,m,te,tt,at,dt,At,Y,_t,gt,fe);m.prepareDrawProgram(I,Xt,At.toUnwrapped());const Ht=[];m.terrain&&Ht.push(Zt.centroidVertexBuffer),st&&Ht.push(Zt.layoutVertexExtBuffer),Xt.draw(I,I.gl.TRIANGLES,w,S,k,r.CullFaceMode.backCCW,Ee,h.id,Zt.layoutVertexBuffer,Zt.indexBuffer,Zt.segments,h.paint,m.transform.zoom,Ut,Ht)}}function Kc(m,o,h,g,w,S){const k=[Y=>{let st=Y.canonical.x-1,_t=Y.wrap;return st<0&&(st=(1<<Y.canonical.z)-1,_t--),new r.OverscaledTileID(Y.overscaledZ,_t,Y.canonical.z,st,Y.canonical.y)},Y=>{let st=Y.canonical.x+1,_t=Y.wrap;return st===1<<Y.canonical.z&&(st=0,_t++),new r.OverscaledTileID(Y.overscaledZ,_t,Y.canonical.z,st,Y.canonical.y)},Y=>new r.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,(Y.canonical.y===0?1<<Y.canonical.z:Y.canonical.y)-1),Y=>new r.OverscaledTileID(Y.overscaledZ,Y.wrap,Y.canonical.z,Y.canonical.x,Y.canonical.y===(1<<Y.canonical.z)-1?0:Y.canonical.y+1)],I=Y=>{const st=o.getSource().minzoom,_t=Mt=>{const At=o.getTileByID(Mt);if(At&&At.hasData())return At.getBucket(w)},gt=[0,-1,1];for(const Mt of gt){if(Y.overscaledZ+Mt<st)continue;const At=_t(Y.calculateScaledKey(Y.overscaledZ+Mt));if(At)return At}},B=[0,0,0],V=(Y,st)=>(B[0]=Math.min(Y.min.y,st.min.y),B[1]=Math.max(Y.max.y,st.max.y),B[2]=r.EXTENT-st.min.x>Y.max.x?st.min.x-r.EXTENT:Y.max.x,B),U=(Y,st)=>(B[0]=Math.min(Y.min.x,st.min.x),B[1]=Math.max(Y.max.x,st.max.x),B[2]=r.EXTENT-st.min.y>Y.max.y?st.min.y-r.EXTENT:Y.max.y,B),K=[(Y,st)=>V(Y,st),(Y,st)=>V(st,Y),(Y,st)=>U(Y,st),(Y,st)=>U(st,Y)],tt=new r.Point(0,0);let at,ut,lt;const dt=(Y,st,_t,gt,Mt)=>{const At=[[gt?_t:Y,gt?Y:_t,0],[gt?_t:st,gt?st:_t,0]],kt=Mt<0?r.EXTENT+Mt:Mt,Zt=[gt?kt:(Y+st)/2,gt?(Y+st)/2:kt,0];return _t===0&&Mt<0||_t!==0&&Mt>0?S.getForTilePoints(lt,[Zt],!0,ut):At.push(Zt),S.getForTilePoints(h,At,!0,at),Math.max(At[0][2],At[1][2],Zt[2])/S.exaggeration()};for(let Y=0;Y<4;Y++){const st=(Y<2?1:5)-Y,_t=g.borders[Y];if(_t.length===0)continue;const gt=lt=k[Y](h),Mt=I(gt);if(!(Mt&&Mt instanceof r.FillExtrusionBucket&&Mt.enableTerrain)||g.borderDoneWithNeighborZ[Y]===Mt.canonical.z&&Mt.borderDoneWithNeighborZ[st]===g.canonical.z||(ut=S.findDEMTileFor(gt),!ut||!ut.dem))continue;if(!at){const Ut=S.findDEMTileFor(h);if(!Ut||!Ut.dem)return;at=Ut}const At=Mt.borders[st];let kt=0;const Zt=Mt.borderDoneWithNeighborZ[st]!==g.canonical.z;if(g.canonical.z===Mt.canonical.z){for(let Ut=0;Ut<_t.length;Ut++){const Xt=g.featuresOnBorder[_t[Ut]],Te=Xt.borders[Y];let Gt;for(;kt<At.length&&(Gt=Mt.featuresOnBorder[At[kt]],!(Gt.borders[st][1]>Te[0]+3));)Zt&&Mt.encodeCentroid(void 0,Gt,!1),kt++;if(Gt&&kt<At.length){const fe=kt;let te=0;for(;!(Gt.borders[st][0]>Te[1]-3)&&(te++,++kt!==At.length);)Gt=Mt.featuresOnBorder[At[kt]];if(Gt=Mt.featuresOnBorder[At[fe]],Xt.intersectsCount()>1||Gt.intersectsCount()>1||te!==1){te!==1&&(kt=fe),g.encodeCentroid(void 0,Xt,!1),Zt&&Mt.encodeCentroid(void 0,Gt,!1);continue}const Ee=K[Y](Xt,Gt),Ht=Y%2?r.EXTENT-1:0;tt.x=dt(Ee[0],Math.min(r.EXTENT-1,Ee[1]),Ht,Y<2,Ee[2]),tt.y=0,g.encodeCentroid(tt,Xt,!1),Zt&&Mt.encodeCentroid(tt,Gt,!1)}else g.encodeCentroid(void 0,Xt,!1)}g.borderDoneWithNeighborZ[Y]=Mt.canonical.z,g.needsCentroidUpdate=!0,Zt&&(Mt.borderDoneWithNeighborZ[st]=g.canonical.z,Mt.needsCentroidUpdate=!0)}else{for(const Ut of _t)g.encodeCentroid(void 0,g.featuresOnBorder[Ut],!1);if(Zt){for(const Ut of At)Mt.encodeCentroid(void 0,Mt.featuresOnBorder[Ut],!1);Mt.borderDoneWithNeighborZ[st]=g.canonical.z,Mt.needsCentroidUpdate=!0}g.borderDoneWithNeighborZ[Y]=Mt.canonical.z,g.needsCentroidUpdate=!0}}(g.needsCentroidUpdate||!g.centroidVertexBuffer&&g.centroidVertexArray.length!==0)&&g.uploadCentroid(m)}const Qo=new r.Color(1,0,0,1),Yc=new r.Color(0,1,0,1),Vu=new r.Color(0,0,1,1),Ah=new r.Color(1,0,1,1),zs=new r.Color(0,1,1,1);function Or(m,o,h){const g=m.context,w=m.transform,S=g.gl,k=w.projection.name==="globe",I=k?["PROJECTION_GLOBE_VIEW"]:null;let B=h.projMatrix;if(k&&r.globeToMercatorTransition(w.zoom)>0){const Xt=r.transitionTileAABBinECEF(h.canonical,w),Te=r.globeDenormalizeECEF(Xt);B=r.multiply(new Float32Array(16),w.globeMatrix,Te),r.multiply(B,w.projMatrix,B)}const V=m.useProgram("debug",null,I),U=o.getTileByID(h.key);m.terrain&&m.terrain.setupElevationDraw(U,V);const K=r.DepthMode.disabled,tt=r.StencilMode.disabled,at=m.colorModeForRenderPass(),ut="$debug";g.activeTexture.set(S.TEXTURE0),m.emptyTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),k?U._makeGlobeTileDebugBuffers(m.context,w):U._makeDebugTileBoundsBuffers(m.context,w.projection);const lt=U._tileDebugBuffer||m.debugBuffer,dt=U._tileDebugIndexBuffer||m.debugIndexBuffer,Y=U._tileDebugSegments||m.debugSegments;V.draw(g,S.LINE_STRIP,K,tt,at,r.CullFaceMode.disabled,Ml(B,r.Color.red),ut,lt,dt,Y,null,null,null,[U._globeTileDebugBorderBuffer]);const st=U.latestRawTileData,_t=Math.floor((st&&st.byteLength||0)/1024),gt=o.getTile(h).tileSize,Mt=512/Math.min(gt,512)*(h.overscaledZ/w.zoom)*.5;let At=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(At+=` => ${h.overscaledZ}`),At+=` ${_t}kb`,(function(Xt,Te){Xt.initDebugOverlayCanvas();const Gt=Xt.debugOverlayCanvas,fe=Xt.context.gl,te=Xt.debugOverlayCanvas.getContext("2d");te.clearRect(0,0,Gt.width,Gt.height),te.shadowColor="white",te.shadowBlur=2,te.lineWidth=1.5,te.strokeStyle="white",te.textBaseline="top",te.font="bold 36px Open Sans, sans-serif",te.fillText(Te,5,5),te.strokeText(Te,5,5),Xt.debugOverlayTexture.update(Gt),Xt.debugOverlayTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE)})(m,At);const kt=U._tileDebugTextBuffer||m.debugBuffer,Zt=U._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Ut=U._tileDebugTextSegments||m.debugSegments;V.draw(g,S.TRIANGLES,K,tt,r.ColorMode.alphaBlended,r.CullFaceMode.disabled,Ml(B,r.Color.transparent,Mt),ut,kt,Zt,Ut,null,null,null,[U._globeTileDebugTextBuffer])}function Jc(m,o,h,g){wa(m,0,o+h/2,m.transform.width,h,g)}function ba(m,o,h,g){wa(m,o-h/2,0,h,m.transform.height,g)}function wa(m,o,h,g,w,S){const k=m.context,I=k.gl;I.enable(I.SCISSOR_TEST),I.scissor(o*r.exported.devicePixelRatio,h*r.exported.devicePixelRatio,g*r.exported.devicePixelRatio,w*r.exported.devicePixelRatio),k.clear({color:S}),I.disable(I.SCISSOR_TEST)}const pc=r.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Qc}=pc;function tr(m,o,h,g){m.emplaceBack(o,h,g)}class mc{constructor(o){this.vertexArray=new r.StructArrayLayout3f12,this.indices=new r.StructArrayLayout3ui6,tr(this.vertexArray,-1,-1,1),tr(this.vertexArray,1,-1,1),tr(this.vertexArray,-1,1,1),tr(this.vertexArray,1,1,1),tr(this.vertexArray,-1,-1,-1),tr(this.vertexArray,1,-1,-1),tr(this.vertexArray,-1,1,-1),tr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Qc),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=r.SegmentVector.simpleSegment(0,0,36,12)}}function ws(m,o,h,g,w,S){const k=m.gl,I=o.paint.get("sky-atmosphere-color"),B=o.paint.get("sky-atmosphere-halo-color"),V=o.paint.get("sky-atmosphere-sun-intensity"),U=((K,tt,at,ut,lt)=>({u_matrix_3f:K,u_sun_direction:tt,u_sun_intensity:at,u_color_tint_r:[ut.r,ut.g,ut.b,ut.a],u_color_tint_m:[lt.r,lt.g,lt.b,lt.a],u_luminance:5e-5}))(r.fromMat4(r.create$1(),g),w,V,I,B);k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_CUBE_MAP_POSITIVE_X+S,o.skyboxTexture,0),h.draw(m,k.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,r.ColorMode.unblended,r.CullFaceMode.frontCW,U,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const nl=r.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class _c{constructor(o){const h=new r.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const g=new r.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(h,nl.members),this.indexBuffer=o.createIndexBuffer(g),this.segments=r.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ta={symbol:function(m,o,h,g,w){if(m.renderPass!=="translucent")return;const S=r.StencilMode.disabled,k=m.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&(function(I,B,V,U,K,tt,at){const ut=B.transform,lt=K==="map",dt=tt==="map";for(const Y of I){const st=U.getTile(Y),_t=st.getBucket(V);if(!_t||!_t.text||!_t.text.segments.get().length)continue;const gt=r.evaluateSizeForZoom(_t.textSizeData,ut.zoom),Mt=on(Y,_t.getProjection(),ut),At=ut.calculatePixelsToTileUnitsMatrix(st),kt=le(Mt,st.tileID.canonical,dt,lt,ut,_t.getProjection(),At),Zt=V.layout.get("icon-text-fit")!=="none"&&_t.hasIconData();if(gt){const Ut=Math.pow(2,ut.zoom-st.tileID.overscaledZ);tl(_t,lt,dt,at,r.symbolSize,ut,kt,Y,Ut,gt,Zt)}}})(g,m,h,o,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),w),h.paint.get("icon-opacity").constantOr(1)!==0&&fc(m,o,h,g,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),S,k),h.paint.get("text-opacity").constantOr(1)!==0&&fc(m,o,h,g,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),S,k),o.map.showCollisionBoxes&&(Jo(m,o,h,g,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Jo(m,o,h,g,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(m,o,h,g){if(m.renderPass!=="translucent")return;const w=h.paint.get("circle-opacity"),S=h.paint.get("circle-stroke-width"),k=h.paint.get("circle-stroke-opacity"),I=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(w.constantOr(1)===0&&(S.constantOr(1)===0||k.constantOr(1)===0))return;const B=m.context,V=B.gl,U=m.transform,K=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),tt=r.StencilMode.disabled,at=m.colorModeForRenderPass(),ut=U.projection.name==="globe",lt=[r.mercatorXfromLng(U.center.lng),r.mercatorYfromLat(U.center.lat)],dt=[];for(let st=0;st<g.length;st++){const _t=g[st],gt=o.getTile(_t),Mt=gt.getBucket(h);if(!Mt||Mt.projection.name!==U.projection.name)continue;const At=Mt.programConfigurations.get(h.id),kt=hc(h);ut&&kt.push("PROJECTION_GLOBE_VIEW");const Zt=m.useProgram("circle",At,kt),Ut=Mt.layoutVertexBuffer,Xt=Mt.globeExtVertexBuffer,Te=Mt.indexBuffer,Gt=U.projection.createInversionMatrix(U,_t.canonical),fe={programConfiguration:At,program:Zt,layoutVertexBuffer:Ut,globeExtVertexBuffer:Xt,indexBuffer:Te,uniformValues:Xn(m,_t,gt,Gt,lt,h),tile:gt};if(I){const te=Mt.segments.get();for(const Ee of te)dt.push({segments:new r.SegmentVector([Ee]),sortKey:Ee.sortKey,state:fe})}else dt.push({segments:Mt.segments,sortKey:0,state:fe})}I&&dt.sort(((st,_t)=>st.sortKey-_t.sortKey));const Y={useDepthForOcclusion:!ut};for(const st of dt){const{programConfiguration:_t,program:gt,layoutVertexBuffer:Mt,globeExtVertexBuffer:At,indexBuffer:kt,uniformValues:Zt,tile:Ut}=st.state,Xt=st.segments;m.terrain&&m.terrain.setupElevationDraw(Ut,gt,Y),m.prepareDrawProgram(B,gt,Ut.tileID.toUnwrapped()),gt.draw(B,V.TRIANGLES,K,tt,at,r.CullFaceMode.disabled,Zt,h.id,Mt,kt,Xt,h.paint,U.zoom,_t,[At])}},heatmap:function(m,o,h,g){if(h.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const w=m.context,S=w.gl,k=r.StencilMode.disabled,I=new r.ColorMode([S.ONE,S.ONE],r.Color.transparent,[!0,!0,!0,!0]);(function(at,ut,lt,dt){const Y=at.gl,st=ut.width*dt,_t=ut.height*dt;at.activeTexture.set(Y.TEXTURE1),at.viewport.set([0,0,st,_t]);let gt=lt.heatmapFbo;if(!gt||gt&&(gt.width!==st||gt.height!==_t)){gt&&gt.destroy();const Mt=Y.createTexture();Y.bindTexture(Y.TEXTURE_2D,Mt),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_S,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_WRAP_T,Y.CLAMP_TO_EDGE),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_2D,Y.TEXTURE_MAG_FILTER,Y.LINEAR),gt=lt.heatmapFbo=at.createFramebuffer(st,_t,!1),(function(At,kt,Zt,Ut,Xt,Te){const Gt=At.gl;Gt.texImage2D(Gt.TEXTURE_2D,0,At.isWebGL2&&At.extRenderToTextureHalfFloat?Gt.RGBA16F:Gt.RGBA,Xt,Te,0,Gt.RGBA,At.extRenderToTextureHalfFloat?At.isWebGL2?Gt.HALF_FLOAT:At.extTextureHalfFloat.HALF_FLOAT_OES:Gt.UNSIGNED_BYTE,null),Ut.colorAttachment.set(Zt)})(at,0,Mt,gt,st,_t)}else Y.bindTexture(Y.TEXTURE_2D,gt.colorAttachment.get()),at.bindFramebuffer.set(gt.framebuffer)})(w,m,h,m.transform.projection.name==="globe"?.5:.25),w.clear({color:r.Color.transparent});const B=m.transform,V=B.projection.name==="globe",U=V?["PROJECTION_GLOBE_VIEW"]:null,K=V?r.CullFaceMode.frontCCW:r.CullFaceMode.disabled,tt=[r.mercatorXfromLng(B.center.lng),r.mercatorYfromLat(B.center.lat)];for(let at=0;at<g.length;at++){const ut=g[at];if(o.hasRenderableParent(ut))continue;const lt=o.getTile(ut),dt=lt.getBucket(h);if(!dt||dt.projection.name!==B.projection.name)continue;const Y=dt.programConfigurations.get(h.id),st=m.useProgram("heatmap",Y,U),{zoom:_t}=m.transform;m.terrain&&m.terrain.setupElevationDraw(lt,st),m.prepareDrawProgram(w,st,ut.toUnwrapped());const gt=B.projection.createInversionMatrix(B,ut.canonical);st.draw(w,S.TRIANGLES,r.DepthMode.disabled,k,I,K,Xc(m,ut,lt,gt,tt,_t,h.paint.get("heatmap-intensity")),h.id,dt.layoutVertexBuffer,dt.indexBuffer,dt.segments,h.paint,m.transform.zoom,Y,V?[dt.globeExtVertexBuffer]:null)}w.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),(function(w,S){const k=w.context,I=k.gl,B=S.heatmapFbo;if(!B)return;k.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,B.colorAttachment.get()),k.activeTexture.set(I.TEXTURE1);let V=S.colorRampTexture;V||(V=S.colorRampTexture=new r.Texture(k,S.colorRamp,I.RGBA)),V.bind(I.LINEAR,I.CLAMP_TO_EDGE),w.useProgram("heatmapTexture").draw(k,I.TRIANGLES,r.DepthMode.disabled,r.StencilMode.disabled,w.colorModeForRenderPass(),r.CullFaceMode.disabled,((U,K,tt,at)=>({u_image:0,u_color_ramp:1,u_opacity:K.paint.get("heatmap-opacity")}))(0,S),S.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,S.paint,w.transform.zoom)})(m,h))},line:function(m,o,h,g){if(m.renderPass!=="translucent")return;const w=h.paint.get("line-opacity"),S=h.paint.get("line-width");if(w.constantOr(1)===0||S.constantOr(1)===0)return;const k=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),I=m.colorModeForRenderPass(),B=m.terrain&&m.terrain.renderingToTexture?1:r.exported.devicePixelRatio,V=h.paint.get("line-dasharray"),U=V.constantOr(1),K=h.layout.get("line-cap"),tt=h.paint.get("line-pattern"),at=tt.constantOr(1),ut=h.paint.get("line-gradient"),lt=at?"linePattern":"line",dt=m.context,Y=dt.gl,st=(gt=>{const Mt=[];Ya(gt)&&Mt.push("RENDER_LINE_DASH"),gt.paint.get("line-gradient")&&Mt.push("RENDER_LINE_GRADIENT");const At=gt.paint.get("line-trim-offset");At[0]===0&&At[1]===0||Mt.push("RENDER_LINE_TRIM_OFFSET");const kt=gt.paint.get("line-pattern").constantOr(1),Zt=gt.paint.get("line-opacity").constantOr(1)!==1;return!kt&&Zt&&Mt.push("RENDER_LINE_ALPHA_DISCARD"),Mt})(h);let _t=st.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(_t=!1);for(const gt of g){const Mt=o.getTile(gt);if(at&&!Mt.patternsLoaded())continue;const At=Mt.getBucket(h);if(!At)continue;m.prepareDrawTile();const kt=At.programConfigurations.get(h.id),Zt=m.useProgram(lt,kt,st),Ut=tt.constantOr(null);if(Ut&&Mt.imageAtlas){const se=Mt.imageAtlas.patternPositions[Ut.toString()];se&&kt.setConstantPatternPositions(se)}const Xt=V.constantOr(null),Te=K.constantOr(null);if(!at&&Xt&&Te&&Mt.lineAtlas){const se=Mt.lineAtlas.getDash(Xt,Te);se&&kt.setConstantPatternPositions(se)}let[Gt,fe]=h.paint.get("line-trim-offset");(Te==="round"||Te==="square")&&Gt!==fe&&(Gt===0&&(Gt-=1),fe===1&&(fe+=1));const te=m.terrain?gt.projMatrix:null,Ee=at?Yo(m,Mt,h,te,B):Cl(m,Mt,h,te,At.lineClipsArray.length,B,[Gt,fe]);if(ut){const se=At.gradients[h.id];let be=se.texture;if(h.gradientVersion!==se.version){let ge=256;if(h.stepInterpolant){const Me=o.getSource().maxzoom,ai=gt.canonical.z===Me?Math.ceil(1<<m.transform.maxZoom-gt.canonical.z):1;ge=r.clamp(r.nextPowerOfTwo(At.maxLineLength/r.EXTENT*1024*ai),256,dt.maxTextureSize)}se.gradient=r.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:ge,image:se.gradient||void 0,clips:At.lineClipsArray}),se.texture?se.texture.update(se.gradient):se.texture=new r.Texture(dt,se.gradient,Y.RGBA),se.version=h.gradientVersion,be=se.texture}dt.activeTexture.set(Y.TEXTURE1),be.bind(h.stepInterpolant?Y.NEAREST:Y.LINEAR,Y.CLAMP_TO_EDGE)}U&&(dt.activeTexture.set(Y.TEXTURE0),Mt.lineAtlasTexture.bind(Y.LINEAR,Y.REPEAT),kt.updatePaintBuffers()),at&&(dt.activeTexture.set(Y.TEXTURE0),Mt.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),kt.updatePaintBuffers()),m.prepareDrawProgram(dt,Zt,gt.toUnwrapped());const Ht=se=>{Zt.draw(dt,Y.TRIANGLES,k,se,I,r.CullFaceMode.disabled,Ee,h.id,At.layoutVertexBuffer,At.indexBuffer,At.segments,h.paint,m.transform.zoom,kt,[At.layoutVertexBuffer2])};if(_t){const se=m.stencilModeForClipping(gt).ref;se===0&&m.terrain&&dt.clear({stencil:0});const be={func:Y.EQUAL,mask:255};Ee.u_alpha_discard_threshold=.8,Ht(new r.StencilMode(be,se,255,Y.KEEP,Y.KEEP,Y.INVERT)),Ee.u_alpha_discard_threshold=0,Ht(new r.StencilMode(be,se,255,Y.KEEP,Y.KEEP,Y.KEEP))}else Ht(m.stencilModeForClipping(gt))}_t&&(m.resetStencilClippingMasks(),m.terrain&&dt.clear({stencil:0}))},fill:function(m,o,h,g){const w=h.paint.get("fill-color"),S=h.paint.get("fill-opacity");if(S.constantOr(1)===0)return;const k=m.colorModeForRenderPass(),I=h.paint.get("fill-pattern"),B=m.opaquePassEnabledForLayer()&&!I.constantOr(1)&&w.constantOr(r.Color.transparent).a===1&&S.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===B){const V=m.depthModeForSublayer(1,m.renderPass==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly);ju(m,o,h,g,V,k,!1)}if(m.renderPass==="translucent"&&h.paint.get("fill-antialias")){const V=m.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,r.DepthMode.ReadOnly);ju(m,o,h,g,V,k,!0)}},"fill-extrusion":function(m,o,h,g){const w=h.paint.get("fill-extrusion-opacity");if(w!==0&&m.renderPass==="translucent"){const S=new r.DepthMode(m.context.gl.LEQUAL,r.DepthMode.ReadWrite,m.depthRangeFor3D);if(w!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))xa(m,o,h,g,S,r.StencilMode.disabled,r.ColorMode.disabled),xa(m,o,h,g,S,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const k=m.colorModeForRenderPass();xa(m,o,h,g,S,r.StencilMode.disabled,k)}}},hillshade:function(m,o,h,g){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;const w=m.context,S=m.depthModeForSublayer(0,r.DepthMode.ReadOnly),k=m.colorModeForRenderPass(),I=m.terrain&&m.terrain.renderingToTexture,[B,V]=m.renderPass!=="translucent"||I?[{},g]:m.stencilConfigForOverlap(g);for(const U of V){const K=o.getTile(U);if(K.needsHillshadePrepare&&m.renderPass==="offscreen")lc(m,K,h,S,r.StencilMode.disabled,k);else if(m.renderPass==="translucent"){const tt=I&&m.terrain?m.terrain.stencilModeForRTTOverlap(U):B[U.overscaledZ];ac(m,U,K,h,S,tt,k)}}w.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,o,h,g,w,S){if(m.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!g.length)return;const k=m.context,I=k.gl,B=o.getSource(),V=m.useProgram("raster"),U=m.colorModeForRenderPass(),K=m.terrain&&m.terrain.renderingToTexture,[tt,at]=B instanceof yi||K?[{},g]:m.stencilConfigForOverlap(g),ut=at[at.length-1].overscaledZ,lt=!m.options.moving;for(const dt of at){const Y=K?r.DepthMode.disabled:m.depthModeForSublayer(dt.overscaledZ-ut,h.paint.get("raster-opacity")===1?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly,I.LESS),st=dt.toUnwrapped(),_t=o.getTile(dt);if(K&&(!_t||!_t.hasData()))continue;const gt=K?dt.projMatrix:m.transform.calculateProjMatrix(st,lt),Mt=m.terrain&&K?m.terrain.stencilModeForRTTOverlap(dt):tt[dt.overscaledZ],At=S?0:h.paint.get("raster-fade-duration");_t.registerFadeDuration(At);const kt=o.findLoadedParent(dt,0),Zt=cc(_t,kt,o,m.transform,At);let Ut,Xt;m.terrain&&m.terrain.prepareDrawTile();const Te=h.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;k.activeTexture.set(I.TEXTURE0),_t.texture.bind(Te,I.CLAMP_TO_EDGE),k.activeTexture.set(I.TEXTURE1),kt?(kt.texture.bind(Te,I.CLAMP_TO_EDGE),Ut=Math.pow(2,kt.tileID.overscaledZ-_t.tileID.overscaledZ),Xt=[_t.tileID.canonical.x*Ut%1,_t.tileID.canonical.y*Ut%1]):_t.texture.bind(Te,I.CLAMP_TO_EDGE),_t.texture.useMipmap&&k.extTextureFilterAnisotropic&&m.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,k.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,k.extTextureFilterAnisotropicMax);const Gt=Al(gt,Xt||[0,0],Ut||1,Zt,h,B instanceof yi?B.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(k,V,st),B instanceof yi)B.boundsBuffer&&B.boundsSegments&&V.draw(k,I.TRIANGLES,Y,r.StencilMode.disabled,U,r.CullFaceMode.disabled,Gt,h.id,B.boundsBuffer,m.quadTriangleIndexBuffer,B.boundsSegments);else{const{tileBoundsBuffer:fe,tileBoundsIndexBuffer:te,tileBoundsSegments:Ee}=m.getTileBoundsBuffers(_t);V.draw(k,I.TRIANGLES,Y,Mt,U,r.CullFaceMode.disabled,Gt,h.id,fe,te,Ee)}}m.resetStencilClippingMasks()},background:function(m,o,h,g){const w=h.paint.get("background-color"),S=h.paint.get("background-opacity");if(S===0)return;const k=m.context,I=k.gl,B=m.transform,V=B.tileSize,U=h.paint.get("background-pattern");if(m.isPatternMissing(U))return;const K=!U&&w.a===1&&S===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==K)return;const tt=r.StencilMode.disabled,at=m.depthModeForSublayer(0,K==="opaque"?r.DepthMode.ReadWrite:r.DepthMode.ReadOnly),ut=m.colorModeForRenderPass(),lt=m.useProgram(U?"backgroundPattern":"background");let dt,Y=g;Y||(dt=m.getBackgroundTiles(),Y=Object.values(dt).map((st=>st.tileID))),U&&(k.activeTexture.set(I.TEXTURE0),m.imageManager.bind(m.context));for(const st of Y){const _t=st.toUnwrapped(),gt=g?st.projMatrix:m.transform.calculateProjMatrix(_t);m.prepareDrawTile();const Mt=o?o.getTile(st):dt?dt[st.key]:new r.Tile(st,V,B.zoom,m),At=U?Ja(gt,S,m,U,{tileID:st,tileSize:V}):zr(gt,S,w);m.prepareDrawProgram(k,lt,_t);const{tileBoundsBuffer:kt,tileBoundsIndexBuffer:Zt,tileBoundsSegments:Ut}=m.getTileBoundsBuffers(Mt);lt.draw(k,I.TRIANGLES,at,tt,ut,r.CullFaceMode.disabled,At,h.id,kt,Zt,Ut)}},sky:function(m,o,h){const g=m.transform,w=g.projection.name==="mercator"||g.projection.name==="globe"?1:r.smoothstep(7,8,g.zoom),S=h.paint.get("sky-opacity")*w;if(S===0)return;const k=m.context,I=h.paint.get("sky-type"),B=new r.DepthMode(k.gl.LEQUAL,r.DepthMode.ReadOnly,[0,1]),V=m.frameCounter/1e3%1;I==="atmosphere"?m.renderPass==="offscreen"?h.needsSkyboxCapture(m)&&((function(U,K,tt,at){const ut=U.context,lt=ut.gl;let dt=K.skyboxFbo;if(!dt){dt=K.skyboxFbo=ut.createFramebuffer(32,32,!1),K.skyboxGeometry=new mc(ut),K.skyboxTexture=ut.gl.createTexture(),lt.bindTexture(lt.TEXTURE_CUBE_MAP,K.skyboxTexture),lt.texParameteri(lt.TEXTURE_CUBE_MAP,lt.TEXTURE_WRAP_S,lt.CLAMP_TO_EDGE),lt.texParameteri(lt.TEXTURE_CUBE_MAP,lt.TEXTURE_WRAP_T,lt.CLAMP_TO_EDGE),lt.texParameteri(lt.TEXTURE_CUBE_MAP,lt.TEXTURE_MIN_FILTER,lt.LINEAR),lt.texParameteri(lt.TEXTURE_CUBE_MAP,lt.TEXTURE_MAG_FILTER,lt.LINEAR);for(let gt=0;gt<6;++gt)lt.texImage2D(lt.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0,lt.RGBA,32,32,0,lt.RGBA,lt.UNSIGNED_BYTE,null)}ut.bindFramebuffer.set(dt.framebuffer),ut.viewport.set([0,0,32,32]);const Y=K.getCenter(U,!0),st=U.useProgram("skyboxCapture"),_t=new Float64Array(16);r.identity(_t),r.rotateY(_t,_t,.5*-Math.PI),ws(ut,K,st,_t,Y,0),r.identity(_t),r.rotateY(_t,_t,.5*Math.PI),ws(ut,K,st,_t,Y,1),r.identity(_t),r.rotateX(_t,_t,.5*-Math.PI),ws(ut,K,st,_t,Y,2),r.identity(_t),r.rotateX(_t,_t,.5*Math.PI),ws(ut,K,st,_t,Y,3),r.identity(_t),ws(ut,K,st,_t,Y,4),r.identity(_t),r.rotateY(_t,_t,Math.PI),ws(ut,K,st,_t,Y,5),ut.viewport.set([0,0,U.width,U.height])})(m,h),h.markSkyboxValid(m)):m.renderPass==="sky"&&(function(U,K,tt,at,ut){const lt=U.context,dt=lt.gl,Y=U.transform,st=U.useProgram("skybox");lt.activeTexture.set(dt.TEXTURE0),dt.bindTexture(dt.TEXTURE_CUBE_MAP,K.skyboxTexture);const _t=((gt,Mt,At,kt,Zt)=>({u_matrix:gt,u_sun_direction:Mt,u_cubemap:0,u_opacity:kt,u_temporal_offset:Zt}))(Y.skyboxMatrix,K.getCenter(U,!1),0,at,ut);U.prepareDrawProgram(lt,st),st.draw(lt,dt.TRIANGLES,tt,r.StencilMode.disabled,U.colorModeForRenderPass(),r.CullFaceMode.backCW,_t,"skybox",K.skyboxGeometry.vertexBuffer,K.skyboxGeometry.indexBuffer,K.skyboxGeometry.segment)})(m,h,B,S,V):I==="gradient"&&m.renderPass==="sky"&&(function(U,K,tt,at,ut){const lt=U.context,dt=lt.gl,Y=U.transform,st=U.useProgram("skyboxGradient");K.skyboxGeometry||(K.skyboxGeometry=new mc(lt)),lt.activeTexture.set(dt.TEXTURE0);let _t=K.colorRampTexture;_t||(_t=K.colorRampTexture=new r.Texture(lt,K.colorRamp,dt.RGBA)),_t.bind(dt.LINEAR,dt.CLAMP_TO_EDGE);const gt=((Mt,At,kt,Zt,Ut)=>({u_matrix:Mt,u_color_ramp:0,u_center_direction:At,u_radius:r.degToRad(kt),u_opacity:Zt,u_temporal_offset:Ut}))(Y.skyboxMatrix,K.getCenter(U,!1),K.paint.get("sky-gradient-radius"),at,ut);U.prepareDrawProgram(lt,st),st.draw(lt,dt.TRIANGLES,tt,r.StencilMode.disabled,U.colorModeForRenderPass(),r.CullFaceMode.backCW,gt,"skyboxGradient",K.skyboxGeometry.vertexBuffer,K.skyboxGeometry.indexBuffer,K.skyboxGeometry.segment)})(m,h,B,S,V)},debug:function(m,o,h){for(let g=0;g<h.length;g++)Or(m,o,h[g])},custom:function(m,o,h,g){const w=m.context,S=h.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&h.isLayerDraped()){if(m.renderPass==="offscreen"){const k=S.prerender;if(k){if(m.setCustomLayerDefaults(),w.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const I=m.transform.pointMerc;k.call(S,w.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.globeToMercatorTransition(m.transform.zoom),[I.x,I.y],m.transform.pixelsPerMeterRatio)}else k.call(S,w.gl,m.transform.customLayerMatrix());w.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const I=S.renderToTile;if(I){const B=g[0].canonical,V=new r.MercatorCoordinate(B.x+g[0].wrap*(1<<B.z),B.y,B.z);w.setDepthMode(r.DepthMode.disabled),w.setStencilMode(r.StencilMode.disabled),w.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),I.call(S,w.gl,V),w.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),w.setColorMode(m.colorModeForRenderPass()),w.setStencilMode(r.StencilMode.disabled);const k=S.renderingMode==="3d"?new r.DepthMode(m.context.gl.LEQUAL,r.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,r.DepthMode.ReadOnly);if(w.setDepthMode(k),m.transform.projection.name==="globe"){const I=m.transform.pointMerc;S.render(w.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),r.globeToMercatorTransition(m.transform.zoom),[I.x,I.y],m.transform.pixelsPerMeterRatio)}else S.render(w.gl,m.transform.customLayerMatrix());w.setDirty(),m.setBaseState(),w.bindFramebuffer.set(null)}}else r.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class er{constructor(o,h,g=!1){this.context=new Ae(o,g),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=r.SourceCache.maxUnderzooming+r.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,h){const g=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new eo(this,o));const w=this._terrain;this.transform.elevation=g?w:null,w.update(o,this.transform,h)}_updateFog(o){const h=o.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,w]=h.getFovAdjustedRange(this.transform._fov);if(g>w)return void(this.transform.fogCullDistSq=null);const S=g+.78*(w-g);this.transform.fogCullDistSq=S*S}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,h){if(this.width=o*r.exported.devicePixelRatio,this.height=h*r.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._layers[g].resize()}setup(){const o=this.context,h=new r.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(r.EXTENT,0),h.emplaceBack(0,r.EXTENT),h.emplaceBack(r.EXTENT,r.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(h,r.posAttributes.members),this.tileExtentSegments=r.SegmentVector.simpleSegment(0,0,4,2);const g=new r.StructArrayLayout2i4;g.emplaceBack(0,0),g.emplaceBack(r.EXTENT,0),g.emplaceBack(0,r.EXTENT),g.emplaceBack(r.EXTENT,r.EXTENT),this.debugBuffer=o.createVertexBuffer(g,r.posAttributes.members),this.debugSegments=r.SegmentVector.simpleSegment(0,0,4,5);const w=new r.StructArrayLayout2i4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(w,r.posAttributes.members),this.viewportSegments=r.SegmentVector.simpleSegment(0,0,4,2);const S=new r.StructArrayLayout4i8;S.emplaceBack(0,0,0,0),S.emplaceBack(r.EXTENT,0,r.EXTENT,0),S.emplaceBack(0,r.EXTENT,0,r.EXTENT),S.emplaceBack(r.EXTENT,r.EXTENT,r.EXTENT,r.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(S,r.boundsAttributes.members),this.mercatorBoundsSegments=r.SegmentVector.simpleSegment(0,0,4,2);const k=new r.StructArrayLayout3ui6;k.emplaceBack(0,1,2),k.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(k);const I=new r.StructArrayLayout1ui2;for(const V of[0,1,3,2,0])I.emplaceBack(V);this.debugIndexBuffer=o.createIndexBuffer(I),this.emptyTexture=new r.Texture(o,new r.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=r.create();const B=this.context.gl;this.stencilClearMode=new r.StencilMode({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO),this.loadTimeStamps.push(r.window.performance.now()),this.atmosphereBuffer=new _c(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,h=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,h.TRIANGLES,r.DepthMode.disabled,this.stencilClearMode,r.ColorMode.disabled,r.CullFaceMode.disabled,Ur(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,h,g){if(!h||this.currentStencilSource===h.id||!o.isTileClipped()||!g||g.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const B of g)if(this._tileClippingMaskIDs[B.key]===void 0){I=!0;break}if(!I)return}this.currentStencilSource=h.id;const w=this.context,S=w.gl;this.nextStencilID+g.length>256&&this.clearStencil(),w.setColorMode(r.ColorMode.disabled),w.setDepthMode(r.DepthMode.disabled);const k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of g){const B=h.getTile(I),V=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:U,tileBoundsIndexBuffer:K,tileBoundsSegments:tt}=this.getTileBoundsBuffers(B);k.draw(w,S.TRIANGLES,r.DepthMode.disabled,new r.StencilMode({func:S.ALWAYS,mask:0},V,255,S.KEEP,S.KEEP,S.REPLACE),r.ColorMode.disabled,r.CullFaceMode.disabled,Ur(I.projMatrix),"$clipping",U,K,tt)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,h=this.context.gl;return new r.StencilMode({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const h=this.context.gl;return new r.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){const h=this.context.gl,g=o.sort(((k,I)=>I.overscaledZ-k.overscaledZ)),w=g[g.length-1].overscaledZ,S=g[0].overscaledZ-w+1;if(S>1){this.currentStencilSource=void 0,this.nextStencilID+S>256&&this.clearStencil();const k={};for(let I=0;I<S;I++)k[I+w]=new r.StencilMode({func:h.GEQUAL,mask:255},I+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=S,[k,g]}return[{[w]:r.StencilMode.disabled},g]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new r.ColorMode([o.CONSTANT_COLOR,o.ONE],new r.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?r.ColorMode.unblended:r.ColorMode.alphaBlended}depthModeForSublayer(o,h,g){if(!this.opaquePassEnabledForLayer())return r.DepthMode.disabled;const w=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new r.DepthMode(g||this.context.gl.LEQUAL,h,[w,w])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,h){this.style=o,this.options=h,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(r.exported.now()),this.imageManager.beginFrame();const g=this.style.order,w=this.style._sourceCaches;for(const V in w){const U=w[V];U.used&&U.prepare(this.context)}const S={},k={},I={};for(const V in w){const U=w[V];S[V]=U.getVisibleCoordinates(),k[V]=S[V].slice().reverse(),I[V]=U.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let V=0;V<g.length;V++)if(this.style._layers[g[V]].is3D()){this.opaquePassCutoff=V;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new r.GlobeSharedBuffers(this.context)),!r.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const V of g){const U=this.style._layers[V],K=o._getLayerSourceCache(U);if(!U.hasOffscreenPass()||U.isHidden(this.transform.zoom))continue;const tt=K?k[K.id]:void 0;(U.type==="custom"||U.isSky()||tt&&tt.length)&&this.renderLayer(this,K,U,tt)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon];const B=this.terrain;if(B&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&B.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?r.Color.black:r.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=g.length-1;this.currentLayer>=0;this.currentLayer--){const V=this.style._layers[g[this.currentLayer]],U=o._getLayerSourceCache(V);if(V.isSky())continue;const K=U?k[U.id]:void 0;this._renderTileClippingMasks(V,U,K),this.renderLayer(this,U,V,K)}if(this.style.fog&&this.transform.projection.supportsFog&&(function(V,U){const K=V.context,tt=K.gl,at=V.transform,ut=new r.DepthMode(tt.LEQUAL,r.DepthMode.ReadOnly,[0,1]),lt=V.useProgram("globeAtmosphere",null,at.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),dt=r.globeToMercatorTransition(at.zoom),Y=U.properties.get("color").toArray01(),st=U.properties.get("high-color").toArray01(),_t=U.properties.get("space-color").toArray01PremultipliedAlpha(),gt=r.identity$1([]);r.rotateY$1(gt,gt,-r.degToRad(at._center.lng)),r.rotateX$1(gt,gt,r.degToRad(at._center.lat)),r.rotateZ$1(gt,gt,at.angle),r.rotateX$1(gt,gt,-at._pitch);const Mt=r.fromQuat(new Float32Array(16),gt),At=r.mapValue(U.properties.get("star-intensity"),0,1,0,.25),kt=5e-4,Zt=r.mapValue(U.properties.get("horizon-blend"),0,1,kt,.25),Ut=r.globeUseCustomAntiAliasing(V,K,at)&&Zt===kt?at.worldSize/(2*Math.PI*1.025)-1:at.globeRadius,Xt=V.frameCounter/1e3%1,Te=r.length(at.globeCenterInViewSpace),Gt=Math.sqrt(Math.pow(Te,2)-Math.pow(Ut,2)),fe=Math.acos(Gt/Te),te=((Ht,se,be,ge,Me,ai,bi,ei,li,$i,ji,oi,en,un)=>({u_frustum_tl:Ht,u_frustum_tr:se,u_frustum_br:be,u_frustum_bl:ge,u_horizon:Me,u_transition:ai,u_fadeout_range:bi,u_color:ei,u_high_color:li,u_space_color:$i,u_star_intensity:ji,u_star_size:5*r.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:oi,u_horizon_angle:en,u_rotation_matrix:un}))(at.frustumCorners.TL,at.frustumCorners.TR,at.frustumCorners.BR,at.frustumCorners.BL,at.frustumCorners.horizon,dt,Zt,Y,st,_t,At,Xt,fe,Mt);V.prepareDrawProgram(K,lt);const Ee=V.atmosphereBuffer;Ee&&lt.draw(K,tt.TRIANGLES,ut,r.StencilMode.disabled,r.ColorMode.alphaBlended,r.CullFaceMode.backCW,te,"skybox",Ee.vertexBuffer,Ee.indexBuffer,Ee.segments)})(this,this.style.fog),this.renderPass="sky",(r.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<g.length;this.currentLayer++){const V=this.style._layers[g[this.currentLayer]],U=o._getLayerSourceCache(V);V.isSky()&&this.renderLayer(this,U,V,U?k[U.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<g.length;){const V=this.style._layers[g[this.currentLayer]],U=o._getLayerSourceCache(V);if(V.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(V)){if(V.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const K=U?(V.type==="symbol"?I:k)[U.id]:void 0;this._renderTileClippingMasks(V,U,U?S[U.id]:void 0),this.renderLayer(this,U,V,K),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let V=null;r.values(this.style._layers).forEach((U=>{const K=o._getLayerSourceCache(U);K&&!U.isHidden(this.transform.zoom)&&(!V||V.getSource().maxzoom<K.getSource().maxzoom)&&(V=K)})),V&&this.options.showTileBoundaries&&ta.debug(this,V,V.getVisibleCoordinates())}this.options.showPadding&&(function(V){const U=V.transform.padding;Jc(V,V.transform.height-(U.top||0),3,Qo),Jc(V,U.bottom||0,3,Yc),ba(V,U.left||0,3,Vu),ba(V,V.transform.width-(U.right||0),3,Ah);const K=V.transform.centerPoint;(function(tt,at,ut,lt){wa(tt,at-1,ut-10,2,20,lt),wa(tt,at-10,ut-1,20,2,lt)})(V,K.x,V.transform.height-K.y,zs)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(r.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,h,g,w){g.isHidden(this.transform.zoom)||(g.type==="background"||g.type==="sky"||g.type==="custom"||w&&w.length)&&(this.id=g.id,this.gpuTimingStart(g),(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes(g.type)||o.terrain&&g.type==="custom")&&ta[g.type](o,h,g,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let g=this.gpuTimers[o.id];g||(g=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),g.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,g.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,h=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),o.beginQueryEXT(o.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const h={};for(const g in o){const w=o[g],S=this.context.extTimerQuery,k=S.getQueryObjectEXT(w.query,S.QUERY_RESULT_EXT)/1e6;S.deleteQueryEXT(w.query),h[g]=k}return h}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery;let g=0;for(const w of o)g+=h.getQueryObjectEXT(w,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(w);return g}translatePosMatrix(o,h,g,w,S){if(!g[0]&&!g[1])return o;const k=S?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(k){const V=Math.sin(k),U=Math.cos(k);g=[g[0]*U-g[1]*V,g[0]*V+g[1]*U]}const I=[S?g[0]:ce(h,g[0],this.transform.zoom),S?g[1]:ce(h,g[1],this.transform.zoom),0],B=new Float32Array(16);return r.translate(B,o,I),B}saveTileTexture(o){const h=this._tileTextures[o.size[0]];h?h.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const h=this._tileTextures[o];return h&&h.length>0?h.pop():null}isPatternMissing(o){return o===null||o!==void 0&&!this.imageManager.getPattern(o.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&this.terrain.exaggeration()===0,g=this.style&&this.style.fog,w=[];return this.terrainRenderModeElevated()&&w.push("TERRAIN"),this.transform.projection.name==="globe"&&w.push("GLOBE"),h&&w.push("ZERO_EXAGGERATION"),g&&!o&&g.getOpacity(this.transform.pitch)!==0&&w.push("FOG"),o&&w.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&w.push("OVERDRAW_INSPECTOR"),w}useProgram(o,h,g){this.cache=this.cache||{};const w=g||[],S=this.currentGlobalDefines().concat(w),k=Hi.cacheKey(Gc[o],o,S,h);return this.cache[k]||(this.cache[k]=new Hi(this.context,o,Gc[o],h,Gs[o],S)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=r.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new r.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,h,g){if(this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const S=w.getOpacity(this.transform.pitch),k=((I,B,V,U,K,tt,at,ut,lt,dt,Y)=>{const st=I.transform,_t=B.properties.get("color").toArray01();_t[3]=U;const gt=I.frameCounter/1e3%1;return{u_fog_matrix:V?st.calculateFogTileMatrix(V):I.identityMat,u_fog_range:B.getFovAdjustedRange(st._fov),u_fog_color:_t,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_temporal_offset:gt,u_frustum_tl:K,u_frustum_tr:tt,u_frustum_br:at,u_frustum_bl:ut,u_globe_pos:lt,u_globe_radius:dt,u_viewport:Y,u_globe_transition:r.globeToMercatorTransition(st.zoom),u_is_globe:+(st.projection.name==="globe")}})(this,w,g,S,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*r.exported.devicePixelRatio,this.transform.height*r.exported.devicePixelRatio]);h.setFogUniformValues(o,k)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,h=o.createTexture();return o.bindTexture(o.TEXTURE_2D,h),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,h=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const w of g)h[w.key]=o[w.key]||new r.Tile(w,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class Il{constructor(o=0,h=0,g=0,w=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(g)||g<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=g,this.right=w}interpolate(o,h,g){return h.top!=null&&o.top!=null&&(this.top=r.number(o.top,h.top,g)),h.bottom!=null&&o.bottom!=null&&(this.bottom=r.number(o.bottom,h.bottom,g)),h.left!=null&&o.left!=null&&(this.left=r.number(o.left,h.left,g)),h.right!=null&&o.right!=null&&(this.right=r.number(o.right,h.right,g)),this}getCenter(o,h){const g=r.clamp((this.left+o-this.right)/2,0,o),w=r.clamp((this.top+h-this.bottom)/2,0,h);return new r.Point(g,w)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new Il(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ll(m,o){const h=r.getColumn(m,3);r.fromQuat(m,o),r.setColumn(m,3,h)}function Zi(m,o){const h=r.identity$1([]);return r.rotateZ$1(h,h,-o),r.rotateX$1(h,h,-m),h}function Dl(m,o){const h=[m[0],m[1],0],g=[o[0],o[1],0];if(r.length(h)>=1e-15){const k=r.normalize([],h);r.scale$2(g,k,r.dot(g,k)),o[0]=g[0],o[1]=g[1]}const w=r.cross([],o,m);if(r.len(w)<1e-15)return null;const S=Math.atan2(-w[1],w[0]);return Zi(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),S)}class yr{constructor(o,h){this.position=o,this.orientation=h}get position(){return this._position}set position(o){if(o){const h=o instanceof r.MercatorCoordinate?o:new r.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(h.x=r.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(o,h){if(this.orientation=null,!this.position)return;const g=this.position,w=this._elevation?this._elevation.getAtPointOrZero(r.MercatorCoordinate.fromLngLat(o)):0,S=r.MercatorCoordinate.fromLngLat(o,w),k=[S.x-g.x,S.y-g.y,S.z-g.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=Dl(k,h)}setPitchBearing(o,h){this.orientation=Zi(r.degToRad(o),r.degToRad(-h))}}class Lo{constructor(o,h){this._transform=r.identity([]),this.orientation=h,this.position=o}get mercatorPosition(){const o=this.position;return new r.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=r.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var h;o&&r.setColumn(this._transform,3,[(h=o)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||r.identity$1([]),o&&Ll(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,h){this._orientation=Zi(o,h),Ll(this._transform,this._orientation)}forward(){const o=r.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=r.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=r.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,h){const g=new Float64Array(16);return r.invert(g,this.getWorldToCamera(o,h)),g}getWorldToCameraPosition(o,h,g){const w=this.position;r.scale$2(w,w,-o);const S=new Float64Array(16);return r.fromScaling(S,[g,g,g]),r.translate(S,S,w),S[10]*=h,S}getWorldToCamera(o,h){const g=new Float64Array(16),w=new Float64Array(4),S=this.position;return r.conjugate(w,this._orientation),r.scale$2(S,S,-o),r.fromQuat(g,w),r.translate(g,g,S),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=h,g[9]*=h,g[10]*=h,g[11]*=h,g}getCameraToClipPerspective(o,h,g,w){const S=new Float64Array(16);return r.perspective(S,o,h,g,w),S}getDistanceToElevation(o,h=!1){const g=o===0?0:r.mercatorZfromAltitude(o,h?r.latFromMercatorY(this.position[1]):this.position[1]),w=this.forward();return(g-this.position[2])/w[2]}clone(){return new Lo([...this.position],[...this.orientation])}}function Ta(m,o){const h=gc(m.projection,m.zoom,m.width,m.height),g=(function(S,k,I,B,V){const U=new r.LngLat(I.lng-180*ro,I.lat),K=new r.LngLat(I.lng+180*ro,I.lat),tt=S.project(U.lng,U.lat),at=S.project(K.lng,K.lat),ut=-Math.atan2(at.y-tt.y,at.x-tt.x),lt=r.MercatorCoordinate.fromLngLat(I);lt.y=r.clamp(lt.y,-1+ro,1-ro);const dt=lt.toLngLat(),Y=S.project(dt.lng,dt.lat),st=r.MercatorCoordinate.fromLngLat(dt);st.x+=ro;const _t=st.toLngLat(),gt=S.project(_t.lng,_t.lat),Mt=zl(gt.x-Y.x,gt.y-Y.y,ut),At=r.MercatorCoordinate.fromLngLat(dt);At.y+=ro;const kt=At.toLngLat(),Zt=S.project(kt.lng,kt.lat),Ut=zl(Zt.x-Y.x,Zt.y-Y.y,ut),Xt=Math.abs(Mt.x)/Math.abs(Ut.y),Te=r.identity([]);r.rotateZ(Te,Te,-ut*(1-(V?0:B)));const Gt=r.identity([]);return r.scale(Gt,Gt,[1,1-(1-Xt)*B,1]),Gt[4]=-Ut.x/Ut.y*B,r.rotateZ(Gt,Gt,ut),r.multiply(Gt,Te,Gt),Gt})(m.projection,0,m.center,h,o),w=tu(m);return r.scale(g,g,[w,w,1]),g}function tu(m){const o=m.projection,h=gc(m.projection,m.zoom,m.width,m.height),g=eu(o,m.center),w=eu(o,r.LngLat.convert(o.center));return Math.pow(2,g*h+(1-h)*w)}function gc(m,o,h,g,w=1/0){const S=m.range;if(!S)return 0;const k=Math.min(w,Math.max(h,g)),I=Math.log(k/1024)/Math.LN2;return r.smoothstep(S[0]+I,S[1]+I,o)}const ro=1/4e4;function eu(m,o){const h=r.clamp(o.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),g=new r.LngLat(o.lng-180*ro,h),w=new r.LngLat(o.lng+180*ro,h),S=m.project(g.lng,h),k=m.project(w.lng,h),I=r.MercatorCoordinate.fromLngLat(g),B=r.MercatorCoordinate.fromLngLat(w),V=k.x-S.x,U=k.y-S.y,K=B.x-I.x,tt=B.y-I.y,at=Math.sqrt((K*K+tt*tt)/(V*V+U*U));return Math.log(at)/Math.LN2}function zl(m,o,h){const g=Math.cos(h),w=Math.sin(h);return{x:m*g-o*w,y:m*w+o*g}}class Ea{constructor(o,h,g,w,S,k,I){this.tileSize=512,this._renderWorldCopies=S===void 0||S,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=g??0,this._maxPitch=w??60,this.setProjection(k),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new r.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Il,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Lo,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new Ea(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o,h=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||g)&&this._updateCameraOnTerrain(),(o||g)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return r.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=r.getProjection(this.projectionOptions);const g=!E(h,this.getProjection());return g&&this._calcMatrices(),this.mercatorFromTransition=!1,g}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=r.getProjection({name:"mercator"});const h=o!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return r.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new r.Point(this.width,this.height)}get bearing(){return r.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const h=-o*Math.PI/180;var g;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(g=new r.ARRAY_TYPE(4),r.ARRAY_TYPE!=Float32Array&&(g[1]=0,g[2]=0),g[0]=1,g[3]=1,g),(function(w,S,k){var I=S[0],B=S[1],V=S[2],U=S[3],K=Math.sin(k),tt=Math.cos(k);w[0]=I*tt+V*K,w[1]=B*tt+U*K,w[2]=I*-K+V*tt,w[3]=B*-K+U*tt})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const h=r.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=r.degToRad(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let w=0,S=0;for(let k=0;k<h.length;k++){const I=new r.Point(h[k][0]*this.width,g+h[k][1]*(this.height-g)),B=o.pointCoordinate(I);if(!B)continue;const V=1/Math.hypot(B[0]-this._camera.position[0],B[1]-this._camera.position[1]);w+=B[3]*V,S+=V}return S===0?NaN:w/S}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*h,w=this._mercatorZfromZoom(o),S=this._mercatorZfromZoom(this._maxZoom),k=Math.max(w-g,S);this._setZoom(this._zoomFromMercatorZ(k))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let g;g=o.z<this._camera.position[2]?[h.x,h.y,h.z]:[o.x,o.y,o.z];const w=r.length(r.sub([],this._camera.position,g));return r.clamp(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let h=!1;if(o.orientation&&!r.exactEquals(o.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(o.orientation)),o.position){const g=[o.position.x,o.position.y,o.position.z];r.exactEquals$1(g,this._camera.position)||(this._setCameraPosition(g),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,h=new yr;return h.position=new r.MercatorCoordinate(o[0],o[1],o[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(o){if(!r.length$1(o))return!1;r.normalize$1(o,o);const h=r.transformQuat([],[0,0,-1],o),g=r.transformQuat([],[0,-1,0],o);if(g[2]<0)return!1;const w=Dl(h,g);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(o){const h=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;o[2]=r.clamp(o[2],w/g,w/h),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,g){this._unmodified=!1,this._edgeInsets.interpolate(o,h,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){const h=[new r.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const g=this.pointCoordinate(new r.Point(0,0)),w=this.pointCoordinate(new r.Point(this.width,0)),S=this.pointCoordinate(new r.Point(this.width,this.height)),k=this.pointCoordinate(new r.Point(0,this.height)),I=Math.floor(Math.min(g.x,w.x,S.x,k.x)),B=Math.floor(Math.max(g.x,w.x,S.x,k.x)),V=1;for(let U=I-V;U<=B+V;U++)U!==0&&h.push(new r.UnwrappedTileID(U,o))}return h}coveringTiles(o){let h=this.coveringZoomLevel(o);const g=h,w=this.elevation&&!o.isTerrainDEM,S=this.projection.name==="mercator";if(o.minzoom!==void 0&&h<o.minzoom)return[];o.maxzoom!==void 0&&h>o.maxzoom&&(h=o.maxzoom);const k=this.locationCoordinate(this.center),I=this.center.lat,B=1<<h,V=[B*k.x,B*k.y,0],U=this.projection.name==="globe",K=!U,tt=r.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,K),at=U?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ut=B*r.mercatorZfromAltitude(1,this.center.lat),lt=this._camera.position[2]/r.mercatorZfromAltitude(1,this.center.lat),dt=[B*at.x,B*at.y,lt*(K?1:ut)],Y=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),st=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,_t=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,gt=o.isTerrainDEM?-_t:this._elevation?this._elevation.getMinElevationBelowMSL():0,Mt=this.projection.isReprojectedInTileSpace?tu(this):1,At=Ht=>{const be=new r.MercatorCoordinate(Ht.x+25e-6,Ht.y,Ht.z),ge=new r.MercatorCoordinate(Ht.x,Ht.y+25e-6,Ht.z),Me=Ht.toLngLat(),ai=be.toLngLat(),bi=ge.toLngLat(),ei=this.locationCoordinate(Me),li=this.locationCoordinate(ai),$i=this.locationCoordinate(bi),ji=Math.hypot(li.x-ei.x,li.y-ei.y),oi=Math.hypot($i.x-ei.x,$i.y-ei.y);return Math.sqrt(ji*oi)*Mt/25e-6},kt=Ht=>{const se=_t,be=gt;return{aabb:r.tileAABB(this,B,0,0,0,Ht,be,se,this.projection),zoom:0,x:0,y:0,minZ:be,maxZ:se,wrap:Ht,fullyVisible:!1}},Zt=[];let Ut=[];const Xt=h,Te=o.reparseOverscaled?g:h,Gt=Ht=>Ht*Ht,fe=Gt((lt-this._centerAltitude)*ut),te=Ht=>{if(!this._elevation||!Ht.tileID||!S)return;const se=this._elevation.getMinMaxForTile(Ht.tileID),be=Ht.aabb;se?(be.min[2]=se.min,be.max[2]=se.max,be.center[2]=(be.min[2]+be.max[2])/2):(Ht.shouldSplit=Ee(Ht),Ht.shouldSplit||(be.min[2]=be.max[2]=be.center[2]=this._centerAltitude))},Ee=Ht=>{if(Ht.zoom<st)return!0;if(Ht.zoom===Xt)return!1;if(Ht.shouldSplit!=null)return Ht.shouldSplit;const se=Ht.aabb.distanceX(dt),be=Ht.aabb.distanceY(dt);let ge=fe,Me=1;if(U){ge=Gt(Ht.aabb.distanceZ(dt));const ei=Math.pow(2,Ht.zoom),li=r.latFromMercatorY((Ht.y+1)/ei),$i=r.latFromMercatorY(Ht.y/ei),ji=Math.min(Math.max(I,li),$i),oi=r.circumferenceAtLatitude(ji)/r.circumferenceAtLatitude(I);if(Me=ji===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,oi/this._mercatorScaleRatio),this.zoom<=r.GLOBE_ZOOM_THRESHOLD_MIN&&Ht.zoom===Xt-1&&oi>=.9)return!0}else if(w&&(ge=Gt(Ht.aabb.distanceZ(dt)*ut)),this.projection.isReprojectedInTileSpace&&g<=5){const ei=Math.pow(2,Ht.zoom),li=At(new r.MercatorCoordinate((Ht.x+.5)/ei,(Ht.y+.5)/ei));Me=li>.85?1:li}const ai=se*se+be*be+ge,bi=Gt((1<<Xt-Ht.zoom)*Y*Me*((ei,li)=>{if(li*Gt(.707)<ei)return 1;const $i=Math.sqrt(li/ei);return $i/(1.4144271570014144+(Math.pow(1.1,$i-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(ge,fe),ai));return ai<bi};if(this.renderWorldCopies)for(let Ht=1;Ht<=3;Ht++)Zt.push(kt(-Ht)),Zt.push(kt(Ht));for(Zt.push(kt(0));Zt.length>0;){const Ht=Zt.pop(),se=Ht.x,be=Ht.y;let ge=Ht.fullyVisible;if(!ge){const Me=Ht.aabb.intersects(tt);if(Me===0)continue;ge=Me===2}if(Ht.zoom!==Xt&&Ee(Ht))for(let Me=0;Me<4;Me++){const ai=(se<<1)+Me%2,bi=(be<<1)+(Me>>1),ei={aabb:S?Ht.aabb.quadrant(Me):r.tileAABB(this,B,Ht.zoom+1,ai,bi,Ht.wrap,Ht.minZ,Ht.maxZ,this.projection),zoom:Ht.zoom+1,x:ai,y:bi,wrap:Ht.wrap,fullyVisible:ge,tileID:void 0,shouldSplit:void 0,minZ:Ht.minZ,maxZ:Ht.maxZ};w&&!U&&(ei.tileID=new r.OverscaledTileID(Ht.zoom+1===Xt?Te:Ht.zoom+1,Ht.wrap,Ht.zoom+1,ai,bi),te(ei)),Zt.push(ei)}else{const Me=Ht.zoom===Xt?Te:Ht.zoom;if(o.minzoom&&o.minzoom>Me)continue;const ai=V[0]-(.5+se+(Ht.wrap<<Ht.zoom))*(1<<h-Ht.zoom),bi=V[1]-.5-be,ei=Ht.tileID?Ht.tileID:new r.OverscaledTileID(Me,Ht.wrap,Ht.zoom,se,be);Ut.push({tileID:ei,distanceSq:ai*ai+bi*bi})}}if(this.fogCullDistSq){const Ht=this.fogCullDistSq,se=this.horizonLineFromTop();Ut=Ut.filter((be=>{const ge=[0,0,0,1],Me=[r.EXTENT,r.EXTENT,0,1],ai=this.calculateFogTileMatrix(be.tileID.toUnwrapped());r.transformMat4$1(ge,ge,ai),r.transformMat4$1(Me,Me,ai);const bi=r.getAABBPointSquareDist(ge,Me);if(bi===0)return!0;let ei=!1;const li=this._elevation;if(li&&bi>Ht&&se!==0){const $i=this.calculateProjMatrix(be.tileID.toUnwrapped());let ji;o.isTerrainDEM||(ji=li.getMinMaxForTile(be.tileID)),ji||(ji={min:gt,max:_t});const oi=r.furthestTileCorner(this.rotation),en=[oi[0]*r.EXTENT,oi[1]*r.EXTENT,ji.max];r.transformMat4(en,en,$i),ei=(1-en[1])*this.height*.5<se}return bi<Ht||ei}))}return Ut.sort(((Ht,se)=>Ht.distanceSq-se.distanceSq)).map((Ht=>Ht.tileID))}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const h=r.clamp(o.lat,-r.MAX_MERCATOR_LATITUDE,r.MAX_MERCATOR_LATITUDE),g=this.projection.project(o.lng,h);return new r.Point(g.x*this.worldSize,g.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/r.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,h){let g,w;const S=this.centerPoint;if(this.projection.name==="globe"){const I=this.worldSize;g=(h.x-S.x)/I,w=(h.y-S.y)/I}else{const I=this.pointCoordinate(h),B=this.pointCoordinate(S);g=I.x-B.x,w=I.y-B.y}const k=this.locationCoordinate(o);this.setLocation(new r.MercatorCoordinate(k.x-g,k.y-w))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,h){const g=h?r.mercatorZfromAltitude(h,o.lat):void 0,w=this.projection.project(o.lng,o.lat);return new r.MercatorCoordinate(w.x,w.y,g)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,h){const g=h??this._centerAltitude,w=[o.x,o.y,0,1],S=[o.x,o.y,1,1];r.transformMat4$1(w,w,this.pixelMatrixInverse),r.transformMat4$1(S,S,this.pixelMatrixInverse);const k=S[3];r.scale$1(w,w,1/w[3]),r.scale$1(S,S,1/k);const I=w[2],B=S[2];return{p0:w,p1:S,t:I===B?0:(g-I)/(B-I)}}screenPointToMercatorRay(o){const h=[o.x,o.y,0,1],g=[o.x,o.y,1,1];return r.transformMat4$1(h,h,this.pixelMatrixInverse),r.transformMat4$1(g,g,this.pixelMatrixInverse),r.scale$1(h,h,1/h[3]),r.scale$1(g,g,1/g[3]),h[2]=r.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,g[2]=r.mercatorZfromAltitude(g[2],this._center.lat)*this.worldSize,r.scale$1(h,h,1/this.worldSize),r.scale$1(g,g,1/this.worldSize),new r.Ray([h[0],h[1],h[2]],r.normalize([],r.sub([],g,h)))}rayIntersectionCoordinate(o){const{p0:h,p1:g,t:w}=o,S=r.mercatorZfromAltitude(h[2],this._center.lat),k=r.mercatorZfromAltitude(g[2],this._center.lat);return new r.MercatorCoordinate(r.number(h[0],g[0],w)/this.worldSize,r.number(h[1],g[1],w)/this.worldSize,r.number(S,k,w))}pointCoordinate(o,h=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,h)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let h=this.projection.pointCoordinate3D(this,o.x,o.y);if(h)return new r.MercatorCoordinate(h[0],h[1],h[2]);let g=0,w=this.horizonLineFromTop();if(o.y>w)return this.pointCoordinate(o);const S=.02*w,k=o.clone();for(let I=0;I<10&&w-g>S;I++){k.y=r.number(g,w,.66);const B=this.projection.pointCoordinate3D(this,k.x,k.y);B?(w=k.y,h=B):g=k.y}return h?new r.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(o);const h=this.pointCoordinate(o);return h.y>=0&&h.y<=1}_coordinatePoint(o,h){const g=h&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,w=[o.x*this.worldSize,o.y*this.worldSize,g+o.toAltitude(),1];return r.transformMat4$1(w,w,this.pixelMatrix),w[3]>0?new r.Point(w[0]/w[3],w[1]/w[3]):new r.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:h}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,S=this.pointLocation3D(new r.Point(h,o)),k=this.pointLocation3D(new r.Point(w,o)),I=this.pointLocation3D(new r.Point(w,g)),B=this.pointLocation3D(new r.Point(h,g));let V=Math.min(S.lng,k.lng,I.lng,B.lng),U=Math.max(S.lng,k.lng,I.lng,B.lng),K=Math.min(S.lat,k.lat,I.lat,B.lat),tt=Math.max(S.lat,k.lat,I.lat,B.lat);const at=Math.pow(2,-this.zoom)/16*270,ut=this.projection.name==="globe"?1:4,lt=(dt,Y,st,_t,gt)=>{const Mt=(dt+st)/2,At=(Y+_t)/2,kt=new r.Point(Mt,At),{lng:Zt,lat:Ut}=this.pointLocation3D(kt),Xt=Math.max(0,V-Zt,K-Ut,Zt-U,Ut-tt);V=Math.min(V,Zt),U=Math.max(U,Zt),K=Math.min(K,Ut),tt=Math.max(tt,Ut),(gt<ut||Xt>at)&&(lt(dt,Y,Mt,At,gt+1),lt(Mt,At,st,_t,gt+1))};if(lt(h,o,w,o,1),lt(w,o,w,g,1),lt(w,g,h,g,1),lt(h,g,h,o,1),this.projection.name==="globe"){const[dt,Y]=r.polesInViewport(this);dt?(tt=90,U=180,V=-180):Y&&(K=-90,U=180,V=-180)}return new r.LngLatBounds(new r.LngLat(V,K),new r.LngLat(U,tt))}_getBoundsRectangular(o,h){const{top:g,left:w}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,k=this.width-this._edgeInsets.right,I=new r.Point(w,g),B=new r.Point(k,g),V=new r.Point(k,S),U=new r.Point(w,S);let K=this.pointCoordinate(I,o),tt=this.pointCoordinate(B,o);const at=this.pointCoordinate(V,h),ut=this.pointCoordinate(U,h),lt=(dt,Y)=>(Y.y-dt.y)/(Y.x-dt.x);return K.y>1&&tt.y>=0?K=new r.MercatorCoordinate((1-ut.y)/lt(ut,K)+ut.x,1):K.y<0&&tt.y<=1&&(K=new r.MercatorCoordinate(-ut.y/lt(ut,K)+ut.x,0)),tt.y>1&&K.y>=0?tt=new r.MercatorCoordinate((1-at.y)/lt(at,tt)+at.x,1):tt.y<0&&K.y<=1&&(tt=new r.MercatorCoordinate(-at.y/lt(at,tt)+at.x,0)),new r.LngLatBounds().extend(this.coordinateLocation(K)).extend(this.coordinateLocation(tt)).extend(this.coordinateLocation(ut)).extend(this.coordinateLocation(at))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=o.visibleDemTiles.reduce(((g,w)=>{if(w.dem){const S=w.dem.tree;g.min=Math.min(g.min,S.minimums[0]),g.max=Math.max(g.max,S.maximums[0])}return g}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*o.exaggeration(),h.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,g=this.height/2-h*(1-this._horizonShift);return o?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-r.MAX_MERCATOR_LATITUDE,this.maxLat=r.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=r.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=r.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=r.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=r.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,h){return this.projection.createTileMatrix(this,h,o)}calculateDistanceTileData(o){const h=o.key,g=this._distanceTileDataCache;if(g[h])return g[h];const w=o.canonical,S=1/this.height,k=this.cameraWorldSize,I=k/this.zoomScale(w.z),B=(w.x+Math.pow(2,w.z)*o.wrap)*I,V=w.y*I,U=this.point;U.x*=k/this.worldSize,U.y*=k/this.worldSize;const K=this.angle,tt=Math.sin(-K),at=-Math.cos(-K);return g[h]={bearing:[tt,at],center:[(U.x-B)*S,(U.y-V)*S],scale:I/r.EXTENT*S},g[h]}calculateFogTileMatrix(o){const h=o.key,g=this._fogTileMatrixCache;if(g[h])return g[h];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return r.multiply(w,this.worldToFogMatrix,w),g[h]=new Float32Array(w),g[h]}calculateProjMatrix(o,h=!1){const g=o.key,w=h?this._alignedProjMatrixCache:this._projMatrixCache;if(w[g])return w[g];const S=this.calculatePosMatrix(o,this.worldSize);return r.multiply(S,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,S),w[g]=new Float32Array(S),w[g]}calculatePixelsToTileUnitsMatrix(o){const h=o.tileID.key,g=this._pixelsToTileUnitsCache;if(g[h])return g[h];const w=(function(S,k){const{scale:I}=S.tileTransform,B=I*r.EXTENT/(S.tileSize*Math.pow(2,k.zoom-S.tileID.overscaledZ+S.tileID.canonical.z));return V=new Float32Array(4),tt=(U=k.inverseAdjustmentMatrix)[1],at=U[2],ut=U[3],dt=(K=[B,B])[1],V[0]=U[0]*(lt=K[0]),V[1]=tt*lt,V[2]=at*dt,V[3]=ut*dt,V;var V,U,K,tt,at,ut,lt,dt})(o,this);return g[h]=w,g[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,h=r.fromScaling([],[o,o,o]);return r.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const h=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(h),w=this._camera.forward(),S=r.mercatorZfromAltitude(1,this._center.lat);g[2]/=S,w[2]/=S,r.normalize(w,w);const k=o.raycast(g,w,o.exaggeration());if(k){const I=r.scaleAndAdd([],g,w,k),B=new r.MercatorCoordinate(I[0],I[1],r.mercatorZfromAltitude(I[2],r.latFromMercatorY(I[1]))),V=(B.z+r.length([B.x-g[0],B.y-g[1],B.z-g[2]*S]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(V),this._centerAltitude=B.toAltitude(),this._center=this.coordinateLocation(B),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const h=this._elevation,g=r.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(g),S=h.getAtPointOrZero(new r.MercatorCoordinate(...w)),k=this.pixelsPerMeter/this.worldSize*S,I=this._minimumHeightOverTerrain(),B=w[2]-k;if(B<=I)if(B<0||o){const V=this.locationCoordinate(this._center,this._centerAltitude),U=[w[0],w[1],V.z-w[2]],K=r.length(U);U[2]-=(I-B)/this._pixelsPerMercatorPixel;const tt=r.length(U);if(tt===0)return;r.scale$2(U,U,K/tt*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],V.z*this._pixelsPerMercatorPixel-U[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const tt=this.center;return tt.lat=r.clamp(tt.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(tt.lng=r.clamp(tt.lng,this.minLng,this.maxLng)),this.center=tt,void(this._constraining=!1)}const h=this._unmodified,{x:g,y:w}=this.point;let S=0,k=g,I=w;const B=this.width/2,V=this.height/2,U=this.worldMinY*this.scale,K=this.worldMaxY*this.scale;if(w-V<U&&(I=U+V),w+V>K&&(I=K-V),K-U<this.height&&(S=Math.max(S,this.height/(K-U)),I=(K+U)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const tt=this.worldMinX*this.scale,at=this.worldMaxX*this.scale,ut=this.worldSize/2-(tt+at)/2;k=(g+ut+this.worldSize)%this.worldSize-ut,k-B<tt&&(k=tt+B),k+B>at&&(k=at-B),at-tt<this.width&&(S=Math.max(S,this.width/(at-tt)),k=(at+tt)/2)}k===g&&I===w||(this.center=this.unproject(new r.Point(k,I))),S&&(this.zoom+=this.scaleZoom(S)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,h=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=r.mercatorZfromAltitude(1,this.center.lat)/r.mercatorZfromAltitude(1,r.GLOBE_SCALE_MATCH_LATITUDE));const g=gc(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,g),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const w=this.projection.zAxisUnit==="meters"?h:1,S=this._camera.getWorldToCamera(this.worldSize,w),k=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);k[8]=2*-o.x/this.width,k[9]=2*o.y/this.height;let I=r.mul([],k,S);if(this.projection.isReprojectedInTileSpace){const At=this.locationCoordinate(this.center),kt=r.identity([]);r.translate(kt,kt,[At.x*this.worldSize,At.y*this.worldSize,0]),r.multiply(kt,kt,Ta(this)),r.translate(kt,kt,[-At.x*this.worldSize,-At.y*this.worldSize,0]),r.multiply(I,I,kt),this.inverseAdjustmentMatrix=(function(Zt){const Ut=Ta(Zt,!0);return Nt([],[Ut[0],Ut[1],Ut[4],Ut[5]])})(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=r.scale([],I,[this.worldSize,this.worldSize,this.worldSize/w,1]),this.projMatrix=I,this.invProjMatrix=r.invert(new Float64Array(16),this.projMatrix);const B=r.invert([],k);this.frustumCorners=r.FrustumCorners.fromInvProjectionMatrix(B,this.horizonLineFromTop(),this.height);const V=new Float32Array(16);r.identity(V),r.scale(V,V,[1,-1,1]),r.rotateX(V,V,this._pitch),r.rotateZ(V,V,this.angle);const U=r.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),K=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;U[8]=2*-o.x/this.width,U[9]=2*(o.y+K)/this.height,this.skyboxMatrix=r.multiply(V,U,V);const tt=this.point,at=tt.x,ut=tt.y,lt=this.width%2/2,dt=this.height%2/2,Y=Math.cos(this.angle),st=Math.sin(this.angle),_t=at-Math.round(at)+Y*lt+st*dt,gt=ut-Math.round(ut)+Y*dt+st*lt,Mt=new Float64Array(I);if(r.translate(Mt,Mt,[_t>.5?_t-1:_t,gt>.5?gt-1:gt,0]),this.alignedProjMatrix=Mt,I=r.create(),r.scale(I,I,[this.width/2,-this.height/2,1]),r.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=r.create(),r.scale(I,I,[1,-1,1]),r.translate(I,I,[-1,-1,0]),r.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=r.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=r.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=r.calculateGlobeMatrix(this);const At=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=r.transformMat4(At,At,S),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,g=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,S=[o,o,h];r.scale$2(S,S,w),r.scale$2(g,g,-1),r.multiply$2(g,g,S);const k=r.create();r.translate(k,k,g),r.scale(k,k,S),this.mercatorFogMatrix=k,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,h,w)}_computeCameraPosition(o){const h=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),w=this.point,S=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-o/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-g[0]*S,w.y/this.worldSize-g[1]*S,o/this.worldSize*this._centerAltitude-g[2]*S]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],w=o[2];let S=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(S=Math.min((h-g)/w,1)),this._camera.position=r.scaleAndAdd([],this._camera.position,o,S),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,h=this._camera.forward(),{pitch:g,bearing:w}=this._camera.getPitchBearing(),S=r.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,k=this._mercatorZfromZoom(this._maxZoom)*Math.cos(r.degToRad(this._maxPitch)),I=Math.max((o[2]-S)/Math.cos(g),k),B=this._zoomFromMercatorZ(I);r.scaleAndAdd(o,o,h,I),this._pitch=r.clamp(g,r.degToRad(this.minPitch),r.degToRad(this.maxPitch)),this.angle=r.wrap(w,-Math.PI,Math.PI),this._setZoom(r.clamp(B,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new r.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let h=0,g=r.GLOBE_ZOOM_THRESHOLD_MAX,w=0,S=1/0;for(;g-h>1e-6&&g>h;){const k=h+.5*(g-h),I=this.tileSize*Math.pow(2,k),B=this.getCameraToCenterDistance(this.projection,k,I),V=this.scaleZoom(B/(o*this.tileSize)),U=Math.abs(k-V);U<S&&(S=U,w=k),k<V?h=k:g=k}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(r.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,h){const g=Math.min(o.x,h.x),w=Math.max(o.x,h.x),S=Math.min(o.y,h.y),k=Math.max(o.y,h.y);if(S<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const I=[new r.Point(g,S),new r.Point(w,k),new r.Point(g,k),new r.Point(w,S)],B=this.renderWorldCopies?-3:0,V=this.renderWorldCopies?4:1;for(const U of I){const K=this.pointRayIntersection(U);if(K.t<0)return!0;const tt=this.rayIntersectionCoordinate(K);if(tt.x<B||tt.y<0||tt.x>V||tt.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+r.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new r.Point(0,0),new r.Point(this.width,this.height))}zoomDeltaToMovement(o,h){const g=r.length(r.sub([],this._camera.position,o)),w=this._zoomFromMercatorZ(g)+h;return g-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const o=(function([h,g,w],S){const k=[h,g,w,1];r.transformMat4$1(k,k,S);const I=k[3]=Math.max(k[3],1e-6);return k[0]/=I,k[1]/=I,k[2]/=I,k})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new r.Point(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new r.Point(0,o))}}getCameraToCenterDistance(o,h=this.zoom,g=this.worldSize){const w=gc(o,h,this.width,this.height,1024),S=o.pixelSpaceConversion(this.center.lat,g,w);return .5/Math.tan(.5*this._fov)*this.height*S}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&r.multiply(o,o,this.globeMatrix),o}}function Sa(m,o){let h=!1,g=null;const w=()=>{g=null,h&&(m(),g=setTimeout(w,o),h=!1)};return()=>(h=!0,g||w(),g)}class Ol{constructor(o){this._hashName=o&&encodeURIComponent(o),r.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Sa(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,r.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),r.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const h=Do(o);if(this._hashName){const g=this._hashName;let w=!1;const S=r.window.location.hash.slice(1).split("&").map((k=>{const I=k.split("=")[0];return I===g?(w=!0,`${I}=${h}`):k})).filter((k=>k));return w||S.push(`${g}=${h}`),`#${S.join("&")}`}return`#${h}`}_getCurrentHash(){const o=r.window.location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map((g=>g.split("="))).forEach((g=>{g[0]===this._hashName&&(h=g)})),(h&&h[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some((g=>isNaN(g)))){const g=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(h[3]||0):o.getBearing();return o.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:g,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=r.window.location.href.replace(/(#.+)?$/,this.getHashString());r.window.history.replaceState(r.window.history.state,null,o)}}function Do(m,o){const h=m.getCenter(),g=Math.round(100*m.getZoom())/100,w=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),S=Math.pow(10,w),k=Math.round(h.lng*S)/S,I=Math.round(h.lat*S)/S,B=m.getBearing(),V=m.getPitch();let U=o?`/${k}/${I}/${g}`:`${g}/${I}/${k}`;return(B||V)&&(U+="/"+Math.round(10*B)/10),V&&(U+=`/${Math.round(V)}`),U}const sl={linearity:.3,easing:r.bezier(0,0,.3,1)},Rl=r.extend({deceleration:2500,maxSpeed:1400},sl),f=r.extend({deceleration:20,maxSpeed:1400},sl),x=r.extend({deceleration:1e3,maxSpeed:360},sl),A=r.extend({deceleration:1e3,maxSpeed:90},sl);class F{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:r.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,h=r.exported.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new r.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:S}of this._inertiaBuffer)h.zoom+=S.zoomDelta||0,h.bearing+=S.bearingDelta||0,h.pitch+=S.pitchDelta||0,S.panDelta&&h.pan._add(S.panDelta),S.around&&(h.around=S.around),S.pinchAround&&(h.pinchAround=S.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(h.pan.mag()){const S=ot(h.pan.mag(),g,r.extend({},Rl,o||{}));w.offset=h.pan.mult(S.amount/h.pan.mag()),w.center=this._map.transform.center,q(w,S)}if(h.zoom){const S=ot(h.zoom,g,f);w.zoom=this._map.transform.zoom+S.amount,q(w,S)}if(h.bearing){const S=ot(h.bearing,g,x);w.bearing=this._map.transform.bearing+r.clamp(S.amount,-179,179),q(w,S)}if(h.pitch){const S=ot(h.pitch,g,A);w.pitch=this._map.transform.pitch+S.amount,q(w,S)}if(w.zoom||w.bearing){const S=h.pinchAround===void 0?h.around:h.pinchAround;w.around=S?this._map.unproject(S):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function q(m,o){(!m.duration||m.duration<o.duration)&&(m.duration=o.duration,m.easing=o.easing)}function ot(m,o,h){const{maxSpeed:g,linearity:w,deceleration:S}=h,k=r.clamp(m*w/(o/1e3),-g,g),I=Math.abs(k)/(S*w);return{easing:h.easing,duration:1e3*I,amount:k*(I/2)}}class Pt extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,g,w={}){const S=Ot(h.getCanvasContainer(),g),k=h.unproject(S);super(o,r.extend({point:S,lngLat:k,originalEvent:g},w)),this._defaultPrevented=!1,this.target=h}}class Yt extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,g){const w=o==="touchend"?g.changedTouches:g.touches,S=zt(h.getCanvasContainer(),w),k=S.map((B=>h.unproject(B))),I=S.reduce(((B,V,U,K)=>B.add(V.div(K.length))),new r.Point(0,0));super(o,{points:S,point:I,lngLats:k,lngLat:h.unproject(I),originalEvent:g}),this._defaultPrevented=!1}}class ue extends r.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,g){super(o,{originalEvent:g}),this._defaultPrevented=!1}}class Ie{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new ue(o.type,this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new Pt(o.type,this._map,o))}mouseup(o){this._map.fire(new Pt(o.type,this._map,o))}preclick(o){const h=r.extend({},o);h.type="preclick",this._map.fire(new Pt(h.type,this._map,h))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Pt(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Pt(o.type,this._map,o))}mouseover(o){this._map.fire(new Pt(o.type,this._map,o))}mouseout(o){this._map.fire(new Pt(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Yt(o.type,this._map,o))}touchmove(o){this._map.fire(new Yt(o.type,this._map,o))}touchend(o){this._map.fire(new Yt(o.type,this._map,o))}touchcancel(o){this._map.fire(new Yt(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ni{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Pt(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pt("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Pt(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class wi{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(ft(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;const g=h,w=this._startPos,S=this._lastPos;if(!w||!S||S.equals(g)||!this._box&&g.dist(w)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=j("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const k=Math.min(w.x,g.x),I=Math.max(w.x,g.x),B=Math.min(w.y,g.y),V=Math.max(w.y,g.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${k}px,${B}px)`,this._box.style.width=I-k+"px",this._box.style.height=V-B+"px")}))}mouseupWindow(o,h){if(!this._active)return;const g=this._startPos,w=h;if(g&&o.button===0){if(this.reset(),bt(),g.x!==w.x||g.y!==w.y)return this._map.fire(new r.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:S=>S.fitScreenCoordinates(g,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),xt(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new r.Event(o,{originalEvent:h}))}}function Di(m,o){const h={};for(let g=0;g<m.length;g++)h[m[g].identifier]=o[g];return h}class $n{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,h,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),g.length===this.numTouches&&(this.centroid=(function(w){const S=new r.Point(0,0);for(const k of w)S._add(k);return S.div(w.length)})(h),this.touches=Di(g,h)))}touchmove(o,h,g){if(this.aborted||!this.centroid)return;const w=Di(g,h);for(const S in this.touches){const k=w[S];(!k||k.dist(this.touches[S])>30)&&(this.aborted=!0)}}touchend(o,h,g){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),g.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class ss{constructor(o){this.singleTap=new $n(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,h,g){this.singleTap.touchstart(o,h,g)}touchmove(o,h,g){this.singleTap.touchmove(o,h,g)}touchend(o,h,g){const w=this.singleTap.touchend(o,h,g);if(w){const S=o.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(w)<30;if(S&&k||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class vr{constructor(){this._zoomIn=new ss({numTouches:1,numTaps:2}),this._zoomOut=new ss({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,g){this._zoomIn.touchstart(o,h,g),this._zoomOut.touchstart(o,h,g)}touchmove(o,h,g){this._zoomIn.touchmove(o,h,g),this._zoomOut.touchmove(o,h,g)}touchend(o,h,g){const w=this._zoomIn.touchend(o,h,g),S=this._zoomOut.touchend(o,h,g);return w?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(w)},{originalEvent:o})}):S?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(S)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Hs={0:1,2:2};class Os{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,h){return!1}_move(o,h){return{}}mousedown(o,h){if(this._lastPoint)return;const g=Rt(o);this._correctButton(o,g)&&(this._lastPoint=h,this._eventButton=g)}mousemoveWindow(o,h){const g=this._lastPoint;if(g){if(o.preventDefault(),this._eventButton!=null&&(function(w,S){const k=Hs[S];return w.buttons===void 0||(w.buttons&k)!==k})(o,this._eventButton))this.reset();else if(this._moved||!(h.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(g,h)}}mouseupWindow(o){this._lastPoint&&Rt(o)===this._eventButton&&(this._moved&&bt(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Bl extends Os{mousedown(o,h){super.mousedown(o,h),this._lastPoint&&(this._active=!0)}_correctButton(o,h){return h===0&&!o.ctrlKey}_move(o,h){return{around:h,panDelta:h.sub(o)}}}class yc extends Os{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const g=.8*(h.x-o.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(o){o.preventDefault()}}class iu extends Os{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const g=-.5*(h.y-o.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(o){o.preventDefault()}}class Fl{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),r.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new r.Point(0,0)}touchstart(o,h,g){return this._calculateTransform(o,h,g)}touchmove(o,h,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(g.length===1&&!r.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,h,g)}}touchend(o,h,g){this._calculateTransform(o,h,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,g){g.length>0&&(this._active=!0);const w=Di(g,h),S=new r.Point(0,0),k=new r.Point(0,0);let I=0;for(const V in w){const U=w[V],K=this._touches[V];K&&(S._add(U),k._add(U.sub(K)),I++,w[V]=U)}if(this._touches=w,I<this._minTouches||!k.mag())return;const B=k.div(I);return this._sum._add(B),this._sum.mag()<this._clickTolerance?void 0:{around:S.div(I),panDelta:B}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")}),500)}}class Nl{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,h,g){return{}}touchstart(o,h,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,g){const w=this._firstTwoTouches;if(!w)return;o.preventDefault();const[S,k]=w,I=oo(g,h,S),B=oo(g,h,k);if(!I||!B)return;const V=this._aroundCenter?null:I.add(B).div(2);return this._move([I,B],V,o)}touchend(o,h,g){if(!this._firstTwoTouches)return;const[w,S]=this._firstTwoTouches,k=oo(g,h,w),I=oo(g,h,S);k&&I||(this._active&&bt(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function oo(m,o,h){for(let g=0;g<m.length;g++)if(m[g].identifier===h)return o[g]}function pn(m,o){return Math.log(m/o)/Math.LN2}class jl extends Nl{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){const g=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(pn(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:pn(this._distance,g),pinchAround:h}}}function nu(m,o){return 180*m.angleWith(o)/Math.PI}class Uu extends Nl{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){const g=this._vector;if(this._vector=o[0].sub(o[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:nu(this._vector,g),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const h=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const w=nu(o,g);return Math.abs(w)<h}}function ea(m){return Math.abs(m.y)>Math.abs(m.x)}class vc extends Nl{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,ea(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,g){const w=this._lastPoints;if(!w)return;const S=o[0].sub(w[0]),k=o[1].sub(w[1]);return this._map._cooperativeGestures&&!r.isFullscreen()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(S,k,g.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(S.y+k.y)/2*-.5})}gestureBeginsVertically(o,h,g){if(this._valid!==void 0)return this._valid;const w=o.mag()>=2,S=h.mag()>=2;if(!w&&!S)return;if(!w||!S)return this._firstMove==null&&(this._firstMove=g),g-this._firstMove<100&&void 0;const k=o.y>0==h.y>0;return ea(o)&&ea(h)&&k}}const su={panStep:100,bearingStep:15,pitchStep:10};class Ph{constructor(){const o=su;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,g=0,w=0,S=0,k=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?g=-1:(o.preventDefault(),S=-1);break;case 39:o.shiftKey?g=1:(o.preventDefault(),S=1);break;case 38:o.shiftKey?w=1:(o.preventDefault(),k=-1);break;case 40:o.shiftKey?w=-1:(o.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(g=0,w=0),{cameraAnimation:I=>{const B=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:kd,zoom:h?Math.round(B)+h*(o.shiftKey?2:1):B,bearing:I.getBearing()+g*this._bearingStep,pitch:I.getPitch()+w*this._pitchStep,offset:[-S*this._panStep,-k*this._panStep],center:I.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function kd(m){return m*(2-m)}const $u=4.000244140625;class Id{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,r.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||r.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=o.deltaMode===r.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const g=r.exported.now(),w=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,h!==0&&h%$u==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(w*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=Ot(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const B=this._type==="wheel"&&Math.abs(this._delta)>$u?this._wheelZoomRate:this._defaultZoomRate;let V=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&V!==0&&(V=1/V);const U=h(),K=Math.pow(2,U),tt=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):K;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(tt*V))),this._type==="wheel"&&(this._startZoom=U,this._easing=this._smoothOutEasing(200)),this._delta=0}const g=typeof this._targetZoom=="number"?this._targetZoom:h(),w=this._startZoom,S=this._easing;let k,I=!1;if(this._type==="wheel"&&w&&S){const B=Math.min((r.exported.now()-this._lastWheelEventTime)/200,1),V=S(B);k=r.number(w,g,V),B<1?this._frameId||(this._frameId=!0):I=!0}else k=g,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:k-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=r.ease;if(this._prevEase){const g=this._prevEase,w=(r.exported.now()-g.start)/g.duration,S=g.easing(w+.01)-g.easing(w),k=.27/Math.sqrt(S*S+1e-4)*.01,I=Math.sqrt(.0729-k*k);h=r.bezier(k,I,.25,1)}return this._prevEase={start:r.exported.now(),duration:o,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=j("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(r.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")}),200)}}class kh{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Rs{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,h){return o.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(o.shiftKey?-1:1),around:g.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ld{constructor(){this._tap=new ss({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,h,g){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=h[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(o,h,g))}touchmove(o,h,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const w=h[0],S=w.y-this._swipePoint.y;return this._swipePoint=w,o.preventDefault(),this._active=!0,{zoomDelta:S/128}}}else this._tap.touchmove(o,h,g)}touchend(o,h,g){this._tapTime?this._swipePoint&&g.length===0&&this.reset():this._tap.touchend(o,h,g)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class rl{constructor(o,h,g){this._el=o,this._mousePan=h,this._touchPan=g}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Dd{constructor(o,h,g){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ih{constructor(o,h,g,w){this._el=o,this._touchZoom=h,this._touchRotate=g,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Wr=m=>m.zoom||m.drag||m.pitch||m.rotate;class Wu extends r.Event{}class zd{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,h){const g=r.sub([],h,o);this.radius=r.length(g[2]<0?r.div([],g,this.constants):[g[0],g[1],0])}projectRay(o){r.div(o,o,this.constants),r.normalize(o,o),r.mul$1(o,o,this.constants);const h=r.scale$2([],o,this.radius);if(h[2]>0){const g=r.scale$2([],[0,0,1],r.dot(h,[0,0,1])),w=r.scale$2([],r.normalize([],[h[0],h[1],0]),this.radius),S=r.add([],h,r.scale$2([],r.sub([],r.add([],w,g),h),2));h[0]=S[0],h[1]=S[1]}return h}}function Zr(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class ia{constructor(o,h){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new F(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new zd,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),r.bindAll(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[r.window.document,"mousemove",{capture:!0}],[r.window.document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[r.window,"blur",void 0]];for(const[w,S,k]of this._listeners)w.addEventListener(S,w===r.window.document?this.handleWindowEvent:this.handleEvent,k)}destroy(){for(const[o,h,g]of this._listeners)o.removeEventListener(h,o===r.window.document?this.handleWindowEvent:this.handleEvent,g)}_addDefaultHandlers(o){const h=this._map,g=h.getCanvasContainer();this._add("mapEvent",new Ie(h,o));const w=h.boxZoom=new wi(h,o);this._add("boxZoom",w);const S=new vr,k=new Rs;h.doubleClickZoom=new kh(k,S),this._add("tapZoom",S),this._add("clickZoom",k);const I=new Ld;this._add("tapDragZoom",I);const B=h.touchPitch=new vc(h);this._add("touchPitch",B);const V=new yc(o),U=new iu(o);h.dragRotate=new Dd(o,V,U),this._add("mouseRotate",V,["mousePitch"]),this._add("mousePitch",U,["mouseRotate"]);const K=new Bl(o),tt=new Fl(h,o);h.dragPan=new rl(g,K,tt),this._add("mousePan",K),this._add("touchPan",tt,["touchZoom","touchRotate"]);const at=new Uu,ut=new jl;h.touchZoomRotate=new Ih(g,ut,at,I),this._add("touchRotate",at,["touchPan","touchZoom"]),this._add("touchZoom",ut,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ni(h));const lt=h.scrollZoom=new Id(h,this);this._add("scrollZoom",lt,["mousePan"]);const dt=h.keyboard=new Ph;this._add("keyboard",dt);for(const Y of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[Y]&&h[Y].enable(o[Y])}_add(o,h,g){this._handlers.push({handlerName:o,handler:h,allowed:g}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Wr(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,h,g){for(const w in o)if(w!==g&&(!h||h.indexOf(w)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const h=[];for(const g of o)this._el.contains(g.target)&&h.push(g);return h}handleEvent(o,h){this._updatingCamera=!0;const g=o.type==="renderFrame",w=g?void 0:o,S={needsRenderFrame:!1},k={},I={},B=o.touches?this._getMapTouches(o.touches):void 0,V=B?zt(this._el,B):g?void 0:Ot(this._el,o);for(const{handlerName:tt,handler:at,allowed:ut}of this._handlers){if(!at.isEnabled())continue;let lt;this._blockedByActive(I,ut,tt)?at.reset():at[h||o.type]&&(lt=at[h||o.type](o,V,B),this.mergeHandlerResult(S,k,lt,tt,w),lt&&lt.needsRenderFrame&&this._triggerRenderFrame()),(lt||at.isActive())&&(I[tt]=at)}const U={};for(const tt in this._previousActiveHandlers)I[tt]||(U[tt]=w);this._previousActiveHandlers=I,(Object.keys(U).length||Zr(S))&&(this._changes.push([S,k,U]),this._triggerRenderFrame()),(Object.keys(I).length||Zr(S))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:K}=S;K&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],K(this._map))}mergeHandlerResult(o,h,g,w,S){if(!g)return;r.extend(o,g);const k={handlerName:w,originalEvent:g.originalEvent||S};g.zoomDelta!==void 0&&(h.zoom=k),g.panDelta!==void 0&&(h.drag=k),g.pitchDelta!==void 0&&(h.pitch=k),g.bearingDelta!==void 0&&(h.rotate=k)}_applyChanges(){const o={},h={},g={};for(const[w,S,k]of this._changes)w.panDelta&&(o.panDelta=(o.panDelta||new r.Point(0,0))._add(w.panDelta)),w.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(o.around=w.around),w.aroundCoord!==void 0&&(o.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(o.pinchAround=w.pinchAround),w.noInertia&&(o.noInertia=w.noInertia),r.extend(h,S),r.extend(g,k);this._updateMapTransform(o,h,g),this._changes=[]}_updateMapTransform(o,h,g){const w=this._map,S=w.transform,k=st=>[st.x,st.y,st.z];if((st=>{const _t=this._eventsInProgress.drag;return _t&&!this._handlersById[_t.handlerName].isActive()})()&&!Zr(o)){const st=S.zoom;S.cameraElevationReference="sea",S.recenterOnTerrain(),S.cameraElevationReference="ground",st!==S.zoom&&this._map._update(!0)}if(S._isCameraConstrained&&w._stop(!0),!Zr(o))return void this._fireEvents(h,g,!0);let{panDelta:I,zoomDelta:B,bearingDelta:V,pitchDelta:U,around:K,aroundCoord:tt,pinchAround:at}=o;S._isCameraConstrained&&(B>0&&(B=0),S._isCameraConstrained=!1),at!==void 0&&(K=at),(B||(st=>h[st]&&!this._eventsInProgress[st])("drag"))&&K&&(this._dragOrigin=k(S.pointCoordinate3D(K)),this._trackingEllipsoid.setup(S._camera.position,this._dragOrigin)),S.cameraElevationReference="sea",w._stop(!0),K=K||w.transform.centerPoint,V&&(S.bearing+=V),U&&(S.pitch+=U),S._updateCameraState();const ut=[0,0,0];if(I)if(S.projection.name==="mercator"){const st=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(K).dir),_t=this._trackingEllipsoid.projectRay(S.screenPointToMercatorRay(K.sub(I)).dir);ut[0]=_t[0]-st[0],ut[1]=_t[1]-st[1]}else{const st=S.pointCoordinate(K);if(S.projection.name==="globe"){I=I.rotate(-S.angle);const _t=S._pixelsPerMercatorPixel/S.worldSize;ut[0]=-I.x*r.mercatorScale(r.latFromMercatorY(st.y))*_t,ut[1]=-I.y*r.mercatorScale(S.center.lat)*_t}else{const _t=S.pointCoordinate(K.sub(I));st&&_t&&(ut[0]=_t.x-st.x,ut[1]=_t.y-st.y)}}const lt=S.zoom,dt=[0,0,0];if(B){const st=k(tt||S.pointCoordinate3D(K)),_t={dir:r.normalize([],r.sub([],st,S._camera.position))};if(_t.dir[2]<0){const gt=S.zoomDeltaToMovement(st,B);r.scale$2(dt,_t.dir,gt)}}const Y=r.add(ut,ut,dt);S._translateCameraConstrained(Y),B&&Math.abs(S.zoom-lt)>1e-4&&S.recenterOnTerrain(),S.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,g,!0)}_fireEvents(o,h,g){const w=Wr(this._eventsInProgress),S=Wr(o),k={};for(const U in o){const{originalEvent:K}=o[U];this._eventsInProgress[U]||(k[`${U}start`]=K),this._eventsInProgress[U]=o[U]}!w&&S&&this._fireEvent("movestart",S.originalEvent);for(const U in k)this._fireEvent(U,k[U]);S&&this._fireEvent("move",S.originalEvent);for(const U in o){const{originalEvent:K}=o[U];this._fireEvent(U,K)}const I={};let B;for(const U in this._eventsInProgress){const{handlerName:K,originalEvent:tt}=this._eventsInProgress[U];this._handlersById[K].isActive()||(delete this._eventsInProgress[U],B=h[K]||tt,I[`${U}end`]=B)}for(const U in I)this._fireEvent(U,I[U]);const V=Wr(this._eventsInProgress);if(g&&(w||S)&&!V){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),K=tt=>tt!==0&&-this._bearingSnap<tt&&tt<this._bearingSnap;U?(K(U.bearing||this._map.getBearing())&&(U.bearing=0),this._map.easeTo(U,{originalEvent:B})):(this._map.fire(new r.Event("moveend",{originalEvent:B})),K(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new r.Event(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((o=>{this._frameId=void 0,this.handleEvent(new Wu("renderFrame",{timeStamp:o})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Gr="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class zo extends r.Evented{constructor(o,h){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,r.bindAll(["_renderFrameCallback"],this)}getCenter(){return new r.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,g){return o=r.Point.convert(o).mult(-1),this.panTo(this.transform.center,r.extend({offset:o},h),g)}panTo(o,h,g){return this.easeTo(r.extend({center:o},h),g)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,g){return this.easeTo(r.extend({zoom:o},h),g)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,g){return this.easeTo(r.extend({bearing:o},h),g)}resetNorth(o,h){return this.rotateTo(0,r.extend({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(r.extend({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=r.LngLatBounds.convert(o);const g=h&&h.bearing||0,w=h&&h.pitch||0,S=o.getNorthWest(),k=o.getSouthEast();return this._cameraForBounds(this.transform,S,k,g,w,h)}_extendCameraOptions(o){const h={top:0,bottom:0,right:0,left:0};if(typeof(o=r.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const g=o.padding;o.padding={top:g,bottom:g,right:g,left:g}}return o.padding=r.extend(h,o.padding),o}_minimumAABBFrustumDistance(o,h){const g=h.max[0]-h.min[0],w=h.max[1]-h.min[1];return g/w>o.aspect?g/(2*Math.tan(.5*o.fovX)*o.aspect):w/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,h,g,w,S,k){const I=o.clone(),B=this._extendCameraOptions(k);I.bearing=w,I.pitch=S;const V=r.LngLat.convert(h),U=r.LngLat.convert(g),K=.5*(V.lat+U.lat),tt=.5*(V.lng+U.lng),at=r.latLngToECEF(K,tt),ut=r.normalize([],at),lt=r.normalize([],r.cross([],ut,[0,1,0])),dt=r.cross([],lt,ut),Y=[lt[0],lt[1],lt[2],0,dt[0],dt[1],dt[2],0,ut[0],ut[1],ut[2],0,0,0,0,1],st=[at,r.latLngToECEF(V.lat,V.lng),r.latLngToECEF(U.lat,V.lng),r.latLngToECEF(U.lat,U.lng),r.latLngToECEF(V.lat,U.lng),r.latLngToECEF(K,V.lng),r.latLngToECEF(K,U.lng),r.latLngToECEF(V.lat,tt),r.latLngToECEF(U.lat,tt)];let _t=r.Aabb.fromPoints(st.map((ge=>[r.dot(lt,ge),r.dot(dt,ge),r.dot(ut,ge)])));const gt=r.transformMat4([],_t.center,Y);r.squaredLength(gt)===0&&r.set(gt,0,0,1),r.normalize(gt,gt),r.scale$2(gt,gt,r.GLOBE_RADIUS),I.center=r.ecefToLatLng(gt);const Mt=I.getWorldToCameraMatrix(),At=r.invert(new Float64Array(16),Mt);_t=r.Aabb.applyTransform(_t,r.multiply([],Mt,Y)),r.transformMat4(gt,gt,Mt);const kt=.5*(_t.max[2]-_t.min[2]),Zt=this._minimumAABBFrustumDistance(I,_t),Ut=r.scale$2([],[0,0,1],kt),Xt=r.add(Ut,gt,Ut),Te=Zt+(I.pitch===0?0:r.distance(gt,Xt)),Gt=I.globeCenterInViewSpace,fe=r.sub([],gt,[Gt[0],Gt[1],Gt[2]]);r.normalize(fe,fe),r.scale$2(fe,fe,Te);const te=r.add([],gt,fe);r.transformMat4(te,te,At);const Ee=r.earthRadius/r.GLOBE_RADIUS,Ht=r.length(te),se=r.mercatorZfromAltitude(Math.max(Ht*Ee-r.earthRadius,Number.EPSILON),0),be=Math.min(I.zoomFromMercatorZAdjusted(se),B.maxZoom);return be>.5*(r.GLOBE_ZOOM_THRESHOLD_MIN+r.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=be,this._cameraForBounds(I,h,g,w,S,k)):{center:I.center,zoom:be,bearing:w,pitch:S}}queryTerrainElevation(o,h){const g=this.transform.elevation;return g?(h=r.extend({},{exaggerated:!0},h),g.getAtPoint(r.MercatorCoordinate.fromLngLat(o),null,h.exaggerated)):null}_cameraForBounds(o,h,g,w,S,k){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,h,g,w,S,k);const I=o.clone(),B=this._extendCameraOptions(k),V=I.padding;I.bearing=w,I.pitch=S;const U=r.LngLat.convert(h),K=r.LngLat.convert(g),tt=new r.LngLat(U.lng,K.lat),at=new r.LngLat(K.lng,U.lat),ut=I.project(U),lt=I.project(K),dt=this.queryTerrainElevation(U),Y=this.queryTerrainElevation(K),st=this.queryTerrainElevation(tt),_t=this.queryTerrainElevation(at),gt=[[ut.x,ut.y,Math.min(dt||0,Y||0,st||0,_t||0)],[lt.x,lt.y,Math.max(dt||0,Y||0,st||0,_t||0)]];let Mt=r.Aabb.fromPoints(gt);const At=I.getWorldToCameraMatrix(),kt=r.invert(new Float64Array(16),At);Mt=r.Aabb.applyTransform(Mt,At);const Zt=r.sub([],Mt.max,Mt.min),Ut=V.left||0,Xt=V.right||0,Te=V.bottom||0,Gt=V.top||0,{left:fe,right:te,top:Ee,bottom:Ht}=B.padding,se=.5*(Ut+Xt),be=.5*(Gt+Te),ge=Math.min(I.scaleZoom(I.scale*Math.min((I.width-(Ut+Xt+fe+te))/Zt[0],(I.height-(Te+Gt+Ht+Ee))/Zt[1])),B.maxZoom),Me=I.scale/I.zoomScale(ge);Mt=new r.Aabb([Mt.min[0]-(fe+se)*Me,Mt.min[1]-(Ht+be)*Me,Mt.min[2]],[Mt.max[0]+(te+se)*Me,Mt.max[1]+(Ee+be)*Me,Mt.max[2]]);const ai=.5*Zt[2],bi=this._minimumAABBFrustumDistance(I,Mt),ei=[0,0,1,0];r.transformMat4$1(ei,ei,At),r.normalize$2(ei,ei);const li=r.scale$2([],ei,bi+ai),$i=r.add([],Mt.center,li),ji=(typeof B.offset.x=="number"&&typeof B.offset.y=="number"?new r.Point(B.offset.x,B.offset.y):r.Point.convert(B.offset)).rotate(-r.degToRad(w));Mt.center[0]-=ji.x*Me,Mt.center[1]+=ji.y*Me,r.transformMat4(Mt.center,Mt.center,kt),r.transformMat4($i,$i,kt);const oi=[Mt.center[0],Mt.center[1],$i[2]*I.pixelsPerMeter];r.scale$2(oi,oi,1/I.worldSize);const en=r.lngFromMercatorX(oi[0]),un=r.latFromMercatorY(oi[1]),mn=Math.min(I._zoomFromMercatorZ(oi[2]),B.maxZoom),hn=new r.LngLat(en,un);return I.mercatorFromTransition&&mn<.5*(r.GLOBE_ZOOM_THRESHOLD_MIN+r.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=mn,this._cameraForBounds(I,h,g,w,S,k)):{center:hn,zoom:mn,bearing:w,pitch:S}}fitBounds(o,h,g){const w=this.cameraForBounds(o,h);return this._fitInternal(w,h,g)}fitScreenCoordinates(o,h,g,w,S){const k=r.Point.convert(o),I=r.Point.convert(h),B=new r.Point(Math.min(k.x,I.x),Math.min(k.y,I.y)),V=new r.Point(Math.max(k.x,I.x),Math.max(k.y,I.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(k,I))return this;const U=this.transform.pointLocation3D(B),K=this.transform.pointLocation3D(V),tt=this.transform.pointLocation3D(new r.Point(B.x,V.y)),at=this.transform.pointLocation3D(new r.Point(V.x,B.y)),ut=[Math.min(U.lng,K.lng,tt.lng,at.lng),Math.min(U.lat,K.lat,tt.lat,at.lat)],lt=[Math.max(U.lng,K.lng,tt.lng,at.lng),Math.max(U.lat,K.lat,tt.lat,at.lat)],dt=w&&w.pitch?w.pitch:this.getPitch(),Y=this._cameraForBounds(this.transform,ut,lt,g,dt,w);return this._fitInternal(Y,w,S)}_fitInternal(o,h,g){return o?(delete(h=r.extend(o,h)).padding,h.linear?this.easeTo(h,g):this.flyTo(h,g)):this}jumpTo(o,h){this.stop();const g=o.preloadOnly?this.transform.clone():this.transform;let w=!1,S=!1,k=!1;return"zoom"in o&&g.zoom!==+o.zoom&&(w=!0,g.zoom=+o.zoom),o.center!==void 0&&(g.center=r.LngLat.convert(o.center)),"bearing"in o&&g.bearing!==+o.bearing&&(S=!0,g.bearing=+o.bearing),"pitch"in o&&g.pitch!==+o.pitch&&(k=!0,g.pitch=+o.pitch),o.padding==null||g.isPaddingEqual(o.padding)||(g.padding=o.padding),o.preloadOnly?(this._preloadTiles(g),this):(this.fire(new r.Event("movestart",h)).fire(new r.Event("move",h)),w&&this.fire(new r.Event("zoomstart",h)).fire(new r.Event("zoom",h)).fire(new r.Event("zoomend",h)),S&&this.fire(new r.Event("rotatestart",h)).fire(new r.Event("rotate",h)).fire(new r.Event("rotateend",h)),k&&this.fire(new r.Event("pitchstart",h)).fire(new r.Event("pitch",h)).fire(new r.Event("pitchend",h)),this.fire(new r.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||r.warnOnce(Gr),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,h){const g=this.transform;if(!g.projection.supportsFreeCamera)return r.warnOnce(Gr),this;this.stop();const w=g.zoom,S=g.pitch,k=g.bearing;g.setFreeCameraOptions(o);const I=w!==g.zoom,B=S!==g.pitch,V=k!==g.bearing;return this.fire(new r.Event("movestart",h)).fire(new r.Event("move",h)),I&&this.fire(new r.Event("zoomstart",h)).fire(new r.Event("zoom",h)).fire(new r.Event("zoomend",h)),V&&this.fire(new r.Event("rotatestart",h)).fire(new r.Event("rotate",h)).fire(new r.Event("rotateend",h)),B&&this.fire(new r.Event("pitchstart",h)).fire(new r.Event("pitch",h)).fire(new r.Event("pitchend",h)),this.fire(new r.Event("moveend",h)),this}easeTo(o,h){this._stop(!1,o.easeId),((o=r.extend({offset:[0,0],duration:500,easing:r.ease},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const g=this.transform,w=this.getZoom(),S=this.getBearing(),k=this.getPitch(),I=this.getPadding(),B="zoom"in o?+o.zoom:w,V="bearing"in o?this._normalizeBearing(o.bearing,S):S,U="pitch"in o?+o.pitch:k,K="padding"in o?o.padding:g.padding,tt=r.Point.convert(o.offset);let at,ut,lt;if(g.projection.name==="globe"){const Ut=r.MercatorCoordinate.fromLngLat(g.center),Xt=tt.rotate(-g.angle);Ut.x+=Xt.x/g.worldSize,Ut.y+=Xt.y/g.worldSize;const Te=Ut.toLngLat(),Gt=r.LngLat.convert(o.center||Te);this._normalizeCenter(Gt),at=g.centerPoint.add(Xt),ut=new r.Point(Ut.x,Ut.y).mult(g.worldSize),lt=new r.Point(r.mercatorXfromLng(Gt.lng),r.mercatorYfromLat(Gt.lat)).mult(g.worldSize).sub(ut)}else{at=g.centerPoint.add(tt);const Ut=g.pointLocation(at),Xt=r.LngLat.convert(o.center||Ut);this._normalizeCenter(Xt),ut=g.project(Ut),lt=g.project(Xt).sub(ut)}const dt=g.zoomScale(B-w);let Y,st;o.around&&(Y=r.LngLat.convert(o.around),st=g.locationPoint(Y));const _t=this._zooming||B!==w,gt=this._rotating||S!==V,Mt=this._pitching||U!==k,At=!g.isPaddingEqual(K),kt=Ut=>Xt=>{if(_t&&(Ut.zoom=r.number(w,B,Xt)),gt&&(Ut.bearing=r.number(S,V,Xt)),Mt&&(Ut.pitch=r.number(k,U,Xt)),At&&(Ut.interpolatePadding(I,K,Xt),at=Ut.centerPoint.add(tt)),Y)Ut.setLocationAtPoint(Y,st);else{const Te=Ut.zoomScale(Ut.zoom-w),Gt=B>w?Math.min(2,dt):Math.max(.5,dt),fe=Math.pow(Gt,1-Xt),te=Ut.unproject(ut.add(lt.mult(Xt*fe)).mult(Te));Ut.setLocationAtPoint(Ut.renderWorldCopies?te.wrap():te,at)}return o.preloadOnly||this._fireMoveEvents(h),Ut};if(o.preloadOnly){const Ut=this._emulate(kt,o.duration,g);return this._preloadTiles(Ut),this}const Zt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_t,this._rotating=gt,this._pitching=Mt,this._padding=At,this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,Zt),this._ease(kt(g),(Ut=>{g.recenterOnTerrain(),this._afterEase(h,Ut)}),o),this}_prepareEase(o,h,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||g.moving||this.fire(new r.Event("movestart",o)),this._zooming&&!g.zooming&&this.fire(new r.Event("zoomstart",o)),this._rotating&&!g.rotating&&this.fire(new r.Event("rotatestart",o)),this._pitching&&!g.pitching&&this.fire(new r.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new r.Event("move",o)),this._zooming&&this.fire(new r.Event("zoom",o)),this._rotating&&this.fire(new r.Event("rotate",o)),this._pitching&&this.fire(new r.Event("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,w=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new r.Event("zoomend",o)),w&&this.fire(new r.Event("rotateend",o)),S&&this.fire(new r.Event("pitchend",o)),this.fire(new r.Event("moveend",o))}flyTo(o,h){if(this._prefersReducedMotion(o)){const ge=r.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(ge,h)}this.stop(),o=r.extend({offset:[0,0],speed:1.2,curve:1.42,easing:r.ease},o);const g=this.transform,w=this.getZoom(),S=this.getBearing(),k=this.getPitch(),I=this.getPadding(),B="zoom"in o?r.clamp(+o.zoom,g.minZoom,g.maxZoom):w,V="bearing"in o?this._normalizeBearing(o.bearing,S):S,U="pitch"in o?+o.pitch:k,K="padding"in o?o.padding:g.padding,tt=g.zoomScale(B-w),at=r.Point.convert(o.offset);let ut=g.centerPoint.add(at);const lt=g.pointLocation(ut),dt=r.LngLat.convert(o.center||lt);this._normalizeCenter(dt);const Y=g.project(lt),st=g.project(dt).sub(Y);let _t=o.curve;const gt=Math.max(g.width,g.height),Mt=gt/tt,At=st.mag();if("minZoom"in o){const ge=r.clamp(Math.min(o.minZoom,w,B),g.minZoom,g.maxZoom),Me=gt/g.zoomScale(ge-w);_t=Math.sqrt(Me/At*2)}const kt=_t*_t;function Zt(ge){const Me=(Mt*Mt-gt*gt+(ge?-1:1)*kt*kt*At*At)/(2*(ge?Mt:gt)*kt*At);return Math.log(Math.sqrt(Me*Me+1)-Me)}function Ut(ge){return(Math.exp(ge)-Math.exp(-ge))/2}function Xt(ge){return(Math.exp(ge)+Math.exp(-ge))/2}const Te=Zt(0);let Gt=function(ge){return Xt(Te)/Xt(Te+_t*ge)},fe=function(ge){return gt*((Xt(Te)*(Ut(Me=Te+_t*ge)/Xt(Me))-Ut(Te))/kt)/At;var Me},te=(Zt(1)-Te)/_t;if(Math.abs(At)<1e-6||!isFinite(te)){if(Math.abs(gt-Mt)<1e-6)return this.easeTo(o,h);const ge=Mt<gt?-1:1;te=Math.abs(Math.log(Mt/gt))/_t,fe=function(){return 0},Gt=function(Me){return Math.exp(ge*_t*Me)}}o.duration="duration"in o?+o.duration:1e3*te/("screenSpeed"in o?+o.screenSpeed/_t:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const Ee=S!==V,Ht=U!==k,se=!g.isPaddingEqual(K),be=ge=>Me=>{const ai=Me*te,bi=1/Gt(ai);ge.zoom=Me===1?B:w+ge.scaleZoom(bi),Ee&&(ge.bearing=r.number(S,V,Me)),Ht&&(ge.pitch=r.number(k,U,Me)),se&&(ge.interpolatePadding(I,K,Me),ut=ge.centerPoint.add(at));const ei=Me===1?dt:ge.unproject(Y.add(st.mult(fe(ai))).mult(bi));return ge.setLocationAtPoint(ge.renderWorldCopies?ei.wrap():ei,ut),ge._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(h),ge};if(o.preloadOnly){const ge=this._emulate(be,o.duration,g);return this._preloadTiles(ge),this}return this._zooming=!0,this._rotating=Ee,this._pitching=Ht,this._padding=se,this._prepareEase(h,!1),this._ease(be(g),(()=>this._afterEase(h)),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,h)}if(!o){const g=this.handlers;g&&g.stop(!1)}return this}_ease(o,h,g){g.animate===!1||g.duration===0?(o(1),h()):(this._easeStart=r.exported.now(),this._easeOptions=g,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((r.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,h){o=r.wrap(o,-180,180);const g=Math.abs(o-h);return Math.abs(o-360-h)<g&&(o-=360),Math.abs(o+360-h)<g&&(o+=360),o}_normalizeCenter(o){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const g=o.lng-h.center.lng;o.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&r.exported.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,h,g){const w=Math.ceil(15*h/1e3),S=[],k=o(g.clone());for(let I=0;I<=w;I++){const B=k(I/w);S.push(B.clone())}return S}}class Je{constructor(o={}){this.options=o,r.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const h=this.options&&this.options.compact;return this._map=o,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=j("button","mapboxgl-ctrl-attrib-button",this._container),j("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=j("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,h){const g=this._map._getUIString(`AttributionControl.${h}`);o.setAttribute("aria-label",g),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",g)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||r.config.ACCESS_TOKEN}];if(o){const g=h.reduce(((w,S,k)=>(S.value&&(w+=`${S.key}=${S.value}${k<h.length-1?"&":""}`),w)),"?");o.href=`${r.config.FEEDBACK_URL}/${g}#${Do(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const h=this._map.style._sourceCaches;for(const w in h){const S=h[w];if(S.used){const k=S.getSource();k.attribution&&o.indexOf(k.attribution)<0&&o.push(k.attribution)}}o.sort(((w,S)=>w.length-S.length)),o=o.filter(((w,S)=>{for(let k=S+1;k<o.length;k++)if(o[k].indexOf(w)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const g=o.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,o.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Lh{constructor(){r.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=j("div","mapboxgl-ctrl");const h=j("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const h in o){const g=o[h].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const h=o[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Dh{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){const h=this._currentlyRunning,g=h?this._queue.concat(h):this._queue;for(const w of g)if(w.id===o)return void(w.cancelled=!0)}run(o=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const g of h)if(!g.cancelled&&(g.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function xc(m,o,h){if(m=new r.LngLat(m.lng,m.lat),o){const g=new r.LngLat(m.lng-360,m.lat),w=new r.LngLat(m.lng+360,m.lat),S=360*Math.ceil(Math.abs(m.lng-h.center.lng)/360),k=h.locationPoint(m).distSqr(o),I=o.x<0||o.y<0||o.x>h.width||o.y>h.height;h.locationPoint(g).distSqr(o)<k&&(I||Math.abs(g.lng-h.center.lng)<S)?m=g:h.locationPoint(w).distSqr(o)<k&&(I||Math.abs(w.lng-h.center.lng)<S)&&(m=w)}for(;Math.abs(m.lng-h.center.lng)>180;){const g=h.locationPoint(m);if(g.x>=0&&g.y>=0&&g.x<=h.width&&g.y<=h.height)break;m.lng>h.center.lng?m.lng-=360:m.lng+=360}return m}const Vl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ze extends r.Evented{constructor(o,h){if(super(),(o instanceof r.window.HTMLElement||h)&&(o=r.extend({element:o},h)),r.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=r.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=j("div");const w=41,S=27,k=G("svg",{display:"block",height:w*this._scale+"px",width:S*this._scale+"px",viewBox:`0 0 ${S} ${w}`},this._element),I=G("radialGradient",{id:"shadowGradient"},G("defs",{},k));G("stop",{offset:"10%","stop-opacity":.4},I),G("stop",{offset:"100%","stop-opacity":.05},I),G("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},k),G("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},k),G("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},k),G("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},k),this._offset=r.Point.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(w=>{w.preventDefault()})),this._element.addEventListener("mousedown",(w=>{w.preventDefault()}));const g=this._element.classList;for(const w in Vl)g.remove(`mapboxgl-marker-anchor-${w}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=r.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const h=o.code,g=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&g!==32&&g!==13||this.togglePopup()}_onMapClick(o){const h=o.originalEvent.target,g=this._element;this._popup&&(h===g||g.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,h=this._pos;if(!o||!h)return!1;const g=o.unproject(h),w=o.getFreeCameraOptions();if(!w.position)return!1;const S=w.position.toLngLat();return S.distanceTo(g)<.9*S.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const h=this._pos;if(!h||h.x<0||h.x>o.transform.width||h.y<0||h.y>o.transform.height)return void this._clearFadeTimer();const g=o.unproject(h);let w;o._showingGlobe()&&r.isLngLatBehindGlobe(o.transform,this._lngLat)?w=0:(w=1-o._queryFogOpacity(g),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${Vl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const o=this._pos,h=this._map,g=this.getPitchAlignment();if(!h||!o||g!=="map")return"";if(!h._showingGlobe()){const B=h.getPitch();return B?`rotateX(${B}deg)`:""}const w=r.radToDeg(r.globeTiltAtLngLat(h.transform,this._lngLat)),S=o.sub(r.globeCenterToScreenPoint(h.transform)),k=Math.abs(S.x)+Math.abs(S.y);if(k===0)return"";const I=w/k;return`rotateX(${-S.y*I}deg) rotateY(${S.x*I}deg)`}_calculateZTransform(){const o=this._pos,h=this._map;if(!h||!o)return"";let g=0;const w=this.getRotationAlignment();if(w==="map")if(h._showingGlobe()){const S=h.project(new r.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),k=h.project(new r.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(S);g=r.radToDeg(Math.atan2(k.y,k.x))-90}else g=-h.getBearing();else if(w==="horizon"){const S=r.smoothstep(4,6,h.getZoom()),k=r.globeCenterToScreenPoint(h.transform);k.y+=S*h.transform.height;const I=o.sub(k),B=r.radToDeg(Math.atan2(I.y,I.x));g=(B>90?B-270:B+90)*(1-S)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(o){r.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=xc(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),o===!0?this._updateFrameId=r.window.requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),h._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(o){return this._offset=r.Point.convert(o),this._update(),this}_onMove(o){const h=this._map;if(!h)return;const g=this._pointerdownPos,w=this._positionDelta;if(g&&w){if(!this._isDragging){const S=this._clickTolerance||h._clickTolerance;if(o.point.dist(g)<S)return;this._isDragging=!0}this._pos=o.point.sub(w),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new r.Event("dragstart"))),this.fire(new r.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new r.Event("dragend")),this._state="inactive"}_addDragHandler(o){const h=this._map,g=this._pos;h&&g&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(g),this._pointerdownPos=o.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const h=this._map;return h&&(o?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const zh={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Lf=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Oh(m=new r.Point(0,0),o="bottom"){if(typeof m=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(o){case"top":return new r.Point(0,m);case"top-left":return new r.Point(h,h);case"top-right":return new r.Point(-h,h);case"bottom":return new r.Point(0,-m);case"bottom-left":return new r.Point(h,-h);case"bottom-right":return new r.Point(-h,-h);case"left":return new r.Point(m,0);case"right":return new r.Point(-m,0)}return new r.Point(0,0)}return m instanceof r.Point||Array.isArray(m)?r.Point.convert(m):r.Point.convert(m[o]||[0,0])}class bc{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const h=r.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,h,g){this._start=this.getValue(h),this._end=o,this._startTime=h,this._endTime=h+g}}const ru={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Od={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Df={showCompass:!0,showZoom:!0,visualizePitch:!1};class ou{constructor(o,h,g=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new yc({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,g&&(this.mousePitch=new iu({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),r.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(o,h){this.mouseRotate.mousedown(o,h),this.mousePitch&&this.mousePitch.mousedown(o,h),ft()}move(o,h){const g=this.map,w=this.mouseRotate.mousemoveWindow(o,h),S=w&&w.bearingDelta;if(S&&g.setBearing(g.getBearing()+S),this.mousePitch){const k=this.mousePitch.mousemoveWindow(o,h),I=k&&k.pitchDelta;I&&g.setPitch(g.getPitch()+I)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){xt(),r.window.removeEventListener("mousemove",this.mousemove),r.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(r.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),Ot(this.element,o)),r.window.addEventListener("mousemove",this.mousemove),r.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,Ot(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=zt(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=zt(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const it={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},D={maxWidth:100,unit:"metric"},H={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},pt={version:r.version,supported:C,setRTLTextPlugin:r.setRTLTextPlugin,getRTLTextPluginStatus:r.getRTLTextPluginStatus,Map:class extends zo{constructor(m){if(r.LivePerformanceUtils.mark(r.PerformanceMarkers.create),(m=r.extend({},Od,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&r.isSafariWithAntialiasingBug(r.window)&&(m.antialias=!1,r.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ea(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._useWebGL2=m.useWebGL2,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Dh,this._domRenderTaskQueue=new Dh,this._controls=[],this._markers=[],this._popups=[],this._mapId=r.uniqueId(),this._locale=r.extend({},ru,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new bc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new r.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,typeof m.container=="string"){if(this._container=r.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof r.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&r.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),r.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),r.window!==void 0&&(r.window.addEventListener("online",this._onWindowOnline,!1),r.window.addEventListener("resize",this._onWindowResize,!1),r.window.addEventListener("orientationchange",this._onWindowResize,!1),r.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ia(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new Ol(typeof m.hash=="string"&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,r.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new Je({customAttribution:m.customAttribution})),this._logoControl=new Lh,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(o=>{this._update(o.dataType==="style"),this.fire(new r.Event(`${o.dataType}data`,o))})),this.on("dataloading",(o=>{this.fire(new r.Event(`${o.dataType}dataloading`,o))}))}_getMapId(){return this._mapId}addControl(m,o){if(o===void 0&&(o=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=m.onAdd(this);this._controls.push(m);const g=this._controlPositions[o];return o.indexOf("bottom")!==-1?g.insertBefore(h,g.firstChild):g.appendChild(h),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new r.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(m);return o>-1&&this._controls.splice(o,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new r.Event("movestart",m)).fire(new r.Event("move",m)),this.fire(new r.Event("resize",m)),o&&this.fire(new r.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(r.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new r.Event("zoomstart")).fire(new r.Event("zoom")).fire(new r.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new r.Event("pitchstart")).fire(new r.Event("pitch")).fire(new r.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?r.window.navigator.language:Array.isArray(m)?m.length===0?void 0:m.map((o=>o==="auto"?r.window.navigator.language:o)):m}setLanguage(m){const o=this._parseLanguage(m);if(!this.style||o===this._language)return this;this._language=o,this.style._reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,o=m.projection.name;let h;o==="globe"&&m.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),h=!0):o==="mercator"&&m.zoom<r.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,o){return this._updateProjection(m||o||{name:"mercator"})}_updateProjection(m){let o;if(o=m.name==="globe"&&this.transform.zoom>=r.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(r.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(r.Point.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,o,h){if(m==="mouseenter"||m==="mouseover"){let g=!1;const w=k=>{const I=o.filter((V=>this.getLayer(V))),B=I.length?this.queryRenderedFeatures(k.point,{layers:I}):[];B.length?g||(g=!0,h.call(this,new Pt(m,this,k.originalEvent,{features:B}))):g=!1},S=()=>{g=!1};return{layers:new Set(o),listener:h,delegates:{mousemove:w,mouseout:S}}}if(m==="mouseleave"||m==="mouseout"){let g=!1;const w=k=>{const I=o.filter((B=>this.getLayer(B)));(I.length?this.queryRenderedFeatures(k.point,{layers:I}):[]).length?g=!0:g&&(g=!1,h.call(this,new Pt(m,this,k.originalEvent)))},S=k=>{g&&(g=!1,h.call(this,new Pt(m,this,k.originalEvent)))};return{layers:new Set(o),listener:h,delegates:{mousemove:w,mouseout:S}}}{const g=w=>{const S=o.filter((I=>this.getLayer(I))),k=S.length?this.queryRenderedFeatures(w.point,{layers:S}):[];k.length&&(w.features=k,h.call(this,w),delete w.features)};return{layers:new Set(o),listener:h,delegates:{[m]:g}}}}on(m,o,h){if(h===void 0)return super.on(m,o);Array.isArray(o)||(o=[o]);const g=this._createDelegatedListener(m,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(g);for(const w in g.delegates)this.on(w,g.delegates[w]);return this}once(m,o,h){if(h===void 0)return super.once(m,o);Array.isArray(o)||(o=[o]);const g=this._createDelegatedListener(m,o,h);for(const w in g.delegates)this.once(w,g.delegates[w]);return this}off(m,o,h){if(h===void 0)return super.off(m,o);o=new Set(Array.isArray(o)?o:[o]);const g=(S,k)=>{if(S.size!==k.size)return!1;for(const I of S)if(!k.has(I))return!1;return!0},w=this._delegatedListeners?this._delegatedListeners[m]:void 0;return w&&(S=>{for(let k=0;k<S.length;k++){const I=S[k];if(I.listener===h&&g(I.layers,o)){for(const B in I.delegates)this.off(B,I.delegates[B]);return S.splice(k,1),this}}})(w),this}queryRenderedFeatures(m,o){return this.style?(o!==void 0||m===void 0||m instanceof r.Point||Array.isArray(m)||(o=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(m,o){return this.style.querySourceFeatures(m,o)}isPointOnSurface(m){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&r.warnOnce(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(r.Point.convert(m))}setStyle(m,o){return(o=r.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(m,o))}_getUIString(m){const o=this._locale[m];if(o==null)throw new Error(`Missing UI string '${m}'`);return o}_updateStyle(m,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new qn(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof m=="string"?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new qn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,o){if(typeof m=="string"){const h=this._requestManager.normalizeStyleURL(m),g=this._requestManager.transformRequest(h,r.ResourceType.Style);r.getJSON(g,((w,S)=>{w?this.fire(new r.ErrorEvent(w)):S&&this._updateDiff(S,o)}))}else typeof m=="object"&&this._updateDiff(m,o)}_updateDiff(m,o){try{this.style.setState(m)&&this._update(!0)}catch(h){r.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(m,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(r.warnOnce("There is no style added to the map."),!1)}addSource(m,o){return this._lazyInitEmptyStyle(),this.style.addSource(m,o),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const o in m){const h=m[o]._tiles;for(const g in h){const w=h[g];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0}addSourceType(m,o,h){this._lazyInitEmptyStyle(),this.style.addSourceType(m,o,h)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,o,{pixelRatio:h=1,sdf:g=!1,stretchX:w,stretchY:S,content:k}={}){if(this._lazyInitEmptyStyle(),o instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&o instanceof r.window.ImageBitmap){const{width:I,height:B,data:V}=r.exported.getImageData(o);this.style.addImage(m,{data:new r.RGBAImage({width:I,height:B},V),pixelRatio:h,stretchX:w,stretchY:S,content:k,sdf:g,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:B}=o,V=o;this.style.addImage(m,{data:new r.RGBAImage({width:I,height:B},new Uint8Array(V.data)),pixelRatio:h,stretchX:w,stretchY:S,content:k,sdf:g,version:0,userImage:V}),V.onAdd&&V.onAdd(this,m)}}updateImage(m,o){const h=this.style.getImage(m);if(!h)return void this.fire(new r.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=o instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&o instanceof r.window.ImageBitmap?r.exported.getImageData(o):o,{width:w,height:S}=g;w!==void 0&&S!==void 0?w===h.data.width&&S===h.data.height?(h.data.replace(g.data,!(o instanceof r.window.HTMLImageElement||r.window.ImageBitmap&&o instanceof r.window.ImageBitmap)),this.style.updateImage(m,h)):this.fire(new r.ErrorEvent(new Error(`The width and height of the updated image (${w}, ${S})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`))):this.fire(new r.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new r.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,o){r.getImage(this._requestManager.transformRequest(m,r.ResourceType.Image),((h,g)=>{o(h,g instanceof r.window.HTMLImageElement?r.exported.getImageData(g):g)}))}listImages(){return this.style.listImages()}addLayer(m,o){return this._lazyInitEmptyStyle(),this.style.addLayer(m,o),this._update(!0)}moveLayer(m,o){return this.style.moveLayer(m,o),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,o,h){return this.style.setLayerZoomRange(m,o,h),this._update(!0)}setFilter(m,o,h={}){return this.style.setFilter(m,o,h),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,o,h,g={}){return this.style.setPaintProperty(m,o,h,g),this._update(!0)}getPaintProperty(m,o){return this.style.getPaintProperty(m,o)}setLayoutProperty(m,o,h,g={}){return this.style.setLayoutProperty(m,o,h,g),this._update(!0)}getLayoutProperty(m,o){return this.style.getLayoutProperty(m,o)}setLight(m,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(r.LngLat.convert(m),this.transform):0}setFeatureState(m,o){return this.style.setFeatureState(m,o),this._update()}removeFeatureState(m,o){return this.style.removeFeatureState(m,o),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let h,g,w,S=this._container;for(;S&&(!g||!w);){const k=r.window.getComputedStyle(S).transform;k&&k!=="none"&&(h=k.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(g=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(w=h[3])),S=S.parentElement}this._containerWidth=g?Math.abs(m/g):m,this._containerHeight=w?Math.abs(o/w):o}_detectMissingCSS(){r.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&r.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=j("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=j("div","mapboxgl-canvas-container",m);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=j("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=j("div","mapboxgl-control-container",m),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((w=>{g[w]=j("div",`mapboxgl-ctrl-${w}`,h)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,o){const h=r.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(m),this._canvas.height=h*Math.ceil(o),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${o}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const o=this._markers.indexOf(m);o!==-1&&this._markers.splice(o,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const o=this._popups.indexOf(m);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const m=r.extend({},C.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._useWebGL2&&this._canvas.getContext("webgl2",m),h=o||this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);h?(this._useWebGL2&&!o&&r.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),r.storeAuthState(h,!0),this.painter=new er(h,this.transform,!!o),this.on("data",(g=>{g.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),r.exported$1.testSupport(h)):this.fire(new r.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new r.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new r.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let o;const h=this.painter.context.extTimerQuery,g=r.exported.now();if(this.listens("gpu-timing-frame")&&(o=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],r.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],r.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,B=this.transform.pitch,V=r.exported.now(),U=new r.EvaluationParameters(I,{now:V,fadeDuration:w,pitch:B,transition:this.style.getTransition()});this.style.update(U)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let S=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),S=this._updateAverageElevation(g),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):S=this._updateAverageElevation(g),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new r.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new r.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const I=r.exported.now()-g;h.endQueryEXT(h.TIME_ELAPSED_EXT,o),setTimeout((()=>{const B=h.getQueryObjectEXT(o,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(o),this.fire(new r.Event("gpu-timing-frame",{cpuTime:I,gpuTime:B})),r.window.performance.mark("frame-gpu",{startTime:g,detail:{gpuTime:B}})}),50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout((()=>{const B=this.painter.queryGpuTimers(I);this.fire(new r.Event("gpu-timing-layer",{layerTimes:B}))}),50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const B=this.painter.queryGpuTimeDeferredRender(I);this.fire(new r.Event("gpu-timing-deferred-render",{gpuTime:B}))}),50)}const k=this._sourcesDirty||this._styleDirty||this._placementDirty||S;if(k||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(S=this._updateAverageElevation(g,!0)),S)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new r.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const B=this._calculateSpeedIndex();this.fire(new r.Event("speedindexcompleted",{speedIndex:B})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,r.LivePerformanceUtils.mark(r.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&r.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const o of this._markers)m&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!m||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(m,o=!1){const h=g=>(this.transform.averageElevation=g,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);if((o||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const g=this.transform.averageElevation;let w=this.transform.sampleAverageElevation(),S=!1;this.transform.elevation&&(S=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(w)?w=0:this._averageElevationLastSampledAt=m;const k=Math.abs(g-w);if(k>1){if(this._isInitialLoad||S)return this._averageElevation.jumpTo(w),h(w);this._averageElevation.easeTo(w,m,300)}else if(k>1e-4)return this._averageElevation.jumpTo(w),h(w)}return!!this._averageElevation.isEasing(m)&&h(this._averageElevation.getValue(m))}_authenticate(){r.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(m=>{if(m&&(m.message===r.AUTH_ERR_MSG||m.status===401)){const o=this.painter.context.gl;r.storeAuthState(o,!1),this._logoControl instanceof Lh&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new r.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),r.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const h=this.painter.context.gl,g=h.createFramebuffer();function w(S){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,S,0);const k=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,k),k}return h.bindFramebuffer(h.FRAMEBUFFER,g),this._canvasPixelComparison(w(m),o.canvasCopies.map(w),o.timeStamps)}_canvasPixelComparison(m,o,h){let g=h[1]-h[0];const w=m.length/4;for(let S=0;S<o.length;S++){const k=o[S];let I=0;for(let B=0;B<k.length;B+=4)k[B]===m[B]&&k[B+1]===m[B+1]&&k[B+2]===m[B+2]&&k[B+3]===m[B+3]&&(I+=1);g+=(h[S+2]-h[S+1])*(1-I/w)}return g}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),r.window!==void 0&&(r.window.removeEventListener("resize",this._onWindowResize,!1),r.window.removeEventListener("orientationchange",this._onWindowResize,!1),r.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),r.window.removeEventListener("online",this._onWindowOnline,!1),r.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),r.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new r.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=r.exported.frame((o=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(o)})))}_preloadTiles(m){const o=this.style?Object.values(this.style._sourceCaches):[];return r.asyncAll(o,((h,g)=>h._preloadTiles(m,g)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){r.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,o){r.setCacheLimits(m,o)}get version(){return r.version}},NavigationControl:class{constructor(m){this.options=r.extend({},Df,m),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this.options.showZoom&&(r.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(o=>{this._map&&this._map.zoomIn({},{originalEvent:o})})),j("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(o=>{this._map&&this._map.zoomOut({},{originalEvent:o})})),j("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(r.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(o=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:o}):h.resetNorth({},{originalEvent:o}))})),this._compassIcon=j("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const o=m.getZoom(),h=o===m.getMaxZoom(),g=o===m.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=o)}))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ou(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,o){const h=j("button",m,this._container);return h.type="button",h.addEventListener("click",o),h}_setButtonTitle(m,o){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${o}`);m.setAttribute("aria-label",h),m.firstElementChild&&m.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends r.Evented{constructor(m){super(),this.options=r.extend({geolocation:r.window.navigator.geolocation},it,m),r.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Sa(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const o=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,m(h)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):r.window.navigator.permissions!==void 0?r.window.navigator.permissions.query({name:"geolocation"}).then((h=>o(h.state!=="denied"))).catch((()=>o())):o()}_isOutOfMapMaxBounds(m){const o=this._map.getMaxBounds(),h=m.coords;return!!o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new r.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("geolocate",m)),this._finish()}}_updateCamera(m){const o=new r.LngLat(m.coords.longitude,m.coords.latitude),h=m.coords.accuracy,g=this._map.getBearing(),w=r.extend({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(h),w,{geolocateSource:!0})}_updateMarker(m){if(m){const o=new r.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,o=r.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,h=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new r.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this._geolocateButton=j("button","mapboxgl-ctrl-geolocate",this._container),j("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){r.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=j("div","mapboxgl-user-location"),this._dotElement.appendChild(j("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(j("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ze({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=j("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ze({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new r.Event("trackuserlocationend")))}))}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return r.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new r.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new r.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new r.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{r.window.addEventListener("ondeviceorientationabsolute"in r.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};r.window.DeviceMotionEvent!==void 0&&typeof r.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((o=>{o==="granted"&&m()})).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),r.window.removeEventListener("deviceorientation",this._onDeviceOrientation),r.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Je,ScaleControl:class{constructor(m){this.options=r.extend({},D,m),this._isNumberFormatSupported=(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}})(),r.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,o=this._map,h=o._containerHeight/2,g=o._containerWidth/2-m/2,w=o.unproject([g,h]),S=o.unproject([g+m,h]),k=w.distanceTo(S);if(this.options.unit==="imperial"){const I=3.2808*k;I>5280?this._setScale(m,I/5280,"mile"):this._setScale(m,I,"foot")}else this.options.unit==="nautical"?this._setScale(m,k/1852,"nautical-mile"):k>=1e3?this._setScale(m,k/1e3,"kilometer"):this._setScale(m,k,"meter")}_setScale(m,o,h){this._map._requestDomTask((()=>{const g=(function(S){const k=Math.pow(10,`${Math.floor(S)}`.length-1);let I=S/k;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:(function(B){const V=Math.pow(10,Math.ceil(-Math.log(B)/Math.LN10));return Math.round(B*V)/V})(I),k*I})(o),w=g/o;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(g):`${g}&nbsp;${H[h]}`,this._container.style.width=m*w+"px"}))}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=j("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof r.window.HTMLElement?this._container=m.container:r.warnOnce("Full screen control 'container' must be a DOM element.")),r.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in r.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in r.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=j("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",r.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,r.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!r.window.document.fullscreenEnabled&&!r.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=j("button","mapboxgl-ctrl-fullscreen",this._controlContainer);j("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),r.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(r.window.document.fullscreenElement||r.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?r.window.document.exitFullscreen?r.window.document.exitFullscreen():r.window.document.webkitCancelFullScreen&&r.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends r.Evented{constructor(m){super(),this.options=r.extend(Object.create(zh),m),r.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new r.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new r.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=r.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(r.window.document.createTextNode(m))}setHTML(m){const o=r.window.document.createDocumentFragment(),h=r.window.document.createElement("body");let g;for(h.innerHTML=m;g=h.firstChild,g;)o.appendChild(g);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=j("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(m),this.options.closeButton){const h=this._closeButton=j("button","mapboxgl-popup-close-button",o);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let o;return this._classList.delete(m)?o=!1:(this._classList.add(m),o=!0),this._updateClassList(),o}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const o=this._map,h=this._container,g=this._pos;if(!o||!h||!g)return"bottom";const w=h.offsetWidth,S=h.offsetHeight,k=g.x<w/2,I=g.x>o.transform.width-w/2;if(g.y+m<S)return k?"top-left":I?"top-right":"top";if(g.y>o.transform.height-S){if(k)return"bottom-left";if(I)return"bottom-right"}return k?"left":I?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),m.className=o.join(" ")}_update(m){const o=this._map,h=this._content;if(!o||!this._lngLat&&!this._trackPointer||!h)return;let g=this._container;if(g||(g=this._container=j("div","mapboxgl-popup",o.getContainer()),this._tip=j("div","mapboxgl-popup-tip",g),g.appendChild(h)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=xc(this._lngLat,this._pos,o.transform)),!this._trackPointer||m){const w=this._pos=this._trackPointer&&m?m:o.project(this._lngLat),S=Oh(this.options.offset),k=this._anchor=this._getAnchor(S.y),I=Oh(this.options.offset,k),B=w.add(I).round();o._requestDomTask((()=>{this._container&&k&&(this._container.style.transform=`${Vl[k]} translate(${B.x}px,${B.y}px)`)}))}if(!this._marker&&o._showingGlobe()){const w=r.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Lf);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Ze,Style:qn,LngLat:r.LngLat,LngLatBounds:r.LngLatBounds,Point:r.Point,MercatorCoordinate:r.MercatorCoordinate,FreeCameraOptions:yr,Evented:r.Evented,config:r.config,prewarm:function(){ns().acquire($s)},clearPrewarmedResources:function(){const m=is;m&&(m.isPreloaded()&&m.numActive()===1?(m.release($s),is=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return r.config.ACCESS_TOKEN},set accessToken(m){r.config.ACCESS_TOKEN=m},get baseApiUrl(){return r.config.API_URL},set baseApiUrl(m){r.config.API_URL=m},get workerCount(){return cs.workerCount},set workerCount(m){cs.workerCount=m},get maxParallelImageRequests(){return r.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){r.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){r.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:r.exported.setNow,restoreNow:r.exported.restoreNow};return pt}));var v=d;return v}))})($_)),$_.exports}var AN=CN();const Sp=Rx(AN),PN={class:"section-card"},kN={class:"meetup-container"},IN={class:"person-header"},LN={class:"person-avatar"},DN={class:"person-info"},zN=["onClick"],ON={class:"station-selector"},RN=["onUpdate:modelValue"],BN=["value"],FN={class:"mt-4"},NN={class:"d-flex flex-wrap gap-2"},jN=["onClick"],VN={class:"map-panel mt-5"},UN={class:"map-wrapper"},$N={key:0,class:"alert alert-warning map-overlay-message mb-0"},WN={key:0,class:"map-overlay-message"},ZN={key:0,class:"text-center py-5"},GN={key:1,class:"alert alert-danger mt-4"},HN={key:2,class:"meetup-results mt-4 feature-result-animate"},qN={class:"mb-3"},XN={class:"row g-3"},KN={class:"col-md-4"},YN={class:"border rounded-3 p-3 bg-light h-100"},JN={class:"mb-2"},QN={class:"mb-0"},t6={class:"col-md-8"},e6={class:"border rounded-3 p-3"},i6={class:"fw-semibold"},n6={class:"text-muted small"},s6={class:"badge bg-warning text-dark fs-6"},r6="pk.eyJ1IjoiY2hlZWF1biIsImEiOiJja2NydG83cWMwaGJsMnBqdjR5aHc3MzdlIn0.YGTZpi7JQMquEOv9E8K_bg",o6="/sg-rail.geojson",A_=10,a6={__name:"MeetupFinder",setup(n){const{allStations:t,shortestPath:i,estimateTimeMinutes:l,summariseSegments:c}=e0();let d=0;const _=Yi([{id:++d,station:""},{id:++d,station:""}]),v=["Bishan","Dhoby Ghaut","Jurong East","Paya Lebar","City Hall","HarbourFront"],r=Yi(!1),E=Yi(""),C=Yi(null),z=Yi(null),R=Yi(null),j=Yi(!1),G=Yi(""),W=Yi("");let Q=null;const rt=new Map,ft=new Map;let xt=null;const mt=Er(()=>!j.value&&!G.value);function bt(){return _.value.length>=A_?(ee(`Maximum of ${A_} people reached.`),!1):(_.value.push({id:++d,station:""}),!0)}function Ot(de){_.value=_.value.filter(he=>he.id!==de),ae()}function zt(){_.value=[{id:++d,station:""},{id:++d,station:""}],C.value=null,E.value="",ae(),ye()}function Rt(de){const he=_.value.find(oe=>!oe.station);if(he)he.station=de,ee(`${de} assigned to Person ${_.value.indexOf(he)+1}.`);else{if(!bt())return;const Oe=_.value[_.value.length-1];Oe.station=de,ee(`${de} assigned to new Person ${_.value.length}.`)}}async function Bt(){E.value="",C.value=null;const de=_.value.map($t=>$t.station).filter(Boolean);if(de.length<2){E.value="Please provide at least two starting stations.";return}r.value=!0,await new Promise($t=>setTimeout($t,450));let he=null,oe=1/0,Oe=null;if(t.forEach($t=>{let ce=0;const Ve=[];for(const je of de){if(je===$t)continue;const Xe=i(je,$t);if(!Xe){ce=1/0;break}ce+=Xe.totalWeight,Ve.push({origin:je,path:Xe,minutes:l(Xe.totalWeight),segments:c(Xe),steps:Xe.steps})}ce<oe&&(oe=ce,he=$t,Oe=Ve)}),!he||!Oe?.length){E.value="Unable to locate a fair meet-up point for the provided stations.",r.value=!1;return}const Ue=Oe.reduce(($t,ce)=>$t+ce.minutes,0);C.value={station:he,totalMinutes:Ue,averageMinutes:Ue/Oe.length,details:Oe},r.value=!1,ye(),ee(`Suggested meeting point: ${he}`)}function Nt(de){const he=["","","","","","","","","",""];return he[(de-1)%he.length]}function ee(de){de&&(W.value=de,Q&&(clearTimeout(Q),Q=null),Q=window.setTimeout(()=>{W.value="",Q=null},3500))}function Wt(de){if(!de)return;const he=_.value.findIndex($t=>$t.station===de);if(he!==-1){_.value[he].station="",ee(`${de} removed from Person ${he+1}.`);return}const oe=_.value.findIndex($t=>!$t.station);if(oe!==-1){_.value[oe].station=de,ee(`${de} assigned to Person ${oe+1}.`);return}if(_.value.length>=A_){ee(`Cannot add ${de}; maximum of ${A_} people reached.`);return}if(!bt())return;const Ue=_.value.length-1;_.value[Ue].station=de,ee(`${de} assigned to new Person ${Ue+1}.`)}function ae(){!R.value||!j.value||(ft.forEach(de=>de.remove()),ft.clear(),_.value.forEach((de,he)=>{if(!de.station)return;const oe=rt.get(de.station.toLowerCase());if(!oe)return;const Oe=document.createElement("div");Oe.className="avatar-marker",Oe.textContent=Nt(he+1);const Ue=new Sp.Marker(Oe).setLngLat(oe.geometry.coordinates).addTo(R.value);ft.set(de.id,Ue)}))}function ye(){if(!R.value||!j.value)return;xt&&(xt.remove(),xt=null);const de=C.value?.station;if(!de)return;const he=rt.get(de.toLowerCase());if(!he)return;const oe=document.createElement("div");oe.className="meetup-marker",oe.innerHTML='<span class="material-icons">place</span>',xt=new Sp.Marker(oe).setLngLat(he.geometry.coordinates).addTo(R.value),R.value.flyTo({center:he.geometry.coordinates,zoom:13,essential:!0,speed:.8})}async function He(){R.value||!z.value||(Sp.accessToken=r6,R.value=new Sp.Map({container:z.value,style:"mapbox://styles/mapbox/streets-v11",center:[103.8475,1.3011],zoom:11,renderWorldCopies:!1,pitchWithRotate:!1,attributionControl:!1,cooperativeGestures:!0}),R.value.addControl(new Sp.NavigationControl({showCompass:!1})),R.value.on("load",async()=>{try{const de=await fetch(o6);if(!de.ok)throw new Error(`Unable to load map data (HTTP ${de.status})`);const he=await de.json();R.value.addSource("singatrain-rail",{type:"geojson",data:he}),R.value.addLayer({id:"singatrain-lines",source:"singatrain-rail",filter:["==",["geometry-type"],"LineString"],type:"line",paint:{"line-width":["interpolate",["linear"],["zoom"],10,2,16,6],"line-color":["match",["get","line_color"],"orangered","#d42e12","mediumseagreen","#009645","orange","#fa9e0d","saddlebrown","#9D5B25","darkmagenta","#9900aa","darkslateblue","#005ec4","#748477"],"line-opacity":.8},layout:{"line-cap":"round","line-join":"round"}}),R.value.addLayer({id:"singatrain-stations",source:"singatrain-rail",filter:["all",["==",["geometry-type"],"Point"],["==",["get","stop_type"],"station"]],type:"circle",paint:{"circle-radius":6,"circle-color":["match",["get","station_colors"],"red","#d42e12","green","#009645","orange","#fa9e0d","brown","#9D5B25","purple","#9900aa","blue","#005ec4","#748477"],"circle-stroke-color":"#fff","circle-stroke-width":2}}),R.value.addLayer({id:"singatrain-labels",source:"singatrain-rail",filter:["==",["get","stop_type"],"station"],type:"symbol",layout:{"text-field":["get","name"],"text-size":12,"text-anchor":"top","text-offset":[0,.8],"text-font":["DIN Pro Medium","Arial Unicode MS Bold"]},paint:{"text-color":"#2f3640","text-halo-color":"#fff","text-halo-width":1}}),he.features.filter(oe=>oe.geometry?.type==="Point"&&oe.properties?.stop_type==="station").forEach(oe=>{rt.set(oe.properties.name.toLowerCase(),oe)}),R.value.on("mouseenter","singatrain-stations",()=>{R.value&&(R.value.getCanvas().style.cursor="pointer")}),R.value.on("mouseleave","singatrain-stations",()=>{R.value&&(R.value.getCanvas().style.cursor="")}),R.value.on("click","singatrain-stations",oe=>{const Ue=oe.features?.[0]?.properties?.name;Wt(Ue)}),j.value=!0,G.value="",ae(),ye()}catch(de){console.error("Failed to load rail GeoJSON",de),G.value="Map data is unavailable right now. Please try again later."}}))}return Md(()=>{He()}),Cd(()=>{ft.forEach(de=>de.remove()),ft.clear(),xt&&(xt.remove(),xt=null),R.value&&(R.value.remove(),R.value=null),Q&&(clearTimeout(Q),Q=null)}),qr(_,()=>{ae()},{deep:!0}),qr(()=>C.value?.station,()=>{ye()}),qr(j,de=>{de&&(ae(),ye())}),(de,he)=>(Ye(),ii("section",PN,[ht("div",{class:"d-flex flex-wrap justify-content-between align-items-start gap-3 mb-4"},[he[1]||(he[1]=ht("div",null,[ht("h2",{class:"section-title mb-2"},"Meet-up Point Finder"),ht("p",{class:"text-muted mb-0"}," Enter origin stations for your group and well suggest the fairest MRT interchange, minimising total travel time for everyone. ")],-1)),ht("button",{class:"btn btn-outline-danger hover-float",type:"button",onClick:bt},[...he[0]||(he[0]=[ht("span",{class:"material-icons me-1"},"person_add",-1),sn(" Add person ",-1)])])]),ht("div",kN,[(Ye(!0),ii(an,null,gs(_.value,(oe,Oe)=>(Ye(),ii("div",{key:oe.id,class:$c(["person-card",{active:!!oe.station}])},[ht("div",IN,[ht("div",LN,Ge(Oe+1),1),ht("div",DN,[ht("h6",null,"Person "+Ge(Oe+1),1),ht("small",null,Ge(oe.station||"Choose a starting station"),1)]),_.value.length>1?(Ye(),ii("button",{key:0,class:"btn btn-sm btn-outline-danger ms-auto",type:"button",onClick:Ue=>Ot(oe.id)},[...he[2]||(he[2]=[ht("span",{class:"material-icons"},"delete",-1)])],8,zN)):cr("",!0)]),ht("div",ON,[ar(ht("select",{"onUpdate:modelValue":Ue=>oe.station=Ue,class:"form-select"},[he[3]||(he[3]=ht("option",{value:""},"-- Select station --",-1)),(Ye(!0),ii(an,null,gs(es(t),Ue=>(Ye(),ii("option",{key:Ue,value:Ue},Ge(Ue),9,BN))),128))],8,RN),[[jc,oe.station]])])],2))),128)),ht("div",{class:"meetup-actions"},[ht("button",{class:"btn btn-primary hover-float",type:"button",onClick:Bt},[...he[4]||(he[4]=[ht("span",{class:"material-icons"},"travel_explore",-1),sn(" Find optimal meet-up ",-1)])]),ht("button",{class:"btn btn-outline-danger hover-float",type:"button",onClick:zt},[...he[5]||(he[5]=[ht("span",{class:"material-icons"},"restart_alt",-1),sn(" Clear ",-1)])])])]),ht("div",FN,[he[6]||(he[6]=ht("div",{class:"text-muted mb-2"},"Quick add",-1)),ht("div",NN,[(Ye(),ii(an,null,gs(v,oe=>ht("button",{key:oe,class:"btn btn-sm btn-outline-secondary quick-station-btn",type:"button",onClick:Oe=>Rt(oe)},Ge(oe),9,jN)),64))])]),ht("div",VN,[he[8]||(he[8]=D_('<div class="d-flex flex-wrap align-items-center justify-content-between gap-3 mb-3"><div class="d-flex align-items-center gap-2"><span class="material-icons text-danger">map</span><h5 class="mb-0">Interactive MRT Network</h5></div><div class="text-muted small">Click a station to assign or remove it for the next available person.</div></div>',1)),ht("div",UN,[ht("div",{ref_key:"mapContainer",ref:z,class:"meetup-map rounded-4"},null,512),ht("div",{class:$c(["map-loading-overlay",{show:mt.value}])},[...he[7]||(he[7]=[D_('<div class="map-loading-content"><div class="capybaraloader"><div class="capybara"><div class="capy"><div class="capyhead"><div class="capyear"><div class="capyear2"></div></div><div class="capyear"><div class="capyear2"></div></div><div class="capymouth"><div class="capylips"></div><div class="capylips"></div></div><div class="capyeye"></div><div class="capyeye"></div></div><div class="capyleg"><div class="capyleg2"></div><div class="capyleg2"></div></div></div></div><div class="loader"><div class="loaderline"></div></div></div><h6 class="mt-3">Loading the rail network</h6><p class="mb-0">Map layers are stitched together in a moment.</p></div>',1)])],2),G.value?(Ye(),ii("div",$N,Ge(G.value),1)):cr("",!0)]),W.value?(Ye(),ii("div",WN,Ge(W.value),1)):cr("",!0)]),r.value?(Ye(),ii("div",ZN,[...he[9]||(he[9]=[D_('<div class="capybaraloader mx-auto"><div class="capybara"><div class="capy"><div class="capyhead"><div class="capyear"><div class="capyear2"></div></div><div class="capyear"><div class="capyear2"></div></div><div class="capymouth"><div class="capylips"></div><div class="capylips"></div></div><div class="capyeye"></div><div class="capyeye"></div></div><div class="capyleg"><div class="capyleg2"></div><div class="capyleg2"></div></div></div></div><div class="loader"><div class="loaderline"></div></div></div><p class="mt-3 text-muted">Crunching routes</p>',2)])])):cr("",!0),E.value?(Ye(),ii("div",GN,Ge(E.value),1)):cr("",!0),C.value?(Ye(),ii("div",HN,[ht("h4",qN,[he[10]||(he[10]=ht("span",{class:"material-icons align-middle me-2 text-danger"},"place",-1)),sn(" Suggested meet-up: "+Ge(C.value.station),1)]),ht("div",XN,[ht("div",KN,[ht("div",YN,[ht("p",JN,[he[11]||(he[11]=ht("strong",null,"Total travel time:",-1)),sn(" "+Ge(C.value.totalMinutes)+" minutes ",1)]),ht("p",QN,[he[12]||(he[12]=ht("strong",null,"Average per person:",-1)),sn(" "+Ge(C.value.averageMinutes.toFixed(1))+" minutes ",1)])])]),ht("div",t6,[ht("div",e6,[he[13]||(he[13]=ht("h6",{class:"text-uppercase text-muted fw-semibold mb-2"},"Individual journeys",-1)),(Ye(!0),ii(an,null,gs(C.value.details,oe=>(Ye(),ii("div",{key:oe.origin,class:"d-flex justify-content-between align-items-center border-bottom py-2"},[ht("div",null,[ht("div",i6,Ge(oe.origin),1),ht("div",n6,Ge(oe.steps.length)+" stops / "+Ge(oe.segments.length)+" segment(s) ",1)]),ht("span",s6,Ge(oe.minutes)+" min",1)]))),128))])])])])):cr("",!0)]))}},l6={class:"section-card"},c6={key:0,class:"row g-4"},u6={class:"col-lg-6"},h6={class:"border rounded-3 p-4 h-100"},d6={class:"col-lg-6"},f6={class:"border rounded-3 p-4 h-100"},p6={key:1,class:"mt-4"},m6={class:"d-flex flex-wrap justify-content-between align-items-center gap-3 mb-4"},_6={class:"mb-1"},g6={class:"text-muted mb-0"},y6={key:0},v6={class:"row g-4"},x6={class:"col-lg-6"},b6={class:"border rounded-3 p-4 h-100"},w6={class:"col-lg-6"},T6={class:"border rounded-3 p-4 h-100"},E6={key:0,class:"text-muted"},S6={key:1,class:"list-unstyled mb-3"},M6={class:"fw-semibold"},C6={class:"text-muted small"},A6=["onClick"],P6={__name:"Profile",setup(n){const{state:t,updateUser:i,removeFavorite:l,clearFavorites:c}=bm(),d=Er(()=>t.user),_=Er(()=>t.favorites),v=Er(()=>!!t.user.email),r=Yi(""),E=Yi(""),C=Yi(""),z=Yi(""),R=Yi(""),j=Yi(t.user.name),G=Yi(t.user.email);qr(d,xt=>{j.value=xt.name,G.value=xt.email},{immediate:!0});function W(){!r.value||!E.value||(i({email:r.value,name:r.value.split("@")[0],memberSince:t.user.memberSince||new Date().toLocaleDateString()}),j.value=t.user.name,G.value=t.user.email,E.value="")}function Q(){!C.value||!z.value||!R.value||(i({name:C.value,email:z.value,memberSince:new Date().toLocaleDateString()}),j.value=C.value,G.value=z.value,C.value="",z.value="",R.value="")}function rt(){i({name:j.value})}function ft(){i({name:"Guest User",email:"",memberSince:""}),j.value="Guest User",G.value=""}return(xt,mt)=>(Ye(),ii("section",l6,[mt[24]||(mt[24]=ht("h2",{class:"section-title mb-3"},"Profile & Preferences",-1)),mt[25]||(mt[25]=ht("p",{class:"text-muted"}," Manage your SingaTrain identity, preferred stations, and saved choices. Authentication is simulated locally; plug in Firebase when you are ready for production sign-ins. ",-1)),v.value?(Ye(),ii("div",p6,[ht("div",m6,[ht("div",null,[ht("h3",_6,"Welcome back, "+Ge(d.value.name||"Commuter")+" ",1),ht("p",g6,[mt[17]||(mt[17]=sn(" Signed in as ",-1)),ht("strong",null,Ge(d.value.email),1),d.value.memberSince?(Ye(),ii("span",y6,"  Member since "+Ge(d.value.memberSince),1)):cr("",!0)])]),ht("button",{class:"btn btn-outline-danger",type:"button",onClick:ft},[...mt[18]||(mt[18]=[ht("span",{class:"material-icons me-1"},"logout",-1),sn(" Sign out ",-1)])])]),ht("div",v6,[ht("div",x6,[ht("div",b6,[mt[22]||(mt[22]=ht("h4",{class:"mb-3"},"Profile details",-1)),ht("form",{onSubmit:md(rt,["prevent"])},[mt[19]||(mt[19]=ht("label",{class:"form-label",for:"profileName"},"Display name",-1)),ar(ht("input",{id:"profileName","onUpdate:modelValue":mt[5]||(mt[5]=bt=>j.value=bt),type:"text",class:"form-control mb-3"},null,512),[[zc,j.value]]),mt[20]||(mt[20]=ht("label",{class:"form-label",for:"profileEmail"},"Email",-1)),ar(ht("input",{id:"profileEmail","onUpdate:modelValue":mt[6]||(mt[6]=bt=>G.value=bt),type:"email",class:"form-control mb-4",disabled:""},null,512),[[zc,G.value]]),mt[21]||(mt[21]=ht("button",{class:"btn btn-primary w-100",type:"submit"},"Save profile",-1))],32)])]),ht("div",w6,[ht("div",T6,[mt[23]||(mt[23]=ht("h4",{class:"mb-3"},"Favourite stations",-1)),_.value.length?(Ye(),ii("ul",S6,[(Ye(!0),ii(an,null,gs(_.value,bt=>(Ye(),ii("li",{key:bt.station,class:"d-flex justify-content-between align-items-center border rounded p-2 mb-2"},[ht("div",null,[ht("div",M6,Ge(bt.label||bt.station),1),ht("div",C6,Ge(bt.station),1)]),ht("button",{class:"btn btn-sm btn-outline-danger",type:"button",onClick:Ot=>es(l)(bt.station)}," Remove ",8,A6)]))),128))])):(Ye(),ii("div",E6,"Add favourites from the Live Tracker to see them here.")),_.value.length?(Ye(),ii("button",{key:2,class:"btn btn-outline-danger w-100",type:"button",onClick:mt[7]||(mt[7]=(...bt)=>es(c)&&es(c)(...bt))}," Clear favourites ")):cr("",!0)])])])])):(Ye(),ii("div",c6,[ht("div",u6,[ht("div",h6,[mt[11]||(mt[11]=ht("h3",{class:"mb-3"},"Sign in",-1)),ht("form",{onSubmit:md(W,["prevent"])},[mt[8]||(mt[8]=ht("label",{class:"form-label",for:"loginEmail"},"Email",-1)),ar(ht("input",{id:"loginEmail","onUpdate:modelValue":mt[0]||(mt[0]=bt=>r.value=bt),type:"email",class:"form-control mb-3",required:""},null,512),[[zc,r.value]]),mt[9]||(mt[9]=ht("label",{class:"form-label",for:"loginPassword"},"Password",-1)),ar(ht("input",{id:"loginPassword","onUpdate:modelValue":mt[1]||(mt[1]=bt=>E.value=bt),type:"password",class:"form-control mb-4",required:""},null,512),[[zc,E.value]]),mt[10]||(mt[10]=ht("button",{class:"btn btn-primary w-100",type:"submit"},"Sign in",-1))],32)])]),ht("div",d6,[ht("div",f6,[mt[16]||(mt[16]=ht("h3",{class:"mb-3"},"Register",-1)),ht("form",{onSubmit:md(Q,["prevent"])},[mt[12]||(mt[12]=ht("label",{class:"form-label",for:"registerName"},"Display name",-1)),ar(ht("input",{id:"registerName","onUpdate:modelValue":mt[2]||(mt[2]=bt=>C.value=bt),type:"text",class:"form-control mb-3",required:""},null,512),[[zc,C.value]]),mt[13]||(mt[13]=ht("label",{class:"form-label",for:"registerEmail"},"Email",-1)),ar(ht("input",{id:"registerEmail","onUpdate:modelValue":mt[3]||(mt[3]=bt=>z.value=bt),type:"email",class:"form-control mb-3",required:""},null,512),[[zc,z.value]]),mt[14]||(mt[14]=ht("label",{class:"form-label",for:"registerPassword"},"Password",-1)),ar(ht("input",{id:"registerPassword","onUpdate:modelValue":mt[4]||(mt[4]=bt=>R.value=bt),type:"password",class:"form-control mb-4",required:""},null,512),[[zc,R.value]]),mt[15]||(mt[15]=ht("button",{class:"btn btn-outline-danger w-100",type:"submit"},"Create account",-1))],32)])])]))]))}},Ov={"Downtown Line":{"Towards Expo":[{code:"DT1",station:"Bukit Panjang",first:"5:30 AM",last:"11:35 PM"},{code:"DT7",station:"Sixth Avenue",first:"5:38 AM",last:"11:42 PM"},{code:"DT14",station:"Bugis",first:"5:44 AM",last:"11:55 PM"},{code:"DT21",station:"Bencoolen",first:"5:47 AM",last:"12:02 AM"},{code:"DT35",station:"Expo",first:"5:50 AM",last:"12:15 AM"}],"Towards Bukit Panjang":[{code:"DT35",station:"Expo",first:"5:32 AM",last:"11:40 PM"},{code:"DT29",station:"Bedok North",first:"5:41 AM",last:"11:52 PM"},{code:"DT20",station:"Fort Canning",first:"5:49 AM",last:"12:08 AM"},{code:"DT9",station:"Newton",first:"5:55 AM",last:"12:18 AM"},{code:"DT1",station:"Bukit Panjang",first:"6:03 AM",last:"12:33 AM"}]},"North East Line":{"Towards HarbourFront":[{code:"NE17",station:"Punggol",first:"5:36 AM",last:"11:47 PM"},{code:"NE12",station:"Serangoon",first:"5:42 AM",last:"11:59 PM"},{code:"NE7",station:"Little India",first:"5:47 AM",last:"12:08 AM"},{code:"NE3",station:"Outram Park",first:"5:53 AM",last:"12:20 AM"},{code:"NE1",station:"HarbourFront",first:"5:56 AM",last:"12:24 AM"}],"Towards Punggol Coast":[{code:"NE1",station:"HarbourFront",first:"5:34 AM",last:"11:45 PM"},{code:"NE4",station:"Chinatown",first:"5:38 AM",last:"11:53 PM"},{code:"NE10",station:"Potong Pasir",first:"5:46 AM",last:"12:05 AM"},{code:"NE14",station:"Hougang",first:"5:51 AM",last:"12:15 AM"},{code:"NE18",station:"Punggol Coast (future)",first:"",last:""}]},"North-South Line":{},"East-West Line":{},"Thomson-East Coast Line":{},"Circle Line":{},"LRT Line":{}},k6={class:"section-card"},I6={class:"row g-3 align-items-end"},L6={class:"col-md-4"},D6=["value"],z6={class:"col-md-4"},O6=["value"],R6={class:"col-md-4"},B6={class:"border rounded-3 p-3 mt-4"},F6={class:"d-flex justify-content-between align-items-center mb-3"},N6={class:"badge bg-secondary"},j6={key:0,class:"text-muted"},V6={class:"fw-semibold"},U6={class:"text-muted small"},$6={class:"text-end"},W6={class:"text-muted small"},Z6={__name:"FirstLastTrain",setup(n){const t=Object.keys(Ov),i=Yi(t[0]),l=Er(()=>Object.keys(Ov[i.value]||{})),c=Yi(""),d=Yi("");qr(l,v=>{v.includes(c.value)||(c.value=v[0]||"")},{immediate:!0});const _=Er(()=>{const v=Ov[i.value]?.[c.value]||[];if(!d.value)return v;const r=d.value.toLowerCase();return v.filter(E=>E.station.toLowerCase().includes(r)||E.code.toLowerCase().includes(r))});return(v,r)=>(Ye(),ii("section",k6,[r[8]||(r[8]=ht("h2",{class:"section-title mb-3"},"First & Last Train Timings",-1)),r[9]||(r[9]=ht("p",{class:"text-muted"},[sn(" Reference departures for selected lines and directions. Integrate with the real LTA DataMall feed by replacing the static dataset in "),ht("code",null,"src/data/trainTimings.js"),sn(". ")],-1)),ht("div",I6,[ht("div",L6,[r[3]||(r[3]=ht("label",{class:"form-label",for:"timingLine"},"Line",-1)),ar(ht("select",{id:"timingLine","onUpdate:modelValue":r[0]||(r[0]=E=>i.value=E),class:"form-select"},[(Ye(!0),ii(an,null,gs(es(t),E=>(Ye(),ii("option",{key:E,value:E},Ge(E),9,D6))),128))],512),[[jc,i.value]])]),ht("div",z6,[r[4]||(r[4]=ht("label",{class:"form-label",for:"timingDirection"},"Direction",-1)),ar(ht("select",{id:"timingDirection","onUpdate:modelValue":r[1]||(r[1]=E=>c.value=E),class:"form-select"},[(Ye(!0),ii(an,null,gs(l.value,E=>(Ye(),ii("option",{key:E,value:E},Ge(E),9,O6))),128))],512),[[jc,c.value]])]),ht("div",R6,[r[5]||(r[5]=ht("label",{class:"form-label",for:"timingSearch"},"Search station",-1)),ar(ht("input",{id:"timingSearch","onUpdate:modelValue":r[2]||(r[2]=E=>d.value=E),type:"search",class:"form-control",placeholder:"Start typing a station"},null,512),[[zc,d.value]])])]),ht("div",B6,[ht("div",F6,[ht("strong",null,Ge(i.value)+"  "+Ge(c.value),1),ht("span",N6,Ge(_.value.length)+" station(s)",1)]),_.value.length?cr("",!0):(Ye(),ii("div",j6,"No stations match your search.")),(Ye(!0),ii(an,null,gs(_.value,E=>(Ye(),ii("div",{key:E.code,class:"d-flex justify-content-between py-2 border-top"},[ht("div",null,[ht("div",V6,Ge(E.station),1),ht("div",U6,Ge(E.code),1)]),ht("div",$6,[ht("div",null,[r[6]||(r[6]=ht("strong",null,"First",-1)),sn(" "+Ge(E.first),1)]),ht("div",W6,[r[7]||(r[7]=ht("strong",null,"Last",-1)),sn(" "+Ge(E.last),1)])])]))),128))])]))}},G6={class:"container my-4"},H6={__name:"App",setup(n){const{state:t}=bm(),i={dashboard:Qw,live:_O,route:ZO,fare:SN,meetup:a6,profile:P6,firstLast:Z6},l=Er(()=>i[t.activeTab]||Qw);function c(){cx&&cx.from(".section-card",{opacity:0,y:30,duration:.45,ease:"power2.out"})}return Md(()=>{d_&&d_.init({once:!0,duration:550,easing:"ease-out"}),Kp(()=>c())}),qr(()=>t.activeTab,()=>{Kp(()=>{d_&&d_.refreshHard(),c()})}),(d,_)=>(Ye(),ii("div",null,[vo(Ez),ht("main",G6,[vo(xL,{name:"fade-slide",mode:"out-in"},{default:rS(()=>[(Ye(),zS(wI(l.value),{key:es(t).activeTab}))]),_:1})])]))}};var W_={exports:{}};/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */var q6=W_.exports,kE;function X6(){return kE||(kE=1,(function(n,t){(function(i,l){n.exports=l()})(q6,function(){const i=new Map,l={set(it,D,H){i.has(it)||i.set(it,new Map);const pt=i.get(it);pt.has(D)||pt.size===0?pt.set(D,H):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(pt.keys())[0]}.`)},get:(it,D)=>i.has(it)&&i.get(it).get(D)||null,remove(it,D){if(!i.has(it))return;const H=i.get(it);H.delete(D),H.size===0&&i.delete(it)}},c="transitionend",d=it=>(it&&window.CSS&&window.CSS.escape&&(it=it.replace(/#([^\s"#']+)/g,(D,H)=>`#${CSS.escape(H)}`)),it),_=it=>it==null?`${it}`:Object.prototype.toString.call(it).match(/\s([a-z]+)/i)[1].toLowerCase(),v=it=>{it.dispatchEvent(new Event(c))},r=it=>!(!it||typeof it!="object")&&(it.jquery!==void 0&&(it=it[0]),it.nodeType!==void 0),E=it=>r(it)?it.jquery?it[0]:it:typeof it=="string"&&it.length>0?document.querySelector(d(it)):null,C=it=>{if(!r(it)||it.getClientRects().length===0)return!1;const D=getComputedStyle(it).getPropertyValue("visibility")==="visible",H=it.closest("details:not([open])");if(!H)return D;if(H!==it){const pt=it.closest("summary");if(pt&&pt.parentNode!==H||pt===null)return!1}return D},z=it=>!it||it.nodeType!==Node.ELEMENT_NODE||!!it.classList.contains("disabled")||(it.disabled!==void 0?it.disabled:it.hasAttribute("disabled")&&it.getAttribute("disabled")!=="false"),R=it=>{if(!document.documentElement.attachShadow)return null;if(typeof it.getRootNode=="function"){const D=it.getRootNode();return D instanceof ShadowRoot?D:null}return it instanceof ShadowRoot?it:it.parentNode?R(it.parentNode):null},j=()=>{},G=it=>{it.offsetHeight},W=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,Q=[],rt=()=>document.documentElement.dir==="rtl",ft=it=>{var D;D=()=>{const H=W();if(H){const pt=it.NAME,m=H.fn[pt];H.fn[pt]=it.jQueryInterface,H.fn[pt].Constructor=it,H.fn[pt].noConflict=()=>(H.fn[pt]=m,it.jQueryInterface)}},document.readyState==="loading"?(Q.length||document.addEventListener("DOMContentLoaded",()=>{for(const H of Q)H()}),Q.push(D)):D()},xt=(it,D=[],H=it)=>typeof it=="function"?it.call(...D):H,mt=(it,D,H=!0)=>{if(!H)return void xt(it);const pt=(h=>{if(!h)return 0;let{transitionDuration:g,transitionDelay:w}=window.getComputedStyle(h);const S=Number.parseFloat(g),k=Number.parseFloat(w);return S||k?(g=g.split(",")[0],w=w.split(",")[0],1e3*(Number.parseFloat(g)+Number.parseFloat(w))):0})(D)+5;let m=!1;const o=({target:h})=>{h===D&&(m=!0,D.removeEventListener(c,o),xt(it))};D.addEventListener(c,o),setTimeout(()=>{m||v(D)},pt)},bt=(it,D,H,pt)=>{const m=it.length;let o=it.indexOf(D);return o===-1?!H&&pt?it[m-1]:it[0]:(o+=H?1:-1,pt&&(o=(o+m)%m),it[Math.max(0,Math.min(o,m-1))])},Ot=/[^.]*(?=\..*)\.|.*/,zt=/\..*/,Rt=/::\d+$/,Bt={};let Nt=1;const ee={mouseenter:"mouseover",mouseleave:"mouseout"},Wt=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ae(it,D){return D&&`${D}::${Nt++}`||it.uidEvent||Nt++}function ye(it){const D=ae(it);return it.uidEvent=D,Bt[D]=Bt[D]||{},Bt[D]}function He(it,D,H=null){return Object.values(it).find(pt=>pt.callable===D&&pt.delegationSelector===H)}function de(it,D,H){const pt=typeof D=="string",m=pt?H:D||H;let o=Ue(it);return Wt.has(o)||(o=it),[pt,m,o]}function he(it,D,H,pt,m){if(typeof D!="string"||!it)return;let[o,h,g]=de(D,H,pt);D in ee&&(h=(U=>function(K){if(!K.relatedTarget||K.relatedTarget!==K.delegateTarget&&!K.delegateTarget.contains(K.relatedTarget))return U.call(this,K)})(h));const w=ye(it),S=w[g]||(w[g]={}),k=He(S,h,o?H:null);if(k)return void(k.oneOff=k.oneOff&&m);const I=ae(h,D.replace(Ot,"")),B=o?(function(V,U,K){return function tt(at){const ut=V.querySelectorAll(U);for(let{target:lt}=at;lt&&lt!==this;lt=lt.parentNode)for(const dt of ut)if(dt===lt)return ce(at,{delegateTarget:lt}),tt.oneOff&&$t.off(V,at.type,U,K),K.apply(lt,[at])}})(it,H,h):(function(V,U){return function K(tt){return ce(tt,{delegateTarget:V}),K.oneOff&&$t.off(V,tt.type,U),U.apply(V,[tt])}})(it,h);B.delegationSelector=o?H:null,B.callable=h,B.oneOff=m,B.uidEvent=I,S[I]=B,it.addEventListener(g,B,o)}function oe(it,D,H,pt,m){const o=He(D[H],pt,m);o&&(it.removeEventListener(H,o,!!m),delete D[H][o.uidEvent])}function Oe(it,D,H,pt){const m=D[H]||{};for(const[o,h]of Object.entries(m))o.includes(pt)&&oe(it,D,H,h.callable,h.delegationSelector)}function Ue(it){return it=it.replace(zt,""),ee[it]||it}const $t={on(it,D,H,pt){he(it,D,H,pt,!1)},one(it,D,H,pt){he(it,D,H,pt,!0)},off(it,D,H,pt){if(typeof D!="string"||!it)return;const[m,o,h]=de(D,H,pt),g=h!==D,w=ye(it),S=w[h]||{},k=D.startsWith(".");if(o===void 0){if(k)for(const I of Object.keys(w))Oe(it,w,I,D.slice(1));for(const[I,B]of Object.entries(S)){const V=I.replace(Rt,"");g&&!D.includes(V)||oe(it,w,h,B.callable,B.delegationSelector)}}else{if(!Object.keys(S).length)return;oe(it,w,h,o,m?H:null)}},trigger(it,D,H){if(typeof D!="string"||!it)return null;const pt=W();let m=null,o=!0,h=!0,g=!1;D!==Ue(D)&&pt&&(m=pt.Event(D,H),pt(it).trigger(m),o=!m.isPropagationStopped(),h=!m.isImmediatePropagationStopped(),g=m.isDefaultPrevented());const w=ce(new Event(D,{bubbles:o,cancelable:!0}),H);return g&&w.preventDefault(),h&&it.dispatchEvent(w),w.defaultPrevented&&m&&m.preventDefault(),w}};function ce(it,D={}){for(const[H,pt]of Object.entries(D))try{it[H]=pt}catch{Object.defineProperty(it,H,{configurable:!0,get:()=>pt})}return it}function Ve(it){if(it==="true")return!0;if(it==="false")return!1;if(it===Number(it).toString())return Number(it);if(it===""||it==="null")return null;if(typeof it!="string")return it;try{return JSON.parse(decodeURIComponent(it))}catch{return it}}function je(it){return it.replace(/[A-Z]/g,D=>`-${D.toLowerCase()}`)}const Xe={setDataAttribute(it,D,H){it.setAttribute(`data-bs-${je(D)}`,H)},removeDataAttribute(it,D){it.removeAttribute(`data-bs-${je(D)}`)},getDataAttributes(it){if(!it)return{};const D={},H=Object.keys(it.dataset).filter(pt=>pt.startsWith("bs")&&!pt.startsWith("bsConfig"));for(const pt of H){let m=pt.replace(/^bs/,"");m=m.charAt(0).toLowerCase()+m.slice(1),D[m]=Ve(it.dataset[pt])}return D},getDataAttribute:(it,D)=>Ve(it.getAttribute(`data-bs-${je(D)}`))};class ri{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(D){return D=this._mergeConfigObj(D),D=this._configAfterMerge(D),this._typeCheckConfig(D),D}_configAfterMerge(D){return D}_mergeConfigObj(D,H){const pt=r(H)?Xe.getDataAttribute(H,"config"):{};return{...this.constructor.Default,...typeof pt=="object"?pt:{},...r(H)?Xe.getDataAttributes(H):{},...typeof D=="object"?D:{}}}_typeCheckConfig(D,H=this.constructor.DefaultType){for(const[pt,m]of Object.entries(H)){const o=D[pt],h=r(o)?"element":_(o);if(!new RegExp(m).test(h))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${pt}" provided type "${h}" but expected type "${m}".`)}}}class vi extends ri{constructor(D,H){super(),(D=E(D))&&(this._element=D,this._config=this._getConfig(H),l.set(this._element,this.constructor.DATA_KEY,this))}dispose(){l.remove(this._element,this.constructor.DATA_KEY),$t.off(this._element,this.constructor.EVENT_KEY);for(const D of Object.getOwnPropertyNames(this))this[D]=null}_queueCallback(D,H,pt=!0){mt(D,H,pt)}_getConfig(D){return D=this._mergeConfigObj(D,this._element),D=this._configAfterMerge(D),this._typeCheckConfig(D),D}static getInstance(D){return l.get(E(D),this.DATA_KEY)}static getOrCreateInstance(D,H={}){return this.getInstance(D)||new this(D,typeof H=="object"?H:null)}static get VERSION(){return"5.3.8"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(D){return`${D}${this.EVENT_KEY}`}}const Ii=it=>{let D=it.getAttribute("data-bs-target");if(!D||D==="#"){let H=it.getAttribute("href");if(!H||!H.includes("#")&&!H.startsWith("."))return null;H.includes("#")&&!H.startsWith("#")&&(H=`#${H.split("#")[1]}`),D=H&&H!=="#"?H.trim():null}return D?D.split(",").map(H=>d(H)).join(","):null},Qe={find:(it,D=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(D,it)),findOne:(it,D=document.documentElement)=>Element.prototype.querySelector.call(D,it),children:(it,D)=>[].concat(...it.children).filter(H=>H.matches(D)),parents(it,D){const H=[];let pt=it.parentNode.closest(D);for(;pt;)H.push(pt),pt=pt.parentNode.closest(D);return H},prev(it,D){let H=it.previousElementSibling;for(;H;){if(H.matches(D))return[H];H=H.previousElementSibling}return[]},next(it,D){let H=it.nextElementSibling;for(;H;){if(H.matches(D))return[H];H=H.nextElementSibling}return[]},focusableChildren(it){const D=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(H=>`${H}:not([tabindex^="-"])`).join(",");return this.find(D,it).filter(H=>!z(H)&&C(H))},getSelectorFromElement(it){const D=Ii(it);return D&&Qe.findOne(D)?D:null},getElementFromSelector(it){const D=Ii(it);return D?Qe.findOne(D):null},getMultipleElementsFromSelector(it){const D=Ii(it);return D?Qe.find(D):[]}},_n=(it,D="hide")=>{const H=`click.dismiss${it.EVENT_KEY}`,pt=it.NAME;$t.on(document,H,`[data-bs-dismiss="${pt}"]`,function(m){if(["A","AREA"].includes(this.tagName)&&m.preventDefault(),z(this))return;const o=Qe.getElementFromSelector(this)||this.closest(`.${pt}`);it.getOrCreateInstance(o)[D]()})},ls=".bs.alert",Tt=`close${ls}`,Ft=`closed${ls}`;class Jt extends vi{static get NAME(){return"alert"}close(){if($t.trigger(this._element,Tt).defaultPrevented)return;this._element.classList.remove("show");const D=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,D)}_destroyElement(){this._element.remove(),$t.trigger(this._element,Ft),this.dispose()}static jQueryInterface(D){return this.each(function(){const H=Jt.getOrCreateInstance(this);if(typeof D=="string"){if(H[D]===void 0||D.startsWith("_")||D==="constructor")throw new TypeError(`No method named "${D}"`);H[D](this)}})}}_n(Jt,"close"),ft(Jt);const Se='[data-bs-toggle="button"]';class me extends vi{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(D){return this.each(function(){const H=me.getOrCreateInstance(this);D==="toggle"&&H[D]()})}}$t.on(document,"click.bs.button.data-api",Se,it=>{it.preventDefault();const D=it.target.closest(Se);me.getOrCreateInstance(D).toggle()}),ft(me);const we=".bs.swipe",Ke=`touchstart${we}`,$e=`touchmove${we}`,Ne=`touchend${we}`,Re=`pointerdown${we}`,fi=`pointerup${we}`,ti={endCallback:null,leftCallback:null,rightCallback:null},ci={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class _i extends ri{constructor(D,H){super(),this._element=D,D&&_i.isSupported()&&(this._config=this._getConfig(H),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return ti}static get DefaultType(){return ci}static get NAME(){return"swipe"}dispose(){$t.off(this._element,we)}_start(D){this._supportPointerEvents?this._eventIsPointerPenTouch(D)&&(this._deltaX=D.clientX):this._deltaX=D.touches[0].clientX}_end(D){this._eventIsPointerPenTouch(D)&&(this._deltaX=D.clientX-this._deltaX),this._handleSwipe(),xt(this._config.endCallback)}_move(D){this._deltaX=D.touches&&D.touches.length>1?0:D.touches[0].clientX-this._deltaX}_handleSwipe(){const D=Math.abs(this._deltaX);if(D<=40)return;const H=D/this._deltaX;this._deltaX=0,H&&xt(H>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?($t.on(this._element,Re,D=>this._start(D)),$t.on(this._element,fi,D=>this._end(D)),this._element.classList.add("pointer-event")):($t.on(this._element,Ke,D=>this._start(D)),$t.on(this._element,$e,D=>this._move(D)),$t.on(this._element,Ne,D=>this._end(D)))}_eventIsPointerPenTouch(D){return this._supportPointerEvents&&(D.pointerType==="pen"||D.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Ei=".bs.carousel",Ji=".data-api",Ri="ArrowLeft",Fn="ArrowRight",Mn="next",zn="prev",Vn="left",Us="right",Mr=`slide${Ei}`,Cn=`slid${Ei}`,fs=`keydown${Ei}`,Ys=`mouseenter${Ei}`,Eo=`mouseleave${Ei}`,ec=`dragstart${Ei}`,Et=`load${Ei}${Ji}`,et=`click${Ei}${Ji}`,nt="carousel",wt="active",Lt=".active",jt=".carousel-item",Kt=Lt+jt,qt={[Ri]:Us,[Fn]:Vn},Vt={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},ne={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ae extends vi{constructor(D,H){super(D,H),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Qe.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===nt&&this.cycle()}static get Default(){return Vt}static get DefaultType(){return ne}static get NAME(){return"carousel"}next(){this._slide(Mn)}nextWhenVisible(){!document.hidden&&C(this._element)&&this.next()}prev(){this._slide(zn)}pause(){this._isSliding&&v(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?$t.one(this._element,Cn,()=>this.cycle()):this.cycle())}to(D){const H=this._getItems();if(D>H.length-1||D<0)return;if(this._isSliding)return void $t.one(this._element,Cn,()=>this.to(D));const pt=this._getItemIndex(this._getActive());if(pt===D)return;const m=D>pt?Mn:zn;this._slide(m,H[D])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(D){return D.defaultInterval=D.interval,D}_addEventListeners(){this._config.keyboard&&$t.on(this._element,fs,D=>this._keydown(D)),this._config.pause==="hover"&&($t.on(this._element,Ys,()=>this.pause()),$t.on(this._element,Eo,()=>this._maybeEnableCycle())),this._config.touch&&_i.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const H of Qe.find(".carousel-item img",this._element))$t.on(H,ec,pt=>pt.preventDefault());const D={leftCallback:()=>this._slide(this._directionToOrder(Vn)),rightCallback:()=>this._slide(this._directionToOrder(Us)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new _i(this._element,D)}_keydown(D){if(/input|textarea/i.test(D.target.tagName))return;const H=qt[D.key];H&&(D.preventDefault(),this._slide(this._directionToOrder(H)))}_getItemIndex(D){return this._getItems().indexOf(D)}_setActiveIndicatorElement(D){if(!this._indicatorsElement)return;const H=Qe.findOne(Lt,this._indicatorsElement);H.classList.remove(wt),H.removeAttribute("aria-current");const pt=Qe.findOne(`[data-bs-slide-to="${D}"]`,this._indicatorsElement);pt&&(pt.classList.add(wt),pt.setAttribute("aria-current","true"))}_updateInterval(){const D=this._activeElement||this._getActive();if(!D)return;const H=Number.parseInt(D.getAttribute("data-bs-interval"),10);this._config.interval=H||this._config.defaultInterval}_slide(D,H=null){if(this._isSliding)return;const pt=this._getActive(),m=D===Mn,o=H||bt(this._getItems(),pt,m,this._config.wrap);if(o===pt)return;const h=this._getItemIndex(o),g=I=>$t.trigger(this._element,I,{relatedTarget:o,direction:this._orderToDirection(D),from:this._getItemIndex(pt),to:h});if(g(Mr).defaultPrevented||!pt||!o)return;const w=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(h),this._activeElement=o;const S=m?"carousel-item-start":"carousel-item-end",k=m?"carousel-item-next":"carousel-item-prev";o.classList.add(k),G(o),pt.classList.add(S),o.classList.add(S),this._queueCallback(()=>{o.classList.remove(S,k),o.classList.add(wt),pt.classList.remove(wt,k,S),this._isSliding=!1,g(Cn)},pt,this._isAnimated()),w&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return Qe.findOne(Kt,this._element)}_getItems(){return Qe.find(jt,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(D){return rt()?D===Vn?zn:Mn:D===Vn?Mn:zn}_orderToDirection(D){return rt()?D===zn?Vn:Us:D===zn?Us:Vn}static jQueryInterface(D){return this.each(function(){const H=Ae.getOrCreateInstance(this,D);if(typeof D!="number"){if(typeof D=="string"){if(H[D]===void 0||D.startsWith("_")||D==="constructor")throw new TypeError(`No method named "${D}"`);H[D]()}}else H.to(D)})}}$t.on(document,et,"[data-bs-slide], [data-bs-slide-to]",function(it){const D=Qe.getElementFromSelector(this);if(!D||!D.classList.contains(nt))return;it.preventDefault();const H=Ae.getOrCreateInstance(D),pt=this.getAttribute("data-bs-slide-to");return pt?(H.to(pt),void H._maybeEnableCycle()):Xe.getDataAttribute(this,"slide")==="next"?(H.next(),void H._maybeEnableCycle()):(H.prev(),void H._maybeEnableCycle())}),$t.on(window,Et,()=>{const it=Qe.find('[data-bs-ride="carousel"]');for(const D of it)Ae.getOrCreateInstance(D)}),ft(Ae);const Be=".bs.collapse",Pe=`show${Be}`,Si=`shown${Be}`,yi=`hide${Be}`,Le=`hidden${Be}`,Mi=`click${Be}.data-api`,Bi="show",tn="collapse",An="collapsing",ps=`:scope .${tn} .${tn}`,Nn='[data-bs-toggle="collapse"]',$s={parent:null,toggle:!0},cs={parent:"(null|element)",toggle:"boolean"};class is extends vi{constructor(D,H){super(D,H),this._isTransitioning=!1,this._triggerArray=[];const pt=Qe.find(Nn);for(const m of pt){const o=Qe.getSelectorFromElement(m),h=Qe.find(o).filter(g=>g===this._element);o!==null&&h.length&&this._triggerArray.push(m)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return $s}static get DefaultType(){return cs}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let D=[];if(this._config.parent&&(D=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(m=>m!==this._element).map(m=>is.getOrCreateInstance(m,{toggle:!1}))),D.length&&D[0]._isTransitioning||$t.trigger(this._element,Pe).defaultPrevented)return;for(const m of D)m.hide();const H=this._getDimension();this._element.classList.remove(tn),this._element.classList.add(An),this._element.style[H]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const pt=`scroll${H[0].toUpperCase()+H.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(An),this._element.classList.add(tn,Bi),this._element.style[H]="",$t.trigger(this._element,Si)},this._element,!0),this._element.style[H]=`${this._element[pt]}px`}hide(){if(this._isTransitioning||!this._isShown()||$t.trigger(this._element,yi).defaultPrevented)return;const D=this._getDimension();this._element.style[D]=`${this._element.getBoundingClientRect()[D]}px`,G(this._element),this._element.classList.add(An),this._element.classList.remove(tn,Bi);for(const H of this._triggerArray){const pt=Qe.getElementFromSelector(H);pt&&!this._isShown(pt)&&this._addAriaAndCollapsedClass([H],!1)}this._isTransitioning=!0,this._element.style[D]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(An),this._element.classList.add(tn),$t.trigger(this._element,Le)},this._element,!0)}_isShown(D=this._element){return D.classList.contains(Bi)}_configAfterMerge(D){return D.toggle=!!D.toggle,D.parent=E(D.parent),D}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const D=this._getFirstLevelChildren(Nn);for(const H of D){const pt=Qe.getElementFromSelector(H);pt&&this._addAriaAndCollapsedClass([H],this._isShown(pt))}}_getFirstLevelChildren(D){const H=Qe.find(ps,this._config.parent);return Qe.find(D,this._config.parent).filter(pt=>!H.includes(pt))}_addAriaAndCollapsedClass(D,H){if(D.length)for(const pt of D)pt.classList.toggle("collapsed",!H),pt.setAttribute("aria-expanded",H)}static jQueryInterface(D){const H={};return typeof D=="string"&&/show|hide/.test(D)&&(H.toggle=!1),this.each(function(){const pt=is.getOrCreateInstance(this,H);if(typeof D=="string"){if(pt[D]===void 0)throw new TypeError(`No method named "${D}"`);pt[D]()}})}}$t.on(document,Mi,Nn,function(it){(it.target.tagName==="A"||it.delegateTarget&&it.delegateTarget.tagName==="A")&&it.preventDefault();for(const D of Qe.getMultipleElementsFromSelector(this))is.getOrCreateInstance(D,{toggle:!1}).toggle()}),ft(is);var ns="top",ur="bottom",Js="right",Ti="left",ja="auto",hr=[ns,ur,Js,Ti],So="start",Mo="end",jr="clippingParents",Vr="viewport",Vo="popper",Va="reference",dr=hr.reduce(function(it,D){return it.concat([D+"-"+So,D+"-"+Mo])},[]),Cr=[].concat(hr,[ja]).reduce(function(it,D){return it.concat([D,D+"-"+So,D+"-"+Mo])},[]),ma="beforeRead",le="read",Vi="afterRead",Li="beforeMain",Un="main",Uo="afterMain",Is="beforeWrite",Ua="write",Fi="afterWrite",gn=[ma,le,Vi,Li,Un,Uo,Is,Ua,Fi];function Fe(it){return it?(it.nodeName||"").toLowerCase():null}function mi(it){if(it==null)return window;if(it.toString()!=="[object Window]"){var D=it.ownerDocument;return D&&D.defaultView||window}return it}function hi(it){return it instanceof mi(it).Element||it instanceof Element}function On(it){return it instanceof mi(it).HTMLElement||it instanceof HTMLElement}function Ls(it){return typeof ShadowRoot<"u"&&(it instanceof mi(it).ShadowRoot||it instanceof ShadowRoot)}const xi={name:"applyStyles",enabled:!0,phase:"write",fn:function(it){var D=it.state;Object.keys(D.elements).forEach(function(H){var pt=D.styles[H]||{},m=D.attributes[H]||{},o=D.elements[H];On(o)&&Fe(o)&&(Object.assign(o.style,pt),Object.keys(m).forEach(function(h){var g=m[h];g===!1?o.removeAttribute(h):o.setAttribute(h,g===!0?"":g)}))})},effect:function(it){var D=it.state,H={popper:{position:D.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(D.elements.popper.style,H.popper),D.styles=H,D.elements.arrow&&Object.assign(D.elements.arrow.style,H.arrow),function(){Object.keys(D.elements).forEach(function(pt){var m=D.elements[pt],o=D.attributes[pt]||{},h=Object.keys(D.styles.hasOwnProperty(pt)?D.styles[pt]:H[pt]).reduce(function(g,w){return g[w]="",g},{});On(m)&&Fe(m)&&(Object.assign(m.style,h),Object.keys(o).forEach(function(g){m.removeAttribute(g)}))})}},requires:["computeStyles"]};function Ui(it){return it.split("-")[0]}var xs=Math.max,Qs=Math.min,Zn=Math.round;function on(){var it=navigator.userAgentData;return it!=null&&it.brands&&Array.isArray(it.brands)?it.brands.map(function(D){return D.brand+"/"+D.version}).join(" "):navigator.userAgent}function _a(){return!/^((?!chrome|android).)*safari/i.test(on())}function Ds(it,D,H){D===void 0&&(D=!1),H===void 0&&(H=!1);var pt=it.getBoundingClientRect(),m=1,o=1;D&&On(it)&&(m=it.offsetWidth>0&&Zn(pt.width)/it.offsetWidth||1,o=it.offsetHeight>0&&Zn(pt.height)/it.offsetHeight||1);var h=(hi(it)?mi(it):window).visualViewport,g=!_a()&&H,w=(pt.left+(g&&h?h.offsetLeft:0))/m,S=(pt.top+(g&&h?h.offsetTop:0))/o,k=pt.width/m,I=pt.height/o;return{width:k,height:I,top:S,right:w+k,bottom:S+I,left:w,x:w,y:S}}function Co(it){var D=Ds(it),H=it.offsetWidth,pt=it.offsetHeight;return Math.abs(D.width-H)<=1&&(H=D.width),Math.abs(D.height-pt)<=1&&(pt=D.height),{x:it.offsetLeft,y:it.offsetTop,width:H,height:pt}}function Ao(it,D){var H=D.getRootNode&&D.getRootNode();if(it.contains(D))return!0;if(H&&Ls(H)){var pt=D;do{if(pt&&it.isSameNode(pt))return!0;pt=pt.parentNode||pt.host}while(pt)}return!1}function fr(it){return mi(it).getComputedStyle(it)}function ic(it){return["table","td","th"].indexOf(Fe(it))>=0}function Ws(it){return((hi(it)?it.ownerDocument:it.document)||window.document).documentElement}function Po(it){return Fe(it)==="html"?it:it.assignedSlot||it.parentNode||(Ls(it)?it.host:null)||Ws(it)}function ga(it){return On(it)&&fr(it).position!=="fixed"?it.offsetParent:null}function Yr(it){for(var D=mi(it),H=ga(it);H&&ic(H)&&fr(H).position==="static";)H=ga(H);return H&&(Fe(H)==="html"||Fe(H)==="body"&&fr(H).position==="static")?D:H||(function(pt){var m=/firefox/i.test(on());if(/Trident/i.test(on())&&On(pt)&&fr(pt).position==="fixed")return null;var o=Po(pt);for(Ls(o)&&(o=o.host);On(o)&&["html","body"].indexOf(Fe(o))<0;){var h=fr(o);if(h.transform!=="none"||h.perspective!=="none"||h.contain==="paint"||["transform","perspective"].indexOf(h.willChange)!==-1||m&&h.willChange==="filter"||m&&h.filter&&h.filter!=="none")return o;o=o.parentNode}return null})(it)||D}function pi(it){return["top","bottom"].indexOf(it)>=0?"x":"y"}function Xi(it,D,H){return xs(it,Qs(D,H))}function cn(it){return Object.assign({},{top:0,right:0,bottom:0,left:0},it)}function vl(it,D){return D.reduce(function(H,pt){return H[pt]=it,H},{})}const bs={name:"arrow",enabled:!0,phase:"main",fn:function(it){var D,H=it.state,pt=it.name,m=it.options,o=H.elements.arrow,h=H.modifiersData.popperOffsets,g=Ui(H.placement),w=pi(g),S=[Ti,Js].indexOf(g)>=0?"height":"width";if(o&&h){var k=(function(gt,Mt){return cn(typeof(gt=typeof gt=="function"?gt(Object.assign({},Mt.rects,{placement:Mt.placement})):gt)!="number"?gt:vl(gt,hr))})(m.padding,H),I=Co(o),B=w==="y"?ns:Ti,V=w==="y"?ur:Js,U=H.rects.reference[S]+H.rects.reference[w]-h[w]-H.rects.popper[S],K=h[w]-H.rects.reference[w],tt=Yr(o),at=tt?w==="y"?tt.clientHeight||0:tt.clientWidth||0:0,ut=U/2-K/2,lt=k[B],dt=at-I[S]-k[V],Y=at/2-I[S]/2+ut,st=Xi(lt,Y,dt),_t=w;H.modifiersData[pt]=((D={})[_t]=st,D.centerOffset=st-Y,D)}},effect:function(it){var D=it.state,H=it.options.element,pt=H===void 0?"[data-popper-arrow]":H;pt!=null&&(typeof pt!="string"||(pt=D.elements.popper.querySelector(pt)))&&Ao(D.elements.popper,pt)&&(D.elements.arrow=pt)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function us(it){return it.split("-")[1]}var nc={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Ar(it){var D,H=it.popper,pt=it.popperRect,m=it.placement,o=it.variation,h=it.offsets,g=it.position,w=it.gpuAcceleration,S=it.adaptive,k=it.roundOffsets,I=it.isFixed,B=h.x,V=B===void 0?0:B,U=h.y,K=U===void 0?0:U,tt=typeof k=="function"?k({x:V,y:K}):{x:V,y:K};V=tt.x,K=tt.y;var at=h.hasOwnProperty("x"),ut=h.hasOwnProperty("y"),lt=Ti,dt=ns,Y=window;if(S){var st=Yr(H),_t="clientHeight",gt="clientWidth";st===mi(H)&&fr(st=Ws(H)).position!=="static"&&g==="absolute"&&(_t="scrollHeight",gt="scrollWidth"),(m===ns||(m===Ti||m===Js)&&o===Mo)&&(dt=ur,K-=(I&&st===Y&&Y.visualViewport?Y.visualViewport.height:st[_t])-pt.height,K*=w?1:-1),m!==Ti&&(m!==ns&&m!==ur||o!==Mo)||(lt=Js,V-=(I&&st===Y&&Y.visualViewport?Y.visualViewport.width:st[gt])-pt.width,V*=w?1:-1)}var Mt,At=Object.assign({position:g},S&&nc),kt=k===!0?(function(Zt,Ut){var Xt=Zt.x,Te=Zt.y,Gt=Ut.devicePixelRatio||1;return{x:Zn(Xt*Gt)/Gt||0,y:Zn(Te*Gt)/Gt||0}})({x:V,y:K},mi(H)):{x:V,y:K};return V=kt.x,K=kt.y,w?Object.assign({},At,((Mt={})[dt]=ut?"0":"",Mt[lt]=at?"0":"",Mt.transform=(Y.devicePixelRatio||1)<=1?"translate("+V+"px, "+K+"px)":"translate3d("+V+"px, "+K+"px, 0)",Mt)):Object.assign({},At,((D={})[dt]=ut?K+"px":"",D[lt]=at?V+"px":"",D.transform="",D))}const yn={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(it){var D=it.state,H=it.options,pt=H.gpuAcceleration,m=pt===void 0||pt,o=H.adaptive,h=o===void 0||o,g=H.roundOffsets,w=g===void 0||g,S={placement:Ui(D.placement),variation:us(D.placement),popper:D.elements.popper,popperRect:D.rects.popper,gpuAcceleration:m,isFixed:D.options.strategy==="fixed"};D.modifiersData.popperOffsets!=null&&(D.styles.popper=Object.assign({},D.styles.popper,Ar(Object.assign({},S,{offsets:D.modifiersData.popperOffsets,position:D.options.strategy,adaptive:h,roundOffsets:w})))),D.modifiersData.arrow!=null&&(D.styles.arrow=Object.assign({},D.styles.arrow,Ar(Object.assign({},S,{offsets:D.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:w})))),D.attributes.popper=Object.assign({},D.attributes.popper,{"data-popper-placement":D.placement})},data:{}};var Pr={passive:!0};const Gn={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(it){var D=it.state,H=it.instance,pt=it.options,m=pt.scroll,o=m===void 0||m,h=pt.resize,g=h===void 0||h,w=mi(D.elements.popper),S=[].concat(D.scrollParents.reference,D.scrollParents.popper);return o&&S.forEach(function(k){k.addEventListener("scroll",H.update,Pr)}),g&&w.addEventListener("resize",H.update,Pr),function(){o&&S.forEach(function(k){k.removeEventListener("scroll",H.update,Pr)}),g&&w.removeEventListener("resize",H.update,Pr)}},data:{}};var pr={left:"right",right:"left",bottom:"top",top:"bottom"};function Hn(it){return it.replace(/left|right|bottom|top/g,function(D){return pr[D]})}var sc={start:"end",end:"start"};function rc(it){return it.replace(/start|end/g,function(D){return sc[D]})}function kr(it){var D=mi(it);return{scrollLeft:D.pageXOffset,scrollTop:D.pageYOffset}}function Ir(it){return Ds(Ws(it)).left+kr(it).scrollLeft}function $a(it){var D=fr(it),H=D.overflow,pt=D.overflowX,m=D.overflowY;return/auto|scroll|overlay|hidden/.test(H+m+pt)}function Zc(it){return["html","body","#document"].indexOf(Fe(it))>=0?it.ownerDocument.body:On(it)&&$a(it)?it:Zc(Po(it))}function Wi(it,D){var H;D===void 0&&(D=[]);var pt=Zc(it),m=pt===((H=it.ownerDocument)==null?void 0:H.body),o=mi(pt),h=m?[o].concat(o.visualViewport||[],$a(pt)?pt:[]):pt,g=D.concat(h);return m?g:g.concat(Wi(Po(h)))}function $o(it){return Object.assign({},it,{left:it.x,top:it.y,right:it.x+it.width,bottom:it.y+it.height})}function qn(it,D,H){return D===Vr?$o((function(pt,m){var o=mi(pt),h=Ws(pt),g=o.visualViewport,w=h.clientWidth,S=h.clientHeight,k=0,I=0;if(g){w=g.width,S=g.height;var B=_a();(B||!B&&m==="fixed")&&(k=g.offsetLeft,I=g.offsetTop)}return{width:w,height:S,x:k+Ir(pt),y:I}})(it,H)):hi(D)?(function(pt,m){var o=Ds(pt,!1,m==="fixed");return o.top=o.top+pt.clientTop,o.left=o.left+pt.clientLeft,o.bottom=o.top+pt.clientHeight,o.right=o.left+pt.clientWidth,o.width=pt.clientWidth,o.height=pt.clientHeight,o.x=o.left,o.y=o.top,o})(D,H):$o((function(pt){var m,o=Ws(pt),h=kr(pt),g=(m=pt.ownerDocument)==null?void 0:m.body,w=xs(o.scrollWidth,o.clientWidth,g?g.scrollWidth:0,g?g.clientWidth:0),S=xs(o.scrollHeight,o.clientHeight,g?g.scrollHeight:0,g?g.clientHeight:0),k=-h.scrollLeft+Ir(pt),I=-h.scrollTop;return fr(g||o).direction==="rtl"&&(k+=xs(o.clientWidth,g?g.clientWidth:0)-w),{width:w,height:S,x:k,y:I}})(Ws(it)))}function Wo(it){var D,H=it.reference,pt=it.element,m=it.placement,o=m?Ui(m):null,h=m?us(m):null,g=H.x+H.width/2-pt.width/2,w=H.y+H.height/2-pt.height/2;switch(o){case ns:D={x:g,y:H.y-pt.height};break;case ur:D={x:g,y:H.y+H.height};break;case Js:D={x:H.x+H.width,y:w};break;case Ti:D={x:H.x-pt.width,y:w};break;default:D={x:H.x,y:H.y}}var S=o?pi(o):null;if(S!=null){var k=S==="y"?"height":"width";switch(h){case So:D[S]=D[S]-(H[k]/2-pt[k]/2);break;case Mo:D[S]=D[S]+(H[k]/2-pt[k]/2)}}return D}function mr(it,D){D===void 0&&(D={});var H=D,pt=H.placement,m=pt===void 0?it.placement:pt,o=H.strategy,h=o===void 0?it.strategy:o,g=H.boundary,w=g===void 0?jr:g,S=H.rootBoundary,k=S===void 0?Vr:S,I=H.elementContext,B=I===void 0?Vo:I,V=H.altBoundary,U=V!==void 0&&V,K=H.padding,tt=K===void 0?0:K,at=cn(typeof tt!="number"?tt:vl(tt,hr)),ut=B===Vo?Va:Vo,lt=it.rects.popper,dt=it.elements[U?ut:B],Y=(function(Ut,Xt,Te,Gt){var fe=Xt==="clippingParents"?(function(se){var be=Wi(Po(se)),ge=["absolute","fixed"].indexOf(fr(se).position)>=0&&On(se)?Yr(se):se;return hi(ge)?be.filter(function(Me){return hi(Me)&&Ao(Me,ge)&&Fe(Me)!=="body"}):[]})(Ut):[].concat(Xt),te=[].concat(fe,[Te]),Ee=te[0],Ht=te.reduce(function(se,be){var ge=qn(Ut,be,Gt);return se.top=xs(ge.top,se.top),se.right=Qs(ge.right,se.right),se.bottom=Qs(ge.bottom,se.bottom),se.left=xs(ge.left,se.left),se},qn(Ut,Ee,Gt));return Ht.width=Ht.right-Ht.left,Ht.height=Ht.bottom-Ht.top,Ht.x=Ht.left,Ht.y=Ht.top,Ht})(hi(dt)?dt:dt.contextElement||Ws(it.elements.popper),w,k,h),st=Ds(it.elements.reference),_t=Wo({reference:st,element:lt,placement:m}),gt=$o(Object.assign({},lt,_t)),Mt=B===Vo?gt:st,At={top:Y.top-Mt.top+at.top,bottom:Mt.bottom-Y.bottom+at.bottom,left:Y.left-Mt.left+at.left,right:Mt.right-Y.right+at.right},kt=it.modifiersData.offset;if(B===Vo&&kt){var Zt=kt[m];Object.keys(At).forEach(function(Ut){var Xt=[Js,ur].indexOf(Ut)>=0?1:-1,Te=[ns,ur].indexOf(Ut)>=0?"y":"x";At[Ut]+=Zt[Te]*Xt})}return At}function ko(it,D){D===void 0&&(D={});var H=D,pt=H.placement,m=H.boundary,o=H.rootBoundary,h=H.padding,g=H.flipVariations,w=H.allowedAutoPlacements,S=w===void 0?Cr:w,k=us(pt),I=k?g?dr:dr.filter(function(U){return us(U)===k}):hr,B=I.filter(function(U){return S.indexOf(U)>=0});B.length===0&&(B=I);var V=B.reduce(function(U,K){return U[K]=mr(it,{placement:K,boundary:m,rootBoundary:o,padding:h})[Ui(K)],U},{});return Object.keys(V).sort(function(U,K){return V[U]-V[K]})}const Zo={name:"flip",enabled:!0,phase:"main",fn:function(it){var D=it.state,H=it.options,pt=it.name;if(!D.modifiersData[pt]._skip){for(var m=H.mainAxis,o=m===void 0||m,h=H.altAxis,g=h===void 0||h,w=H.fallbackPlacements,S=H.padding,k=H.boundary,I=H.rootBoundary,B=H.altBoundary,V=H.flipVariations,U=V===void 0||V,K=H.allowedAutoPlacements,tt=D.options.placement,at=Ui(tt),ut=w||(at!==tt&&U?(function(se){if(Ui(se)===ja)return[];var be=Hn(se);return[rc(se),be,rc(be)]})(tt):[Hn(tt)]),lt=[tt].concat(ut).reduce(function(se,be){return se.concat(Ui(be)===ja?ko(D,{placement:be,boundary:k,rootBoundary:I,padding:S,flipVariations:U,allowedAutoPlacements:K}):be)},[]),dt=D.rects.reference,Y=D.rects.popper,st=new Map,_t=!0,gt=lt[0],Mt=0;Mt<lt.length;Mt++){var At=lt[Mt],kt=Ui(At),Zt=us(At)===So,Ut=[ns,ur].indexOf(kt)>=0,Xt=Ut?"width":"height",Te=mr(D,{placement:At,boundary:k,rootBoundary:I,altBoundary:B,padding:S}),Gt=Ut?Zt?Js:Ti:Zt?ur:ns;dt[Xt]>Y[Xt]&&(Gt=Hn(Gt));var fe=Hn(Gt),te=[];if(o&&te.push(Te[kt]<=0),g&&te.push(Te[Gt]<=0,Te[fe]<=0),te.every(function(se){return se})){gt=At,_t=!1;break}st.set(At,te)}if(_t)for(var Ee=function(se){var be=lt.find(function(ge){var Me=st.get(ge);if(Me)return Me.slice(0,se).every(function(ai){return ai})});if(be)return gt=be,"break"},Ht=U?3:1;Ht>0&&Ee(Ht)!=="break";Ht--);D.placement!==gt&&(D.modifiersData[pt]._skip=!0,D.placement=gt,D.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Jr(it,D,H){return H===void 0&&(H={x:0,y:0}),{top:it.top-D.height-H.y,right:it.right-D.width+H.x,bottom:it.bottom-D.height+H.y,left:it.left-D.width-H.x}}function Wa(it){return[ns,Js,ur,Ti].some(function(D){return it[D]>=0})}const ya={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(it){var D=it.state,H=it.name,pt=D.rects.reference,m=D.rects.popper,o=D.modifiersData.preventOverflow,h=mr(D,{elementContext:"reference"}),g=mr(D,{altBoundary:!0}),w=Jr(h,pt),S=Jr(g,m,o),k=Wa(w),I=Wa(S);D.modifiersData[H]={referenceClippingOffsets:w,popperEscapeOffsets:S,isReferenceHidden:k,hasPopperEscaped:I},D.attributes.popper=Object.assign({},D.attributes.popper,{"data-popper-reference-hidden":k,"data-popper-escaped":I})}},Za={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(it){var D=it.state,H=it.options,pt=it.name,m=H.offset,o=m===void 0?[0,0]:m,h=Cr.reduce(function(k,I){return k[I]=(function(B,V,U){var K=Ui(B),tt=[Ti,ns].indexOf(K)>=0?-1:1,at=typeof U=="function"?U(Object.assign({},V,{placement:B})):U,ut=at[0],lt=at[1];return ut=ut||0,lt=(lt||0)*tt,[Ti,Js].indexOf(K)>=0?{x:lt,y:ut}:{x:ut,y:lt}})(I,D.rects,o),k},{}),g=h[D.placement],w=g.x,S=g.y;D.modifiersData.popperOffsets!=null&&(D.modifiersData.popperOffsets.x+=w,D.modifiersData.popperOffsets.y+=S),D.modifiersData[pt]=h}},Ga={name:"popperOffsets",enabled:!0,phase:"read",fn:function(it){var D=it.state,H=it.name;D.modifiersData[H]=Wo({reference:D.rects.reference,element:D.rects.popper,placement:D.placement})},data:{}},xl={name:"preventOverflow",enabled:!0,phase:"main",fn:function(it){var D=it.state,H=it.options,pt=it.name,m=H.mainAxis,o=m===void 0||m,h=H.altAxis,g=h!==void 0&&h,w=H.boundary,S=H.rootBoundary,k=H.altBoundary,I=H.padding,B=H.tether,V=B===void 0||B,U=H.tetherOffset,K=U===void 0?0:U,tt=mr(D,{boundary:w,rootBoundary:S,padding:I,altBoundary:k}),at=Ui(D.placement),ut=us(D.placement),lt=!ut,dt=pi(at),Y=dt==="x"?"y":"x",st=D.modifiersData.popperOffsets,_t=D.rects.reference,gt=D.rects.popper,Mt=typeof K=="function"?K(Object.assign({},D.rects,{placement:D.placement})):K,At=typeof Mt=="number"?{mainAxis:Mt,altAxis:Mt}:Object.assign({mainAxis:0,altAxis:0},Mt),kt=D.modifiersData.offset?D.modifiersData.offset[D.placement]:null,Zt={x:0,y:0};if(st){if(o){var Ut,Xt=dt==="y"?ns:Ti,Te=dt==="y"?ur:Js,Gt=dt==="y"?"height":"width",fe=st[dt],te=fe+tt[Xt],Ee=fe-tt[Te],Ht=V?-gt[Gt]/2:0,se=ut===So?_t[Gt]:gt[Gt],be=ut===So?-gt[Gt]:-_t[Gt],ge=D.elements.arrow,Me=V&&ge?Co(ge):{width:0,height:0},ai=D.modifiersData["arrow#persistent"]?D.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},bi=ai[Xt],ei=ai[Te],li=Xi(0,_t[Gt],Me[Gt]),$i=lt?_t[Gt]/2-Ht-li-bi-At.mainAxis:se-li-bi-At.mainAxis,ji=lt?-_t[Gt]/2+Ht+li+ei+At.mainAxis:be+li+ei+At.mainAxis,oi=D.elements.arrow&&Yr(D.elements.arrow),en=oi?dt==="y"?oi.clientTop||0:oi.clientLeft||0:0,un=(Ut=kt?.[dt])!=null?Ut:0,mn=fe+ji-un,hn=Xi(V?Qs(te,fe+$i-un-en):te,fe,V?xs(Ee,mn):Ee);st[dt]=hn,Zt[dt]=hn-fe}if(g){var qs,Bs=dt==="x"?ns:Ti,ao=dt==="x"?ur:Js,ir=st[Y],vn=Y==="y"?"height":"width",dn=ir+tt[Bs],Ki=ir-tt[ao],Kn=[ns,Ti].indexOf(at)!==-1,nr=(qs=kt?.[Y])!=null?qs:0,xn=Kn?dn:ir-_t[vn]-gt[vn]-nr+At.altAxis,xr=Kn?ir+_t[vn]+gt[vn]-nr-At.altAxis:Ki,au=V&&Kn?(function(Ul,lu,Oo){var Ma=Xi(Ul,lu,Oo);return Ma>Oo?Oo:Ma})(xn,ir,xr):Xi(V?xn:dn,ir,V?xr:Ki);st[Y]=au,Zt[Y]=au-ir}D.modifiersData[pt]=Zt}},requiresIfExists:["offset"]};function Lr(it,D,H){H===void 0&&(H=!1);var pt,m,o=On(D),h=On(D)&&(function(I){var B=I.getBoundingClientRect(),V=Zn(B.width)/I.offsetWidth||1,U=Zn(B.height)/I.offsetHeight||1;return V!==1||U!==1})(D),g=Ws(D),w=Ds(it,h,H),S={scrollLeft:0,scrollTop:0},k={x:0,y:0};return(o||!o&&!H)&&((Fe(D)!=="body"||$a(g))&&(S=(pt=D)!==mi(pt)&&On(pt)?{scrollLeft:(m=pt).scrollLeft,scrollTop:m.scrollTop}:kr(pt)),On(D)?((k=Ds(D,!0)).x+=D.clientLeft,k.y+=D.clientTop):g&&(k.x=Ir(g))),{x:w.left+S.scrollLeft-k.x,y:w.top+S.scrollTop-k.y,width:w.width,height:w.height}}function Gc(it){var D=new Map,H=new Set,pt=[];function m(o){H.add(o.name),[].concat(o.requires||[],o.requiresIfExists||[]).forEach(function(h){if(!H.has(h)){var g=D.get(h);g&&m(g)}}),pt.push(o)}return it.forEach(function(o){D.set(o.name,o)}),it.forEach(function(o){H.has(o.name)||m(o)}),pt}var Go={placement:"bottom",modifiers:[],strategy:"absolute"};function Ni(){for(var it=arguments.length,D=new Array(it),H=0;H<it;H++)D[H]=arguments[H];return!D.some(function(pt){return!(pt&&typeof pt.getBoundingClientRect=="function")})}function bl(it){it===void 0&&(it={});var D=it,H=D.defaultModifiers,pt=H===void 0?[]:H,m=D.defaultOptions,o=m===void 0?Go:m;return function(h,g,w){w===void 0&&(w=o);var S,k,I={placement:"bottom",orderedModifiers:[],options:Object.assign({},Go,o),modifiersData:{},elements:{reference:h,popper:g},attributes:{},styles:{}},B=[],V=!1,U={state:I,setOptions:function(tt){var at=typeof tt=="function"?tt(I.options):tt;K(),I.options=Object.assign({},o,I.options,at),I.scrollParents={reference:hi(h)?Wi(h):h.contextElement?Wi(h.contextElement):[],popper:Wi(g)};var ut,lt,dt=(function(Y){var st=Gc(Y);return gn.reduce(function(_t,gt){return _t.concat(st.filter(function(Mt){return Mt.phase===gt}))},[])})((ut=[].concat(pt,I.options.modifiers),lt=ut.reduce(function(Y,st){var _t=Y[st.name];return Y[st.name]=_t?Object.assign({},_t,st,{options:Object.assign({},_t.options,st.options),data:Object.assign({},_t.data,st.data)}):st,Y},{}),Object.keys(lt).map(function(Y){return lt[Y]})));return I.orderedModifiers=dt.filter(function(Y){return Y.enabled}),I.orderedModifiers.forEach(function(Y){var st=Y.name,_t=Y.options,gt=_t===void 0?{}:_t,Mt=Y.effect;if(typeof Mt=="function"){var At=Mt({state:I,name:st,instance:U,options:gt});B.push(At||function(){})}}),U.update()},forceUpdate:function(){if(!V){var tt=I.elements,at=tt.reference,ut=tt.popper;if(Ni(at,ut)){I.rects={reference:Lr(at,Yr(ut),I.options.strategy==="fixed"),popper:Co(ut)},I.reset=!1,I.placement=I.options.placement,I.orderedModifiers.forEach(function(Mt){return I.modifiersData[Mt.name]=Object.assign({},Mt.data)});for(var lt=0;lt<I.orderedModifiers.length;lt++)if(I.reset!==!0){var dt=I.orderedModifiers[lt],Y=dt.fn,st=dt.options,_t=st===void 0?{}:st,gt=dt.name;typeof Y=="function"&&(I=Y({state:I,options:_t,name:gt,instance:U})||I)}else I.reset=!1,lt=-1}}},update:(S=function(){return new Promise(function(tt){U.forceUpdate(),tt(I)})},function(){return k||(k=new Promise(function(tt){Promise.resolve().then(function(){k=void 0,tt(S())})})),k}),destroy:function(){K(),V=!0}};if(!Ni(h,g))return U;function K(){B.forEach(function(tt){return tt()}),B=[]}return U.setOptions(w).then(function(tt){!V&&w.onFirstUpdate&&w.onFirstUpdate(tt)}),U}}var oc=bl(),ac=bl({defaultModifiers:[Gn,Ga,yn,xi]}),wl=bl({defaultModifiers:[Gn,Ga,yn,xi,Za,Zo,xl,bs,ya]});const lc=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Uo,afterRead:Vi,afterWrite:Fi,applyStyles:xi,arrow:bs,auto:ja,basePlacements:hr,beforeMain:Li,beforeRead:ma,beforeWrite:Is,bottom:ur,clippingParents:jr,computeStyles:yn,createPopper:wl,createPopperBase:oc,createPopperLite:ac,detectOverflow:mr,end:Mo,eventListeners:Gn,flip:Zo,hide:ya,left:Ti,main:Un,modifierPhases:gn,offset:Za,placements:Cr,popper:Vo,popperGenerator:bl,popperOffsets:Ga,preventOverflow:xl,read:le,reference:Va,right:Js,start:So,top:ns,variationPlacements:dr,viewport:Vr,write:Ua},Symbol.toStringTag,{value:"Module"})),Tl="dropdown",Dr=".bs.dropdown",Ha=".data-api",Ho="ArrowUp",Qr="ArrowDown",qo=`hide${Dr}`,El=`hidden${Dr}`,Sl=`show${Dr}`,Ur=`shown${Dr}`,cc=`click${Dr}${Ha}`,Xo=`keydown${Dr}${Ha}`,Zs=`keyup${Dr}${Ha}`,to="show",eo='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Hi=`${eo}.${to}`,io=".dropdown-menu",uc=rt()?"top-end":"top-start",Hc=rt()?"top-start":"top-end",Nu=rt()?"bottom-end":"bottom-start",Ko=rt()?"bottom-start":"bottom-end",qc=rt()?"left-start":"right-start",$r=rt()?"right-start":"left-start",qa={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},Ch={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class Xn extends vi{constructor(D,H){super(D,H),this._popper=null,this._parent=this._element.parentNode,this._menu=Qe.next(this._element,io)[0]||Qe.prev(this._element,io)[0]||Qe.findOne(io,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return qa}static get DefaultType(){return Ch}static get NAME(){return Tl}toggle(){return this._isShown()?this.hide():this.show()}show(){if(z(this._element)||this._isShown())return;const D={relatedTarget:this._element};if(!$t.trigger(this._element,Sl,D).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const H of[].concat(...document.body.children))$t.on(H,"mouseover",j);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(to),this._element.classList.add(to),$t.trigger(this._element,Ur,D)}}hide(){if(z(this._element)||!this._isShown())return;const D={relatedTarget:this._element};this._completeHide(D)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(D){if(!$t.trigger(this._element,qo,D).defaultPrevented){if("ontouchstart"in document.documentElement)for(const H of[].concat(...document.body.children))$t.off(H,"mouseover",j);this._popper&&this._popper.destroy(),this._menu.classList.remove(to),this._element.classList.remove(to),this._element.setAttribute("aria-expanded","false"),Xe.removeDataAttribute(this._menu,"popper"),$t.trigger(this._element,El,D)}}_getConfig(D){if(typeof(D=super._getConfig(D)).reference=="object"&&!r(D.reference)&&typeof D.reference.getBoundingClientRect!="function")throw new TypeError(`${Tl.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return D}_createPopper(){if(lc===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let D=this._element;this._config.reference==="parent"?D=this._parent:r(this._config.reference)?D=E(this._config.reference):typeof this._config.reference=="object"&&(D=this._config.reference);const H=this._getPopperConfig();this._popper=wl(D,this._menu,H)}_isShown(){return this._menu.classList.contains(to)}_getPlacement(){const D=this._parent;if(D.classList.contains("dropend"))return qc;if(D.classList.contains("dropstart"))return $r;if(D.classList.contains("dropup-center"))return"top";if(D.classList.contains("dropdown-center"))return"bottom";const H=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return D.classList.contains("dropup")?H?Hc:uc:H?Ko:Nu}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:D}=this._config;return typeof D=="string"?D.split(",").map(H=>Number.parseInt(H,10)):typeof D=="function"?H=>D(H,this._element):D}_getPopperConfig(){const D={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(Xe.setDataAttribute(this._menu,"popper","static"),D.modifiers=[{name:"applyStyles",enabled:!1}]),{...D,...xt(this._config.popperConfig,[void 0,D])}}_selectMenuItem({key:D,target:H}){const pt=Qe.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(m=>C(m));pt.length&&bt(pt,H,D===Qr,!pt.includes(H)).focus()}static jQueryInterface(D){return this.each(function(){const H=Xn.getOrCreateInstance(this,D);if(typeof D=="string"){if(H[D]===void 0)throw new TypeError(`No method named "${D}"`);H[D]()}})}static clearMenus(D){if(D.button===2||D.type==="keyup"&&D.key!=="Tab")return;const H=Qe.find(Hi);for(const pt of H){const m=Xn.getInstance(pt);if(!m||m._config.autoClose===!1)continue;const o=D.composedPath(),h=o.includes(m._menu);if(o.includes(m._element)||m._config.autoClose==="inside"&&!h||m._config.autoClose==="outside"&&h||m._menu.contains(D.target)&&(D.type==="keyup"&&D.key==="Tab"||/input|select|option|textarea|form/i.test(D.target.tagName)))continue;const g={relatedTarget:m._element};D.type==="click"&&(g.clickEvent=D),m._completeHide(g)}}static dataApiKeydownHandler(D){const H=/input|textarea/i.test(D.target.tagName),pt=D.key==="Escape",m=[Ho,Qr].includes(D.key);if(!m&&!pt||H&&!pt)return;D.preventDefault();const o=this.matches(eo)?this:Qe.prev(this,eo)[0]||Qe.next(this,eo)[0]||Qe.findOne(eo,D.delegateTarget.parentNode),h=Xn.getOrCreateInstance(o);if(m)return D.stopPropagation(),h.show(),void h._selectMenuItem(D);h._isShown()&&(D.stopPropagation(),h.hide(),o.focus())}}$t.on(document,Xo,eo,Xn.dataApiKeydownHandler),$t.on(document,Xo,io,Xn.dataApiKeydownHandler),$t.on(document,cc,Xn.clearMenus),$t.on(document,Zs,Xn.clearMenus),$t.on(document,cc,eo,function(it){it.preventDefault(),Xn.getOrCreateInstance(this).toggle()}),ft(Xn);const hc="backdrop",Io="show",Ml=`mousedown.bs.${hc}`,Xa={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Xc={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class Cl extends ri{constructor(D){super(),this._config=this._getConfig(D),this._isAppended=!1,this._element=null}static get Default(){return Xa}static get DefaultType(){return Xc}static get NAME(){return hc}show(D){if(!this._config.isVisible)return void xt(D);this._append();const H=this._getElement();this._config.isAnimated&&G(H),H.classList.add(Io),this._emulateAnimation(()=>{xt(D)})}hide(D){this._config.isVisible?(this._getElement().classList.remove(Io),this._emulateAnimation(()=>{this.dispose(),xt(D)})):xt(D)}dispose(){this._isAppended&&($t.off(this._element,Ml),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const D=document.createElement("div");D.className=this._config.className,this._config.isAnimated&&D.classList.add("fade"),this._element=D}return this._element}_configAfterMerge(D){return D.rootElement=E(D.rootElement),D}_append(){if(this._isAppended)return;const D=this._getElement();this._config.rootElement.append(D),$t.on(D,Ml,()=>{xt(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(D){mt(D,this._getElement(),this._config.isAnimated)}}const Yo=".bs.focustrap",_r=`focusin${Yo}`,Ka=`keydown.tab${Yo}`,Ya="backward",Al={autofocus:!0,trapElement:null},no={autofocus:"boolean",trapElement:"element"};class gr extends ri{constructor(D){super(),this._config=this._getConfig(D),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Al}static get DefaultType(){return no}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),$t.off(document,Yo),$t.on(document,_r,D=>this._handleFocusin(D)),$t.on(document,Ka,D=>this._handleKeydown(D)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,$t.off(document,Yo))}_handleFocusin(D){const{trapElement:H}=this._config;if(D.target===document||D.target===H||H.contains(D.target))return;const pt=Qe.focusableChildren(H);pt.length===0?H.focus():this._lastTabNavDirection===Ya?pt[pt.length-1].focus():pt[0].focus()}_handleKeydown(D){D.key==="Tab"&&(this._lastTabNavDirection=D.shiftKey?Ya:"forward")}}const dc=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",so=".sticky-top",Pl="padding-right",zr="margin-right";class Ja{constructor(){this._element=document.body}getWidth(){const D=document.documentElement.clientWidth;return Math.abs(window.innerWidth-D)}hide(){const D=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Pl,H=>H+D),this._setElementAttributes(dc,Pl,H=>H+D),this._setElementAttributes(so,zr,H=>H-D)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Pl),this._resetElementAttributes(dc,Pl),this._resetElementAttributes(so,zr)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(D,H,pt){const m=this.getWidth();this._applyManipulationCallback(D,o=>{if(o!==this._element&&window.innerWidth>o.clientWidth+m)return;this._saveInitialAttribute(o,H);const h=window.getComputedStyle(o).getPropertyValue(H);o.style.setProperty(H,`${pt(Number.parseFloat(h))}px`)})}_saveInitialAttribute(D,H){const pt=D.style.getPropertyValue(H);pt&&Xe.setDataAttribute(D,H,pt)}_resetElementAttributes(D,H){this._applyManipulationCallback(D,pt=>{const m=Xe.getDataAttribute(pt,H);m!==null?(Xe.removeDataAttribute(pt,H),pt.style.setProperty(H,m)):pt.style.removeProperty(H)})}_applyManipulationCallback(D,H){if(r(D))H(D);else for(const pt of Qe.find(D,this._element))H(pt)}}const Gs=".bs.modal",Qa=`hide${Gs}`,Jo=`hidePrevented${Gs}`,kl=`hidden${Gs}`,va=`show${Gs}`,tl=`shown${Gs}`,el=`resize${Gs}`,fc=`click.dismiss${Gs}`,il=`mousedown.dismiss${Gs}`,ju=`keydown.dismiss${Gs}`,xa=`click${Gs}.data-api`,Kc="modal-open",Qo="show",Yc="modal-static",Vu={backdrop:!0,focus:!0,keyboard:!0},Ah={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class zs extends vi{constructor(D,H){super(D,H),this._dialog=Qe.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new Ja,this._addEventListeners()}static get Default(){return Vu}static get DefaultType(){return Ah}static get NAME(){return"modal"}toggle(D){return this._isShown?this.hide():this.show(D)}show(D){this._isShown||this._isTransitioning||$t.trigger(this._element,va,{relatedTarget:D}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Kc),this._adjustDialog(),this._backdrop.show(()=>this._showElement(D)))}hide(){this._isShown&&!this._isTransitioning&&($t.trigger(this._element,Qa).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Qo),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){$t.off(window,Gs),$t.off(this._dialog,Gs),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new Cl({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new gr({trapElement:this._element})}_showElement(D){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const H=Qe.findOne(".modal-body",this._dialog);H&&(H.scrollTop=0),G(this._element),this._element.classList.add(Qo),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,$t.trigger(this._element,tl,{relatedTarget:D})},this._dialog,this._isAnimated())}_addEventListeners(){$t.on(this._element,ju,D=>{D.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),$t.on(window,el,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),$t.on(this._element,il,D=>{$t.one(this._element,fc,H=>{this._element===D.target&&this._element===H.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Kc),this._resetAdjustments(),this._scrollBar.reset(),$t.trigger(this._element,kl)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if($t.trigger(this._element,Jo).defaultPrevented)return;const D=this._element.scrollHeight>document.documentElement.clientHeight,H=this._element.style.overflowY;H==="hidden"||this._element.classList.contains(Yc)||(D||(this._element.style.overflowY="hidden"),this._element.classList.add(Yc),this._queueCallback(()=>{this._element.classList.remove(Yc),this._queueCallback(()=>{this._element.style.overflowY=H},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const D=this._element.scrollHeight>document.documentElement.clientHeight,H=this._scrollBar.getWidth(),pt=H>0;if(pt&&!D){const m=rt()?"paddingLeft":"paddingRight";this._element.style[m]=`${H}px`}if(!pt&&D){const m=rt()?"paddingRight":"paddingLeft";this._element.style[m]=`${H}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(D,H){return this.each(function(){const pt=zs.getOrCreateInstance(this,D);if(typeof D=="string"){if(pt[D]===void 0)throw new TypeError(`No method named "${D}"`);pt[D](H)}})}}$t.on(document,xa,'[data-bs-toggle="modal"]',function(it){const D=Qe.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&it.preventDefault(),$t.one(D,va,pt=>{pt.defaultPrevented||$t.one(D,kl,()=>{C(this)&&this.focus()})});const H=Qe.findOne(".modal.show");H&&zs.getInstance(H).hide(),zs.getOrCreateInstance(D).toggle(this)}),_n(zs),ft(zs);const Or=".bs.offcanvas",Jc=".data-api",ba=`load${Or}${Jc}`,wa="show",pc="showing",Qc="hiding",tr=".offcanvas.show",mc=`show${Or}`,ws=`shown${Or}`,nl=`hide${Or}`,_c=`hidePrevented${Or}`,ta=`hidden${Or}`,er=`resize${Or}`,Il=`click${Or}${Jc}`,Ll=`keydown.dismiss${Or}`,Zi={backdrop:!0,keyboard:!0,scroll:!1},Dl={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class yr extends vi{constructor(D,H){super(D,H),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Zi}static get DefaultType(){return Dl}static get NAME(){return"offcanvas"}toggle(D){return this._isShown?this.hide():this.show(D)}show(D){this._isShown||$t.trigger(this._element,mc,{relatedTarget:D}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new Ja().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(pc),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(wa),this._element.classList.remove(pc),$t.trigger(this._element,ws,{relatedTarget:D})},this._element,!0))}hide(){this._isShown&&($t.trigger(this._element,nl).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Qc),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(wa,Qc),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new Ja().reset(),$t.trigger(this._element,ta)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const D=!!this._config.backdrop;return new Cl({className:"offcanvas-backdrop",isVisible:D,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:D?()=>{this._config.backdrop!=="static"?this.hide():$t.trigger(this._element,_c)}:null})}_initializeFocusTrap(){return new gr({trapElement:this._element})}_addEventListeners(){$t.on(this._element,Ll,D=>{D.key==="Escape"&&(this._config.keyboard?this.hide():$t.trigger(this._element,_c))})}static jQueryInterface(D){return this.each(function(){const H=yr.getOrCreateInstance(this,D);if(typeof D=="string"){if(H[D]===void 0||D.startsWith("_")||D==="constructor")throw new TypeError(`No method named "${D}"`);H[D](this)}})}}$t.on(document,Il,'[data-bs-toggle="offcanvas"]',function(it){const D=Qe.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&it.preventDefault(),z(this))return;$t.one(D,ta,()=>{C(this)&&this.focus()});const H=Qe.findOne(tr);H&&H!==D&&yr.getInstance(H).hide(),yr.getOrCreateInstance(D).toggle(this)}),$t.on(window,ba,()=>{for(const it of Qe.find(tr))yr.getOrCreateInstance(it).show()}),$t.on(window,er,()=>{for(const it of Qe.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(it).position!=="fixed"&&yr.getOrCreateInstance(it).hide()}),_n(yr),ft(yr);const Lo={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Ta=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),tu=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,gc=(it,D)=>{const H=it.nodeName.toLowerCase();return D.includes(H)?!Ta.has(H)||!!tu.test(it.nodeValue):D.filter(pt=>pt instanceof RegExp).some(pt=>pt.test(H))},ro={allowList:Lo,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},eu={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},zl={entry:"(string|element|function|null)",selector:"(string|element)"};class Ea extends ri{constructor(D){super(),this._config=this._getConfig(D)}static get Default(){return ro}static get DefaultType(){return eu}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(D=>this._resolvePossibleFunction(D)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(D){return this._checkContent(D),this._config.content={...this._config.content,...D},this}toHtml(){const D=document.createElement("div");D.innerHTML=this._maybeSanitize(this._config.template);for(const[m,o]of Object.entries(this._config.content))this._setContent(D,o,m);const H=D.children[0],pt=this._resolvePossibleFunction(this._config.extraClass);return pt&&H.classList.add(...pt.split(" ")),H}_typeCheckConfig(D){super._typeCheckConfig(D),this._checkContent(D.content)}_checkContent(D){for(const[H,pt]of Object.entries(D))super._typeCheckConfig({selector:H,entry:pt},zl)}_setContent(D,H,pt){const m=Qe.findOne(pt,D);m&&((H=this._resolvePossibleFunction(H))?r(H)?this._putElementInTemplate(E(H),m):this._config.html?m.innerHTML=this._maybeSanitize(H):m.textContent=H:m.remove())}_maybeSanitize(D){return this._config.sanitize?(function(H,pt,m){if(!H.length)return H;if(m&&typeof m=="function")return m(H);const o=new window.DOMParser().parseFromString(H,"text/html"),h=[].concat(...o.body.querySelectorAll("*"));for(const g of h){const w=g.nodeName.toLowerCase();if(!Object.keys(pt).includes(w)){g.remove();continue}const S=[].concat(...g.attributes),k=[].concat(pt["*"]||[],pt[w]||[]);for(const I of S)gc(I,k)||g.removeAttribute(I.nodeName)}return o.body.innerHTML})(D,this._config.allowList,this._config.sanitizeFn):D}_resolvePossibleFunction(D){return xt(D,[void 0,this])}_putElementInTemplate(D,H){if(this._config.html)return H.innerHTML="",void H.append(D);H.textContent=D.textContent}}const Sa=new Set(["sanitize","allowList","sanitizeFn"]),Ol="fade",Do="show",sl=".tooltip-inner",Rl=".modal",f="hide.bs.modal",x="hover",A="focus",F="click",q={AUTO:"auto",TOP:"top",RIGHT:rt()?"left":"right",BOTTOM:"bottom",LEFT:rt()?"right":"left"},ot={allowList:Lo,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Pt={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Yt extends vi{constructor(D,H){if(lc===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(D,H),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return ot}static get DefaultType(){return Pt}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),$t.off(this._element.closest(Rl),f,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const D=$t.trigger(this._element,this.constructor.eventName("show")),H=(R(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(D.defaultPrevented||!H)return;this._disposePopper();const pt=this._getTipElement();this._element.setAttribute("aria-describedby",pt.getAttribute("id"));const{container:m}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(m.append(pt),$t.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(pt),pt.classList.add(Do),"ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))$t.on(o,"mouseover",j);this._queueCallback(()=>{$t.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!$t.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(Do),"ontouchstart"in document.documentElement)for(const D of[].concat(...document.body.children))$t.off(D,"mouseover",j);this._activeTrigger[F]=!1,this._activeTrigger[A]=!1,this._activeTrigger[x]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),$t.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(D){const H=this._getTemplateFactory(D).toHtml();if(!H)return null;H.classList.remove(Ol,Do),H.classList.add(`bs-${this.constructor.NAME}-auto`);const pt=(m=>{do m+=Math.floor(1e6*Math.random());while(document.getElementById(m));return m})(this.constructor.NAME).toString();return H.setAttribute("id",pt),this._isAnimated()&&H.classList.add(Ol),H}setContent(D){this._newContent=D,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(D){return this._templateFactory?this._templateFactory.changeContent(D):this._templateFactory=new Ea({...this._config,content:D,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[sl]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(D){return this.constructor.getOrCreateInstance(D.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Ol)}_isShown(){return this.tip&&this.tip.classList.contains(Do)}_createPopper(D){const H=xt(this._config.placement,[this,D,this._element]),pt=q[H.toUpperCase()];return wl(this._element,D,this._getPopperConfig(pt))}_getOffset(){const{offset:D}=this._config;return typeof D=="string"?D.split(",").map(H=>Number.parseInt(H,10)):typeof D=="function"?H=>D(H,this._element):D}_resolvePossibleFunction(D){return xt(D,[this._element,this._element])}_getPopperConfig(D){const H={placement:D,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:pt=>{this._getTipElement().setAttribute("data-popper-placement",pt.state.placement)}}]};return{...H,...xt(this._config.popperConfig,[void 0,H])}}_setListeners(){const D=this._config.trigger.split(" ");for(const H of D)if(H==="click")$t.on(this._element,this.constructor.eventName("click"),this._config.selector,pt=>{const m=this._initializeOnDelegatedTarget(pt);m._activeTrigger[F]=!(m._isShown()&&m._activeTrigger[F]),m.toggle()});else if(H!=="manual"){const pt=H===x?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),m=H===x?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");$t.on(this._element,pt,this._config.selector,o=>{const h=this._initializeOnDelegatedTarget(o);h._activeTrigger[o.type==="focusin"?A:x]=!0,h._enter()}),$t.on(this._element,m,this._config.selector,o=>{const h=this._initializeOnDelegatedTarget(o);h._activeTrigger[o.type==="focusout"?A:x]=h._element.contains(o.relatedTarget),h._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},$t.on(this._element.closest(Rl),f,this._hideModalHandler)}_fixTitle(){const D=this._element.getAttribute("title");D&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",D),this._element.setAttribute("data-bs-original-title",D),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(D,H){clearTimeout(this._timeout),this._timeout=setTimeout(D,H)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(D){const H=Xe.getDataAttributes(this._element);for(const pt of Object.keys(H))Sa.has(pt)&&delete H[pt];return D={...H,...typeof D=="object"&&D?D:{}},D=this._mergeConfigObj(D),D=this._configAfterMerge(D),this._typeCheckConfig(D),D}_configAfterMerge(D){return D.container=D.container===!1?document.body:E(D.container),typeof D.delay=="number"&&(D.delay={show:D.delay,hide:D.delay}),typeof D.title=="number"&&(D.title=D.title.toString()),typeof D.content=="number"&&(D.content=D.content.toString()),D}_getDelegateConfig(){const D={};for(const[H,pt]of Object.entries(this._config))this.constructor.Default[H]!==pt&&(D[H]=pt);return D.selector=!1,D.trigger="manual",D}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(D){return this.each(function(){const H=Yt.getOrCreateInstance(this,D);if(typeof D=="string"){if(H[D]===void 0)throw new TypeError(`No method named "${D}"`);H[D]()}})}}ft(Yt);const ue=".popover-header",Ie=".popover-body",ni={...Yt.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},wi={...Yt.DefaultType,content:"(null|string|element|function)"};class Di extends Yt{static get Default(){return ni}static get DefaultType(){return wi}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[ue]:this._getTitle(),[Ie]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(D){return this.each(function(){const H=Di.getOrCreateInstance(this,D);if(typeof D=="string"){if(H[D]===void 0)throw new TypeError(`No method named "${D}"`);H[D]()}})}}ft(Di);const $n=".bs.scrollspy",ss=`activate${$n}`,vr=`click${$n}`,Hs=`load${$n}.data-api`,Os="active",Bl="[href]",yc=".nav-link",iu=`${yc}, .nav-item > ${yc}, .list-group-item`,Fl={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Nl={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class oo extends vi{constructor(D,H){super(D,H),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Fl}static get DefaultType(){return Nl}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const D of this._observableSections.values())this._observer.observe(D)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(D){return D.target=E(D.target)||document.body,D.rootMargin=D.offset?`${D.offset}px 0px -30%`:D.rootMargin,typeof D.threshold=="string"&&(D.threshold=D.threshold.split(",").map(H=>Number.parseFloat(H))),D}_maybeEnableSmoothScroll(){this._config.smoothScroll&&($t.off(this._config.target,vr),$t.on(this._config.target,vr,Bl,D=>{const H=this._observableSections.get(D.target.hash);if(H){D.preventDefault();const pt=this._rootElement||window,m=H.offsetTop-this._element.offsetTop;if(pt.scrollTo)return void pt.scrollTo({top:m,behavior:"smooth"});pt.scrollTop=m}}))}_getNewObserver(){const D={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(H=>this._observerCallback(H),D)}_observerCallback(D){const H=h=>this._targetLinks.get(`#${h.target.id}`),pt=h=>{this._previousScrollData.visibleEntryTop=h.target.offsetTop,this._process(H(h))},m=(this._rootElement||document.documentElement).scrollTop,o=m>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=m;for(const h of D){if(!h.isIntersecting){this._activeTarget=null,this._clearActiveClass(H(h));continue}const g=h.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(o&&g){if(pt(h),!m)return}else o||g||pt(h)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const D=Qe.find(Bl,this._config.target);for(const H of D){if(!H.hash||z(H))continue;const pt=Qe.findOne(decodeURI(H.hash),this._element);C(pt)&&(this._targetLinks.set(decodeURI(H.hash),H),this._observableSections.set(H.hash,pt))}}_process(D){this._activeTarget!==D&&(this._clearActiveClass(this._config.target),this._activeTarget=D,D.classList.add(Os),this._activateParents(D),$t.trigger(this._element,ss,{relatedTarget:D}))}_activateParents(D){if(D.classList.contains("dropdown-item"))Qe.findOne(".dropdown-toggle",D.closest(".dropdown")).classList.add(Os);else for(const H of Qe.parents(D,".nav, .list-group"))for(const pt of Qe.prev(H,iu))pt.classList.add(Os)}_clearActiveClass(D){D.classList.remove(Os);const H=Qe.find(`${Bl}.${Os}`,D);for(const pt of H)pt.classList.remove(Os)}static jQueryInterface(D){return this.each(function(){const H=oo.getOrCreateInstance(this,D);if(typeof D=="string"){if(H[D]===void 0||D.startsWith("_")||D==="constructor")throw new TypeError(`No method named "${D}"`);H[D]()}})}}$t.on(window,Hs,()=>{for(const it of Qe.find('[data-bs-spy="scroll"]'))oo.getOrCreateInstance(it)}),ft(oo);const pn=".bs.tab",jl=`hide${pn}`,nu=`hidden${pn}`,Uu=`show${pn}`,ea=`shown${pn}`,vc=`click${pn}`,su=`keydown${pn}`,Ph=`load${pn}`,kd="ArrowLeft",$u="ArrowRight",Id="ArrowUp",kh="ArrowDown",Rs="Home",Ld="End",rl="active",Dd="fade",Ih="show",Wr=".dropdown-toggle",Wu=`:not(${Wr})`,zd='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',Zr=`.nav-link${Wu}, .list-group-item${Wu}, [role="tab"]${Wu}, ${zd}`,ia=`.${rl}[data-bs-toggle="tab"], .${rl}[data-bs-toggle="pill"], .${rl}[data-bs-toggle="list"]`;class Gr extends vi{constructor(D){super(D),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),$t.on(this._element,su,H=>this._keydown(H)))}static get NAME(){return"tab"}show(){const D=this._element;if(this._elemIsActive(D))return;const H=this._getActiveElem(),pt=H?$t.trigger(H,jl,{relatedTarget:D}):null;$t.trigger(D,Uu,{relatedTarget:H}).defaultPrevented||pt&&pt.defaultPrevented||(this._deactivate(H,D),this._activate(D,H))}_activate(D,H){D&&(D.classList.add(rl),this._activate(Qe.getElementFromSelector(D)),this._queueCallback(()=>{D.getAttribute("role")==="tab"?(D.removeAttribute("tabindex"),D.setAttribute("aria-selected",!0),this._toggleDropDown(D,!0),$t.trigger(D,ea,{relatedTarget:H})):D.classList.add(Ih)},D,D.classList.contains(Dd)))}_deactivate(D,H){D&&(D.classList.remove(rl),D.blur(),this._deactivate(Qe.getElementFromSelector(D)),this._queueCallback(()=>{D.getAttribute("role")==="tab"?(D.setAttribute("aria-selected",!1),D.setAttribute("tabindex","-1"),this._toggleDropDown(D,!1),$t.trigger(D,nu,{relatedTarget:H})):D.classList.remove(Ih)},D,D.classList.contains(Dd)))}_keydown(D){if(![kd,$u,Id,kh,Rs,Ld].includes(D.key))return;D.stopPropagation(),D.preventDefault();const H=this._getChildren().filter(m=>!z(m));let pt;if([Rs,Ld].includes(D.key))pt=H[D.key===Rs?0:H.length-1];else{const m=[$u,kh].includes(D.key);pt=bt(H,D.target,m,!0)}pt&&(pt.focus({preventScroll:!0}),Gr.getOrCreateInstance(pt).show())}_getChildren(){return Qe.find(Zr,this._parent)}_getActiveElem(){return this._getChildren().find(D=>this._elemIsActive(D))||null}_setInitialAttributes(D,H){this._setAttributeIfNotExists(D,"role","tablist");for(const pt of H)this._setInitialAttributesOnChild(pt)}_setInitialAttributesOnChild(D){D=this._getInnerElement(D);const H=this._elemIsActive(D),pt=this._getOuterElement(D);D.setAttribute("aria-selected",H),pt!==D&&this._setAttributeIfNotExists(pt,"role","presentation"),H||D.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(D,"role","tab"),this._setInitialAttributesOnTargetPanel(D)}_setInitialAttributesOnTargetPanel(D){const H=Qe.getElementFromSelector(D);H&&(this._setAttributeIfNotExists(H,"role","tabpanel"),D.id&&this._setAttributeIfNotExists(H,"aria-labelledby",`${D.id}`))}_toggleDropDown(D,H){const pt=this._getOuterElement(D);if(!pt.classList.contains("dropdown"))return;const m=(o,h)=>{const g=Qe.findOne(o,pt);g&&g.classList.toggle(h,H)};m(Wr,rl),m(".dropdown-menu",Ih),pt.setAttribute("aria-expanded",H)}_setAttributeIfNotExists(D,H,pt){D.hasAttribute(H)||D.setAttribute(H,pt)}_elemIsActive(D){return D.classList.contains(rl)}_getInnerElement(D){return D.matches(Zr)?D:Qe.findOne(Zr,D)}_getOuterElement(D){return D.closest(".nav-item, .list-group-item")||D}static jQueryInterface(D){return this.each(function(){const H=Gr.getOrCreateInstance(this);if(typeof D=="string"){if(H[D]===void 0||D.startsWith("_")||D==="constructor")throw new TypeError(`No method named "${D}"`);H[D]()}})}}$t.on(document,vc,zd,function(it){["A","AREA"].includes(this.tagName)&&it.preventDefault(),z(this)||Gr.getOrCreateInstance(this).show()}),$t.on(window,Ph,()=>{for(const it of Qe.find(ia))Gr.getOrCreateInstance(it)}),ft(Gr);const zo=".bs.toast",Je=`mouseover${zo}`,Lh=`mouseout${zo}`,Dh=`focusin${zo}`,xc=`focusout${zo}`,Vl=`hide${zo}`,Ze=`hidden${zo}`,zh=`show${zo}`,Lf=`shown${zo}`,Oh="hide",bc="show",ru="showing",Od={animation:"boolean",autohide:"boolean",delay:"number"},Df={animation:!0,autohide:!0,delay:5e3};class ou extends vi{constructor(D,H){super(D,H),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Df}static get DefaultType(){return Od}static get NAME(){return"toast"}show(){$t.trigger(this._element,zh).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Oh),G(this._element),this._element.classList.add(bc,ru),this._queueCallback(()=>{this._element.classList.remove(ru),$t.trigger(this._element,Lf),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&($t.trigger(this._element,Vl).defaultPrevented||(this._element.classList.add(ru),this._queueCallback(()=>{this._element.classList.add(Oh),this._element.classList.remove(ru,bc),$t.trigger(this._element,Ze)},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(bc),super.dispose()}isShown(){return this._element.classList.contains(bc)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(D,H){switch(D.type){case"mouseover":case"mouseout":this._hasMouseInteraction=H;break;case"focusin":case"focusout":this._hasKeyboardInteraction=H}if(H)return void this._clearTimeout();const pt=D.relatedTarget;this._element===pt||this._element.contains(pt)||this._maybeScheduleHide()}_setListeners(){$t.on(this._element,Je,D=>this._onInteraction(D,!0)),$t.on(this._element,Lh,D=>this._onInteraction(D,!1)),$t.on(this._element,Dh,D=>this._onInteraction(D,!0)),$t.on(this._element,xc,D=>this._onInteraction(D,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(D){return this.each(function(){const H=ou.getOrCreateInstance(this,D);if(typeof D=="string"){if(H[D]===void 0)throw new TypeError(`No method named "${D}"`);H[D](this)}})}}return _n(ou),ft(ou),{Alert:Jt,Button:me,Carousel:Ae,Collapse:is,Dropdown:Xn,Modal:zs,Offcanvas:yr,Popover:Di,ScrollSpy:oo,Tab:Gr,Toast:ou,Tooltip:Yt}})})(W_)),W_.exports}X6();ZL(H6).mount("#app");
